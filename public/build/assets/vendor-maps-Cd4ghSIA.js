import{g as mm,c as Ii}from"./vendor-CH53hkvC.js";var Ku={exports:{}};var $_=Ku.exports,um;function V_(){return um||(um=1,(function(Fe,Oe){(function(De,st){st(Oe)})($_,(function(De){var st="1.9.4";function T(s){var m,x,C,B;for(x=1,C=arguments.length;x<C;x++){B=arguments[x];for(m in B)s[m]=B[m]}return s}var w=Object.create||(function(){function s(){}return function(m){return s.prototype=m,new s}})();function v(s,m){var x=Array.prototype.slice;if(s.bind)return s.bind.apply(s,x.call(arguments,1));var C=x.call(arguments,2);return function(){return s.apply(m,C.length?C.concat(x.call(arguments)):arguments)}}var o=0;function I(s){return"_leaflet_id"in s||(s._leaflet_id=++o),s._leaflet_id}function R(s,m,x){var C,B,W,me;return me=function(){C=!1,B&&(W.apply(x,B),B=!1)},W=function(){C?B=arguments:(s.apply(x,arguments),setTimeout(me,m),C=!0)},W}function q(s,m,x){var C=m[1],B=m[0],W=C-B;return s===C&&x?s:((s-B)%W+W)%W+B}function X(){return!1}function re(s,m){if(m===!1)return s;var x=Math.pow(10,m===void 0?6:m);return Math.round(s*x)/x}function ce(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function Ae(s){return ce(s).split(/\s+/)}function Pe(s,m){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?w(s.options):{});for(var x in m)s.options[x]=m[x];return s.options}function le(s,m,x){var C=[];for(var B in s)C.push(encodeURIComponent(x?B.toUpperCase():B)+"="+encodeURIComponent(s[B]));return(!m||m.indexOf("?")===-1?"?":"&")+C.join("&")}var it=/\{ *([\w_ -]+) *\}/g;function We(s,m){return s.replace(it,function(x,C){var B=m[C];if(B===void 0)throw new Error("No value provided for variable "+x);return typeof B=="function"&&(B=B(m)),B})}var He=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function bt(s,m){for(var x=0;x<s.length;x++)if(s[x]===m)return x;return-1}var Bt="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Di(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var Ot=0;function Ai(s){var m=+new Date,x=Math.max(0,16-(m-Ot));return Ot=m+x,window.setTimeout(s,x)}var En=window.requestAnimationFrame||Di("RequestAnimationFrame")||Ai,zn=window.cancelAnimationFrame||Di("CancelAnimationFrame")||Di("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function Pi(s,m,x){if(x&&En===Ai)s.call(m);else return En.call(window,v(s,m))}function yi(s){s&&zn.call(window,s)}var Jn={__proto__:null,extend:T,create:w,bind:v,get lastId(){return o},stamp:I,throttle:R,wrapNum:q,falseFn:X,formatNum:re,trim:ce,splitWords:Ae,setOptions:Pe,getParamString:le,template:We,isArray:He,indexOf:bt,emptyImageUrl:Bt,requestFn:En,cancelFn:zn,requestAnimFrame:Pi,cancelAnimFrame:yi};function bn(){}bn.extend=function(s){var m=function(){Pe(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},x=m.__super__=this.prototype,C=w(x);C.constructor=m,m.prototype=C;for(var B in this)Object.prototype.hasOwnProperty.call(this,B)&&B!=="prototype"&&B!=="__super__"&&(m[B]=this[B]);return s.statics&&T(m,s.statics),s.includes&&(za(s.includes),T.apply(null,[C].concat(s.includes))),T(C,s),delete C.statics,delete C.includes,C.options&&(C.options=x.options?w(x.options):{},T(C.options,s.options)),C._initHooks=[],C.callInitHooks=function(){if(!this._initHooksCalled){x.callInitHooks&&x.callInitHooks.call(this),this._initHooksCalled=!0;for(var W=0,me=C._initHooks.length;W<me;W++)C._initHooks[W].call(this)}},m},bn.include=function(s){var m=this.prototype.options;return T(this.prototype,s),s.options&&(this.prototype.options=m,this.mergeOptions(s.options)),this},bn.mergeOptions=function(s){return T(this.prototype.options,s),this},bn.addInitHook=function(s){var m=Array.prototype.slice.call(arguments,1),x=typeof s=="function"?s:function(){this[s].apply(this,m)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(x),this};function za(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=He(s)?s:[s];for(var m=0;m<s.length;m++)s[m]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ji={on:function(s,m,x){if(typeof s=="object")for(var C in s)this._on(C,s[C],m);else{s=Ae(s);for(var B=0,W=s.length;B<W;B++)this._on(s[B],m,x)}return this},off:function(s,m,x){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var C in s)this._off(C,s[C],m);else{s=Ae(s);for(var B=arguments.length===1,W=0,me=s.length;W<me;W++)B?this._off(s[W]):this._off(s[W],m,x)}return this},_on:function(s,m,x,C){if(typeof m!="function"){console.warn("wrong listener type: "+typeof m);return}if(this._listens(s,m,x)===!1){x===this&&(x=void 0);var B={fn:m,ctx:x};C&&(B.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(B)}},_off:function(s,m,x){var C,B,W;if(this._events&&(C=this._events[s],!!C)){if(arguments.length===1){if(this._firingCount)for(B=0,W=C.length;B<W;B++)C[B].fn=X;delete this._events[s];return}if(typeof m!="function"){console.warn("wrong listener type: "+typeof m);return}var me=this._listens(s,m,x);if(me!==!1){var be=C[me];this._firingCount&&(be.fn=X,this._events[s]=C=C.slice()),C.splice(me,1)}}},fire:function(s,m,x){if(!this.listens(s,x))return this;var C=T({},m,{type:s,target:this,sourceTarget:m&&m.sourceTarget||this});if(this._events){var B=this._events[s];if(B){this._firingCount=this._firingCount+1||1;for(var W=0,me=B.length;W<me;W++){var be=B[W],Re=be.fn;be.once&&this.off(s,Re,be.ctx),Re.call(be.ctx||this,C)}this._firingCount--}}return x&&this._propagateEvent(C),this},listens:function(s,m,x,C){typeof s!="string"&&console.warn('"string" type argument expected');var B=m;typeof m!="function"&&(C=!!m,B=void 0,x=void 0);var W=this._events&&this._events[s];if(W&&W.length&&this._listens(s,B,x)!==!1)return!0;if(C){for(var me in this._eventParents)if(this._eventParents[me].listens(s,m,x,C))return!0}return!1},_listens:function(s,m,x){if(!this._events)return!1;var C=this._events[s]||[];if(!m)return!!C.length;x===this&&(x=void 0);for(var B=0,W=C.length;B<W;B++)if(C[B].fn===m&&C[B].ctx===x)return B;return!1},once:function(s,m,x){if(typeof s=="object")for(var C in s)this._on(C,s[C],m,!0);else{s=Ae(s);for(var B=0,W=s.length;B<W;B++)this._on(s[B],m,x,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[I(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[I(s)],this},_propagateEvent:function(s){for(var m in this._eventParents)this._eventParents[m].fire(s.type,T({layer:s.target,propagatedFrom:s.target},s),!0)}};Ji.addEventListener=Ji.on,Ji.removeEventListener=Ji.clearAllEventListeners=Ji.off,Ji.addOneTimeEventListener=Ji.once,Ji.fireEvent=Ji.fire,Ji.hasEventListeners=Ji.listens;var Hi=bn.extend(Ji);function _t(s,m,x){this.x=x?Math.round(s):s,this.y=x?Math.round(m):m}var $t=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};_t.prototype={clone:function(){return new _t(this.x,this.y)},add:function(s){return this.clone()._add(pt(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(pt(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new _t(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new _t(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=$t(this.x),this.y=$t(this.y),this},distanceTo:function(s){s=pt(s);var m=s.x-this.x,x=s.y-this.y;return Math.sqrt(m*m+x*x)},equals:function(s){return s=pt(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=pt(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+re(this.x)+", "+re(this.y)+")"}};function pt(s,m,x){return s instanceof _t?s:He(s)?new _t(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new _t(s.x,s.y):new _t(s,m,x)}function Ut(s,m){if(s)for(var x=m?[s,m]:s,C=0,B=x.length;C<B;C++)this.extend(x[C])}Ut.prototype={extend:function(s){var m,x;if(!s)return this;if(s instanceof _t||typeof s[0]=="number"||"x"in s)m=x=pt(s);else if(s=Ri(s),m=s.min,x=s.max,!m||!x)return this;return!this.min&&!this.max?(this.min=m.clone(),this.max=x.clone()):(this.min.x=Math.min(m.x,this.min.x),this.max.x=Math.max(x.x,this.max.x),this.min.y=Math.min(m.y,this.min.y),this.max.y=Math.max(x.y,this.max.y)),this},getCenter:function(s){return pt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return pt(this.min.x,this.max.y)},getTopRight:function(){return pt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var m,x;return typeof s[0]=="number"||s instanceof _t?s=pt(s):s=Ri(s),s instanceof Ut?(m=s.min,x=s.max):m=x=s,m.x>=this.min.x&&x.x<=this.max.x&&m.y>=this.min.y&&x.y<=this.max.y},intersects:function(s){s=Ri(s);var m=this.min,x=this.max,C=s.min,B=s.max,W=B.x>=m.x&&C.x<=x.x,me=B.y>=m.y&&C.y<=x.y;return W&&me},overlaps:function(s){s=Ri(s);var m=this.min,x=this.max,C=s.min,B=s.max,W=B.x>m.x&&C.x<x.x,me=B.y>m.y&&C.y<x.y;return W&&me},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var m=this.min,x=this.max,C=Math.abs(m.x-x.x)*s,B=Math.abs(m.y-x.y)*s;return Ri(pt(m.x-C,m.y-B),pt(x.x+C,x.y+B))},equals:function(s){return s?(s=Ri(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function Ri(s,m){return!s||s instanceof Ut?s:new Ut(s,m)}function Ni(s,m){if(s)for(var x=m?[s,m]:s,C=0,B=x.length;C<B;C++)this.extend(x[C])}Ni.prototype={extend:function(s){var m=this._southWest,x=this._northEast,C,B;if(s instanceof Tt)C=s,B=s;else if(s instanceof Ni){if(C=s._southWest,B=s._northEast,!C||!B)return this}else return s?this.extend(kt(s)||ei(s)):this;return!m&&!x?(this._southWest=new Tt(C.lat,C.lng),this._northEast=new Tt(B.lat,B.lng)):(m.lat=Math.min(C.lat,m.lat),m.lng=Math.min(C.lng,m.lng),x.lat=Math.max(B.lat,x.lat),x.lng=Math.max(B.lng,x.lng)),this},pad:function(s){var m=this._southWest,x=this._northEast,C=Math.abs(m.lat-x.lat)*s,B=Math.abs(m.lng-x.lng)*s;return new Ni(new Tt(m.lat-C,m.lng-B),new Tt(x.lat+C,x.lng+B))},getCenter:function(){return new Tt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Tt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Tt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Tt||"lat"in s?s=kt(s):s=ei(s);var m=this._southWest,x=this._northEast,C,B;return s instanceof Ni?(C=s.getSouthWest(),B=s.getNorthEast()):C=B=s,C.lat>=m.lat&&B.lat<=x.lat&&C.lng>=m.lng&&B.lng<=x.lng},intersects:function(s){s=ei(s);var m=this._southWest,x=this._northEast,C=s.getSouthWest(),B=s.getNorthEast(),W=B.lat>=m.lat&&C.lat<=x.lat,me=B.lng>=m.lng&&C.lng<=x.lng;return W&&me},overlaps:function(s){s=ei(s);var m=this._southWest,x=this._northEast,C=s.getSouthWest(),B=s.getNorthEast(),W=B.lat>m.lat&&C.lat<x.lat,me=B.lng>m.lng&&C.lng<x.lng;return W&&me},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,m){return s?(s=ei(s),this._southWest.equals(s.getSouthWest(),m)&&this._northEast.equals(s.getNorthEast(),m)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ei(s,m){return s instanceof Ni?s:new Ni(s,m)}function Tt(s,m,x){if(isNaN(s)||isNaN(m))throw new Error("Invalid LatLng object: ("+s+", "+m+")");this.lat=+s,this.lng=+m,x!==void 0&&(this.alt=+x)}Tt.prototype={equals:function(s,m){if(!s)return!1;s=kt(s);var x=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return x<=(m===void 0?1e-9:m)},toString:function(s){return"LatLng("+re(this.lat,s)+", "+re(this.lng,s)+")"},distanceTo:function(s){return mi.distance(this,kt(s))},wrap:function(){return mi.wrapLatLng(this)},toBounds:function(s){var m=180*s/40075017,x=m/Math.cos(Math.PI/180*this.lat);return ei([this.lat-m,this.lng-x],[this.lat+m,this.lng+x])},clone:function(){return new Tt(this.lat,this.lng,this.alt)}};function kt(s,m,x){return s instanceof Tt?s:He(s)&&typeof s[0]!="object"?s.length===3?new Tt(s[0],s[1],s[2]):s.length===2?new Tt(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Tt(s.lat,"lng"in s?s.lng:s.lon,s.alt):m===void 0?null:new Tt(s,m,x)}var Wi={latLngToPoint:function(s,m){var x=this.projection.project(s),C=this.scale(m);return this.transformation._transform(x,C)},pointToLatLng:function(s,m){var x=this.scale(m),C=this.transformation.untransform(s,x);return this.projection.unproject(C)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var m=this.projection.bounds,x=this.scale(s),C=this.transformation.transform(m.min,x),B=this.transformation.transform(m.max,x);return new Ut(C,B)},infinite:!1,wrapLatLng:function(s){var m=this.wrapLng?q(s.lng,this.wrapLng,!0):s.lng,x=this.wrapLat?q(s.lat,this.wrapLat,!0):s.lat,C=s.alt;return new Tt(x,m,C)},wrapLatLngBounds:function(s){var m=s.getCenter(),x=this.wrapLatLng(m),C=m.lat-x.lat,B=m.lng-x.lng;if(C===0&&B===0)return s;var W=s.getSouthWest(),me=s.getNorthEast(),be=new Tt(W.lat-C,W.lng-B),Re=new Tt(me.lat-C,me.lng-B);return new Ni(be,Re)}},mi=T({},Wi,{wrapLng:[-180,180],R:6371e3,distance:function(s,m){var x=Math.PI/180,C=s.lat*x,B=m.lat*x,W=Math.sin((m.lat-s.lat)*x/2),me=Math.sin((m.lng-s.lng)*x/2),be=W*W+Math.cos(C)*Math.cos(B)*me*me,Re=2*Math.atan2(Math.sqrt(be),Math.sqrt(1-be));return this.R*Re}}),ga=6378137,dn={R:ga,MAX_LATITUDE:85.0511287798,project:function(s){var m=Math.PI/180,x=this.MAX_LATITUDE,C=Math.max(Math.min(x,s.lat),-x),B=Math.sin(C*m);return new _t(this.R*s.lng*m,this.R*Math.log((1+B)/(1-B))/2)},unproject:function(s){var m=180/Math.PI;return new Tt((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*m,s.x*m/this.R)},bounds:(function(){var s=ga*Math.PI;return new Ut([-s,-s],[s,s])})()};function Ia(s,m,x,C){if(He(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=m,this._c=x,this._d=C}Ia.prototype={transform:function(s,m){return this._transform(s.clone(),m)},_transform:function(s,m){return m=m||1,s.x=m*(this._a*s.x+this._b),s.y=m*(this._c*s.y+this._d),s},untransform:function(s,m){return m=m||1,new _t((s.x/m-this._b)/this._a,(s.y/m-this._d)/this._c)}};function nn(s,m,x,C){return new Ia(s,m,x,C)}var pr=T({},mi,{code:"EPSG:3857",projection:dn,transformation:(function(){var s=.5/(Math.PI*dn.R);return nn(s,.5,-s,.5)})()}),Qi=T({},pr,{code:"EPSG:900913"});function Un(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function oa(s,m){var x="",C,B,W,me,be,Re;for(C=0,W=s.length;C<W;C++){for(be=s[C],B=0,me=be.length;B<me;B++)Re=be[B],x+=(B?"L":"M")+Re.x+" "+Re.y;x+=m?Ee.svg?"z":"x":""}return x||"M0 0"}var hi=document.documentElement.style,sa="ActiveXObject"in window,_r=sa&&!document.addEventListener,gr="msLaunchUri"in navigator&&!("documentMode"in document),ya=Dn("webkit"),Qn=Dn("android"),yr=Dn("android 2")||Dn("android 3"),$r=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),In=Qn&&Dn("Google")&&$r<537&&!("AudioNode"in window),xe=!!window.opera,G=!gr&&Dn("chrome"),U=Dn("gecko")&&!ya&&!xe&&!sa,Y=!G&&Dn("safari"),fe=Dn("phantom"),pe="OTransition"in hi,ke=navigator.platform.indexOf("Win")===0,ve=sa&&"transition"in hi,ge="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!yr,Me="MozPerspective"in hi,Ge=!window.L_DISABLE_3D&&(ve||ge||Me)&&!pe&&!fe,$e=typeof orientation<"u"||Dn("mobile"),nt=$e&&ya,dt=$e&&ge,gt=!window.PointerEvent&&window.MSPointerEvent,Ht=!!(window.PointerEvent||gt),Vt="ontouchstart"in window||!!window.TouchEvent,Se=!window.L_NO_TOUCH&&(Vt||Ht),ti=$e&&xe,an=$e&&U,yt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Wt=(function(){var s=!1;try{var m=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",X,m),window.removeEventListener("testPassiveEventSupport",X,m)}catch{}return s})(),rn=(function(){return!!document.createElement("canvas").getContext})(),ii=!!(document.createElementNS&&Un("svg").createSVGRect),vi=!!ii&&(function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ni=!ii&&(function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var m=s.firstChild;return m.style.behavior="url(#default#VML)",m&&typeof m.adj=="object"}catch{return!1}})(),Ui=navigator.platform.indexOf("Mac")===0,vo=navigator.platform.indexOf("Linux")===0;function Dn(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Ee={ie:sa,ielt9:_r,edge:gr,webkit:ya,android:Qn,android23:yr,androidStock:In,opera:xe,chrome:G,gecko:U,safari:Y,phantom:fe,opera12:pe,win:ke,ie3d:ve,webkit3d:ge,gecko3d:Me,any3d:Ge,mobile:$e,mobileWebkit:nt,mobileWebkit3d:dt,msPointer:gt,pointer:Ht,touch:Se,touchNative:Vt,mobileOpera:ti,mobileGecko:an,retina:yt,passiveEvents:Wt,canvas:rn,svg:ii,vml:ni,inlineSvg:vi,mac:Ui,linux:vo},hn=Ee.msPointer?"MSPointerDown":"pointerdown",cn=Ee.msPointer?"MSPointerMove":"pointermove",xo=Ee.msPointer?"MSPointerUp":"pointerup",Gn=Ee.msPointer?"MSPointerCancel":"pointercancel",Qe={touchstart:hn,touchmove:cn,touchend:xo,touchcancel:Gn},Mt={touchstart:bo,touchmove:Aa,touchend:Aa,touchcancel:Aa},xt={},An=!1;function Wo(s,m,x){return m==="touchstart"&&Ko(),Mt[m]?(x=Mt[m].bind(this,x),s.addEventListener(Qe[m],x,!1),x):(console.warn("wrong event specified:",m),X)}function Da(s,m,x){if(!Qe[m]){console.warn("wrong event specified:",m);return}s.removeEventListener(Qe[m],x,!1)}function Pt(s){xt[s.pointerId]=s}function wo(s){xt[s.pointerId]&&(xt[s.pointerId]=s)}function Vr(s){delete xt[s.pointerId]}function Ko(){An||(document.addEventListener(hn,Pt,!0),document.addEventListener(cn,wo,!0),document.addEventListener(xo,Vr,!0),document.addEventListener(Gn,Vr,!0),An=!0)}function Aa(s,m){if(m.pointerType!==(m.MSPOINTER_TYPE_MOUSE||"mouse")){m.touches=[];for(var x in xt)m.touches.push(xt[x]);m.changedTouches=[m],s(m)}}function bo(s,m){m.MSPOINTER_TYPE_TOUCH&&m.pointerType===m.MSPOINTER_TYPE_TOUCH&&Rt(m),Aa(s,m)}function Nr(s){var m={},x,C;for(C in s)x=s[C],m[C]=x&&x.bind?x.bind(s):x;return s=m,m.type="dblclick",m.detail=2,m.isTrusted=!1,m._simulated=!0,m}var ko=200;function kn(s,m){s.addEventListener("dblclick",m);var x=0,C;function B(W){if(W.detail!==1){C=W.detail;return}if(!(W.pointerType==="mouse"||W.sourceCapabilities&&!W.sourceCapabilities.firesTouchEvents)){var me=ua(W);if(!(me.some(function(Re){return Re instanceof HTMLLabelElement&&Re.attributes.for})&&!me.some(function(Re){return Re instanceof HTMLInputElement||Re instanceof HTMLSelectElement}))){var be=Date.now();be-x<=ko?(C++,C===2&&m(Nr(W))):C=1,x=be}}}return s.addEventListener("click",B),{dblclick:m,simDblclick:B}}function Kt(s,m){s.removeEventListener("dblclick",m.dblclick),s.removeEventListener("click",m.simDblclick)}var Ur=qr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),va=qr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Gr=va==="webkitTransition"||va==="OTransition"?va+"End":"transitionend";function tr(s){return typeof s=="string"?document.getElementById(s):s}function Sn(s,m){var x=s.style[m]||s.currentStyle&&s.currentStyle[m];if((!x||x==="auto")&&document.defaultView){var C=document.defaultView.getComputedStyle(s,null);x=C?C[m]:null}return x==="auto"?null:x}function Gt(s,m,x){var C=document.createElement(s);return C.className=m||"",x&&x.appendChild(C),C}function Yt(s){var m=s.parentNode;m&&m.removeChild(s)}function vr(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function ai(s){var m=s.parentNode;m&&m.lastChild!==s&&m.appendChild(s)}function xr(s){var m=s.parentNode;m&&m.firstChild!==s&&m.insertBefore(s,m.firstChild)}function Xo(s,m){if(s.classList!==void 0)return s.classList.contains(m);var x=So(s);return x.length>0&&new RegExp("(^|\\s)"+m+"(\\s|$)").test(x)}function Ct(s,m){if(s.classList!==void 0)for(var x=Ae(m),C=0,B=x.length;C<B;C++)s.classList.add(x[C]);else if(!Xo(s,m)){var W=So(s);Yo(s,(W?W+" ":"")+m)}}function Li(s,m){s.classList!==void 0?s.classList.remove(m):Yo(s,ce((" "+So(s)+" ").replace(" "+m+" "," ")))}function Yo(s,m){s.className.baseVal===void 0?s.className=m:s.className.baseVal=m}function So(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Tn(s,m){"opacity"in s.style?s.style.opacity=m:"filter"in s.style&&ks(s,m)}function ks(s,m){var x=!1,C="DXImageTransform.Microsoft.Alpha";try{x=s.filters.item(C)}catch{if(m===1)return}m=Math.round(m*100),x?(x.Enabled=m!==100,x.Opacity=m):s.style.filter+=" progid:"+C+"(opacity="+m+")"}function qr(s){for(var m=document.documentElement.style,x=0;x<s.length;x++)if(s[x]in m)return s[x];return!1}function Ra(s,m,x){var C=m||new _t(0,0);s.style[Ur]=(Ee.ie3d?"translate("+C.x+"px,"+C.y+"px)":"translate3d("+C.x+"px,"+C.y+"px,0)")+(x?" scale("+x+")":"")}function Mi(s,m){s._leaflet_pos=m,Ee.any3d?Ra(s,m):(s.style.left=m.x+"px",s.style.top=m.y+"px")}function wr(s){return s._leaflet_pos||new _t(0,0)}var ja,ir,Jo;if("onselectstart"in document)ja=function(){mt(window,"selectstart",Rt)},ir=function(){rt(window,"selectstart",Rt)};else{var xa=qr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ja=function(){if(xa){var s=document.documentElement.style;Jo=s[xa],s[xa]="none"}},ir=function(){xa&&(document.documentElement.style[xa]=Jo,Jo=void 0)}}function To(){mt(window,"dragstart",Rt)}function br(){rt(window,"dragstart",Rt)}var la,nr;function Lt(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Zr(),la=s,nr=s.style.outlineStyle,s.style.outlineStyle="none",mt(window,"keydown",Zr))}function Zr(){la&&(la.style.outlineStyle=nr,la=void 0,nr=void 0,rt(window,"keydown",Zr))}function il(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Po(s){var m=s.getBoundingClientRect();return{x:m.width/s.offsetWidth||1,y:m.height/s.offsetHeight||1,boundingClientRect:m}}var Rn={__proto__:null,TRANSFORM:Ur,TRANSITION:va,TRANSITION_END:Gr,get:tr,getStyle:Sn,create:Gt,remove:Yt,empty:vr,toFront:ai,toBack:xr,hasClass:Xo,addClass:Ct,removeClass:Li,setClass:Yo,getClass:So,setOpacity:Tn,testProp:qr,setTransform:Ra,setPosition:Mi,getPosition:wr,get disableTextSelection(){return ja},get enableTextSelection(){return ir},disableImageDrag:To,enableImageDrag:br,preventOutline:Lt,restoreOutline:Zr,getSizedParentNode:il,getScale:Po};function mt(s,m,x,C){if(m&&typeof m=="object")for(var B in m)on(s,B,m[B],x);else{m=Ae(m);for(var W=0,me=m.length;W<me;W++)on(s,m[W],x,C)}return this}var qt="_leaflet_events";function rt(s,m,x,C){if(arguments.length===1)Jt(s),delete s[qt];else if(m&&typeof m=="object")for(var B in m)Pn(s,B,m[B],x);else if(m=Ae(m),arguments.length===2)Jt(s,function(be){return bt(m,be)!==-1});else for(var W=0,me=m.length;W<me;W++)Pn(s,m[W],x,C);return this}function Jt(s,m){for(var x in s[qt]){var C=x.split(/\d/)[0];(!m||m(C))&&Pn(s,C,null,null,x)}}var wa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function on(s,m,x,C){var B=m+I(x)+(C?"_"+I(C):"");if(s[qt]&&s[qt][B])return this;var W=function(be){return x.call(C||s,be||window.event)},me=W;!Ee.touchNative&&Ee.pointer&&m.indexOf("touch")===0?W=Wo(s,m,W):Ee.touch&&m==="dblclick"?W=kn(s,W):"addEventListener"in s?m==="touchstart"||m==="touchmove"||m==="wheel"||m==="mousewheel"?s.addEventListener(wa[m]||m,W,Ee.passiveEvents?{passive:!1}:!1):m==="mouseenter"||m==="mouseleave"?(W=function(be){be=be||window.event,da(s,be)&&me(be)},s.addEventListener(wa[m],W,!1)):s.addEventListener(m,me,!1):s.attachEvent("on"+m,W),s[qt]=s[qt]||{},s[qt][B]=W}function Pn(s,m,x,C,B){B=B||m+I(x)+(C?"_"+I(C):"");var W=s[qt]&&s[qt][B];if(!W)return this;!Ee.touchNative&&Ee.pointer&&m.indexOf("touch")===0?Da(s,m,W):Ee.touch&&m==="dblclick"?Kt(s,W):"removeEventListener"in s?s.removeEventListener(wa[m]||m,W,!1):s.detachEvent("on"+m,W),s[qt][B]=null}function ji(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function ar(s){return on(s,"wheel",ji),this}function ea(s){return mt(s,"mousedown touchstart dblclick contextmenu",ji),s._leaflet_disable_click=!0,this}function Rt(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function qn(s){return Rt(s),ji(s),this}function ua(s){if(s.composedPath)return s.composedPath();for(var m=[],x=s.target;x;)m.push(x),x=x.parentNode;return m}function Lo(s,m){if(!m)return new _t(s.clientX,s.clientY);var x=Po(m),C=x.boundingClientRect;return new _t((s.clientX-C.left)/x.x-m.clientLeft,(s.clientY-C.top)/x.y-m.clientTop)}var jn=Ee.linux&&Ee.chrome?window.devicePixelRatio:Ee.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function rr(s){return Ee.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/jn:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function da(s,m){var x=m.relatedTarget;if(!x)return!0;try{for(;x&&x!==s;)x=x.parentNode}catch{return!1}return x!==s}var nl={__proto__:null,on:mt,off:rt,stopPropagation:ji,disableScrollPropagation:ar,disableClickPropagation:ea,preventDefault:Rt,stop:qn,getPropagationPath:ua,getMousePosition:Lo,getWheelDelta:rr,isExternalTarget:da,addListener:mt,removeListener:rt},Qo=Hi.extend({run:function(s,m,x,C){this.stop(),this._el=s,this._inProgress=!0,this._duration=x||.25,this._easeOutPower=1/Math.max(C||.5,.2),this._startPos=wr(s),this._offset=m.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Pi(this._animate,this),this._step()},_step:function(s){var m=+new Date-this._startTime,x=this._duration*1e3;m<x?this._runFrame(this._easeOut(m/x),s):(this._runFrame(1),this._complete())},_runFrame:function(s,m){var x=this._startPos.add(this._offset.multiplyBy(s));m&&x._round(),Mi(this._el,x),this.fire("step")},_complete:function(){yi(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),It=Hi.extend({options:{crs:pr,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,m){m=Pe(this,m),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=v(this._onResize,this),this._initEvents(),m.maxBounds&&this.setMaxBounds(m.maxBounds),m.zoom!==void 0&&(this._zoom=this._limitZoom(m.zoom)),m.center&&m.zoom!==void 0&&this.setView(kt(m.center),m.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=va&&Ee.any3d&&!Ee.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),mt(this._proxy,Gr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,m,x){if(m=m===void 0?this._zoom:this._limitZoom(m),s=this._limitCenter(kt(s),m,this.options.maxBounds),x=x||{},this._stop(),this._loaded&&!x.reset&&x!==!0){x.animate!==void 0&&(x.zoom=T({animate:x.animate},x.zoom),x.pan=T({animate:x.animate,duration:x.duration},x.pan));var C=this._zoom!==m?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,m,x.zoom):this._tryAnimatedPan(s,x.pan);if(C)return clearTimeout(this._sizeTimer),this}return this._resetView(s,m,x.pan&&x.pan.noMoveStart),this},setZoom:function(s,m){return this._loaded?this.setView(this.getCenter(),s,{zoom:m}):(this._zoom=s,this)},zoomIn:function(s,m){return s=s||(Ee.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,m)},zoomOut:function(s,m){return s=s||(Ee.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,m)},setZoomAround:function(s,m,x){var C=this.getZoomScale(m),B=this.getSize().divideBy(2),W=s instanceof _t?s:this.latLngToContainerPoint(s),me=W.subtract(B).multiplyBy(1-1/C),be=this.containerPointToLatLng(B.add(me));return this.setView(be,m,{zoom:x})},_getBoundsCenterZoom:function(s,m){m=m||{},s=s.getBounds?s.getBounds():ei(s);var x=pt(m.paddingTopLeft||m.padding||[0,0]),C=pt(m.paddingBottomRight||m.padding||[0,0]),B=this.getBoundsZoom(s,!1,x.add(C));if(B=typeof m.maxZoom=="number"?Math.min(m.maxZoom,B):B,B===1/0)return{center:s.getCenter(),zoom:B};var W=C.subtract(x).divideBy(2),me=this.project(s.getSouthWest(),B),be=this.project(s.getNorthEast(),B),Re=this.unproject(me.add(be).divideBy(2).add(W),B);return{center:Re,zoom:B}},fitBounds:function(s,m){if(s=ei(s),!s.isValid())throw new Error("Bounds are not valid.");var x=this._getBoundsCenterZoom(s,m);return this.setView(x.center,x.zoom,m)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,m){return this.setView(s,this._zoom,{pan:m})},panBy:function(s,m){if(s=pt(s).round(),m=m||{},!s.x&&!s.y)return this.fire("moveend");if(m.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Qo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),m.noMoveStart||this.fire("movestart"),m.animate!==!1){Ct(this._mapPane,"leaflet-pan-anim");var x=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,x,m.duration||.25,m.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,m,x){if(x=x||{},x.animate===!1||!Ee.any3d)return this.setView(s,m,x);this._stop();var C=this.project(this.getCenter()),B=this.project(s),W=this.getSize(),me=this._zoom;s=kt(s),m=m===void 0?me:m;var be=Math.max(W.x,W.y),Re=be*this.getZoomScale(me,m),Ze=B.distanceTo(C)||1,ut=1.42,vt=ut*ut;function Dt(wi){var dr=wi?-1:1,hs=wi?Re:be,hr=Re*Re-be*be+dr*vt*vt*Ze*Ze,Fo=2*hs*vt*Ze,qa=hr/Fo,Ir=Math.sqrt(qa*qa+1)-qa,kl=Ir<1e-9?-18:Math.log(Ir);return kl}function Ki(wi){return(Math.exp(wi)-Math.exp(-wi))/2}function Bi(wi){return(Math.exp(wi)+Math.exp(-wi))/2}function Kn(wi){return Ki(wi)/Bi(wi)}var Ln=Dt(0);function Pa(wi){return be*(Bi(Ln)/Bi(Ln+ut*wi))}function ds(wi){return be*(Bi(Ln)*Kn(Ln+ut*wi)-Ki(Ln))/vt}function wl(wi){return 1-Math.pow(1-wi,1.5)}var bl=Date.now(),xi=(Dt(1)-Ln)/ut,zr=x.duration?1e3*x.duration:1e3*xi*.8;function Bn(){var wi=(Date.now()-bl)/zr,dr=wl(wi)*xi;wi<=1?(this._flyToFrame=Pi(Bn,this),this._move(this.unproject(C.add(B.subtract(C).multiplyBy(ds(dr)/Ze)),me),this.getScaleZoom(be/Pa(dr),me),{flyTo:!0})):this._move(s,m)._moveEnd(!0)}return this._moveStart(!0,x.noMoveStart),Bn.call(this),this},flyToBounds:function(s,m){var x=this._getBoundsCenterZoom(s,m);return this.flyTo(x.center,x.zoom,m)},setMaxBounds:function(s){return s=ei(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var m=this.options.minZoom;return this.options.minZoom=s,this._loaded&&m!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var m=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&m!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,m){this._enforcingBounds=!0;var x=this.getCenter(),C=this._limitCenter(x,this._zoom,ei(s));return x.equals(C)||this.panTo(C,m),this._enforcingBounds=!1,this},panInside:function(s,m){m=m||{};var x=pt(m.paddingTopLeft||m.padding||[0,0]),C=pt(m.paddingBottomRight||m.padding||[0,0]),B=this.project(this.getCenter()),W=this.project(s),me=this.getPixelBounds(),be=Ri([me.min.add(x),me.max.subtract(C)]),Re=be.getSize();if(!be.contains(W)){this._enforcingBounds=!0;var Ze=W.subtract(be.getCenter()),ut=be.extend(W).getSize().subtract(Re);B.x+=Ze.x<0?-ut.x:ut.x,B.y+=Ze.y<0?-ut.y:ut.y,this.panTo(this.unproject(B),m),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=T({animate:!1,pan:!0},s===!0?{animate:!0}:s);var m=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var x=this.getSize(),C=m.divideBy(2).round(),B=x.divideBy(2).round(),W=C.subtract(B);return!W.x&&!W.y?this:(s.animate&&s.pan?this.panBy(W):(s.pan&&this._rawPanBy(W),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(v(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:m,newSize:x}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=T({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var m=v(this._handleGeolocationResponse,this),x=v(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(m,x,s):navigator.geolocation.getCurrentPosition(m,x,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var m=s.code,x=s.message||(m===1?"permission denied":m===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:m,message:"Geolocation error: "+x+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var m=s.coords.latitude,x=s.coords.longitude,C=new Tt(m,x),B=C.toBounds(s.coords.accuracy*2),W=this._locateOptions;if(W.setView){var me=this.getBoundsZoom(B);this.setView(C,W.maxZoom?Math.min(me,W.maxZoom):me)}var be={latlng:C,bounds:B,timestamp:s.timestamp};for(var Re in s.coords)typeof s.coords[Re]=="number"&&(be[Re]=s.coords[Re]);this.fire("locationfound",be)}},addHandler:function(s,m){if(!m)return this;var x=this[s]=new m(this);return this._handlers.push(x),this.options[s]&&x.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Yt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(yi(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Yt(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,m){var x="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),C=Gt("div",x,m||this._mapPane);return s&&(this._panes[s]=C),C},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),m=this.unproject(s.getBottomLeft()),x=this.unproject(s.getTopRight());return new Ni(m,x)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,m,x){s=ei(s),x=pt(x||[0,0]);var C=this.getZoom()||0,B=this.getMinZoom(),W=this.getMaxZoom(),me=s.getNorthWest(),be=s.getSouthEast(),Re=this.getSize().subtract(x),Ze=Ri(this.project(be,C),this.project(me,C)).getSize(),ut=Ee.any3d?this.options.zoomSnap:1,vt=Re.x/Ze.x,Dt=Re.y/Ze.y,Ki=m?Math.max(vt,Dt):Math.min(vt,Dt);return C=this.getScaleZoom(Ki,C),ut&&(C=Math.round(C/(ut/100))*(ut/100),C=m?Math.ceil(C/ut)*ut:Math.floor(C/ut)*ut),Math.max(B,Math.min(W,C))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new _t(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,m){var x=this._getTopLeftPoint(s,m);return new Ut(x,x.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,m){var x=this.options.crs;return m=m===void 0?this._zoom:m,x.scale(s)/x.scale(m)},getScaleZoom:function(s,m){var x=this.options.crs;m=m===void 0?this._zoom:m;var C=x.zoom(s*x.scale(m));return isNaN(C)?1/0:C},project:function(s,m){return m=m===void 0?this._zoom:m,this.options.crs.latLngToPoint(kt(s),m)},unproject:function(s,m){return m=m===void 0?this._zoom:m,this.options.crs.pointToLatLng(pt(s),m)},layerPointToLatLng:function(s){var m=pt(s).add(this.getPixelOrigin());return this.unproject(m)},latLngToLayerPoint:function(s){var m=this.project(kt(s))._round();return m._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(kt(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(ei(s))},distance:function(s,m){return this.options.crs.distance(kt(s),kt(m))},containerPointToLayerPoint:function(s){return pt(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return pt(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var m=this.containerPointToLayerPoint(pt(s));return this.layerPointToLatLng(m)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(kt(s)))},mouseEventToContainerPoint:function(s){return Lo(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var m=this._container=tr(s);if(m){if(m._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");mt(m,"scroll",this._onScroll,this),this._containerId=I(m)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ee.any3d,Ct(s,"leaflet-container"+(Ee.touch?" leaflet-touch":"")+(Ee.retina?" leaflet-retina":"")+(Ee.ielt9?" leaflet-oldie":"")+(Ee.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var m=Sn(s,"position");m!=="absolute"&&m!=="relative"&&m!=="fixed"&&m!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Mi(this._mapPane,new _t(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ct(s.markerPane,"leaflet-zoom-hide"),Ct(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,m,x){Mi(this._mapPane,new _t(0,0));var C=!this._loaded;this._loaded=!0,m=this._limitZoom(m),this.fire("viewprereset");var B=this._zoom!==m;this._moveStart(B,x)._move(s,m)._moveEnd(B),this.fire("viewreset"),C&&this.fire("load")},_moveStart:function(s,m){return s&&this.fire("zoomstart"),m||this.fire("movestart"),this},_move:function(s,m,x,C){m===void 0&&(m=this._zoom);var B=this._zoom!==m;return this._zoom=m,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),C?x&&x.pinch&&this.fire("zoom",x):((B||x&&x.pinch)&&this.fire("zoom",x),this.fire("move",x)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return yi(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Mi(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[I(this._container)]=this;var m=s?rt:mt;m(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&m(window,"resize",this._onResize,this),Ee.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){yi(this._resizeRequest),this._resizeRequest=Pi(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,m){for(var x=[],C,B=m==="mouseout"||m==="mouseover",W=s.target||s.srcElement,me=!1;W;){if(C=this._targets[I(W)],C&&(m==="click"||m==="preclick")&&this._draggableMoved(C)){me=!0;break}if(C&&C.listens(m,!0)&&(B&&!da(W,s)||(x.push(C),B))||W===this._container)break;W=W.parentNode}return!x.length&&!me&&!B&&this.listens(m,!0)&&(x=[this]),x},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var m=s.target||s.srcElement;if(!(!this._loaded||m._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(m))){var x=s.type;x==="mousedown"&&Lt(m),this._fireDOMEvent(s,x)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,m,x){if(s.type==="click"){var C=T({},s);C.type="preclick",this._fireDOMEvent(C,C.type,x)}var B=this._findEventTargets(s,m);if(x){for(var W=[],me=0;me<x.length;me++)x[me].listens(m,!0)&&W.push(x[me]);B=W.concat(B)}if(B.length){m==="contextmenu"&&Rt(s);var be=B[0],Re={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Ze=be.getLatLng&&(!be._radius||be._radius<=10);Re.containerPoint=Ze?this.latLngToContainerPoint(be.getLatLng()):this.mouseEventToContainerPoint(s),Re.layerPoint=this.containerPointToLayerPoint(Re.containerPoint),Re.latlng=Ze?be.getLatLng():this.layerPointToLatLng(Re.layerPoint)}for(me=0;me<B.length;me++)if(B[me].fire(m,Re,!0),Re.originalEvent._stopped||B[me].options.bubblingMouseEvents===!1&&bt(this._mouseEvents,m)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,m=this._handlers.length;s<m;s++)this._handlers[s].disable()},whenReady:function(s,m){return this._loaded?s.call(m||this,{target:this}):this.on("load",s,m),this},_getMapPanePos:function(){return wr(this._mapPane)||new _t(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,m){var x=s&&m!==void 0?this._getNewPixelOrigin(s,m):this.getPixelOrigin();return x.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,m){var x=this.getSize()._divideBy(2);return this.project(s,m)._subtract(x)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,m,x){var C=this._getNewPixelOrigin(x,m);return this.project(s,m)._subtract(C)},_latLngBoundsToNewLayerBounds:function(s,m,x){var C=this._getNewPixelOrigin(x,m);return Ri([this.project(s.getSouthWest(),m)._subtract(C),this.project(s.getNorthWest(),m)._subtract(C),this.project(s.getSouthEast(),m)._subtract(C),this.project(s.getNorthEast(),m)._subtract(C)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,m,x){if(!x)return s;var C=this.project(s,m),B=this.getSize().divideBy(2),W=new Ut(C.subtract(B),C.add(B)),me=this._getBoundsOffset(W,x,m);return Math.abs(me.x)<=1&&Math.abs(me.y)<=1?s:this.unproject(C.add(me),m)},_limitOffset:function(s,m){if(!m)return s;var x=this.getPixelBounds(),C=new Ut(x.min.add(s),x.max.add(s));return s.add(this._getBoundsOffset(C,m))},_getBoundsOffset:function(s,m,x){var C=Ri(this.project(m.getNorthEast(),x),this.project(m.getSouthWest(),x)),B=C.min.subtract(s.min),W=C.max.subtract(s.max),me=this._rebound(B.x,-W.x),be=this._rebound(B.y,-W.y);return new _t(me,be)},_rebound:function(s,m){return s+m>0?Math.round(s-m)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(m))},_limitZoom:function(s){var m=this.getMinZoom(),x=this.getMaxZoom(),C=Ee.any3d?this.options.zoomSnap:1;return C&&(s=Math.round(s/C)*C),Math.max(m,Math.min(x,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Li(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,m){var x=this._getCenterOffset(s)._trunc();return(m&&m.animate)!==!0&&!this.getSize().contains(x)?!1:(this.panBy(x,m),!0)},_createAnimProxy:function(){var s=this._proxy=Gt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(m){var x=Ur,C=this._proxy.style[x];Ra(this._proxy,this.project(m.center,m.zoom),this.getZoomScale(m.zoom,1)),C===this._proxy.style[x]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Yt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),m=this.getZoom();Ra(this._proxy,this.project(s,m),this.getZoomScale(m,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,m,x){if(this._animatingZoom)return!0;if(x=x||{},!this._zoomAnimated||x.animate===!1||this._nothingToAnimate()||Math.abs(m-this._zoom)>this.options.zoomAnimationThreshold)return!1;var C=this.getZoomScale(m),B=this._getCenterOffset(s)._divideBy(1-1/C);return x.animate!==!0&&!this.getSize().contains(B)?!1:(Pi(function(){this._moveStart(!0,x.noMoveStart||!1)._animateZoom(s,m,!0)},this),!0)},_animateZoom:function(s,m,x,C){this._mapPane&&(x&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=m,Ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:m,noUpdate:C}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(v(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Li(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ri(s,m){return new It(s,m)}var fn=bn.extend({options:{position:"topright"},initialize:function(s){Pe(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var m=this._map;return m&&m.removeControl(this),this.options.position=s,m&&m.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var m=this._container=this.onAdd(s),x=this.getPosition(),C=s._controlCorners[x];return Ct(m,"leaflet-control"),x.indexOf("bottom")!==-1?C.insertBefore(m,C.firstChild):C.appendChild(m),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Yt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),zt=function(s){return new fn(s)};It.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},m="leaflet-",x=this._controlContainer=Gt("div",m+"control-container",this._container);function C(B,W){var me=m+B+" "+m+W;s[B+W]=Gt("div",me,x)}C("top","left"),C("top","right"),C("bottom","left"),C("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Yt(this._controlCorners[s]);Yt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var St=fn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,m,x,C){return x<C?-1:C<x?1:0}},initialize:function(s,m,x){Pe(this,x),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var C in s)this._addLayer(s[C],C);for(C in m)this._addLayer(m[C],C,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var m=0;m<this._layers.length;m++)this._layers[m].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return fn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,m){return this._addLayer(s,m),this._map?this._update():this},addOverlay:function(s,m){return this._addLayer(s,m,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var m=this._getLayer(I(s));return m&&this._layers.splice(this._layers.indexOf(m),1),this._map?this._update():this},expand:function(){Ct(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(Ct(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Li(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Li(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",m=this._container=Gt("div",s),x=this.options.collapsed;m.setAttribute("aria-haspopup",!0),ea(m),ar(m);var C=this._section=Gt("section",s+"-list");x&&(this._map.on("click",this.collapse,this),mt(m,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var B=this._layersLink=Gt("a",s+"-toggle",m);B.href="#",B.title="Layers",B.setAttribute("role","button"),mt(B,{keydown:function(W){W.keyCode===13&&this._expandSafely()},click:function(W){Rt(W),this._expandSafely()}},this),x||this.expand(),this._baseLayersList=Gt("div",s+"-base",C),this._separator=Gt("div",s+"-separator",C),this._overlaysList=Gt("div",s+"-overlays",C),m.appendChild(C)},_getLayer:function(s){for(var m=0;m<this._layers.length;m++)if(this._layers[m]&&I(this._layers[m].layer)===s)return this._layers[m]},_addLayer:function(s,m,x){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:m,overlay:x}),this.options.sortLayers&&this._layers.sort(v(function(C,B){return this.options.sortFunction(C.layer,B.layer,C.name,B.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;vr(this._baseLayersList),vr(this._overlaysList),this._layerControlInputs=[];var s,m,x,C,B=0;for(x=0;x<this._layers.length;x++)C=this._layers[x],this._addItem(C),m=m||C.overlay,s=s||!C.overlay,B+=C.overlay?0:1;return this.options.hideSingleBase&&(s=s&&B>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=m&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var m=this._getLayer(I(s.target)),x=m.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;x&&this._map.fire(x,m)},_createRadioElement:function(s,m){var x='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(m?' checked="checked"':"")+"/>",C=document.createElement("div");return C.innerHTML=x,C.firstChild},_addItem:function(s){var m=document.createElement("label"),x=this._map.hasLayer(s.layer),C;s.overlay?(C=document.createElement("input"),C.type="checkbox",C.className="leaflet-control-layers-selector",C.defaultChecked=x):C=this._createRadioElement("leaflet-base-layers_"+I(this),x),this._layerControlInputs.push(C),C.layerId=I(s.layer),mt(C,"click",this._onInputClick,this);var B=document.createElement("span");B.innerHTML=" "+s.name;var W=document.createElement("span");m.appendChild(W),W.appendChild(C),W.appendChild(B);var me=s.overlay?this._overlaysList:this._baseLayersList;return me.appendChild(m),this._checkDisabledLayers(),m},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,m,x,C=[],B=[];this._handlingClick=!0;for(var W=s.length-1;W>=0;W--)m=s[W],x=this._getLayer(m.layerId).layer,m.checked?C.push(x):m.checked||B.push(x);for(W=0;W<B.length;W++)this._map.hasLayer(B[W])&&this._map.removeLayer(B[W]);for(W=0;W<C.length;W++)this._map.hasLayer(C[W])||this._map.addLayer(C[W]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,m,x,C=this._map.getZoom(),B=s.length-1;B>=0;B--)m=s[B],x=this._getLayer(m.layerId).layer,m.disabled=x.options.minZoom!==void 0&&C<x.options.minZoom||x.options.maxZoom!==void 0&&C>x.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,mt(s,"click",Rt),this.expand();var m=this;setTimeout(function(){rt(s,"click",Rt),m._preventClick=!1})}}),Hr=function(s,m,x){return new St(s,m,x)},jt=fn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var m="leaflet-control-zoom",x=Gt("div",m+" leaflet-bar"),C=this.options;return this._zoomInButton=this._createButton(C.zoomInText,C.zoomInTitle,m+"-in",x,this._zoomIn),this._zoomOutButton=this._createButton(C.zoomOutText,C.zoomOutTitle,m+"-out",x,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),x},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,m,x,C,B){var W=Gt("a",x,C);return W.innerHTML=s,W.href="#",W.title=m,W.setAttribute("role","button"),W.setAttribute("aria-label",m),ea(W),mt(W,"click",qn),mt(W,"click",B,this),mt(W,"click",this._refocusOnMap,this),W},_updateDisabled:function(){var s=this._map,m="leaflet-disabled";Li(this._zoomInButton,m),Li(this._zoomOutButton,m),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(Ct(this._zoomOutButton,m),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(Ct(this._zoomInButton,m),this._zoomInButton.setAttribute("aria-disabled","true"))}});It.mergeOptions({zoomControl:!0}),It.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new jt,this.addControl(this.zoomControl))});var Mo=function(s){return new jt(s)},Zn=fn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var m="leaflet-control-scale",x=Gt("div",m),C=this.options;return this._addScales(C,m+"-line",x),s.on(C.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),x},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,m,x){s.metric&&(this._mScale=Gt("div",m,x)),s.imperial&&(this._iScale=Gt("div",m,x))},_update:function(){var s=this._map,m=s.getSize().y/2,x=s.distance(s.containerPointToLatLng([0,m]),s.containerPointToLatLng([this.options.maxWidth,m]));this._updateScales(x)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var m=this._getRoundNum(s),x=m<1e3?m+" m":m/1e3+" km";this._updateScale(this._mScale,x,m/s)},_updateImperial:function(s){var m=s*3.2808399,x,C,B;m>5280?(x=m/5280,C=this._getRoundNum(x),this._updateScale(this._iScale,C+" mi",C/x)):(B=this._getRoundNum(m),this._updateScale(this._iScale,B+" ft",B/m))},_updateScale:function(s,m,x){s.style.width=Math.round(this.options.maxWidth*x)+"px",s.innerHTML=m},_getRoundNum:function(s){var m=Math.pow(10,(Math.floor(s)+"").length-1),x=s/m;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:1,m*x}}),Wr=function(s){return new Zn(s)},or='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',es=fn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ee.inlineSvg?or+" ":"")+"Leaflet</a>"},initialize:function(s){Pe(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Gt("div","leaflet-control-attribution"),ea(this._container);for(var m in s._layers)s._layers[m].getAttribution&&this.addAttribution(s._layers[m].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var m in this._attributions)this._attributions[m]&&s.push(m);var x=[];this.options.prefix&&x.push(this.options.prefix),s.length&&x.push(s.join(", ")),this._container.innerHTML=x.join(' <span aria-hidden="true">|</span> ')}}});It.mergeOptions({attributionControl:!0}),It.addInitHook(function(){this.options.attributionControl&&new es().addTo(this)});var Co=function(s){return new es(s)};fn.Layers=St,fn.Zoom=jt,fn.Scale=Zn,fn.Attribution=es,zt.layers=Hr,zt.zoom=Mo,zt.scale=Wr,zt.attribution=Co;var ta=bn.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ta.addTo=function(s,m){return s.addHandler(m,this),this};var iu={Events:Ji},Ss=Ee.touch?"touchstart mousedown":"mousedown",Ci=Hi.extend({options:{clickTolerance:3},initialize:function(s,m,x,C){Pe(this,C),this._element=s,this._dragStartTarget=m||s,this._preventOutline=x},enable:function(){this._enabled||(mt(this._dragStartTarget,Ss,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ci._dragging===this&&this.finishDrag(!0),rt(this._dragStartTarget,Ss,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!Xo(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Ci._dragging===this&&this.finishDrag();return}if(!(Ci._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Ci._dragging=this,this._preventOutline&&Lt(this._element),To(),ja(),!this._moving)){this.fire("down");var m=s.touches?s.touches[0]:s,x=il(this._element);this._startPoint=new _t(m.clientX,m.clientY),this._startPos=wr(this._element),this._parentScale=Po(x);var C=s.type==="mousedown";mt(document,C?"mousemove":"touchmove",this._onMove,this),mt(document,C?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var m=s.touches&&s.touches.length===1?s.touches[0]:s,x=new _t(m.clientX,m.clientY)._subtract(this._startPoint);!x.x&&!x.y||Math.abs(x.x)+Math.abs(x.y)<this.options.clickTolerance||(x.x/=this._parentScale.x,x.y/=this._parentScale.y,Rt(s),this._moved||(this.fire("dragstart"),this._moved=!0,Ct(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(x),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Mi(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Li(document.body,"leaflet-dragging"),this._lastTarget&&(Li(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),rt(document,"mousemove touchmove",this._onMove,this),rt(document,"mouseup touchend touchcancel",this._onUp,this),br(),ir();var m=this._moved&&this._moving;this._moving=!1,Ci._dragging=!1,m&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function ha(s,m,x){var C,B=[1,4,2,8],W,me,be,Re,Ze,ut,vt,Dt;for(W=0,ut=s.length;W<ut;W++)s[W]._code=Oa(s[W],m);for(be=0;be<4;be++){for(vt=B[be],C=[],W=0,ut=s.length,me=ut-1;W<ut;me=W++)Re=s[W],Ze=s[me],Re._code&vt?Ze._code&vt||(Dt=Ba(Ze,Re,vt,m,x),Dt._code=Oa(Dt,m),C.push(Dt)):(Ze._code&vt&&(Dt=Ba(Ze,Re,vt,m,x),Dt._code=Oa(Dt,m),C.push(Dt)),C.push(Re));s=C}return s}function si(s,m){var x,C,B,W,me,be,Re,Ze,ut;if(!s||s.length===0)throw new Error("latlngs not passed");sn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var vt=kt([0,0]),Dt=ei(s),Ki=Dt.getNorthWest().distanceTo(Dt.getSouthWest())*Dt.getNorthEast().distanceTo(Dt.getNorthWest());Ki<1700&&(vt=Fa(s));var Bi=s.length,Kn=[];for(x=0;x<Bi;x++){var Ln=kt(s[x]);Kn.push(m.project(kt([Ln.lat-vt.lat,Ln.lng-vt.lng])))}for(be=Re=Ze=0,x=0,C=Bi-1;x<Bi;C=x++)B=Kn[x],W=Kn[C],me=B.y*W.x-W.y*B.x,Re+=(B.x+W.x)*me,Ze+=(B.y+W.y)*me,be+=me*3;be===0?ut=Kn[0]:ut=[Re/be,Ze/be];var Pa=m.unproject(pt(ut));return kt([Pa.lat+vt.lat,Pa.lng+vt.lng])}function Fa(s){for(var m=0,x=0,C=0,B=0;B<s.length;B++){var W=kt(s[B]);m+=W.lat,x+=W.lng,C++}return kt([m/C,x/C])}var Ts={__proto__:null,clipPolygon:ha,polygonCenter:si,centroid:Fa};function Kr(s,m){if(!m||!s.length)return s.slice();var x=m*m;return s=nu(s,x),s=Ps(s,x),s}function pi(s,m,x){return Math.sqrt(ba(s,m,x,!0))}function al(s,m,x){return ba(s,m,x)}function Ps(s,m){var x=s.length,C=typeof Uint8Array<"u"?Uint8Array:Array,B=new C(x);B[0]=B[x-1]=1,ts(s,B,m,0,x-1);var W,me=[];for(W=0;W<x;W++)B[W]&&me.push(s[W]);return me}function ts(s,m,x,C,B){var W=0,me,be,Re;for(be=C+1;be<=B-1;be++)Re=ba(s[be],s[C],s[B],!0),Re>W&&(me=be,W=Re);W>x&&(m[me]=1,ts(s,m,x,C,me),ts(s,m,x,me,B))}function nu(s,m){for(var x=[s[0]],C=1,B=0,W=s.length;C<W;C++)zo(s[C],s[B])>m&&(x.push(s[C]),B=C);return B<W-1&&x.push(s[W-1]),x}var kr;function Eo(s,m,x,C,B){var W=C?kr:Oa(s,x),me=Oa(m,x),be,Re,Ze;for(kr=me;;){if(!(W|me))return[s,m];if(W&me)return!1;be=W||me,Re=Ba(s,m,be,x,B),Ze=Oa(Re,x),be===W?(s=Re,W=Ze):(m=Re,me=Ze)}}function Ba(s,m,x,C,B){var W=m.x-s.x,me=m.y-s.y,be=C.min,Re=C.max,Ze,ut;return x&8?(Ze=s.x+W*(Re.y-s.y)/me,ut=Re.y):x&4?(Ze=s.x+W*(be.y-s.y)/me,ut=be.y):x&2?(Ze=Re.x,ut=s.y+me*(Re.x-s.x)/W):x&1&&(Ze=be.x,ut=s.y+me*(be.x-s.x)/W),new _t(Ze,ut,B)}function Oa(s,m){var x=0;return s.x<m.min.x?x|=1:s.x>m.max.x&&(x|=2),s.y<m.min.y?x|=4:s.y>m.max.y&&(x|=8),x}function zo(s,m){var x=m.x-s.x,C=m.y-s.y;return x*x+C*C}function ba(s,m,x,C){var B=m.x,W=m.y,me=x.x-B,be=x.y-W,Re=me*me+be*be,Ze;return Re>0&&(Ze=((s.x-B)*me+(s.y-W)*be)/Re,Ze>1?(B=x.x,W=x.y):Ze>0&&(B+=me*Ze,W+=be*Ze)),me=s.x-B,be=s.y-W,C?me*me+be*be:new _t(B,W)}function sn(s){return!He(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Fi(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),sn(s)}function Ls(s,m){var x,C,B,W,me,be,Re,Ze;if(!s||s.length===0)throw new Error("latlngs not passed");sn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var ut=kt([0,0]),vt=ei(s),Dt=vt.getNorthWest().distanceTo(vt.getSouthWest())*vt.getNorthEast().distanceTo(vt.getNorthWest());Dt<1700&&(ut=Fa(s));var Ki=s.length,Bi=[];for(x=0;x<Ki;x++){var Kn=kt(s[x]);Bi.push(m.project(kt([Kn.lat-ut.lat,Kn.lng-ut.lng])))}for(x=0,C=0;x<Ki-1;x++)C+=Bi[x].distanceTo(Bi[x+1])/2;if(C===0)Ze=Bi[0];else for(x=0,W=0;x<Ki-1;x++)if(me=Bi[x],be=Bi[x+1],B=me.distanceTo(be),W+=B,W>C){Re=(W-C)/B,Ze=[be.x-Re*(be.x-me.x),be.y-Re*(be.y-me.y)];break}var Ln=m.unproject(pt(Ze));return kt([Ln.lat+ut.lat,Ln.lng+ut.lng])}var Xr={__proto__:null,simplify:Kr,pointToSegmentDistance:pi,closestPointOnSegment:al,clipSegment:Eo,_getEdgeIntersection:Ba,_getBitCode:Oa,_sqClosestPointOnSegment:ba,isFlat:sn,_flat:Fi,polylineCenter:Ls},Sr={project:function(s){return new _t(s.lng,s.lat)},unproject:function(s){return new Tt(s.y,s.x)},bounds:new Ut([-180,-90],[180,90])},$a={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Ut([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var m=Math.PI/180,x=this.R,C=s.lat*m,B=this.R_MINOR/x,W=Math.sqrt(1-B*B),me=W*Math.sin(C),be=Math.tan(Math.PI/4-C/2)/Math.pow((1-me)/(1+me),W/2);return C=-x*Math.log(Math.max(be,1e-10)),new _t(s.lng*m*x,C)},unproject:function(s){for(var m=180/Math.PI,x=this.R,C=this.R_MINOR/x,B=Math.sqrt(1-C*C),W=Math.exp(-s.y/x),me=Math.PI/2-2*Math.atan(W),be=0,Re=.1,Ze;be<15&&Math.abs(Re)>1e-7;be++)Ze=B*Math.sin(me),Ze=Math.pow((1-Ze)/(1+Ze),B/2),Re=Math.PI/2-2*Math.atan(W*Ze)-me,me+=Re;return new Tt(me*m,s.x*m/x)}},au={__proto__:null,LonLat:Sr,Mercator:$a,SphericalMercator:dn},is=T({},mi,{code:"EPSG:3395",projection:$a,transformation:(function(){var s=.5/(Math.PI*$a.R);return nn(s,.5,-s,.5)})()}),rl=T({},mi,{code:"EPSG:4326",projection:Sr,transformation:nn(1/180,1,-1/180,.5)}),Yr=T({},Wi,{projection:Sr,transformation:nn(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,m){var x=m.lng-s.lng,C=m.lat-s.lat;return Math.sqrt(x*x+C*C)},infinite:!0});Wi.Earth=mi,Wi.EPSG3395=is,Wi.EPSG3857=pr,Wi.EPSG900913=Qi,Wi.EPSG4326=rl,Wi.Simple=Yr;var Fn=Hi.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[I(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[I(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var m=s.target;if(m.hasLayer(this)){if(this._map=m,this._zoomAnimated=m._zoomAnimated,this.getEvents){var x=this.getEvents();m.on(x,this),this.once("remove",function(){m.off(x,this)},this)}this.onAdd(m),this.fire("add"),m.fire("layeradd",{layer:this})}}});It.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var m=I(s);return this._layers[m]?this:(this._layers[m]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var m=I(s);return this._layers[m]?(this._loaded&&s.onRemove(this),delete this._layers[m],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return I(s)in this._layers},eachLayer:function(s,m){for(var x in this._layers)s.call(m,this._layers[x]);return this},_addLayers:function(s){s=s?He(s)?s:[s]:[];for(var m=0,x=s.length;m<x;m++)this.addLayer(s[m])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[I(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var m=I(s);this._zoomBoundLayers[m]&&(delete this._zoomBoundLayers[m],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,m=-1/0,x=this._getZoomSpan();for(var C in this._zoomBoundLayers){var B=this._zoomBoundLayers[C].options;s=B.minZoom===void 0?s:Math.min(s,B.minZoom),m=B.maxZoom===void 0?m:Math.max(m,B.maxZoom)}this._layersMaxZoom=m===-1/0?void 0:m,this._layersMinZoom=s===1/0?void 0:s,x!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Tr=Fn.extend({initialize:function(s,m){Pe(this,m),this._layers={};var x,C;if(s)for(x=0,C=s.length;x<C;x++)this.addLayer(s[x])},addLayer:function(s){var m=this.getLayerId(s);return this._layers[m]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var m=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[m]&&this._map.removeLayer(this._layers[m]),delete this._layers[m],this},hasLayer:function(s){var m=typeof s=="number"?s:this.getLayerId(s);return m in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var m=Array.prototype.slice.call(arguments,1),x,C;for(x in this._layers)C=this._layers[x],C[s]&&C[s].apply(C,m);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,m){for(var x in this._layers)s.call(m,this._layers[x]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return I(s)}}),ol=function(s,m){return new Tr(s,m)},ca=Tr.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Tr.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Tr.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Ni;for(var m in this._layers){var x=this._layers[m];s.extend(x.getBounds?x.getBounds():x.getLatLng())}return s}}),Ms=function(s,m){return new ca(s,m)},sr=bn.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){Pe(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,m){var x=this._getIconUrl(s);if(!x){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var C=this._createImg(x,m&&m.tagName==="IMG"?m:null);return this._setIconStyles(C,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),C},_setIconStyles:function(s,m){var x=this.options,C=x[m+"Size"];typeof C=="number"&&(C=[C,C]);var B=pt(C),W=pt(m==="shadow"&&x.shadowAnchor||x.iconAnchor||B&&B.divideBy(2,!0));s.className="leaflet-marker-"+m+" "+(x.className||""),W&&(s.style.marginLeft=-W.x+"px",s.style.marginTop=-W.y+"px"),B&&(s.style.width=B.x+"px",s.style.height=B.y+"px")},_createImg:function(s,m){return m=m||document.createElement("img"),m.src=s,m},_getIconUrl:function(s){return Ee.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function sl(s){return new sr(s)}var Jr=sr.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Jr.imagePath!="string"&&(Jr.imagePath=this._detectIconPath()),(this.options.imagePath||Jr.imagePath)+sr.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var m=function(x,C,B){var W=C.exec(x);return W&&W[B]};return s=m(s,/^url\((['"])?(.+)\1\)$/,2),s&&m(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Gt("div","leaflet-default-icon-path",document.body),m=Sn(s,"background-image")||Sn(s,"backgroundImage");if(document.body.removeChild(s),m=this._stripUrl(m),m)return m;var x=document.querySelector('link[href$="leaflet.css"]');return x?x.href.substring(0,x.href.length-11-1):""}}),Cs=ta.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Ci(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ct(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Li(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var m=this._marker,x=m._map,C=this._marker.options.autoPanSpeed,B=this._marker.options.autoPanPadding,W=wr(m._icon),me=x.getPixelBounds(),be=x.getPixelOrigin(),Re=Ri(me.min._subtract(be).add(B),me.max._subtract(be).subtract(B));if(!Re.contains(W)){var Ze=pt((Math.max(Re.max.x,W.x)-Re.max.x)/(me.max.x-Re.max.x)-(Math.min(Re.min.x,W.x)-Re.min.x)/(me.min.x-Re.min.x),(Math.max(Re.max.y,W.y)-Re.max.y)/(me.max.y-Re.max.y)-(Math.min(Re.min.y,W.y)-Re.min.y)/(me.min.y-Re.min.y)).multiplyBy(C);x.panBy(Ze,{animate:!1}),this._draggable._newPos._add(Ze),this._draggable._startPos._add(Ze),Mi(m._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=Pi(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(yi(this._panRequest),this._panRequest=Pi(this._adjustPan.bind(this,s)))},_onDrag:function(s){var m=this._marker,x=m._shadow,C=wr(m._icon),B=m._map.layerPointToLatLng(C);x&&Mi(x,C),m._latlng=B,s.latlng=B,s.oldLatLng=this._oldLatLng,m.fire("move",s).fire("drag",s)},_onDragEnd:function(s){yi(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),ka=Fn.extend({options:{icon:new Jr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,m){Pe(this,m),this._latlng=kt(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var m=this._latlng;return this._latlng=kt(s),this.update(),this.fire("move",{oldLatLng:m,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,m="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),x=s.icon.createIcon(this._icon),C=!1;x!==this._icon&&(this._icon&&this._removeIcon(),C=!0,s.title&&(x.title=s.title),x.tagName==="IMG"&&(x.alt=s.alt||"")),Ct(x,m),s.keyboard&&(x.tabIndex="0",x.setAttribute("role","button")),this._icon=x,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&mt(x,"focus",this._panOnFocus,this);var B=s.icon.createShadow(this._shadow),W=!1;B!==this._shadow&&(this._removeShadow(),W=!0),B&&(Ct(B,m),B.alt=""),this._shadow=B,s.opacity<1&&this._updateOpacity(),C&&this.getPane().appendChild(this._icon),this._initInteraction(),B&&W&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(this._icon,"focus",this._panOnFocus,this),Yt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Yt(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Mi(this._icon,s),this._shadow&&Mi(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var m=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(m)},_initInteraction:function(){if(this.options.interactive&&(Ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Cs)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Cs(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Tn(this._icon,s),this._shadow&&Tn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var m=this.options.icon.options,x=m.iconSize?pt(m.iconSize):pt(0,0),C=m.iconAnchor?pt(m.iconAnchor):pt(0,0);s.panInside(this._latlng,{paddingTopLeft:C,paddingBottomRight:x.subtract(C)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ll(s,m){return new ka(s,m)}var Sa=Fn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return Pe(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Va=Sa.extend({options:{fill:!0,radius:10},initialize:function(s,m){Pe(this,m),this._latlng=kt(s),this._radius=this.options.radius},setLatLng:function(s){var m=this._latlng;return this._latlng=kt(s),this.redraw(),this.fire("move",{oldLatLng:m,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var m=s&&s.radius||this._radius;return Sa.prototype.setStyle.call(this,s),this.setRadius(m),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,m=this._radiusY||s,x=this._clickTolerance(),C=[s+x,m+x];this._pxBounds=new Ut(this._point.subtract(C),this._point.add(C))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ul(s,m){return new Va(s,m)}var Qr=Va.extend({initialize:function(s,m,x){if(typeof m=="number"&&(m=T({},x,{radius:m})),Pe(this,m),this._latlng=kt(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Ni(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Sa.prototype.setStyle,_project:function(){var s=this._latlng.lng,m=this._latlng.lat,x=this._map,C=x.options.crs;if(C.distance===mi.distance){var B=Math.PI/180,W=this._mRadius/mi.R/B,me=x.project([m+W,s]),be=x.project([m-W,s]),Re=me.add(be).divideBy(2),Ze=x.unproject(Re).lat,ut=Math.acos((Math.cos(W*B)-Math.sin(m*B)*Math.sin(Ze*B))/(Math.cos(m*B)*Math.cos(Ze*B)))/B;(isNaN(ut)||ut===0)&&(ut=W/Math.cos(Math.PI/180*m)),this._point=Re.subtract(x.getPixelOrigin()),this._radius=isNaN(ut)?0:Re.x-x.project([Ze,s-ut]).x,this._radiusY=Re.y-me.y}else{var vt=C.unproject(C.project(this._latlng).subtract([this._mRadius,0]));this._point=x.latLngToLayerPoint(this._latlng),this._radius=this._point.x-x.latLngToLayerPoint(vt).x}this._updateBounds()}});function ru(s,m,x){return new Qr(s,m,x)}var Na=Sa.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,m){Pe(this,m),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var m=1/0,x=null,C=ba,B,W,me=0,be=this._parts.length;me<be;me++)for(var Re=this._parts[me],Ze=1,ut=Re.length;Ze<ut;Ze++){B=Re[Ze-1],W=Re[Ze];var vt=C(s,B,W,!0);vt<m&&(m=vt,x=C(s,B,W))}return x&&(x.distance=Math.sqrt(m)),x},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ls(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,m){return m=m||this._defaultShape(),s=kt(s),m.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Ni,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return sn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var m=[],x=sn(s),C=0,B=s.length;C<B;C++)x?(m[C]=kt(s[C]),this._bounds.extend(m[C])):m[C]=this._convertLatLngs(s[C]);return m},_project:function(){var s=new Ut;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),m=new _t(s,s);this._rawPxBounds&&(this._pxBounds=new Ut([this._rawPxBounds.min.subtract(m),this._rawPxBounds.max.add(m)]))},_projectLatlngs:function(s,m,x){var C=s[0]instanceof Tt,B=s.length,W,me;if(C){for(me=[],W=0;W<B;W++)me[W]=this._map.latLngToLayerPoint(s[W]),x.extend(me[W]);m.push(me)}else for(W=0;W<B;W++)this._projectLatlngs(s[W],m,x)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var m=this._parts,x,C,B,W,me,be,Re;for(x=0,B=0,W=this._rings.length;x<W;x++)for(Re=this._rings[x],C=0,me=Re.length;C<me-1;C++)be=Eo(Re[C],Re[C+1],s,C,!0),be&&(m[B]=m[B]||[],m[B].push(be[0]),(be[1]!==Re[C+1]||C===me-2)&&(m[B].push(be[1]),B++))}},_simplifyPoints:function(){for(var s=this._parts,m=this.options.smoothFactor,x=0,C=s.length;x<C;x++)s[x]=Kr(s[x],m)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,m){var x,C,B,W,me,be,Re=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(x=0,W=this._parts.length;x<W;x++)for(be=this._parts[x],C=0,me=be.length,B=me-1;C<me;B=C++)if(!(!m&&C===0)&&pi(s,be[B],be[C])<=Re)return!0;return!1}});function dl(s,m){return new Na(s,m)}Na._flat=Fi;var Ta=Na.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return si(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var m=Na.prototype._convertLatLngs.call(this,s),x=m.length;return x>=2&&m[0]instanceof Tt&&m[0].equals(m[x-1])&&m.pop(),m},_setLatLngs:function(s){Na.prototype._setLatLngs.call(this,s),sn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return sn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,m=this.options.weight,x=new _t(m,m);if(s=new Ut(s.min.subtract(x),s.max.add(x)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var C=0,B=this._rings.length,W;C<B;C++)W=ha(this._rings[C],s,!0),W.length&&this._parts.push(W)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var m=!1,x,C,B,W,me,be,Re,Ze;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(W=0,Re=this._parts.length;W<Re;W++)for(x=this._parts[W],me=0,Ze=x.length,be=Ze-1;me<Ze;be=me++)C=x[me],B=x[be],C.y>s.y!=B.y>s.y&&s.x<(B.x-C.x)*(s.y-C.y)/(B.y-C.y)+C.x&&(m=!m);return m||Na.prototype._containsPoint.call(this,s,!0)}});function hl(s,m){return new Ta(s,m)}var fa=ca.extend({initialize:function(s,m){Pe(this,m),this._layers={},s&&this.addData(s)},addData:function(s){var m=He(s)?s:s.features,x,C,B;if(m){for(x=0,C=m.length;x<C;x++)B=m[x],(B.geometries||B.geometry||B.features||B.coordinates)&&this.addData(B);return this}var W=this.options;if(W.filter&&!W.filter(s))return this;var me=Io(s,W);return me?(me.feature=Lr(s),me.defaultOptions=me.options,this.resetStyle(me),W.onEachFeature&&W.onEachFeature(s,me),this.addLayer(me)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=T({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(m){this._setLayerStyle(m,s)},this)},_setLayerStyle:function(s,m){s.setStyle&&(typeof m=="function"&&(m=m(s.feature)),s.setStyle(m))}});function Io(s,m){var x=s.type==="Feature"?s.geometry:s,C=x?x.coordinates:null,B=[],W=m&&m.pointToLayer,me=m&&m.coordsToLatLng||Hn,be,Re,Ze,ut;if(!C&&!x)return null;switch(x.type){case"Point":return be=me(C),Do(W,s,be,m);case"MultiPoint":for(Ze=0,ut=C.length;Ze<ut;Ze++)be=me(C[Ze]),B.push(Do(W,s,be,m));return new ca(B);case"LineString":case"MultiLineString":return Re=Pr(C,x.type==="LineString"?0:1,me),new Na(Re,m);case"Polygon":case"MultiPolygon":return Re=Pr(C,x.type==="Polygon"?1:2,me),new Ta(Re,m);case"GeometryCollection":for(Ze=0,ut=x.geometries.length;Ze<ut;Ze++){var vt=Io({geometry:x.geometries[Ze],type:"Feature",properties:s.properties},m);vt&&B.push(vt)}return new ca(B);case"FeatureCollection":for(Ze=0,ut=x.features.length;Ze<ut;Ze++){var Dt=Io(x.features[Ze],m);Dt&&B.push(Dt)}return new ca(B);default:throw new Error("Invalid GeoJSON object.")}}function Do(s,m,x,C){return s?s(m,x):new ka(x,C&&C.markersInheritOptions&&C)}function Hn(s){return new Tt(s[1],s[0],s[2])}function Pr(s,m,x){for(var C=[],B=0,W=s.length,me;B<W;B++)me=m?Pr(s[B],m-1,x):(x||Hn)(s[B]),C.push(me);return C}function Ao(s,m){return s=kt(s),s.alt!==void 0?[re(s.lng,m),re(s.lat,m),re(s.alt,m)]:[re(s.lng,m),re(s.lat,m)]}function eo(s,m,x,C){for(var B=[],W=0,me=s.length;W<me;W++)B.push(m?eo(s[W],sn(s[W])?0:m-1,x,C):Ao(s[W],C));return!m&&x&&B.length>0&&B.push(B[0].slice()),B}function lr(s,m){return s.feature?T({},s.feature,{geometry:m}):Lr(m)}function Lr(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Ua={toGeoJSON:function(s){return lr(this,{type:"Point",coordinates:Ao(this.getLatLng(),s)})}};ka.include(Ua),Qr.include(Ua),Va.include(Ua),Na.include({toGeoJSON:function(s){var m=!sn(this._latlngs),x=eo(this._latlngs,m?1:0,!1,s);return lr(this,{type:(m?"Multi":"")+"LineString",coordinates:x})}}),Ta.include({toGeoJSON:function(s){var m=!sn(this._latlngs),x=m&&!sn(this._latlngs[0]),C=eo(this._latlngs,x?2:m?1:0,!0,s);return m||(C=[C]),lr(this,{type:(x?"Multi":"")+"Polygon",coordinates:C})}}),Tr.include({toMultiPoint:function(s){var m=[];return this.eachLayer(function(x){m.push(x.toGeoJSON(s).geometry.coordinates)}),lr(this,{type:"MultiPoint",coordinates:m})},toGeoJSON:function(s){var m=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(m==="MultiPoint")return this.toMultiPoint(s);var x=m==="GeometryCollection",C=[];return this.eachLayer(function(B){if(B.toGeoJSON){var W=B.toGeoJSON(s);if(x)C.push(W.geometry);else{var me=Lr(W);me.type==="FeatureCollection"?C.push.apply(C,me.features):C.push(me)}}}),x?lr(this,{geometries:C,type:"GeometryCollection"}):{type:"FeatureCollection",features:C}}});function ns(s,m){return new fa(s,m)}var ou=ns,Ro=Fn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,m,x){this._url=s,this._bounds=ei(m),Pe(this,x)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Yt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&ai(this._image),this},bringToBack:function(){return this._map&&xr(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=ei(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",m=this._image=s?this._url:Gt("img");if(Ct(m,"leaflet-image-layer"),this._zoomAnimated&&Ct(m,"leaflet-zoom-animated"),this.options.className&&Ct(m,this.options.className),m.onselectstart=X,m.onmousemove=X,m.onload=v(this.fire,this,"load"),m.onerror=v(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=m.src;return}m.src=this._url,m.alt=this.options.alt},_animateZoom:function(s){var m=this._map.getZoomScale(s.zoom),x=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;Ra(this._image,x,m)},_reset:function(){var s=this._image,m=new Ut(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),x=m.getSize();Mi(s,m.min),s.style.width=x.x+"px",s.style.height=x.y+"px"},_updateOpacity:function(){Tn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),su=function(s,m,x){return new Ro(s,m,x)},cl=Ro.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",m=this._image=s?this._url:Gt("video");if(Ct(m,"leaflet-image-layer"),this._zoomAnimated&&Ct(m,"leaflet-zoom-animated"),this.options.className&&Ct(m,this.options.className),m.onselectstart=X,m.onmousemove=X,m.onloadeddata=v(this.fire,this,"load"),s){for(var x=m.getElementsByTagName("source"),C=[],B=0;B<x.length;B++)C.push(x[B].src);this._url=x.length>0?C:[m.src];return}He(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(m.style,"objectFit")&&(m.style.objectFit="fill"),m.autoplay=!!this.options.autoplay,m.loop=!!this.options.loop,m.muted=!!this.options.muted,m.playsInline=!!this.options.playsInline;for(var W=0;W<this._url.length;W++){var me=Gt("source");me.src=this._url[W],m.appendChild(me)}}});function fl(s,m,x){return new cl(s,m,x)}var ml=Ro.extend({_initImage:function(){var s=this._image=this._url;Ct(s,"leaflet-image-layer"),this._zoomAnimated&&Ct(s,"leaflet-zoom-animated"),this.options.className&&Ct(s,this.options.className),s.onselectstart=X,s.onmousemove=X}});function Zt(s,m,x){return new ml(s,m,x)}var Wn=Fn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,m){s&&(s instanceof Tt||He(s))?(this._latlng=kt(s),Pe(this,m)):(Pe(this,s),this._source=m),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Tn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Tn(this._container,1),this.bringToFront(),this.options.interactive&&(Ct(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Tn(this._container,0),this._removeTimeout=setTimeout(v(Yt,void 0,this._container),200)):Yt(this._container),this.options.interactive&&(Li(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=kt(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ai(this._container),this},bringToBack:function(){return this._map&&xr(this._container),this},_prepareOpen:function(s){var m=this._source;if(!m._map)return!1;if(m instanceof ca){m=null;var x=this._source._layers;for(var C in x)if(x[C]._map){m=x[C];break}if(!m)return!1;this._source=m}if(!s)if(m.getCenter)s=m.getCenter();else if(m.getLatLng)s=m.getLatLng();else if(m.getBounds)s=m.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,m=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof m=="string")s.innerHTML=m;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(m)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),m=pt(this.options.offset),x=this._getAnchor();this._zoomAnimated?Mi(this._container,s.add(x)):m=m.add(s).add(x);var C=this._containerBottom=-m.y,B=this._containerLeft=-Math.round(this._containerWidth/2)+m.x;this._container.style.bottom=C+"px",this._container.style.left=B+"px"}},_getAnchor:function(){return[0,0]}});It.include({_initOverlay:function(s,m,x,C){var B=m;return B instanceof s||(B=new s(C).setContent(m)),x&&B.setLatLng(x),B}}),Fn.include({_initOverlay:function(s,m,x,C){var B=x;return B instanceof s?(Pe(B,C),B._source=this):(B=m&&!C?m:new s(C,this),B.setContent(x)),B}});var Mr=Wn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Wn.prototype.openOn.call(this,s)},onAdd:function(s){Wn.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Sa||this._source.on("preclick",ji))},onRemove:function(s){Wn.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Sa||this._source.off("preclick",ji))},getEvents:function(){var s=Wn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",m=this._container=Gt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),x=this._wrapper=Gt("div",s+"-content-wrapper",m);if(this._contentNode=Gt("div",s+"-content",x),ea(m),ar(this._contentNode),mt(m,"contextmenu",ji),this._tipContainer=Gt("div",s+"-tip-container",m),this._tip=Gt("div",s+"-tip",this._tipContainer),this.options.closeButton){var C=this._closeButton=Gt("a",s+"-close-button",m);C.setAttribute("role","button"),C.setAttribute("aria-label","Close popup"),C.href="#close",C.innerHTML='<span aria-hidden="true">&#215;</span>',mt(C,"click",function(B){Rt(B),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,m=s.style;m.width="",m.whiteSpace="nowrap";var x=s.offsetWidth;x=Math.min(x,this.options.maxWidth),x=Math.max(x,this.options.minWidth),m.width=x+1+"px",m.whiteSpace="",m.height="";var C=s.offsetHeight,B=this.options.maxHeight,W="leaflet-popup-scrolled";B&&C>B?(m.height=B+"px",Ct(s,W)):Li(s,W),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var m=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),x=this._getAnchor();Mi(this._container,m.add(x))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,m=parseInt(Sn(this._container,"marginBottom"),10)||0,x=this._container.offsetHeight+m,C=this._containerWidth,B=new _t(this._containerLeft,-x-this._containerBottom);B._add(wr(this._container));var W=s.layerPointToContainerPoint(B),me=pt(this.options.autoPanPadding),be=pt(this.options.autoPanPaddingTopLeft||me),Re=pt(this.options.autoPanPaddingBottomRight||me),Ze=s.getSize(),ut=0,vt=0;W.x+C+Re.x>Ze.x&&(ut=W.x+C-Ze.x+Re.x),W.x-ut-be.x<0&&(ut=W.x-be.x),W.y+x+Re.y>Ze.y&&(vt=W.y+x-Ze.y+Re.y),W.y-vt-be.y<0&&(vt=W.y-be.y),(ut||vt)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([ut,vt]))}},_getAnchor:function(){return pt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),as=function(s,m){return new Mr(s,m)};It.mergeOptions({closePopupOnClick:!0}),It.include({openPopup:function(s,m,x){return this._initOverlay(Mr,s,m,x).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Fn.include({bindPopup:function(s,m){return this._popup=this._initOverlay(Mr,this._popup,s,m),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof ca||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){qn(s);var m=s.layer||s.target;if(this._popup._source===m&&!(m instanceof Sa)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=m,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var to=Wn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Wn.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Wn.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Wn.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",m=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Gt("div",m),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+I(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var m,x,C=this._map,B=this._container,W=C.latLngToContainerPoint(C.getCenter()),me=C.layerPointToContainerPoint(s),be=this.options.direction,Re=B.offsetWidth,Ze=B.offsetHeight,ut=pt(this.options.offset),vt=this._getAnchor();be==="top"?(m=Re/2,x=Ze):be==="bottom"?(m=Re/2,x=0):be==="center"?(m=Re/2,x=Ze/2):be==="right"?(m=0,x=Ze/2):be==="left"?(m=Re,x=Ze/2):me.x<W.x?(be="right",m=0,x=Ze/2):(be="left",m=Re+(ut.x+vt.x)*2,x=Ze/2),s=s.subtract(pt(m,x,!0)).add(ut).add(vt),Li(B,"leaflet-tooltip-right"),Li(B,"leaflet-tooltip-left"),Li(B,"leaflet-tooltip-top"),Li(B,"leaflet-tooltip-bottom"),Ct(B,"leaflet-tooltip-"+be),Mi(B,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Tn(this._container,s)},_animateZoom:function(s){var m=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(m)},_getAnchor:function(){return pt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Cr=function(s,m){return new to(s,m)};It.include({openTooltip:function(s,m,x){return this._initOverlay(to,s,m,x).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Fn.include({bindTooltip:function(s,m){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(to,this._tooltip,s,m),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var m=s?"off":"on",x={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?x.add=this._openTooltip:(x.mouseover=this._openTooltip,x.mouseout=this.closeTooltip,x.click=this._openTooltip,this._map?this._addFocusListeners():x.add=this._addFocusListeners),this._tooltip.options.sticky&&(x.mousemove=this._moveTooltip),this[m](x),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof ca||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var m=typeof s.getElement=="function"&&s.getElement();m&&(mt(m,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),mt(m,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var m=typeof s.getElement=="function"&&s.getElement();m&&m.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var m=this;this._map.once("moveend",function(){m._openOnceFlag=!1,m._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var m=s.latlng,x,C;this._tooltip.options.sticky&&s.originalEvent&&(x=this._map.mouseEventToContainerPoint(s.originalEvent),C=this._map.containerPointToLayerPoint(x),m=this._map.layerPointToLatLng(C)),this._tooltip.setLatLng(m)}});var io=sr.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var m=s&&s.tagName==="DIV"?s:document.createElement("div"),x=this.options;if(x.html instanceof Element?(vr(m),m.appendChild(x.html)):m.innerHTML=x.html!==!1?x.html:"",x.bgPos){var C=pt(x.bgPos);m.style.backgroundPosition=-C.x+"px "+-C.y+"px"}return this._setIconStyles(m,"icon"),m},createShadow:function(){return null}});function no(s){return new io(s)}sr.Default=Jr;var mn=Fn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ee.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){Pe(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Yt(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ai(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(xr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=R(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof _t?s:new _t(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var m=this.getPane().children,x=-s(-1/0,1/0),C=0,B=m.length,W;C<B;C++)W=m[C].style.zIndex,m[C]!==this._container&&W&&(x=s(x,+W));isFinite(x)&&(this.options.zIndex=x+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ee.ielt9){Tn(this._container,this.options.opacity);var s=+new Date,m=!1,x=!1;for(var C in this._tiles){var B=this._tiles[C];if(!(!B.current||!B.loaded)){var W=Math.min(1,(s-B.loaded)/200);Tn(B.el,W),W<1?m=!0:(B.active?x=!0:this._onOpaqueTile(B),B.active=!0)}}x&&!this._noPrune&&this._pruneTiles(),m&&(yi(this._fadeFrame),this._fadeFrame=Pi(this._updateOpacity,this))}},_onOpaqueTile:X,_initContainer:function(){this._container||(this._container=Gt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,m=this.options.maxZoom;if(s!==void 0){for(var x in this._levels)x=Number(x),this._levels[x].el.children.length||x===s?(this._levels[x].el.style.zIndex=m-Math.abs(s-x),this._onUpdateLevel(x)):(Yt(this._levels[x].el),this._removeTilesAtZoom(x),this._onRemoveLevel(x),delete this._levels[x]);var C=this._levels[s],B=this._map;return C||(C=this._levels[s]={},C.el=Gt("div","leaflet-tile-container leaflet-zoom-animated",this._container),C.el.style.zIndex=m,C.origin=B.project(B.unproject(B.getPixelOrigin()),s).round(),C.zoom=s,this._setZoomTransform(C,B.getCenter(),B.getZoom()),X(C.el.offsetWidth),this._onCreateLevel(C)),this._level=C,C}},_onUpdateLevel:X,_onRemoveLevel:X,_onCreateLevel:X,_pruneTiles:function(){if(this._map){var s,m,x=this._map.getZoom();if(x>this.options.maxZoom||x<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)m=this._tiles[s],m.retain=m.current;for(s in this._tiles)if(m=this._tiles[s],m.current&&!m.active){var C=m.coords;this._retainParent(C.x,C.y,C.z,C.z-5)||this._retainChildren(C.x,C.y,C.z,C.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var m in this._tiles)this._tiles[m].coords.z===s&&this._removeTile(m)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Yt(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,m,x,C){var B=Math.floor(s/2),W=Math.floor(m/2),me=x-1,be=new _t(+B,+W);be.z=+me;var Re=this._tileCoordsToKey(be),Ze=this._tiles[Re];return Ze&&Ze.active?(Ze.retain=!0,!0):(Ze&&Ze.loaded&&(Ze.retain=!0),me>C?this._retainParent(B,W,me,C):!1)},_retainChildren:function(s,m,x,C){for(var B=2*s;B<2*s+2;B++)for(var W=2*m;W<2*m+2;W++){var me=new _t(B,W);me.z=x+1;var be=this._tileCoordsToKey(me),Re=this._tiles[be];if(Re&&Re.active){Re.retain=!0;continue}else Re&&Re.loaded&&(Re.retain=!0);x+1<C&&this._retainChildren(B,W,x+1,C)}},_resetView:function(s){var m=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),m,m)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var m=this.options;return m.minNativeZoom!==void 0&&s<m.minNativeZoom?m.minNativeZoom:m.maxNativeZoom!==void 0&&m.maxNativeZoom<s?m.maxNativeZoom:s},_setView:function(s,m,x,C){var B=Math.round(m);this.options.maxZoom!==void 0&&B>this.options.maxZoom||this.options.minZoom!==void 0&&B<this.options.minZoom?B=void 0:B=this._clampZoom(B);var W=this.options.updateWhenZooming&&B!==this._tileZoom;(!C||W)&&(this._tileZoom=B,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),B!==void 0&&this._update(s),x||this._pruneTiles(),this._noPrune=!!x),this._setZoomTransforms(s,m)},_setZoomTransforms:function(s,m){for(var x in this._levels)this._setZoomTransform(this._levels[x],s,m)},_setZoomTransform:function(s,m,x){var C=this._map.getZoomScale(x,s.zoom),B=s.origin.multiplyBy(C).subtract(this._map._getNewPixelOrigin(m,x)).round();Ee.any3d?Ra(s.el,B,C):Mi(s.el,B)},_resetGrid:function(){var s=this._map,m=s.options.crs,x=this._tileSize=this.getTileSize(),C=this._tileZoom,B=this._map.getPixelWorldBounds(this._tileZoom);B&&(this._globalTileRange=this._pxBoundsToTileRange(B)),this._wrapX=m.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,m.wrapLng[0]],C).x/x.x),Math.ceil(s.project([0,m.wrapLng[1]],C).x/x.y)],this._wrapY=m.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([m.wrapLat[0],0],C).y/x.x),Math.ceil(s.project([m.wrapLat[1],0],C).y/x.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var m=this._map,x=m._animatingZoom?Math.max(m._animateToZoom,m.getZoom()):m.getZoom(),C=m.getZoomScale(x,this._tileZoom),B=m.project(s,this._tileZoom).floor(),W=m.getSize().divideBy(C*2);return new Ut(B.subtract(W),B.add(W))},_update:function(s){var m=this._map;if(m){var x=this._clampZoom(m.getZoom());if(s===void 0&&(s=m.getCenter()),this._tileZoom!==void 0){var C=this._getTiledPixelBounds(s),B=this._pxBoundsToTileRange(C),W=B.getCenter(),me=[],be=this.options.keepBuffer,Re=new Ut(B.getBottomLeft().subtract([be,-be]),B.getTopRight().add([be,-be]));if(!(isFinite(B.min.x)&&isFinite(B.min.y)&&isFinite(B.max.x)&&isFinite(B.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ze in this._tiles){var ut=this._tiles[Ze].coords;(ut.z!==this._tileZoom||!Re.contains(new _t(ut.x,ut.y)))&&(this._tiles[Ze].current=!1)}if(Math.abs(x-this._tileZoom)>1){this._setView(s,x);return}for(var vt=B.min.y;vt<=B.max.y;vt++)for(var Dt=B.min.x;Dt<=B.max.x;Dt++){var Ki=new _t(Dt,vt);if(Ki.z=this._tileZoom,!!this._isValidTile(Ki)){var Bi=this._tiles[this._tileCoordsToKey(Ki)];Bi?Bi.current=!0:me.push(Ki)}}if(me.sort(function(Ln,Pa){return Ln.distanceTo(W)-Pa.distanceTo(W)}),me.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Kn=document.createDocumentFragment();for(Dt=0;Dt<me.length;Dt++)this._addTile(me[Dt],Kn);this._level.el.appendChild(Kn)}}}},_isValidTile:function(s){var m=this._map.options.crs;if(!m.infinite){var x=this._globalTileRange;if(!m.wrapLng&&(s.x<x.min.x||s.x>x.max.x)||!m.wrapLat&&(s.y<x.min.y||s.y>x.max.y))return!1}if(!this.options.bounds)return!0;var C=this._tileCoordsToBounds(s);return ei(this.options.bounds).overlaps(C)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var m=this._map,x=this.getTileSize(),C=s.scaleBy(x),B=C.add(x),W=m.unproject(C,s.z),me=m.unproject(B,s.z);return[W,me]},_tileCoordsToBounds:function(s){var m=this._tileCoordsToNwSe(s),x=new Ni(m[0],m[1]);return this.options.noWrap||(x=this._map.wrapLatLngBounds(x)),x},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var m=s.split(":"),x=new _t(+m[0],+m[1]);return x.z=+m[2],x},_removeTile:function(s){var m=this._tiles[s];m&&(Yt(m.el),delete this._tiles[s],this.fire("tileunload",{tile:m.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){Ct(s,"leaflet-tile");var m=this.getTileSize();s.style.width=m.x+"px",s.style.height=m.y+"px",s.onselectstart=X,s.onmousemove=X,Ee.ielt9&&this.options.opacity<1&&Tn(s,this.options.opacity)},_addTile:function(s,m){var x=this._getTilePos(s),C=this._tileCoordsToKey(s),B=this.createTile(this._wrapCoords(s),v(this._tileReady,this,s));this._initTile(B),this.createTile.length<2&&Pi(v(this._tileReady,this,s,null,B)),Mi(B,x),this._tiles[C]={el:B,coords:s,current:!0},m.appendChild(B),this.fire("tileloadstart",{tile:B,coords:s})},_tileReady:function(s,m,x){m&&this.fire("tileerror",{error:m,tile:x,coords:s});var C=this._tileCoordsToKey(s);x=this._tiles[C],x&&(x.loaded=+new Date,this._map._fadeAnimated?(Tn(x.el,0),yi(this._fadeFrame),this._fadeFrame=Pi(this._updateOpacity,this)):(x.active=!0,this._pruneTiles()),m||(Ct(x.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:x.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ee.ielt9||!this._map._fadeAnimated?Pi(this._pruneTiles,this):setTimeout(v(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var m=new _t(this._wrapX?q(s.x,this._wrapX):s.x,this._wrapY?q(s.y,this._wrapY):s.y);return m.z=s.z,m},_pxBoundsToTileRange:function(s){var m=this.getTileSize();return new Ut(s.min.unscaleBy(m).floor(),s.max.unscaleBy(m).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function pl(s){return new mn(s)}var Er=mn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,m){this._url=s,m=Pe(this,m),m.detectRetina&&Ee.retina&&m.maxZoom>0?(m.tileSize=Math.floor(m.tileSize/2),m.zoomReverse?(m.zoomOffset--,m.minZoom=Math.min(m.maxZoom,m.minZoom+1)):(m.zoomOffset++,m.maxZoom=Math.max(m.minZoom,m.maxZoom-1)),m.minZoom=Math.max(0,m.minZoom)):m.zoomReverse?m.minZoom=Math.min(m.maxZoom,m.minZoom):m.maxZoom=Math.max(m.minZoom,m.maxZoom),typeof m.subdomains=="string"&&(m.subdomains=m.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,m){return this._url===s&&m===void 0&&(m=!0),this._url=s,m||this.redraw(),this},createTile:function(s,m){var x=document.createElement("img");return mt(x,"load",v(this._tileOnLoad,this,m,x)),mt(x,"error",v(this._tileOnError,this,m,x)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(x.referrerPolicy=this.options.referrerPolicy),x.alt="",x.src=this.getTileUrl(s),x},getTileUrl:function(s){var m={r:Ee.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var x=this._globalTileRange.max.y-s.y;this.options.tms&&(m.y=x),m["-y"]=x}return We(this._url,T(m,this.options))},_tileOnLoad:function(s,m){Ee.ielt9?setTimeout(v(s,this,null,m),0):s(null,m)},_tileOnError:function(s,m,x){var C=this.options.errorTileUrl;C&&m.getAttribute("src")!==C&&(m.src=C),s(x,m)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,m=this.options.maxZoom,x=this.options.zoomReverse,C=this.options.zoomOffset;return x&&(s=m-s),s+C},_getSubdomain:function(s){var m=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[m]},_abortLoading:function(){var s,m;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(m=this._tiles[s].el,m.onload=X,m.onerror=X,!m.complete)){m.src=Bt;var x=this._tiles[s].coords;Yt(m),delete this._tiles[s],this.fire("tileabort",{tile:m,coords:x})}},_removeTile:function(s){var m=this._tiles[s];if(m)return m.el.setAttribute("src",Bt),mn.prototype._removeTile.call(this,s)},_tileReady:function(s,m,x){if(!(!this._map||x&&x.getAttribute("src")===Bt))return mn.prototype._tileReady.call(this,s,m,x)}});function rs(s,m){return new Er(s,m)}var ur=Er.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,m){this._url=s;var x=T({},this.defaultWmsParams);for(var C in m)C in this.options||(x[C]=m[C]);m=Pe(this,m);var B=m.detectRetina&&Ee.retina?2:1,W=this.getTileSize();x.width=W.x*B,x.height=W.y*B,this.wmsParams=x},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var m=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[m]=this._crs.code,Er.prototype.onAdd.call(this,s)},getTileUrl:function(s){var m=this._tileCoordsToNwSe(s),x=this._crs,C=Ri(x.project(m[0]),x.project(m[1])),B=C.min,W=C.max,me=(this._wmsVersion>=1.3&&this._crs===rl?[B.y,B.x,W.y,W.x]:[B.x,B.y,W.x,W.y]).join(","),be=Er.prototype.getTileUrl.call(this,s);return be+le(this.wmsParams,be,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+me},setParams:function(s,m){return T(this.wmsParams,s),m||this.redraw(),this}});function os(s,m){return new ur(s,m)}Er.WMS=ur,rs.wms=os;var ia=Fn.extend({options:{padding:.1},initialize:function(s){Pe(this,s),I(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,m){var x=this._map.getZoomScale(m,this._zoom),C=this._map.getSize().multiplyBy(.5+this.options.padding),B=this._map.project(this._center,m),W=C.multiplyBy(-x).add(B).subtract(this._map._getNewPixelOrigin(s,m));Ee.any3d?Ra(this._container,W,x):Mi(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,m=this._map.getSize(),x=this._map.containerPointToLayerPoint(m.multiplyBy(-s)).round();this._bounds=new Ut(x,x.add(m.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ao=ia.extend({options:{tolerance:0},getEvents:function(){var s=ia.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ia.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");mt(s,"mousemove",this._onMouseMove,this),mt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),mt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){yi(this._redrawRequest),delete this._ctx,Yt(this._container),rt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var m in this._layers)s=this._layers[m],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ia.prototype._update.call(this);var s=this._bounds,m=this._container,x=s.getSize(),C=Ee.retina?2:1;Mi(m,s.min),m.width=C*x.x,m.height=C*x.y,m.style.width=x.x+"px",m.style.height=x.y+"px",Ee.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){ia.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[I(s)]=s;var m=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=m),this._drawLast=m,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var m=s._order,x=m.next,C=m.prev;x?x.prev=C:this._drawLast=C,C?C.next=x:this._drawFirst=x,delete s._order,delete this._layers[I(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var m=s.options.dashArray.split(/[, ]+/),x=[],C,B;for(B=0;B<m.length;B++){if(C=Number(m[B]),isNaN(C))return;x.push(C)}s.options._dashArray=x}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||Pi(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var m=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Ut,this._redrawBounds.extend(s._pxBounds.min.subtract([m,m])),this._redrawBounds.extend(s._pxBounds.max.add([m,m]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var m=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,m.x,m.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,m=this._redrawBounds;if(this._ctx.save(),m){var x=m.getSize();this._ctx.beginPath(),this._ctx.rect(m.min.x,m.min.y,x.x,x.y),this._ctx.clip()}this._drawing=!0;for(var C=this._drawFirst;C;C=C.next)s=C.layer,(!m||s._pxBounds&&s._pxBounds.intersects(m))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,m){if(this._drawing){var x,C,B,W,me=s._parts,be=me.length,Re=this._ctx;if(be){for(Re.beginPath(),x=0;x<be;x++){for(C=0,B=me[x].length;C<B;C++)W=me[x][C],Re[C?"lineTo":"moveTo"](W.x,W.y);m&&Re.closePath()}this._fillStroke(Re,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var m=s._point,x=this._ctx,C=Math.max(Math.round(s._radius),1),B=(Math.max(Math.round(s._radiusY),1)||C)/C;B!==1&&(x.save(),x.scale(1,B)),x.beginPath(),x.arc(m.x,m.y/B,C,0,Math.PI*2,!1),B!==1&&x.restore(),this._fillStroke(x,s)}},_fillStroke:function(s,m){var x=m.options;x.fill&&(s.globalAlpha=x.fillOpacity,s.fillStyle=x.fillColor||x.color,s.fill(x.fillRule||"evenodd")),x.stroke&&x.weight!==0&&(s.setLineDash&&s.setLineDash(m.options&&m.options._dashArray||[]),s.globalAlpha=x.opacity,s.lineWidth=x.weight,s.strokeStyle=x.color,s.lineCap=x.lineCap,s.lineJoin=x.lineJoin,s.stroke())},_onClick:function(s){for(var m=this._map.mouseEventToLayerPoint(s),x,C,B=this._drawFirst;B;B=B.next)x=B.layer,x.options.interactive&&x._containsPoint(m)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(x))&&(C=x);this._fireEvent(C?[C]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var m=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,m)}},_handleMouseOut:function(s){var m=this._hoveredLayer;m&&(Li(this._container,"leaflet-interactive"),this._fireEvent([m],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,m){if(!this._mouseHoverThrottled){for(var x,C,B=this._drawFirst;B;B=B.next)x=B.layer,x.options.interactive&&x._containsPoint(m)&&(C=x);C!==this._hoveredLayer&&(this._handleMouseOut(s),C&&(Ct(this._container,"leaflet-interactive"),this._fireEvent([C],s,"mouseover"),this._hoveredLayer=C)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(v(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,m,x){this._map._fireDOMEvent(m,x||m.type,s)},_bringToFront:function(s){var m=s._order;if(m){var x=m.next,C=m.prev;if(x)x.prev=C;else return;C?C.next=x:x&&(this._drawFirst=x),m.prev=this._drawLast,this._drawLast.next=m,m.next=null,this._drawLast=m,this._requestRedraw(s)}},_bringToBack:function(s){var m=s._order;if(m){var x=m.next,C=m.prev;if(C)C.next=x;else return;x?x.prev=C:C&&(this._drawLast=C),m.prev=null,m.next=this._drawFirst,this._drawFirst.prev=m,this._drawFirst=m,this._requestRedraw(s)}}});function jo(s){return Ee.canvas?new ao(s):null}var ro=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),oo={_initContainer:function(){this._container=Gt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ia.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var m=s._container=ro("shape");Ct(m,"leaflet-vml-shape "+(this.options.className||"")),m.coordsize="1 1",s._path=ro("path"),m.appendChild(s._path),this._updateStyle(s),this._layers[I(s)]=s},_addPath:function(s){var m=s._container;this._container.appendChild(m),s.options.interactive&&s.addInteractiveTarget(m)},_removePath:function(s){var m=s._container;Yt(m),s.removeInteractiveTarget(m),delete this._layers[I(s)]},_updateStyle:function(s){var m=s._stroke,x=s._fill,C=s.options,B=s._container;B.stroked=!!C.stroke,B.filled=!!C.fill,C.stroke?(m||(m=s._stroke=ro("stroke")),B.appendChild(m),m.weight=C.weight+"px",m.color=C.color,m.opacity=C.opacity,C.dashArray?m.dashStyle=He(C.dashArray)?C.dashArray.join(" "):C.dashArray.replace(/( *, *)/g," "):m.dashStyle="",m.endcap=C.lineCap.replace("butt","flat"),m.joinstyle=C.lineJoin):m&&(B.removeChild(m),s._stroke=null),C.fill?(x||(x=s._fill=ro("fill")),B.appendChild(x),x.color=C.fillColor||C.color,x.opacity=C.fillOpacity):x&&(B.removeChild(x),s._fill=null)},_updateCircle:function(s){var m=s._point.round(),x=Math.round(s._radius),C=Math.round(s._radiusY||x);this._setPath(s,s._empty()?"M0 0":"AL "+m.x+","+m.y+" "+x+","+C+" 0,"+65535*360)},_setPath:function(s,m){s._path.v=m},_bringToFront:function(s){ai(s._container)},_bringToBack:function(s){xr(s._container)}},Ga=Ee.vml?ro:Un,so=ia.extend({_initContainer:function(){this._container=Ga("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ga("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Yt(this._container),rt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ia.prototype._update.call(this);var s=this._bounds,m=s.getSize(),x=this._container;(!this._svgSize||!this._svgSize.equals(m))&&(this._svgSize=m,x.setAttribute("width",m.x),x.setAttribute("height",m.y)),Mi(x,s.min),x.setAttribute("viewBox",[s.min.x,s.min.y,m.x,m.y].join(" ")),this.fire("update")}},_initPath:function(s){var m=s._path=Ga("path");s.options.className&&Ct(m,s.options.className),s.options.interactive&&Ct(m,"leaflet-interactive"),this._updateStyle(s),this._layers[I(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Yt(s._path),s.removeInteractiveTarget(s._path),delete this._layers[I(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var m=s._path,x=s.options;m&&(x.stroke?(m.setAttribute("stroke",x.color),m.setAttribute("stroke-opacity",x.opacity),m.setAttribute("stroke-width",x.weight),m.setAttribute("stroke-linecap",x.lineCap),m.setAttribute("stroke-linejoin",x.lineJoin),x.dashArray?m.setAttribute("stroke-dasharray",x.dashArray):m.removeAttribute("stroke-dasharray"),x.dashOffset?m.setAttribute("stroke-dashoffset",x.dashOffset):m.removeAttribute("stroke-dashoffset")):m.setAttribute("stroke","none"),x.fill?(m.setAttribute("fill",x.fillColor||x.color),m.setAttribute("fill-opacity",x.fillOpacity),m.setAttribute("fill-rule",x.fillRule||"evenodd")):m.setAttribute("fill","none"))},_updatePoly:function(s,m){this._setPath(s,oa(s._parts,m))},_updateCircle:function(s){var m=s._point,x=Math.max(Math.round(s._radius),1),C=Math.max(Math.round(s._radiusY),1)||x,B="a"+x+","+C+" 0 1,0 ",W=s._empty()?"M0 0":"M"+(m.x-x)+","+m.y+B+x*2+",0 "+B+-x*2+",0 ";this._setPath(s,W)},_setPath:function(s,m){s._path.setAttribute("d",m)},_bringToFront:function(s){ai(s._path)},_bringToBack:function(s){xr(s._path)}});Ee.vml&&so.include(oo);function ss(s){return Ee.svg||Ee.vml?new so(s):null}It.include({getRenderer:function(s){var m=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return m||(m=this._renderer=this._createRenderer()),this.hasLayer(m)||this.addLayer(m),m},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var m=this._paneRenderers[s];return m===void 0&&(m=this._createRenderer({pane:s}),this._paneRenderers[s]=m),m},_createRenderer:function(s){return this.options.preferCanvas&&jo(s)||ss(s)}});var Et=Ta.extend({initialize:function(s,m){Ta.prototype.initialize.call(this,this._boundsToLatLngs(s),m)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=ei(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function ls(s,m){return new Et(s,m)}so.create=Ga,so.pointsToPath=oa,fa.geometryToLayer=Io,fa.coordsToLatLng=Hn,fa.coordsToLatLngs=Pr,fa.latLngToCoords=Ao,fa.latLngsToCoords=eo,fa.getFeature=lr,fa.asFeature=Lr,It.mergeOptions({boxZoom:!0});var _l=ta.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){mt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Yt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ja(),To(),this._startPoint=this._map.mouseEventToContainerPoint(s),mt(document,{contextmenu:qn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Gt("div","leaflet-zoom-box",this._container),Ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var m=new Ut(this._point,this._startPoint),x=m.getSize();Mi(this._box,m.min),this._box.style.width=x.x+"px",this._box.style.height=x.y+"px"},_finish:function(){this._moved&&(Yt(this._box),Li(this._container,"leaflet-crosshair")),ir(),br(),rt(document,{contextmenu:qn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(v(this._resetState,this),0);var m=new Ni(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(m).fire("boxzoomend",{boxZoomBounds:m})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});It.addInitHook("addHandler","boxZoom",_l),It.mergeOptions({doubleClickZoom:!0});var Es=ta.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var m=this._map,x=m.getZoom(),C=m.options.zoomDelta,B=s.originalEvent.shiftKey?x-C:x+C;m.options.doubleClickZoom==="center"?m.setZoom(B):m.setZoomAround(s.containerPoint,B)}});It.addInitHook("addHandler","doubleClickZoom",Es),It.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var lo=ta.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Ci(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}Ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Li(this._map._container,"leaflet-grab"),Li(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var m=ei(this._map.options.maxBounds);this._offsetLimit=Ri(this._map.latLngToContainerPoint(m.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(m.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var m=this._lastTime=+new Date,x=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(x),this._times.push(m),this._prunePositions(m)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),m=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=m.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,m){return s-(s-m)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),m=this._offsetLimit;s.x<m.min.x&&(s.x=this._viscousLimit(s.x,m.min.x)),s.y<m.min.y&&(s.y=this._viscousLimit(s.y,m.min.y)),s.x>m.max.x&&(s.x=this._viscousLimit(s.x,m.max.x)),s.y>m.max.y&&(s.y=this._viscousLimit(s.y,m.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,m=Math.round(s/2),x=this._initialWorldOffset,C=this._draggable._newPos.x,B=(C-m+x)%s+m-x,W=(C+m+x)%s-m-x,me=Math.abs(B+x)<Math.abs(W+x)?B:W;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=me},_onDragEnd:function(s){var m=this._map,x=m.options,C=!x.inertia||s.noInertia||this._times.length<2;if(m.fire("dragend",s),C)m.fire("moveend");else{this._prunePositions(+new Date);var B=this._lastPos.subtract(this._positions[0]),W=(this._lastTime-this._times[0])/1e3,me=x.easeLinearity,be=B.multiplyBy(me/W),Re=be.distanceTo([0,0]),Ze=Math.min(x.inertiaMaxSpeed,Re),ut=be.multiplyBy(Ze/Re),vt=Ze/(x.inertiaDeceleration*me),Dt=ut.multiplyBy(-vt/2).round();!Dt.x&&!Dt.y?m.fire("moveend"):(Dt=m._limitOffset(Dt,m.options.maxBounds),Pi(function(){m.panBy(Dt,{duration:vt,easeLinearity:me,noMoveStart:!0,animate:!0})}))}}});It.addInitHook("addHandler","dragging",lo),It.mergeOptions({keyboard:!0,keyboardPanDelta:80});var gl=ta.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),mt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),rt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,m=document.documentElement,x=s.scrollTop||m.scrollTop,C=s.scrollLeft||m.scrollLeft;this._map._container.focus(),window.scrollTo(C,x)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var m=this._panKeys={},x=this.keyCodes,C,B;for(C=0,B=x.left.length;C<B;C++)m[x.left[C]]=[-1*s,0];for(C=0,B=x.right.length;C<B;C++)m[x.right[C]]=[s,0];for(C=0,B=x.down.length;C<B;C++)m[x.down[C]]=[0,s];for(C=0,B=x.up.length;C<B;C++)m[x.up[C]]=[0,-1*s]},_setZoomDelta:function(s){var m=this._zoomKeys={},x=this.keyCodes,C,B;for(C=0,B=x.zoomIn.length;C<B;C++)m[x.zoomIn[C]]=s;for(C=0,B=x.zoomOut.length;C<B;C++)m[x.zoomOut[C]]=-s},_addHooks:function(){mt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var m=s.keyCode,x=this._map,C;if(m in this._panKeys){if(!x._panAnim||!x._panAnim._inProgress)if(C=this._panKeys[m],s.shiftKey&&(C=pt(C).multiplyBy(3)),x.options.maxBounds&&(C=x._limitOffset(pt(C),x.options.maxBounds)),x.options.worldCopyJump){var B=x.wrapLatLng(x.unproject(x.project(x.getCenter()).add(C)));x.panTo(B)}else x.panBy(C)}else if(m in this._zoomKeys)x.setZoom(x.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[m]);else if(m===27&&x._popup&&x._popup.options.closeOnEscapeKey)x.closePopup();else return;qn(s)}}});It.addInitHook("addHandler","keyboard",gl),It.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var yl=ta.extend({addHooks:function(){mt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var m=rr(s),x=this._map.options.wheelDebounceTime;this._delta+=m,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var C=Math.max(x-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(v(this._performZoom,this),C),qn(s)},_performZoom:function(){var s=this._map,m=s.getZoom(),x=this._map.options.zoomSnap||0;s._stop();var C=this._delta/(this._map.options.wheelPxPerZoomLevel*4),B=4*Math.log(2/(1+Math.exp(-Math.abs(C))))/Math.LN2,W=x?Math.ceil(B/x)*x:B,me=s._limitZoom(m+(this._delta>0?W:-W))-m;this._delta=0,this._startTime=null,me&&(s.options.scrollWheelZoom==="center"?s.setZoom(m+me):s.setZoomAround(this._lastMousePos,m+me))}});It.addInitHook("addHandler","scrollWheelZoom",yl);var vl=600;It.mergeOptions({tapHold:Ee.touchNative&&Ee.safari&&Ee.mobile,tapTolerance:15});var xl=ta.extend({addHooks:function(){mt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var m=s.touches[0];this._startPos=this._newPos=new _t(m.clientX,m.clientY),this._holdTimeout=setTimeout(v(function(){this._cancel(),this._isTapValid()&&(mt(document,"touchend",Rt),mt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",m))},this),vl),mt(document,"touchend touchcancel contextmenu",this._cancel,this),mt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){rt(document,"touchend",Rt),rt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)},_onMove:function(s){var m=s.touches[0];this._newPos=new _t(m.clientX,m.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,m){var x=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:m.screenX,screenY:m.screenY,clientX:m.clientX,clientY:m.clientY});x._simulated=!0,m.target.dispatchEvent(x)}});It.addInitHook("addHandler","tapHold",xl),It.mergeOptions({touchZoom:Ee.touch,bounceAtZoomLimits:!0});var us=ta.extend({addHooks:function(){Ct(this._map._container,"leaflet-touch-zoom"),mt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Li(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var m=this._map;if(!(!s.touches||s.touches.length!==2||m._animatingZoom||this._zooming)){var x=m.mouseEventToContainerPoint(s.touches[0]),C=m.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=m.getSize()._divideBy(2),this._startLatLng=m.containerPointToLatLng(this._centerPoint),m.options.touchZoom!=="center"&&(this._pinchStartLatLng=m.containerPointToLatLng(x.add(C)._divideBy(2))),this._startDist=x.distanceTo(C),this._startZoom=m.getZoom(),this._moved=!1,this._zooming=!0,m._stop(),mt(document,"touchmove",this._onTouchMove,this),mt(document,"touchend touchcancel",this._onTouchEnd,this),Rt(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var m=this._map,x=m.mouseEventToContainerPoint(s.touches[0]),C=m.mouseEventToContainerPoint(s.touches[1]),B=x.distanceTo(C)/this._startDist;if(this._zoom=m.getScaleZoom(B,this._startZoom),!m.options.bounceAtZoomLimits&&(this._zoom<m.getMinZoom()&&B<1||this._zoom>m.getMaxZoom()&&B>1)&&(this._zoom=m._limitZoom(this._zoom)),m.options.touchZoom==="center"){if(this._center=this._startLatLng,B===1)return}else{var W=x._add(C)._divideBy(2)._subtract(this._centerPoint);if(B===1&&W.x===0&&W.y===0)return;this._center=m.unproject(m.project(this._pinchStartLatLng,this._zoom).subtract(W),this._zoom)}this._moved||(m._moveStart(!0,!1),this._moved=!0),yi(this._animRequest);var me=v(m._move,m,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Pi(me,this,!0),Rt(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,yi(this._animRequest),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});It.addInitHook("addHandler","touchZoom",us),It.BoxZoom=_l,It.DoubleClickZoom=Es,It.Drag=lo,It.Keyboard=gl,It.ScrollWheelZoom=yl,It.TapHold=xl,It.TouchZoom=us,De.Bounds=Ut,De.Browser=Ee,De.CRS=Wi,De.Canvas=ao,De.Circle=Qr,De.CircleMarker=Va,De.Class=bn,De.Control=fn,De.DivIcon=io,De.DivOverlay=Wn,De.DomEvent=nl,De.DomUtil=Rn,De.Draggable=Ci,De.Evented=Hi,De.FeatureGroup=ca,De.GeoJSON=fa,De.GridLayer=mn,De.Handler=ta,De.Icon=sr,De.ImageOverlay=Ro,De.LatLng=Tt,De.LatLngBounds=Ni,De.Layer=Fn,De.LayerGroup=Tr,De.LineUtil=Xr,De.Map=It,De.Marker=ka,De.Mixin=iu,De.Path=Sa,De.Point=_t,De.PolyUtil=Ts,De.Polygon=Ta,De.Polyline=Na,De.Popup=Mr,De.PosAnimation=Qo,De.Projection=au,De.Rectangle=Et,De.Renderer=ia,De.SVG=so,De.SVGOverlay=ml,De.TileLayer=Er,De.Tooltip=to,De.Transformation=Ia,De.Util=Jn,De.VideoOverlay=cl,De.bind=v,De.bounds=Ri,De.canvas=jo,De.circle=ru,De.circleMarker=ul,De.control=zt,De.divIcon=no,De.extend=T,De.featureGroup=Ms,De.geoJSON=ns,De.geoJson=ou,De.gridLayer=pl,De.icon=sl,De.imageOverlay=su,De.latLng=kt,De.latLngBounds=ei,De.layerGroup=ol,De.map=ri,De.marker=ll,De.point=pt,De.polygon=hl,De.polyline=dl,De.popup=as,De.rectangle=ls,De.setOptions=Pe,De.stamp=I,De.svg=ss,De.svgOverlay=Zt,De.tileLayer=rs,De.tooltip=Cr,De.transformation=nn,De.version=st,De.videoOverlay=fl;var uo=window.L;De.noConflict=function(){return window.L=uo,this},window.L=De}))})(Ku,Ku.exports)),Ku.exports}var N_=V_();const X_=mm(N_);var Gd={exports:{}};var U_=Gd.exports,dm;function G_(){return dm||(dm=1,(function(Fe,Oe){(function(De,st){Fe.exports=st()})(U_,(function(){var De={},st={};function T(v,o,I){if(st[v]=I,v==="index"){var R="var sharedModule = {}; ("+st.shared+")(sharedModule); ("+st.worker+")(sharedModule);",q={};return st.shared(q),st.index(De,q),typeof window<"u"&&De.setWorkerUrl(window.URL.createObjectURL(new Blob([R],{type:"text/javascript"}))),De}}T("shared",["exports"],(function(v){function o(n,e,i,r){return new(i||(i=Promise))((function(u,h){function c(k){try{y(r.next(k))}catch(P){h(P)}}function _(k){try{y(r.throw(k))}catch(P){h(P)}}function y(k){var P;k.done?u(k.value):(P=k.value,P instanceof i?P:new i((function(E){E(P)}))).then(c,_)}y((r=r.apply(n,e||[])).next())}))}function I(n,e){this.x=n,this.y=e}function R(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var q,X;typeof SuppressedError=="function"&&SuppressedError,I.prototype={clone(){return new I(this.x,this.y)},add(n){return this.clone()._add(n)},sub(n){return this.clone()._sub(n)},multByPoint(n){return this.clone()._multByPoint(n)},divByPoint(n){return this.clone()._divByPoint(n)},mult(n){return this.clone()._mult(n)},div(n){return this.clone()._div(n)},rotate(n){return this.clone()._rotate(n)},rotateAround(n,e){return this.clone()._rotateAround(n,e)},matMult(n){return this.clone()._matMult(n)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(n){return this.x===n.x&&this.y===n.y},dist(n){return Math.sqrt(this.distSqr(n))},distSqr(n){const e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle(){return Math.atan2(this.y,this.x)},angleTo(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith(n){return this.angleWithSep(n.x,n.y)},angleWithSep(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult(n){const e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add(n){return this.x+=n.x,this.y+=n.y,this},_sub(n){return this.x-=n.x,this.y-=n.y,this},_mult(n){return this.x*=n,this.y*=n,this},_div(n){return this.x/=n,this.y/=n,this},_multByPoint(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint(n){return this.x/=n.x,this.y/=n.y,this},_unit(){return this._div(this.mag()),this},_perp(){const n=this.y;return this.y=this.x,this.x=-n,this},_rotate(n){const e=Math.cos(n),i=Math.sin(n),r=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=r,this},_rotateAround(n,e){const i=Math.cos(n),r=Math.sin(n),u=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-r*(this.y-e.y),this.y=u,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:I},I.convert=function(n){if(n instanceof I)return n;if(Array.isArray(n))return new I(+n[0],+n[1]);if(n.x!==void 0&&n.y!==void 0)return new I(+n.x,+n.y);throw new Error("Expected [x, y] or {x, y} point format")};var re=(function(){if(X)return q;function n(e,i,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(u-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=r,this.p2y=u}return X=1,q=n,n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,u=0;u<8;u++){var h=this.sampleCurveX(r)-e;if(Math.abs(h)<i)return r;var c=this.sampleCurveDerivativeX(r);if(Math.abs(c)<1e-6)break;r-=h/c}var _=0,y=1;for(r=e,u=0;u<20&&(h=this.sampleCurveX(r),!(Math.abs(h-e)<i));u++)e>h?_=r:y=r,r=.5*(y-_)+_;return r},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},q})(),ce=R(re);let Ae,Pe;function le(){return Ae==null&&(Ae=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ae}function it(){if(Pe==null&&(Pe=!1,le())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let r=0;r<25;r++){const u=4*r;e.fillStyle=`rgb(${u},${u+1},${u+2})`,e.fillRect(r%5,Math.floor(r/5),1,1)}const i=e.getImageData(0,0,5,5).data;for(let r=0;r<100;r++)if(r%4!=3&&i[r]!==r){Pe=!0;break}}}return Pe||!1}var We=1e-6,He=typeof Float32Array<"u"?Float32Array:Array;function bt(){var n=new He(9);return He!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Bt(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Di(){var n=new He(3);return He!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Ot(n){var e=n[0],i=n[1],r=n[2];return Math.sqrt(e*e+i*i+r*r)}function Ai(n,e,i){var r=new He(3);return r[0]=n,r[1]=e,r[2]=i,r}function En(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function zn(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function Pi(n,e,i){var r=e[0],u=e[1],h=e[2],c=i[0],_=i[1],y=i[2];return n[0]=u*y-h*_,n[1]=h*c-r*y,n[2]=r*_-u*c,n}var yi,Jn=Ot;function bn(n,e,i){var r=e[0],u=e[1],h=e[2],c=e[3];return n[0]=i[0]*r+i[4]*u+i[8]*h+i[12]*c,n[1]=i[1]*r+i[5]*u+i[9]*h+i[13]*c,n[2]=i[2]*r+i[6]*u+i[10]*h+i[14]*c,n[3]=i[3]*r+i[7]*u+i[11]*h+i[15]*c,n}function za(){var n=new He(4);return He!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Ji(n,e,i,r){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",h=Math.PI/360;e*=h,r*=h,i*=h;var c=Math.sin(e),_=Math.cos(e),y=Math.sin(i),k=Math.cos(i),P=Math.sin(r),E=Math.cos(r);switch(u){case"xyz":n[0]=c*k*E+_*y*P,n[1]=_*y*E-c*k*P,n[2]=_*k*P+c*y*E,n[3]=_*k*E-c*y*P;break;case"xzy":n[0]=c*k*E-_*y*P,n[1]=_*y*E-c*k*P,n[2]=_*k*P+c*y*E,n[3]=_*k*E+c*y*P;break;case"yxz":n[0]=c*k*E+_*y*P,n[1]=_*y*E-c*k*P,n[2]=_*k*P-c*y*E,n[3]=_*k*E+c*y*P;break;case"yzx":n[0]=c*k*E+_*y*P,n[1]=_*y*E+c*k*P,n[2]=_*k*P-c*y*E,n[3]=_*k*E-c*y*P;break;case"zxy":n[0]=c*k*E-_*y*P,n[1]=_*y*E+c*k*P,n[2]=_*k*P+c*y*E,n[3]=_*k*E-c*y*P;break;case"zyx":n[0]=c*k*E-_*y*P,n[1]=_*y*E+c*k*P,n[2]=_*k*P-c*y*E,n[3]=_*k*E+c*y*P;break;default:throw new Error("Unknown angle order "+u)}return n}function Hi(){var n=new He(2);return He!=Float32Array&&(n[0]=0,n[1]=0),n}function _t(n,e){var i=new He(2);return i[0]=n,i[1]=e,i}Di(),yi=new He(4),He!=Float32Array&&(yi[0]=0,yi[1]=0,yi[2]=0,yi[3]=0),Di(),Ai(1,0,0),Ai(0,1,0),za(),za(),bt(),Hi();const $t=8192;function pt(n,e,i){return e*($t/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}function Ut(n,e){return(n%e+e)%e}function Ri(n,e,i){return n*(1-i)+e*i}function Ni(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function ei(n,e,i,r){const u=new ce(n,e,i,r);return h=>u.solve(h)}const Tt=ei(.25,.1,.25,1);function kt(n,e,i){return Math.min(i,Math.max(e,n))}function Wi(n,e,i){const r=i-e,u=((n-e)%r+r)%r+e;return u===e?i:u}function mi(n,...e){for(const i of e)for(const r in i)n[r]=i[r];return n}let ga=1;function dn(n,e,i){const r={};for(const u in n)r[u]=e.call(this,n[u],u,n);return r}function Ia(n,e,i){const r={};for(const u in n)e.call(this,n[u],u,n)&&(r[u]=n[u]);return r}function nn(n){return Array.isArray(n)?n.map(nn):typeof n=="object"&&n?dn(n,nn):n}const pr={};function Qi(n){pr[n]||(typeof console<"u"&&console.warn(n),pr[n]=!0)}function Un(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function oa(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let hi=null;function sa(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const _r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function gr(n,e,i,r,u){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const h=new VideoFrame(n,{timestamp:0});try{const c=h?.format;if(!c||!c.startsWith("BGR")&&!c.startsWith("RGB"))throw new Error(`Unrecognized format ${c}`);const _=c.startsWith("BGR"),y=new Uint8ClampedArray(r*u*4);if(yield h.copyTo(y,(function(k,P,E,D,A){const O=4*Math.max(-P,0),$=(Math.max(0,E)-E)*D*4+O,N=4*D,H=Math.max(0,P),ne=Math.max(0,E);return{rect:{x:H,y:ne,width:Math.min(k.width,P+D)-H,height:Math.min(k.height,E+A)-ne},layout:[{offset:$,stride:N}]}})(n,e,i,r,u)),_)for(let k=0;k<y.length;k+=4){const P=y[k];y[k]=y[k+2],y[k+2]=P}return y}finally{h.close()}}))}let ya,Qn;function yr(n,e,i,r){return n.addEventListener(e,i,r),{unsubscribe:()=>{n.removeEventListener(e,i,r)}}}function $r(n){return n*Math.PI/180}function In(n){return n/Math.PI*180}const xe={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},G={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},U="AbortError";class Y extends Error{constructor(e=U){super(e instanceof Error?e.message:e),this.name=U,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function fe(n){return n.name===U}const pe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ke(n){return pe.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const ve="global-dispatcher";class ge extends Error{constructor(e,i,r,u){super(`AJAXError: ${i} (${e}): ${r}`),this.status=e,this.statusText=i,this.url=r,this.body=u}}const Me=()=>oa(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ge=function(n,e){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const r=ke(n.url);if(r)return r(n,e);if(oa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:ve},e)}if(!(/^file:/.test(i=n.url)||/^file:/.test(Me())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(r,u){return o(this,void 0,void 0,(function*(){const h=new Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,cache:r.cache,referrer:Me(),signal:u.signal});let c,_;r.type!=="json"||h.headers.has("Accept")||h.headers.set("Accept","application/json");try{c=yield fetch(h)}catch(k){throw fe(k)?k:new ge(0,k.message,r.url,new Blob)}if(!c.ok){const k=yield c.blob();throw new ge(c.status,c.statusText,r.url,k)}_=r.type==="arrayBuffer"||r.type==="image"?c.arrayBuffer():r.type==="json"?c.json():c.text();const y=yield _;return u.signal.throwIfAborted(),{data:y,cacheControl:c.headers.get("Cache-Control"),expires:c.headers.get("Expires")}}))})(n,e);if(oa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:ve},e)}var i;return(function(r,u){return new Promise(((h,c)=>{var _;const y=new XMLHttpRequest;y.open(r.method||"GET",r.url,!0),r.type!=="arrayBuffer"&&r.type!=="image"||(y.responseType="arraybuffer");for(const k in r.headers)y.setRequestHeader(k,r.headers[k]);r.type==="json"&&(y.responseType="text",!((_=r.headers)===null||_===void 0)&&_.Accept||y.setRequestHeader("Accept","application/json")),y.withCredentials=r.credentials==="include",y.onerror=()=>{c(new Error(y.statusText))},y.onload=()=>{if(!u.signal.aborted)if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let k=y.response;if(r.type==="json")try{k=JSON.parse(y.response)}catch(P){return void c(P)}h({data:k,cacheControl:y.getResponseHeader("Cache-Control"),expires:y.getResponseHeader("Expires")})}else{const k=new Blob([y.response],{type:y.getResponseHeader("Content-Type")});c(new ge(y.status,y.statusText,r.url,k))}},u.signal.addEventListener("abort",(()=>{y.abort(),c(new Y(u.signal.reason))})),y.send(r.body)}))})(n,e)};function $e(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const e=new URL(n),i=window.location;return e.protocol===i.protocol&&e.host===i.host}function nt(n,e,i){i[n]&&i[n].indexOf(e)!==-1||(i[n]=i[n]||[],i[n].push(e))}function dt(n,e,i){if(i&&i[n]){const r=i[n].indexOf(e);r!==-1&&i[n].splice(r,1)}}class gt{constructor(e,i={}){mi(this,i),this.type=e}}class Ht extends gt{constructor(e,i={}){super("error",mi({error:e},i))}}class Vt{on(e,i){return this._listeners=this._listeners||{},nt(e,i,this._listeners),{unsubscribe:()=>{this.off(e,i)}}}off(e,i){return dt(e,i,this._listeners),dt(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},nt(e,i,this._oneTimeListeners),this):new Promise((r=>this.once(e,r)))}fire(e,i){typeof e=="string"&&(e=new gt(e,i||{}));const r=e.type;if(this.listens(r)){e.target=this;const u=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const _ of u)_.call(this,e);const h=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const _ of h)dt(r,_,this._oneTimeListeners),_.call(this,e);const c=this._eventedParent;c&&(mi(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),c.fire(e))}else e instanceof Ht&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var Se={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const ti=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function an(n,e){const i={};for(const r in n)r!=="ref"&&(i[r]=n[r]);return ti.forEach((r=>{r in e&&(i[r]=e[r])})),i}function yt(n,e){if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let i=0;i<n.length;i++)if(!yt(n[i],e[i]))return!1;return!0}if(typeof n=="object"&&n!==null&&e!==null){if(typeof e!="object"||Object.keys(n).length!==Object.keys(e).length)return!1;for(const i in n)if(!yt(n[i],e[i]))return!1;return!0}return n===e}function Wt(n,e){n.push(e)}function rn(n,e,i){Wt(i,{command:"addSource",args:[n,e[n]]})}function ii(n,e,i){Wt(e,{command:"removeSource",args:[n]}),i[n]=!0}function vi(n,e,i,r){ii(n,i,r),rn(n,e,i)}function ni(n,e,i){let r;for(r in n[i])if(Object.prototype.hasOwnProperty.call(n[i],r)&&r!=="data"&&!yt(n[i][r],e[i][r]))return!1;for(r in e[i])if(Object.prototype.hasOwnProperty.call(e[i],r)&&r!=="data"&&!yt(n[i][r],e[i][r]))return!1;return!0}function Ui(n,e,i,r,u,h){n=n||{},e=e||{};for(const c in n)Object.prototype.hasOwnProperty.call(n,c)&&(yt(n[c],e[c])||i.push({command:h,args:[r,c,e[c],u]}));for(const c in e)Object.prototype.hasOwnProperty.call(e,c)&&!Object.prototype.hasOwnProperty.call(n,c)&&(yt(n[c],e[c])||i.push({command:h,args:[r,c,e[c],u]}))}function vo(n){return n.id}function Dn(n,e){return n[e.id]=e,n}class Ee{constructor(e,i,r,u){this.message=(e?`${e}: `:"")+r,u&&(this.identifier=u),i!=null&&i.__line__&&(this.line=i.__line__)}}function hn(n,...e){for(const i of e)for(const r in i)n[r]=i[r];return n}class cn extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class xo{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[r,u]of i)this.bindings[r]=u}concat(e){return new xo(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Gn={kind:"null"},Qe={kind:"number"},Mt={kind:"string"},xt={kind:"boolean"},An={kind:"color"},Wo={kind:"projectionDefinition"},Da={kind:"object"},Pt={kind:"value"},wo={kind:"collator"},Vr={kind:"formatted"},Ko={kind:"padding"},Aa={kind:"colorArray"},bo={kind:"numberArray"},Nr={kind:"resolvedImage"},ko={kind:"variableAnchorOffsetCollection"};function kn(n,e){return{kind:"array",itemType:n,N:e}}function Kt(n){if(n.kind==="array"){const e=Kt(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const Ur=[Gn,Qe,Mt,xt,An,Wo,Vr,Da,kn(Pt),Ko,bo,Aa,Nr,ko];function va(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!va(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const i of Ur)if(!va(i,e))return null}}return`Expected ${Kt(n)} but found ${Kt(e)} instead.`}function Gr(n,e){return e.some((i=>i.kind===n.kind))}function tr(n,e){return e.some((i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n))}function Sn(n,e){return n.kind==="array"&&e.kind==="array"?n.itemType.kind===e.itemType.kind&&typeof n.N=="number":n.kind===e.kind}const Gt=.96422,Yt=.82521,vr=4/29,ai=6/29,xr=3*ai*ai,Xo=ai*ai*ai,Ct=Math.PI/180,Li=180/Math.PI;function Yo(n){return(n%=360)<0&&(n+=360),n}function So([n,e,i,r]){let u,h;const c=ks((.2225045*(n=Tn(n))+.7168786*(e=Tn(e))+.0606169*(i=Tn(i)))/1);n===e&&e===i?u=h=c:(u=ks((.4360747*n+.3850649*e+.1430804*i)/Gt),h=ks((.0139322*n+.0971045*e+.7141733*i)/Yt));const _=116*c-16;return[_<0?0:_,500*(u-c),200*(c-h),r]}function Tn(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function ks(n){return n>Xo?Math.pow(n,1/3):n/xr+vr}function qr([n,e,i,r]){let u=(n+16)/116,h=isNaN(e)?u:u+e/500,c=isNaN(i)?u:u-i/200;return u=1*Mi(u),h=Gt*Mi(h),c=Yt*Mi(c),[Ra(3.1338561*h-1.6168667*u-.4906146*c),Ra(-.9787684*h+1.9161415*u+.033454*c),Ra(.0719453*h-.2289914*u+1.4052427*c),r]}function Ra(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function Mi(n){return n>ai?n*n*n:xr*(n-vr)}const wr=Object.hasOwn||function(n,e){return Object.prototype.hasOwnProperty.call(n,e)};function ja(n,e){return wr(n,e)?n[e]:void 0}function ir(n){return parseInt(n.padEnd(2,n),16)/255}function Jo(n,e){return xa(e?n/100:n,0,1)}function xa(n,e,i){return Math.min(Math.max(e,n),i)}function To(n){return!n.some(Number.isNaN)}const br={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function la(n,e,i){return n+i*(e-n)}function nr(n,e,i){return n.map(((r,u)=>la(r,e[u],i)))}class Lt{constructor(e,i,r,u=1,h=!0){this.r=e,this.g=i,this.b=r,this.a=u,h||(this.r*=u,this.g*=u,this.b*=u,u||this.overwriteGetter("rgb",[e,i,r,u]))}static parse(e){if(e instanceof Lt)return e;if(typeof e!="string")return;const i=(function(r){if((r=r.toLowerCase().trim())==="transparent")return[0,0,0,0];const u=ja(br,r);if(u){const[c,_,y]=u;return[c/255,_/255,y/255,1]}if(r.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(r)){const c=r.length<6?1:2;let _=1;return[ir(r.slice(_,_+=c)),ir(r.slice(_,_+=c)),ir(r.slice(_,_+=c)),ir(r.slice(_,_+c)||"ff")]}if(r.startsWith("rgb")){const c=r.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(c){const[_,y,k,P,E,D,A,O,$,N,H,ne]=c,K=[P||" ",A||" ",N].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){const J=[k,D,$].join(""),oe=J==="%%%"?100:J===""?255:0;if(oe){const de=[xa(+y/oe,0,1),xa(+E/oe,0,1),xa(+O/oe,0,1),H?Jo(+H,ne):1];if(To(de))return de}}return}}const h=r.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(h){const[c,_,y,k,P,E,D,A,O]=h,$=[y||" ",P||" ",D].join("");if($==="  "||$==="  /"||$===",,"||$===",,,"){const N=[+_,xa(+k,0,100),xa(+E,0,100),A?Jo(+A,O):1];if(To(N))return(function([H,ne,K,J]){function oe(de){const we=(de+H/30)%12,Ve=ne*Math.min(K,1-K);return K-Ve*Math.max(-1,Math.min(we-3,9-we,1))}return H=Yo(H),ne/=100,K/=100,[oe(0),oe(8),oe(4),J]})(N)}}})(e);return i?new Lt(...i,!1):void 0}get rgb(){const{r:e,g:i,b:r,a:u}=this,h=u||1/0;return this.overwriteGetter("rgb",[e/h,i/h,r/h,u])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[i,r,u,h]=So(e),c=Math.sqrt(r*r+u*u);return[Math.round(1e4*c)?Yo(Math.atan2(u,r)*Li):NaN,c,i,h]})(this.rgb))}get lab(){return this.overwriteGetter("lab",So(this.rgb))}overwriteGetter(e,i){return Object.defineProperty(this,e,{value:i}),i}toString(){const[e,i,r,u]=this.rgb;return`rgba(${[e,i,r].map((h=>Math.round(255*h))).join(",")},${u})`}static interpolate(e,i,r,u="rgb"){switch(u){case"rgb":{const[h,c,_,y]=nr(e.rgb,i.rgb,r);return new Lt(h,c,_,y,!1)}case"hcl":{const[h,c,_,y]=e.hcl,[k,P,E,D]=i.hcl;let A,O;if(isNaN(h)||isNaN(k))isNaN(h)?isNaN(k)?A=NaN:(A=k,_!==1&&_!==0||(O=P)):(A=h,E!==1&&E!==0||(O=c));else{let K=k-h;k>h&&K>180?K-=360:k<h&&h-k>180&&(K+=360),A=h+r*K}const[$,N,H,ne]=(function([K,J,oe,de]){return K=isNaN(K)?0:K*Ct,qr([oe,Math.cos(K)*J,Math.sin(K)*J,de])})([A,O??la(c,P,r),la(_,E,r),la(y,D,r)]);return new Lt($,N,H,ne,!1)}case"lab":{const[h,c,_,y]=qr(nr(e.lab,i.lab,r));return new Lt(h,c,_,y,!1)}}}}Lt.black=new Lt(0,0,0,1),Lt.white=new Lt(1,1,1,1),Lt.transparent=new Lt(0,0,0,0),Lt.red=new Lt(1,0,0,1);class Zr{constructor(e,i,r){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const il=["bottom","center","top"];class Po{constructor(e,i,r,u,h,c){this.text=e,this.image=i,this.scale=r,this.fontStack=u,this.textColor=h,this.verticalAlign=c}}class Rn{constructor(e){this.sections=e}static fromString(e){return new Rn([new Po(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof Rn?e:Rn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class mt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof mt)return e;if(typeof e=="number")return new mt([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const i of e)if(typeof i!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new mt(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,r){return new mt(nr(e.values,i.values,r))}}class qt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof qt)return e;if(typeof e=="number")return new qt([e]);if(Array.isArray(e)){for(const i of e)if(typeof i!="number")return;return new qt(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,r){return new qt(nr(e.values,i.values,r))}}class rt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof rt)return e;if(typeof e=="string"){const r=Lt.parse(e);return r?new rt([r]):void 0}if(!Array.isArray(e))return;const i=[];for(const r of e){if(typeof r!="string")return;const u=Lt.parse(r);if(!u)return;i.push(u)}return new rt(i)}toString(){return JSON.stringify(this.values)}static interpolate(e,i,r,u="rgb"){const h=[];if(e.values.length!=i.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${i.values.length}), cannot interpolate.`);for(let c=0;c<e.values.length;c++)h.push(Lt.interpolate(e.values[c],i.values[c],r,u));return new rt(h)}}class Jt extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const wa=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class on{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof on)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let i=0;i<e.length;i+=2){const r=e[i],u=e[i+1];if(typeof r!="string"||!wa.has(r)||!Array.isArray(u)||u.length!==2||typeof u[0]!="number"||typeof u[1]!="number")return}return new on(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,r){const u=e.values,h=i.values;if(u.length!==h.length)throw new Jt(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${i.toString()}`);const c=[];for(let _=0;_<u.length;_+=2){if(u[_]!==h[_])throw new Jt(`Cannot interpolate values containing mismatched anchors. from[${_}]: ${u[_]}, to[${_}]: ${h[_]}`);c.push(u[_]);const[y,k]=u[_+1],[P,E]=h[_+1];c.push([la(y,P,r),la(k,E,r)])}return new on(c)}}class Pn{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Pn({name:e,available:!1}):null}}class ji{constructor(e,i,r){this.from=e,this.to=i,this.transition=r}static interpolate(e,i,r){return new ji(e,i,r)}static parse(e){return e instanceof ji?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new ji(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new ji(e.from,e.to,e.transition):typeof e=="string"?new ji(e,e,1):void 0}}function ar(n,e,i,r){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?r===void 0||typeof r=="number"&&r>=0&&r<=1?null:`Invalid rgba value [${[n,e,i,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof r=="number"?[n,e,i,r]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ea(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof ji||n instanceof Lt||n instanceof Zr||n instanceof Rn||n instanceof mt||n instanceof qt||n instanceof rt||n instanceof on||n instanceof Pn)return!0;if(Array.isArray(n)){for(const e of n)if(!ea(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!ea(n[e]))return!1;return!0}return!1}function Rt(n){if(n===null)return Gn;if(typeof n=="string")return Mt;if(typeof n=="boolean")return xt;if(typeof n=="number")return Qe;if(n instanceof Lt)return An;if(n instanceof ji)return Wo;if(n instanceof Zr)return wo;if(n instanceof Rn)return Vr;if(n instanceof mt)return Ko;if(n instanceof qt)return bo;if(n instanceof rt)return Aa;if(n instanceof on)return ko;if(n instanceof Pn)return Nr;if(Array.isArray(n)){const e=n.length;let i;for(const r of n){const u=Rt(r);if(i){if(i===u)continue;i=Pt;break}i=u}return kn(i||Pt,e)}return Da}function qn(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof Lt||n instanceof ji||n instanceof Rn||n instanceof mt||n instanceof qt||n instanceof rt||n instanceof on||n instanceof Pn?n.toString():JSON.stringify(n)}class ua{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ea(e[1]))return i.error("invalid value");const r=e[1];let u=Rt(r);const h=i.expectedType;return u.kind!=="array"||u.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(u=h),new ua(u,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Lo={string:Mt,number:Qe,boolean:xt,object:Da};class jn{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let r,u=1;const h=e[0];if(h==="array"){let _,y;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in Lo)||k==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);_=Lo[k],u++}else _=Pt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);y=e[2],u++}r=kn(_,y)}else{if(!Lo[h])throw new Error(`Types doesn't contain name = ${h}`);r=Lo[h]}const c=[];for(;u<e.length;u++){const _=i.parse(e[u],u,Pt);if(!_)return null;c.push(_)}return new jn(r,c)}evaluate(e){for(let i=0;i<this.args.length;i++){const r=this.args[i].evaluate(e);if(!va(this.type,Rt(r)))return r;if(i===this.args.length-1)throw new Jt(`Expected value to be of type ${Kt(this.type)}, but found ${Kt(Rt(r))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const rr={"to-boolean":xt,"to-color":An,"to-number":Qe,"to-string":Mt};class da{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const r=e[0];if(!rr[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if((r==="to-boolean"||r==="to-string")&&e.length!==2)return i.error("Expected one argument.");const u=rr[r],h=[];for(let c=1;c<e.length;c++){const _=i.parse(e[c],c,Pt);if(!_)return null;h.push(_)}return new da(u,h)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let i,r;for(const u of this.args){if(i=u.evaluate(e),r=null,i instanceof Lt)return i;if(typeof i=="string"){const h=e.parseColor(i);if(h)return h}else if(Array.isArray(i)&&(r=i.length<3||i.length>4?`Invalid rgba value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:ar(i[0],i[1],i[2],i[3]),!r))return new Lt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Jt(r||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const r of this.args){i=r.evaluate(e);const u=mt.parse(i);if(u)return u}throw new Jt(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"numberArray":{let i;for(const r of this.args){i=r.evaluate(e);const u=qt.parse(i);if(u)return u}throw new Jt(`Could not parse numberArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"colorArray":{let i;for(const r of this.args){i=r.evaluate(e);const u=rt.parse(i);if(u)return u}throw new Jt(`Could not parse colorArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const r of this.args){i=r.evaluate(e);const u=on.parse(i);if(u)return u}throw new Jt(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const r of this.args){if(i=r.evaluate(e),i===null)return 0;const u=Number(i);if(!isNaN(u))return u}throw new Jt(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return Rn.fromString(qn(this.args[0].evaluate(e)));case"resolvedImage":return Pn.fromString(qn(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return qn(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const nl=["Unknown","Point","LineString","Polygon"];class Qo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?nl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache.get(e);return i||(i=Lt.parse(e),this._parseColorCache.set(e,i)),i}}class It{constructor(e,i,r=[],u,h=new xo,c=[]){this.registry=e,this.path=r,this.key=r.map((_=>`[${_}]`)).join(""),this.scope=h,this.errors=c,this.expectedType=u,this._isConstant=i}parse(e,i,r,u,h={}){return i?this.concat(i,r,u)._parse(e,h):this._parse(e,h)}_parse(e,i){function r(u,h,c){return c==="assert"?new jn(h,[u]):c==="coerce"?new da(h,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const h=this.registry[u];if(h){let c=h.parse(e,this);if(!c)return null;if(this.expectedType){const _=this.expectedType,y=c.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||y.kind!=="value"){if(_.kind==="projectionDefinition"&&["string","array"].includes(y.kind)||["color","formatted","resolvedImage"].includes(_.kind)&&["value","string"].includes(y.kind)||["padding","numberArray"].includes(_.kind)&&["value","number","array"].includes(y.kind)||_.kind==="colorArray"&&["value","string","array"].includes(y.kind)||_.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(y.kind))c=r(c,_,i.typeAnnotation||"coerce");else if(this.checkSubtype(_,y))return null}else c=r(c,_,i.typeAnnotation||"assert")}if(!(c instanceof ua)&&c.type.kind!=="resolvedImage"&&this._isConstant(c)){const _=new Qo;try{c=new ua(c.type,c.evaluate(_))}catch(y){return this.error(y.message),null}}return c}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,r){const u=typeof e=="number"?this.path.concat(e):this.path,h=r?this.scope.concat(r):this.scope;return new It(this.registry,this._isConstant,u,i||null,h,this.errors)}error(e,...i){const r=`${this.key}${i.map((u=>`[${u}]`)).join("")}`;this.errors.push(new cn(r,e))}checkSubtype(e,i){const r=va(e,i);return r&&this.error(r),r}}class ri{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let h=1;h<e.length-1;h+=2){const c=e[h];if(typeof c!="string")return i.error(`Expected string, but found ${typeof c} instead.`,h);if(/[^a-zA-Z0-9_]/.test(c))return i.error("Variable names must contain only alphanumeric characters or '_'.",h);const _=i.parse(e[h+1],h+1);if(!_)return null;r.push([c,_])}const u=i.parse(e[e.length-1],e.length-1,i.expectedType,r);return u?new ri(r,u):null}outputDefined(){return this.result.outputDefined()}}class fn{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const r=e[1];return i.scope.has(r)?new fn(r,i.scope.get(r)):i.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class zt{constructor(e,i,r){this.type=e,this.index=i,this.input=r}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=i.parse(e[1],1,Qe),u=i.parse(e[2],2,kn(i.expectedType||Pt));return r&&u?new zt(u.type.itemType,r,u):null}evaluate(e){const i=this.index.evaluate(e),r=this.input.evaluate(e);if(i<0)throw new Jt(`Array index out of bounds: ${i} < 0.`);if(i>=r.length)throw new Jt(`Array index out of bounds: ${i} > ${r.length-1}.`);if(i!==Math.floor(i))throw new Jt(`Array index must be an integer, but found ${i} instead.`);return r[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class St{constructor(e,i){this.type=xt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=i.parse(e[1],1,Pt),u=i.parse(e[2],2,Pt);return r&&u?Gr(r.type,[xt,Mt,Qe,Gn,Pt])?new St(r,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Kt(r.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!tr(i,["boolean","string","number","null"]))throw new Jt(`Expected first argument to be of type boolean, string, number or null, but found ${Kt(Rt(i))} instead.`);if(!tr(r,["string","array"]))throw new Jt(`Expected second argument to be of type array or string, but found ${Kt(Rt(r))} instead.`);return r.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Hr{constructor(e,i,r){this.type=Qe,this.needle=e,this.haystack=i,this.fromIndex=r}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const r=i.parse(e[1],1,Pt),u=i.parse(e[2],2,Pt);if(!r||!u)return null;if(!Gr(r.type,[xt,Mt,Qe,Gn,Pt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Kt(r.type)} instead`);if(e.length===4){const h=i.parse(e[3],3,Qe);return h?new Hr(r,u,h):null}return new Hr(r,u)}evaluate(e){const i=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!tr(i,["boolean","string","number","null"]))throw new Jt(`Expected first argument to be of type boolean, string, number or null, but found ${Kt(Rt(i))} instead.`);let u;if(this.fromIndex&&(u=this.fromIndex.evaluate(e)),tr(r,["string"])){const h=r.indexOf(i,u);return h===-1?-1:[...r.slice(0,h)].length}if(tr(r,["array"]))return r.indexOf(i,u);throw new Jt(`Expected second argument to be of type array or string, but found ${Kt(Rt(r))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class jt{constructor(e,i,r,u,h,c){this.inputType=e,this.type=i,this.input=r,this.cases=u,this.outputs=h,this.otherwise=c}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let r,u;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);const h={},c=[];for(let k=2;k<e.length-1;k+=2){let P=e[k];const E=e[k+1];Array.isArray(P)||(P=[P]);const D=i.concat(k);if(P.length===0)return D.error("Expected at least one branch label.");for(const O of P){if(typeof O!="number"&&typeof O!="string")return D.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return D.error("Numeric branch labels must be integer values.");if(r){if(D.checkSubtype(r,Rt(O)))return null}else r=Rt(O);if(h[String(O)]!==void 0)return D.error("Branch labels must be unique.");h[String(O)]=c.length}const A=i.parse(E,k,u);if(!A)return null;u=u||A.type,c.push(A)}const _=i.parse(e[1],1,Pt);if(!_)return null;const y=i.parse(e[e.length-1],e.length-1,u);return y?_.type.kind!=="value"&&i.concat(1).checkSubtype(r,_.type)?null:new jt(r,u,_,h,c,y):null}evaluate(e){const i=this.input.evaluate(e);return(Rt(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Mo{constructor(e,i,r){this.type=e,this.branches=i,this.otherwise=r}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let r;i.expectedType&&i.expectedType.kind!=="value"&&(r=i.expectedType);const u=[];for(let c=1;c<e.length-1;c+=2){const _=i.parse(e[c],c,xt);if(!_)return null;const y=i.parse(e[c+1],c+1,r);if(!y)return null;u.push([_,y]),r=r||y.type}const h=i.parse(e[e.length-1],e.length-1,r);if(!h)return null;if(!r)throw new Error("Can't infer output type");return new Mo(r,u,h)}evaluate(e){for(const[i,r]of this.branches)if(i.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,r]of this.branches)e(i),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((([e,i])=>i.outputDefined()))&&this.otherwise.outputDefined()}}class Zn{constructor(e,i,r,u){this.type=e,this.input=i,this.beginIndex=r,this.endIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const r=i.parse(e[1],1,Pt),u=i.parse(e[2],2,Qe);if(!r||!u)return null;if(!Gr(r.type,[kn(Pt),Mt,Pt]))return i.error(`Expected first argument to be of type array or string, but found ${Kt(r.type)} instead`);if(e.length===4){const h=i.parse(e[3],3,Qe);return h?new Zn(r.type,r,u,h):null}return new Zn(r.type,r,u)}evaluate(e){const i=this.input.evaluate(e),r=this.beginIndex.evaluate(e);let u;if(this.endIndex&&(u=this.endIndex.evaluate(e)),tr(i,["string"]))return[...i].slice(r,u).join("");if(tr(i,["array"]))return i.slice(r,u);throw new Jt(`Expected first argument to be of type array or string, but found ${Kt(Rt(i))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Wr(n,e){const i=n.length-1;let r,u,h=0,c=i,_=0;for(;h<=c;)if(_=Math.floor((h+c)/2),r=n[_],u=n[_+1],r<=e){if(_===i||e<u)return _;h=_+1}else{if(!(r>e))throw new Jt("Input is not a number.");c=_-1}return 0}class or{constructor(e,i,r){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[u,h]of r)this.labels.push(u),this.outputs.push(h)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const r=i.parse(e[1],1,Qe);if(!r)return null;const u=[];let h=null;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);for(let c=1;c<e.length;c+=2){const _=c===1?-1/0:e[c],y=e[c+1],k=c,P=c+1;if(typeof _!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(u.length&&u[u.length-1][0]>=_)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const E=i.parse(y,P,h);if(!E)return null;h=h||E.type,u.push([_,E])}return new or(h,r,u)}evaluate(e){const i=this.labels,r=this.outputs;if(i.length===1)return r[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return r[0].evaluate(e);const h=i.length;return u>=i[h-1]?r[h-1].evaluate(e):r[Wr(i,u)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function es(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Co,ta,iu=(function(){if(ta)return Co;function n(e,i,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(u-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=r,this.p2y=u}return ta=1,Co=n,n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,u=0;u<8;u++){var h=this.sampleCurveX(r)-e;if(Math.abs(h)<i)return r;var c=this.sampleCurveDerivativeX(r);if(Math.abs(c)<1e-6)break;r-=h/c}var _=0,y=1;for(r=e,u=0;u<20&&(h=this.sampleCurveX(r),!(Math.abs(h-e)<i));u++)e>h?_=r:y=r,r=.5*(y-_)+_;return r},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},Co})(),Ss=es(iu);class Ci{constructor(e,i,r,u,h){this.type=e,this.operator=i,this.interpolation=r,this.input=u,this.labels=[],this.outputs=[];for(const[c,_]of h)this.labels.push(c),this.outputs.push(_)}static interpolationFactor(e,i,r,u){let h=0;if(e.name==="exponential")h=ha(i,e.base,r,u);else if(e.name==="linear")h=ha(i,1,r,u);else if(e.name==="cubic-bezier"){const c=e.controlPoints;h=new Ss(c[0],c[1],c[2],c[3]).solve(ha(i,1,r,u))}return h}static parse(e,i){let[r,u,h,...c]=e;if(!Array.isArray(u)||u.length===0)return i.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const k=u[1];if(typeof k!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:k}}else{if(u[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const k=u.slice(1);if(k.length!==4||k.some((P=>typeof P!="number"||P<0||P>1)))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(h=i.parse(h,2,Qe),!h)return null;const _=[];let y=null;r!=="interpolate-hcl"&&r!=="interpolate-lab"||i.expectedType==Aa?i.expectedType&&i.expectedType.kind!=="value"&&(y=i.expectedType):y=An;for(let k=0;k<c.length;k+=2){const P=c[k],E=c[k+1],D=k+3,A=k+4;if(typeof P!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(_.length&&_[_.length-1][0]>=P)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const O=i.parse(E,A,y);if(!O)return null;y=y||O.type,_.push([P,O])}return Sn(y,Qe)||Sn(y,Wo)||Sn(y,An)||Sn(y,Ko)||Sn(y,bo)||Sn(y,Aa)||Sn(y,ko)||Sn(y,kn(Qe))?new Ci(y,r,u,h,_):i.error(`Type ${Kt(y)} is not interpolatable.`)}evaluate(e){const i=this.labels,r=this.outputs;if(i.length===1)return r[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return r[0].evaluate(e);const h=i.length;if(u>=i[h-1])return r[h-1].evaluate(e);const c=Wr(i,u),_=Ci.interpolationFactor(this.interpolation,u,i[c],i[c+1]),y=r[c].evaluate(e),k=r[c+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return la(y,k,_);case"color":return Lt.interpolate(y,k,_);case"padding":return mt.interpolate(y,k,_);case"colorArray":return rt.interpolate(y,k,_);case"numberArray":return qt.interpolate(y,k,_);case"variableAnchorOffsetCollection":return on.interpolate(y,k,_);case"array":return nr(y,k,_);case"projectionDefinition":return ji.interpolate(y,k,_)}case"interpolate-hcl":switch(this.type.kind){case"color":return Lt.interpolate(y,k,_,"hcl");case"colorArray":return rt.interpolate(y,k,_,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Lt.interpolate(y,k,_,"lab");case"colorArray":return rt.interpolate(y,k,_,"lab")}}}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function ha(n,e,i,r){const u=r-i,h=n-i;return u===0?0:e===1?h/u:(Math.pow(e,h)-1)/(Math.pow(e,u)-1)}const si={color:Lt.interpolate,number:la,padding:mt.interpolate,numberArray:qt.interpolate,colorArray:rt.interpolate,variableAnchorOffsetCollection:on.interpolate,array:nr};class Fa{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let r=null;const u=i.expectedType;u&&u.kind!=="value"&&(r=u);const h=[];for(const _ of e.slice(1)){const y=i.parse(_,1+h.length,r,void 0,{typeAnnotation:"omit"});if(!y)return null;r=r||y.type,h.push(y)}if(!r)throw new Error("No output type");const c=u&&h.some((_=>va(u,_.type)));return new Fa(c?Pt:r,h)}evaluate(e){let i,r=null,u=0;for(const h of this.args)if(u++,r=h.evaluate(e),r&&r instanceof Pn&&!r.available&&(i||(i=r.name),r=null,u===this.args.length&&(r=i)),r!==null)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Ts(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Kr(n,e,i,r){return r.compare(e,i)===0}function pi(n,e,i){const r=n!=="=="&&n!=="!=";return class pm{constructor(h,c,_){this.type=xt,this.lhs=h,this.rhs=c,this.collator=_,this.hasUntypedArgument=h.type.kind==="value"||c.type.kind==="value"}static parse(h,c){if(h.length!==3&&h.length!==4)return c.error("Expected two or three arguments.");const _=h[0];let y=c.parse(h[1],1,Pt);if(!y)return null;if(!Ts(_,y.type))return c.concat(1).error(`"${_}" comparisons are not supported for type '${Kt(y.type)}'.`);let k=c.parse(h[2],2,Pt);if(!k)return null;if(!Ts(_,k.type))return c.concat(2).error(`"${_}" comparisons are not supported for type '${Kt(k.type)}'.`);if(y.type.kind!==k.type.kind&&y.type.kind!=="value"&&k.type.kind!=="value")return c.error(`Cannot compare types '${Kt(y.type)}' and '${Kt(k.type)}'.`);r&&(y.type.kind==="value"&&k.type.kind!=="value"?y=new jn(k.type,[y]):y.type.kind!=="value"&&k.type.kind==="value"&&(k=new jn(y.type,[k])));let P=null;if(h.length===4){if(y.type.kind!=="string"&&k.type.kind!=="string"&&y.type.kind!=="value"&&k.type.kind!=="value")return c.error("Cannot use collator to compare non-string types.");if(P=c.parse(h[3],3,wo),!P)return null}return new pm(y,k,P)}evaluate(h){const c=this.lhs.evaluate(h),_=this.rhs.evaluate(h);if(r&&this.hasUntypedArgument){const y=Rt(c),k=Rt(_);if(y.kind!==k.kind||y.kind!=="string"&&y.kind!=="number")throw new Jt(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${y.kind}, ${k.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const y=Rt(c),k=Rt(_);if(y.kind!=="string"||k.kind!=="string")return e(h,c,_)}return this.collator?i(h,c,_,this.collator.evaluate(h)):e(h,c,_)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}}}const al=pi("==",(function(n,e,i){return e===i}),Kr),Ps=pi("!=",(function(n,e,i){return e!==i}),(function(n,e,i,r){return!Kr(0,e,i,r)})),ts=pi("<",(function(n,e,i){return e<i}),(function(n,e,i,r){return r.compare(e,i)<0})),nu=pi(">",(function(n,e,i){return e>i}),(function(n,e,i,r){return r.compare(e,i)>0})),kr=pi("<=",(function(n,e,i){return e<=i}),(function(n,e,i,r){return r.compare(e,i)<=0})),Eo=pi(">=",(function(n,e,i){return e>=i}),(function(n,e,i,r){return r.compare(e,i)>=0}));class Ba{constructor(e,i,r){this.type=wo,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const r=e[1];if(typeof r!="object"||Array.isArray(r))return i.error("Collator options argument must be an object.");const u=i.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,xt);if(!u)return null;const h=i.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,xt);if(!h)return null;let c=null;return r.locale&&(c=i.parse(r.locale,1,Mt),!c)?null:new Ba(u,h,c)}evaluate(e){return new Zr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Oa{constructor(e,i,r,u,h){this.type=Mt,this.number=e,this.locale=i,this.currency=r,this.minFractionDigits=u,this.maxFractionDigits=h}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const r=i.parse(e[1],1,Qe);if(!r)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let h=null;if(u.locale&&(h=i.parse(u.locale,1,Mt),!h))return null;let c=null;if(u.currency&&(c=i.parse(u.currency,1,Mt),!c))return null;let _=null;if(u["min-fraction-digits"]&&(_=i.parse(u["min-fraction-digits"],1,Qe),!_))return null;let y=null;return u["max-fraction-digits"]&&(y=i.parse(u["max-fraction-digits"],1,Qe),!y)?null:new Oa(r,h,c,_,y)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class zo{constructor(e){this.type=Vr,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&typeof r=="object")return i.error("First argument must be an image or text section.");const u=[];let h=!1;for(let c=1;c<=e.length-1;++c){const _=e[c];if(h&&typeof _=="object"&&!Array.isArray(_)){h=!1;let y=null;if(_["font-scale"]&&(y=i.parse(_["font-scale"],1,Qe),!y))return null;let k=null;if(_["text-font"]&&(k=i.parse(_["text-font"],1,kn(Mt)),!k))return null;let P=null;if(_["text-color"]&&(P=i.parse(_["text-color"],1,An),!P))return null;let E=null;if(_["vertical-align"]){if(typeof _["vertical-align"]=="string"&&!il.includes(_["vertical-align"]))return i.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${_["vertical-align"]}' instead.`);if(E=i.parse(_["vertical-align"],1,Mt),!E)return null}const D=u[u.length-1];D.scale=y,D.font=k,D.textColor=P,D.verticalAlign=E}else{const y=i.parse(e[c],1,Pt);if(!y)return null;const k=y.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,u.push({content:y,scale:null,font:null,textColor:null,verticalAlign:null})}}return new zo(u)}evaluate(e){return new Rn(this.sections.map((i=>{const r=i.content.evaluate(e);return Rt(r)===Nr?new Po("",r,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(e):null):new Po(qn(r),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null,i.verticalAlign?i.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor),i.verticalAlign&&e(i.verticalAlign)}outputDefined(){return!1}}class ba{constructor(e){this.type=Nr,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const r=i.parse(e[1],1,Mt);return r?new ba(r):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),r=Pn.fromString(i);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(i)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class sn{constructor(e){this.type=Qe,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=i.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Kt(r.type)} instead.`):new sn(r):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new Jt(`Expected value to be of type string or array, but found ${Kt(Rt(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Fi=8192;function Ls(n,e){const i=(180+n[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*Fi),Math.round(r*u*Fi)]}function Xr(n,e){const i=Math.pow(2,e.z);return[(u=(n[0]/Fi+e.x)/i,360*u-180),(r=(n[1]/Fi+e.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90)];var r,u}function Sr(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function $a(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function au(n,e,i){const r=n[0]-e[0],u=n[1]-e[1],h=n[0]-i[0],c=n[1]-i[1];return r*c-h*u==0&&r*h<=0&&u*c<=0}function is(n,e,i,r){return(u=[r[0]-i[0],r[1]-i[1]])[0]*(h=[e[0]-n[0],e[1]-n[1]])[1]-u[1]*h[0]!=0&&!(!ca(n,e,i,r)||!ca(i,r,n,e));var u,h}function rl(n,e,i){for(const r of i)for(let u=0;u<r.length-1;++u)if(is(n,e,r[u],r[u+1]))return!0;return!1}function Yr(n,e,i=!1){let r=!1;for(const _ of e)for(let y=0;y<_.length-1;y++){if(au(n,_[y],_[y+1]))return i;(h=_[y])[1]>(u=n)[1]!=(c=_[y+1])[1]>u[1]&&u[0]<(c[0]-h[0])*(u[1]-h[1])/(c[1]-h[1])+h[0]&&(r=!r)}var u,h,c;return r}function Fn(n,e){for(const i of e)if(Yr(n,i))return!0;return!1}function Tr(n,e){for(const i of n)if(!Yr(i,e))return!1;for(let i=0;i<n.length-1;++i)if(rl(n[i],n[i+1],e))return!1;return!0}function ol(n,e){for(const i of e)if(Tr(n,i))return!0;return!1}function ca(n,e,i,r){const u=r[0]-i[0],h=r[1]-i[1],c=(n[0]-i[0])*h-u*(n[1]-i[1]),_=(e[0]-i[0])*h-u*(e[1]-i[1]);return c>0&&_<0||c<0&&_>0}function Ms(n,e,i){const r=[];for(let u=0;u<n.length;u++){const h=[];for(let c=0;c<n[u].length;c++){const _=Ls(n[u][c],i);Sr(e,_),h.push(_)}r.push(h)}return r}function sr(n,e,i){const r=[];for(let u=0;u<n.length;u++){const h=Ms(n[u],e,i);r.push(h)}return r}function sl(n,e,i,r){if(n[0]<i[0]||n[0]>i[2]){const u=.5*r;let h=n[0]-i[0]>u?-r:i[0]-n[0]>u?r:0;h===0&&(h=n[0]-i[2]>u?-r:i[2]-n[0]>u?r:0),n[0]+=h}Sr(e,n)}function Jr(n,e,i,r){const u=Math.pow(2,r.z)*Fi,h=[r.x*Fi,r.y*Fi],c=[];for(const _ of n)for(const y of _){const k=[y.x+h[0],y.y+h[1]];sl(k,e,i,u),c.push(k)}return c}function Cs(n,e,i,r){const u=Math.pow(2,r.z)*Fi,h=[r.x*Fi,r.y*Fi],c=[];for(const y of n){const k=[];for(const P of y){const E=[P.x+h[0],P.y+h[1]];Sr(e,E),k.push(E)}c.push(k)}if(e[2]-e[0]<=u/2){(_=e)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(const y of c)for(const k of y)sl(k,e,i,u)}var _;return c}class ka{constructor(e,i){this.type=xt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ea(e[1])){const r=e[1];if(r.type==="FeatureCollection"){const u=[];for(const h of r.features){const{type:c,coordinates:_}=h.geometry;c==="Polygon"&&u.push(_),c==="MultiPolygon"&&u.push(..._)}if(u.length)return new ka(r,{type:"MultiPolygon",coordinates:u})}else if(r.type==="Feature"){const u=r.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new ka(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new ka(r,r)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,r){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],c=i.canonicalID();if(r.type==="Polygon"){const _=Ms(r.coordinates,h,c),y=Jr(i.geometry(),u,h,c);if(!$a(u,h))return!1;for(const k of y)if(!Yr(k,_))return!1}if(r.type==="MultiPolygon"){const _=sr(r.coordinates,h,c),y=Jr(i.geometry(),u,h,c);if(!$a(u,h))return!1;for(const k of y)if(!Fn(k,_))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,r){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],c=i.canonicalID();if(r.type==="Polygon"){const _=Ms(r.coordinates,h,c),y=Cs(i.geometry(),u,h,c);if(!$a(u,h))return!1;for(const k of y)if(!Tr(k,_))return!1}if(r.type==="MultiPolygon"){const _=sr(r.coordinates,h,c),y=Cs(i.geometry(),u,h,c);if(!$a(u,h))return!1;for(const k of y)if(!ol(k,_))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let ll=class{constructor(n=[],e=(i,r)=>i<r?-1:i>r?1:0){if(this.data=n,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:e,compare:i}=this,r=e[n];for(;n>0;){const u=n-1>>1,h=e[u];if(i(r,h)>=0)break;e[n]=h,n=u}e[n]=r}_down(n){const{data:e,compare:i}=this,r=this.length>>1,u=e[n];for(;n<r;){let h=1+(n<<1);const c=h+1;if(c<this.length&&i(e[c],e[h])<0&&(h=c),i(e[h],u)>=0)break;e[n]=e[h],n=h}e[n]=u}};function Sa(n,e,i=0,r=n.length-1,u=ul){for(;r>i;){if(r-i>600){const y=r-i+1,k=e-i+1,P=Math.log(y),E=.5*Math.exp(2*P/3),D=.5*Math.sqrt(P*E*(y-E)/y)*(k-y/2<0?-1:1);Sa(n,e,Math.max(i,Math.floor(e-k*E/y+D)),Math.min(r,Math.floor(e+(y-k)*E/y+D)),u)}const h=n[e];let c=i,_=r;for(Va(n,i,e),u(n[r],h)>0&&Va(n,i,r);c<_;){for(Va(n,c,_),c++,_--;u(n[c],h)<0;)c++;for(;u(n[_],h)>0;)_--}u(n[i],h)===0?Va(n,i,_):(_++,Va(n,_,r)),_<=e&&(i=_+1),e<=_&&(r=_-1)}}function Va(n,e,i){const r=n[e];n[e]=n[i],n[i]=r}function ul(n,e){return n<e?-1:n>e?1:0}function Qr(n,e){if(n.length<=1)return[n];const i=[];let r,u;for(const h of n){const c=Na(h);c!==0&&(h.area=Math.abs(c),u===void 0&&(u=c<0),u===c<0?(r&&i.push(r),r=[h]):r.push(h))}if(r&&i.push(r),e>1)for(let h=0;h<i.length;h++)i[h].length<=e||(Sa(i[h],e,1,i[h].length-1,ru),i[h]=i[h].slice(0,e));return i}function ru(n,e){return e.area-n.area}function Na(n){let e=0;for(let i,r,u=0,h=n.length,c=h-1;u<h;c=u++)i=n[u],r=n[c],e+=(r.x-i.x)*(i.y+r.y);return e}const dl=1/298.257223563,Ta=dl*(2-dl),hl=Math.PI/180;class fa{constructor(e){const i=6378.137*hl*1e3,r=Math.cos(e*hl),u=1/(1-Ta*(1-r*r)),h=Math.sqrt(u);this.kx=i*h*r,this.ky=i*h*u*(1-Ta)}distance(e,i){const r=this.wrap(e[0]-i[0])*this.kx,u=(e[1]-i[1])*this.ky;return Math.sqrt(r*r+u*u)}pointOnLine(e,i){let r,u,h,c,_=1/0;for(let y=0;y<e.length-1;y++){let k=e[y][0],P=e[y][1],E=this.wrap(e[y+1][0]-k)*this.kx,D=(e[y+1][1]-P)*this.ky,A=0;E===0&&D===0||(A=(this.wrap(i[0]-k)*this.kx*E+(i[1]-P)*this.ky*D)/(E*E+D*D),A>1?(k=e[y+1][0],P=e[y+1][1]):A>0&&(k+=E/this.kx*A,P+=D/this.ky*A)),E=this.wrap(i[0]-k)*this.kx,D=(i[1]-P)*this.ky;const O=E*E+D*D;O<_&&(_=O,r=k,u=P,h=y,c=A)}return{point:[r,u],index:h,t:Math.max(0,Math.min(1,c))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function Io(n,e){return e[0]-n[0]}function Do(n){return n[1]-n[0]+1}function Hn(n,e){return n[1]>=n[0]&&n[1]<e}function Pr(n,e){if(n[0]>n[1])return[null,null];const i=Do(n);if(e){if(i===2)return[n,null];const u=Math.floor(i/2);return[[n[0],n[0]+u],[n[0]+u,n[1]]]}if(i===1)return[n,null];const r=Math.floor(i/2)-1;return[[n[0],n[0]+r],[n[0]+r+1,n[1]]]}function Ao(n,e){if(!Hn(e,n.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let r=e[0];r<=e[1];++r)Sr(i,n[r]);return i}function eo(n){const e=[1/0,1/0,-1/0,-1/0];for(const i of n)for(const r of i)Sr(e,r);return e}function lr(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function Lr(n,e,i){if(!lr(n)||!lr(e))return NaN;let r=0,u=0;return n[2]<e[0]&&(r=e[0]-n[2]),n[0]>e[2]&&(r=n[0]-e[2]),n[1]>e[3]&&(u=n[1]-e[3]),n[3]<e[1]&&(u=e[1]-n[3]),i.distance([0,0],[r,u])}function Ua(n,e,i){const r=i.pointOnLine(e,n);return i.distance(n,r.point)}function ns(n,e,i,r,u){const h=Math.min(Ua(n,[i,r],u),Ua(e,[i,r],u)),c=Math.min(Ua(i,[n,e],u),Ua(r,[n,e],u));return Math.min(h,c)}function ou(n,e,i,r,u){if(!Hn(e,n.length)||!Hn(r,i.length))return 1/0;let h=1/0;for(let c=e[0];c<e[1];++c){const _=n[c],y=n[c+1];for(let k=r[0];k<r[1];++k){const P=i[k],E=i[k+1];if(is(_,y,P,E))return 0;h=Math.min(h,ns(_,y,P,E,u))}}return h}function Ro(n,e,i,r,u){if(!Hn(e,n.length)||!Hn(r,i.length))return NaN;let h=1/0;for(let c=e[0];c<=e[1];++c)for(let _=r[0];_<=r[1];++_)if(h=Math.min(h,u.distance(n[c],i[_])),h===0)return h;return h}function su(n,e,i){if(Yr(n,e,!0))return 0;let r=1/0;for(const u of e){const h=u[0],c=u[u.length-1];if(h!==c&&(r=Math.min(r,Ua(n,[c,h],i)),r===0))return r;const _=i.pointOnLine(u,n);if(r=Math.min(r,i.distance(n,_.point)),r===0)return r}return r}function cl(n,e,i,r){if(!Hn(e,n.length))return NaN;for(let h=e[0];h<=e[1];++h)if(Yr(n[h],i,!0))return 0;let u=1/0;for(let h=e[0];h<e[1];++h){const c=n[h],_=n[h+1];for(const y of i)for(let k=0,P=y.length,E=P-1;k<P;E=k++){const D=y[E],A=y[k];if(is(c,_,D,A))return 0;u=Math.min(u,ns(c,_,D,A,r))}}return u}function fl(n,e){for(const i of n)for(const r of i)if(Yr(r,e,!0))return!0;return!1}function ml(n,e,i,r=1/0){const u=eo(n),h=eo(e);if(r!==1/0&&Lr(u,h,i)>=r)return r;if($a(u,h)){if(fl(n,e))return 0}else if(fl(e,n))return 0;let c=1/0;for(const _ of n)for(let y=0,k=_.length,P=k-1;y<k;P=y++){const E=_[P],D=_[y];for(const A of e)for(let O=0,$=A.length,N=$-1;O<$;N=O++){const H=A[N],ne=A[O];if(is(E,D,H,ne))return 0;c=Math.min(c,ns(E,D,H,ne,i))}}return c}function Zt(n,e,i,r,u,h){if(!h)return;const c=Lr(Ao(r,h),u,i);c<e&&n.push([c,h,[0,0]])}function Wn(n,e,i,r,u,h,c){if(!h||!c)return;const _=Lr(Ao(r,h),Ao(u,c),i);_<e&&n.push([_,h,c])}function Mr(n,e,i,r,u=1/0){let h=Math.min(r.distance(n[0],i[0][0]),u);if(h===0)return h;const c=new ll([[0,[0,n.length-1],[0,0]]],Io),_=eo(i);for(;c.length>0;){const y=c.pop();if(y[0]>=h)continue;const k=y[1],P=e?50:100;if(Do(k)<=P){if(!Hn(k,n.length))return NaN;if(e){const E=cl(n,k,i,r);if(isNaN(E)||E===0)return E;h=Math.min(h,E)}else for(let E=k[0];E<=k[1];++E){const D=su(n[E],i,r);if(h=Math.min(h,D),h===0)return 0}}else{const E=Pr(k,e);Zt(c,h,r,n,_,E[0]),Zt(c,h,r,n,_,E[1])}}return h}function as(n,e,i,r,u,h=1/0){let c=Math.min(h,u.distance(n[0],i[0]));if(c===0)return c;const _=new ll([[0,[0,n.length-1],[0,i.length-1]]],Io);for(;_.length>0;){const y=_.pop();if(y[0]>=c)continue;const k=y[1],P=y[2],E=e?50:100,D=r?50:100;if(Do(k)<=E&&Do(P)<=D){if(!Hn(k,n.length)&&Hn(P,i.length))return NaN;let A;if(e&&r)A=ou(n,k,i,P,u),c=Math.min(c,A);else if(e&&!r){const O=n.slice(k[0],k[1]+1);for(let $=P[0];$<=P[1];++$)if(A=Ua(i[$],O,u),c=Math.min(c,A),c===0)return c}else if(!e&&r){const O=i.slice(P[0],P[1]+1);for(let $=k[0];$<=k[1];++$)if(A=Ua(n[$],O,u),c=Math.min(c,A),c===0)return c}else A=Ro(n,k,i,P,u),c=Math.min(c,A)}else{const A=Pr(k,e),O=Pr(P,r);Wn(_,c,u,n,i,A[0],O[0]),Wn(_,c,u,n,i,A[0],O[1]),Wn(_,c,u,n,i,A[1],O[0]),Wn(_,c,u,n,i,A[1],O[1])}}return c}function to(n){return n.type==="MultiPolygon"?n.coordinates.map((e=>({type:"Polygon",coordinates:e}))):n.type==="MultiLineString"?n.coordinates.map((e=>({type:"LineString",coordinates:e}))):n.type==="MultiPoint"?n.coordinates.map((e=>({type:"Point",coordinates:e}))):[n]}class Cr{constructor(e,i){this.type=Qe,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ea(e[1])){const r=e[1];if(r.type==="FeatureCollection")return new Cr(r,r.features.map((u=>to(u.geometry))).flat());if(r.type==="Feature")return new Cr(r,to(r.geometry));if("type"in r&&"coordinates"in r)return new Cr(r,to(r))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,r){const u=i.geometry(),h=u.flat().map((y=>Xr([y.x,y.y],i.canonical)));if(u.length===0)return NaN;const c=new fa(h[0][1]);let _=1/0;for(const y of r){switch(y.type){case"Point":_=Math.min(_,as(h,!1,[y.coordinates],!1,c,_));break;case"LineString":_=Math.min(_,as(h,!1,y.coordinates,!0,c,_));break;case"Polygon":_=Math.min(_,Mr(h,!1,y.coordinates,c,_))}if(_===0)return _}return _})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,r){const u=i.geometry(),h=u.flat().map((y=>Xr([y.x,y.y],i.canonical)));if(u.length===0)return NaN;const c=new fa(h[0][1]);let _=1/0;for(const y of r){switch(y.type){case"Point":_=Math.min(_,as(h,!0,[y.coordinates],!1,c,_));break;case"LineString":_=Math.min(_,as(h,!0,y.coordinates,!0,c,_));break;case"Polygon":_=Math.min(_,Mr(h,!0,y.coordinates,c,_))}if(_===0)return _}return _})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(i,r){const u=i.geometry();if(u.length===0||u[0].length===0)return NaN;const h=Qr(u,0).map((y=>y.map((k=>k.map((P=>Xr([P.x,P.y],i.canonical))))))),c=new fa(h[0][0][0][1]);let _=1/0;for(const y of r)for(const k of h){switch(y.type){case"Point":_=Math.min(_,Mr([y.coordinates],!1,k,c,_));break;case"LineString":_=Math.min(_,Mr(y.coordinates,!0,k,c,_));break;case"Polygon":_=Math.min(_,ml(k,y.coordinates,c,_))}if(_===0)return _}return _})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class io{constructor(e){this.type=Pt,this.key=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=e[1];return r==null?i.error("Global state property must be defined."):typeof r!="string"?i.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new io(r)}evaluate(e){var i;const r=(i=e.globals)===null||i===void 0?void 0:i.globalState;return r&&Object.keys(r).length!==0?ja(r,this.key):null}eachChild(){}outputDefined(){return!1}}const no={"==":al,"!=":Ps,">":nu,"<":ts,">=":Eo,"<=":kr,array:jn,at:zt,boolean:jn,case:Mo,coalesce:Fa,collator:Ba,format:zo,image:ba,in:St,"index-of":Hr,interpolate:Ci,"interpolate-hcl":Ci,"interpolate-lab":Ci,length:sn,let:ri,literal:ua,match:jt,number:jn,"number-format":Oa,object:jn,slice:Zn,step:or,string:jn,"to-boolean":da,"to-color":da,"to-number":da,"to-string":da,var:fn,within:ka,distance:Cr,"global-state":io};class mn{constructor(e,i,r,u){this.name=e,this.type=i,this._evaluate=r,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,i){const r=e[0],u=mn.definitions[r];if(!u)return i.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(u)?u[0]:u.type,c=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,_=c.filter((([k])=>!Array.isArray(k)||k.length===e.length-1));let y=null;for(const[k,P]of _){y=new It(i.registry,os,i.path,null,i.scope);const E=[];let D=!1;for(let A=1;A<e.length;A++){const O=e[A],$=Array.isArray(k)?k[A-1]:k.type,N=y.parse(O,1+E.length,$);if(!N){D=!0;break}E.push(N)}if(!D)if(Array.isArray(k)&&k.length!==E.length)y.error(`Expected ${k.length} arguments, but found ${E.length} instead.`);else{for(let A=0;A<E.length;A++){const O=Array.isArray(k)?k[A]:k.type,$=E[A];y.concat(A+1).checkSubtype(O,$.type)}if(y.errors.length===0)return new mn(r,h,P,E)}}if(_.length===1)i.errors.push(...y.errors);else{const k=(_.length?_:c).map((([E])=>{return D=E,Array.isArray(D)?`(${D.map(Kt).join(", ")})`:`(${Kt(D.type)}...)`;var D})).join(" | "),P=[];for(let E=1;E<e.length;E++){const D=i.parse(e[E],1+P.length);if(!D)return null;P.push(Kt(D.type))}i.error(`Expected arguments of type ${k}, but found (${P.join(", ")}) instead.`)}return null}static register(e,i){mn.definitions=i;for(const r in i)e[r]=mn}}function pl(n,[e,i,r,u]){e=e.evaluate(n),i=i.evaluate(n),r=r.evaluate(n);const h=u?u.evaluate(n):1,c=ar(e,i,r,h);if(c)throw new Jt(c);return new Lt(e/255,i/255,r/255,h,!1)}function Er(n,e){return n in e}function rs(n,e){const i=e[n];return i===void 0?null:i}function ur(n){return{type:n}}function os(n){if(n instanceof fn)return os(n.boundExpression);if(n instanceof mn&&n.name==="error"||n instanceof Ba||n instanceof ka||n instanceof Cr||n instanceof io)return!1;const e=n instanceof da||n instanceof jn;let i=!0;return n.eachChild((r=>{i=e?i&&os(r):i&&r instanceof ua})),!!i&&ia(n)&&jo(n,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function ia(n){if(n instanceof mn&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof ka||n instanceof Cr)return!1;let e=!0;return n.eachChild((i=>{e&&!ia(i)&&(e=!1)})),e}function ao(n){if(n instanceof mn&&n.name==="feature-state")return!1;let e=!0;return n.eachChild((i=>{e&&!ao(i)&&(e=!1)})),e}function jo(n,e){if(n instanceof mn&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild((r=>{i&&!jo(r,e)&&(i=!1)})),i}function ro(n){return{result:"success",value:n}}function oo(n){return{result:"error",value:n}}function Ga(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function so(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function ss(n){return!!n.expression&&n.expression.interpolated}function Et(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function ls(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&Rt(n)===Da}function _l(n){return n}function Es(n,e){const i=n.stops&&typeof n.stops[0][0]=="object",r=i||!(i||n.property!==void 0),u=n.type||(ss(e)?"exponential":"interval"),h=(function(P){switch(P.type){case"color":return Lt.parse;case"padding":return mt.parse;case"numberArray":return qt.parse;case"colorArray":return rt.parse;default:return null}})(e);if(h&&((n=hn({},n)).stops&&(n.stops=n.stops.map((P=>[P[0],h(P[1])]))),n.default=h(n.default?n.default:e.default)),n.colorSpace&&(c=n.colorSpace)!=="rgb"&&c!=="hcl"&&c!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var c;const _=(function(P){switch(P){case"exponential":return vl;case"interval":return yl;case"categorical":return gl;case"identity":return xl;default:throw new Error(`Unknown function type "${P}"`)}})(u);let y,k;if(u==="categorical"){y=Object.create(null);for(const P of n.stops)y[P[0]]=P[1];k=typeof n.stops[0][0]}if(i){const P={},E=[];for(let O=0;O<n.stops.length;O++){const $=n.stops[O],N=$[0].zoom;P[N]===void 0&&(P[N]={zoom:N,type:n.type,property:n.property,default:n.default,stops:[]},E.push(N)),P[N].stops.push([$[0].value,$[1]])}const D=[];for(const O of E)D.push([P[O].zoom,Es(P[O],e)]);const A={name:"linear"};return{kind:"composite",interpolationType:A,interpolationFactor:Ci.interpolationFactor.bind(void 0,A),zoomStops:D.map((O=>O[0])),evaluate:({zoom:O},$)=>vl({stops:D,base:n.base},e,O).evaluate(O,$)}}if(r){const P=u==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Ci.interpolationFactor.bind(void 0,P),zoomStops:n.stops.map((E=>E[0])),evaluate:({zoom:E})=>_(n,e,E,y,k)}}return{kind:"source",evaluate(P,E){const D=E&&E.properties?E.properties[n.property]:void 0;return D===void 0?lo(n.default,e.default):_(n,e,D,y,k)}}}function lo(n,e,i){return n!==void 0?n:e!==void 0?e:i!==void 0?i:void 0}function gl(n,e,i,r,u){return lo(typeof i===u?r[i]:void 0,n.default,e.default)}function yl(n,e,i){if(Et(i)!=="number")return lo(n.default,e.default);const r=n.stops.length;if(r===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[r-1][0])return n.stops[r-1][1];const u=Wr(n.stops.map((h=>h[0])),i);return n.stops[u][1]}function vl(n,e,i){const r=n.base!==void 0?n.base:1;if(Et(i)!=="number")return lo(n.default,e.default);const u=n.stops.length;if(u===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[u-1][0])return n.stops[u-1][1];const h=Wr(n.stops.map((P=>P[0])),i),c=(function(P,E,D,A){const O=A-D,$=P-D;return O===0?0:E===1?$/O:(Math.pow(E,$)-1)/(Math.pow(E,O)-1)})(i,r,n.stops[h][0],n.stops[h+1][0]),_=n.stops[h][1],y=n.stops[h+1][1],k=si[e.type]||_l;return typeof _.evaluate=="function"?{evaluate(...P){const E=_.evaluate.apply(void 0,P),D=y.evaluate.apply(void 0,P);if(E!==void 0&&D!==void 0)return k(E,D,c,n.colorSpace)}}:k(_,y,c,n.colorSpace)}function xl(n,e,i){switch(e.type){case"color":i=Lt.parse(i);break;case"formatted":i=Rn.fromString(i.toString());break;case"resolvedImage":i=Pn.fromString(i.toString());break;case"padding":i=mt.parse(i);break;case"colorArray":i=rt.parse(i);break;case"numberArray":i=qt.parse(i);break;default:Et(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0)}return lo(i,n.default,e.default)}mn.register(no,{error:[{kind:"error"},[Mt],(n,[e])=>{throw new Jt(e.evaluate(n))}],typeof:[Mt,[Pt],(n,[e])=>Kt(Rt(e.evaluate(n)))],"to-rgba":[kn(Qe,4),[An],(n,[e])=>{const[i,r,u,h]=e.evaluate(n).rgb;return[255*i,255*r,255*u,h]}],rgb:[An,[Qe,Qe,Qe],pl],rgba:[An,[Qe,Qe,Qe,Qe],pl],has:{type:xt,overloads:[[[Mt],(n,[e])=>Er(e.evaluate(n),n.properties())],[[Mt,Da],(n,[e,i])=>Er(e.evaluate(n),i.evaluate(n))]]},get:{type:Pt,overloads:[[[Mt],(n,[e])=>rs(e.evaluate(n),n.properties())],[[Mt,Da],(n,[e,i])=>rs(e.evaluate(n),i.evaluate(n))]]},"feature-state":[Pt,[Mt],(n,[e])=>rs(e.evaluate(n),n.featureState||{})],properties:[Da,[],n=>n.properties()],"geometry-type":[Mt,[],n=>n.geometryType()],id:[Pt,[],n=>n.id()],zoom:[Qe,[],n=>n.globals.zoom],"heatmap-density":[Qe,[],n=>n.globals.heatmapDensity||0],elevation:[Qe,[],n=>n.globals.elevation||0],"line-progress":[Qe,[],n=>n.globals.lineProgress||0],accumulated:[Pt,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[Qe,ur(Qe),(n,e)=>{let i=0;for(const r of e)i+=r.evaluate(n);return i}],"*":[Qe,ur(Qe),(n,e)=>{let i=1;for(const r of e)i*=r.evaluate(n);return i}],"-":{type:Qe,overloads:[[[Qe,Qe],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[Qe],(n,[e])=>-e.evaluate(n)]]},"/":[Qe,[Qe,Qe],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[Qe,[Qe,Qe],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[Qe,[],()=>Math.LN2],pi:[Qe,[],()=>Math.PI],e:[Qe,[],()=>Math.E],"^":[Qe,[Qe,Qe],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[Qe,[Qe],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Qe,[Qe],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Qe,[Qe],(n,[e])=>Math.log(e.evaluate(n))],log2:[Qe,[Qe],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Qe,[Qe],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Qe,[Qe],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Qe,[Qe],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Qe,[Qe],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Qe,[Qe],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Qe,[Qe],(n,[e])=>Math.atan(e.evaluate(n))],min:[Qe,ur(Qe),(n,e)=>Math.min(...e.map((i=>i.evaluate(n))))],max:[Qe,ur(Qe),(n,e)=>Math.max(...e.map((i=>i.evaluate(n))))],abs:[Qe,[Qe],(n,[e])=>Math.abs(e.evaluate(n))],round:[Qe,[Qe],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Qe,[Qe],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Qe,[Qe],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[xt,[Mt,Pt],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[xt,[Pt],(n,[e])=>n.id()===e.value],"filter-type-==":[xt,[Mt],(n,[e])=>n.geometryType()===e.value],"filter-<":[xt,[Mt,Pt],(n,[e,i])=>{const r=n.properties()[e.value],u=i.value;return typeof r==typeof u&&r<u}],"filter-id-<":[xt,[Pt],(n,[e])=>{const i=n.id(),r=e.value;return typeof i==typeof r&&i<r}],"filter->":[xt,[Mt,Pt],(n,[e,i])=>{const r=n.properties()[e.value],u=i.value;return typeof r==typeof u&&r>u}],"filter-id->":[xt,[Pt],(n,[e])=>{const i=n.id(),r=e.value;return typeof i==typeof r&&i>r}],"filter-<=":[xt,[Mt,Pt],(n,[e,i])=>{const r=n.properties()[e.value],u=i.value;return typeof r==typeof u&&r<=u}],"filter-id-<=":[xt,[Pt],(n,[e])=>{const i=n.id(),r=e.value;return typeof i==typeof r&&i<=r}],"filter->=":[xt,[Mt,Pt],(n,[e,i])=>{const r=n.properties()[e.value],u=i.value;return typeof r==typeof u&&r>=u}],"filter-id->=":[xt,[Pt],(n,[e])=>{const i=n.id(),r=e.value;return typeof i==typeof r&&i>=r}],"filter-has":[xt,[Pt],(n,[e])=>e.value in n.properties()],"filter-has-id":[xt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[xt,[kn(Mt)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[xt,[kn(Pt)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[xt,[Mt,kn(Pt)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[xt,[Mt,kn(Pt)],(n,[e,i])=>(function(r,u,h,c){for(;h<=c;){const _=h+c>>1;if(u[_]===r)return!0;u[_]>r?c=_-1:h=_+1}return!1})(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:xt,overloads:[[[xt,xt],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[ur(xt),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:xt,overloads:[[[xt,xt],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[ur(xt),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[xt,[xt],(n,[e])=>!e.evaluate(n)],"is-supported-script":[xt,[Mt],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[Mt,[Mt],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Mt,[Mt],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Mt,ur(Pt),(n,e)=>e.map((i=>qn(i.evaluate(n)))).join("")],"resolved-locale":[Mt,[wo],(n,[e])=>e.evaluate(n).resolvedLocale()]});class us{constructor(e,i,r){this.expression=e,this._warningHistory={},this._evaluator=new Qo,this._defaultValue=i?(function(u){if(u.type==="color"&&ls(u.default))return new Lt(0,0,0,0);switch(u.type){case"color":return Lt.parse(u.default)||null;case"padding":return mt.parse(u.default)||null;case"numberArray":return qt.parse(u.default)||null;case"colorArray":return rt.parse(u.default)||null;case"variableAnchorOffsetCollection":return on.parse(u.default)||null;case"projectionDefinition":return ji.parse(u.default)||null;default:return u.default===void 0?null:u.default}})(i):null,this._enumValues=i&&i.type==="enum"?i.values:null,this._globalState=r}evaluateWithoutErrorHandling(e,i,r,u,h,c){return this._globalState&&(e=be(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=c,this.expression.evaluate(this._evaluator)}evaluate(e,i,r,u,h,c){this._globalState&&(e=be(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=c||null;try{const _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new Jt(`Expected value to be one of ${Object.keys(this._enumValues).map((y=>JSON.stringify(y))).join(", ")}, but found ${JSON.stringify(_)} instead.`);return _}catch(_){return this._warningHistory[_.message]||(this._warningHistory[_.message]=!0,typeof console<"u"&&console.warn(_.message)),this._defaultValue}}}function uo(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in no}function s(n,e,i){const r=new It(no,os,[],e?(function(h){const c={color:An,string:Mt,number:Qe,enum:Mt,boolean:xt,formatted:Vr,padding:Ko,numberArray:bo,colorArray:Aa,projectionDefinition:Wo,resolvedImage:Nr,variableAnchorOffsetCollection:ko};return h.type==="array"?kn(c[h.value]||Pt,h.length):c[h.type]})(e):void 0),u=r.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?ro(new us(u,e,i)):oo(r.errors)}class m{constructor(e,i,r){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!ao(i.expression),this.globalStateRefs=me(i.expression),this._globalState=r}evaluateWithoutErrorHandling(e,i,r,u,h,c){return this._globalState&&(e=be(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,r,u,h,c)}evaluate(e,i,r,u,h,c){return this._globalState&&(e=be(e,this._globalState)),this._styleExpression.evaluate(e,i,r,u,h,c)}}class x{constructor(e,i,r,u,h){this.kind=e,this.zoomStops=r,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!ao(i.expression),this.globalStateRefs=me(i.expression),this.interpolationType=u,this._globalState=h}evaluateWithoutErrorHandling(e,i,r,u,h,c){return this._globalState&&(e=be(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,r,u,h,c)}evaluate(e,i,r,u,h,c){return this._globalState&&(e=be(e,this._globalState)),this._styleExpression.evaluate(e,i,r,u,h,c)}interpolationFactor(e,i,r){return this.interpolationType?Ci.interpolationFactor(this.interpolationType,e,i,r):0}}function C(n,e,i){const r=s(n,e,i);if(r.result==="error")return r;const u=r.value.expression,h=ia(u);if(!h&&!Ga(e))return oo([new cn("","data expressions not supported")]);const c=jo(u,["zoom"]);if(!c&&!so(e))return oo([new cn("","zoom expressions not supported")]);const _=W(u);return _||c?_ instanceof cn?oo([_]):_ instanceof Ci&&!ss(e)?oo([new cn("",'"interpolate" expressions cannot be used with this property')]):ro(_?new x(h?"camera":"composite",r.value,_.labels,_ instanceof Ci?_.interpolation:void 0,i):new m(h?"constant":"source",r.value,i)):oo([new cn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class B{constructor(e,i){this._parameters=e,this._specification=i,hn(this,Es(this._parameters,this._specification))}static deserialize(e){return new B(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function W(n){let e=null;if(n instanceof ri)e=W(n.result);else if(n instanceof Fa){for(const i of n.args)if(e=W(i),e)break}else(n instanceof or||n instanceof Ci)&&n.input instanceof mn&&n.input.name==="zoom"&&(e=n);return e instanceof cn||n.eachChild((i=>{const r=W(i);r instanceof cn?e=r:!e&&r?e=new cn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&r&&e!==r&&(e=new cn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function me(n,e=new Set){return n instanceof io&&e.add(n.key),n.eachChild((i=>{me(i,e)})),e}function be(n,e){const{zoom:i,heatmapDensity:r,elevation:u,lineProgress:h,isSupportedScript:c,accumulated:_}=n??{};return{zoom:i,heatmapDensity:r,elevation:u,lineProgress:h,isSupportedScript:c,accumulated:_,globalState:e}}function Re(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!Re(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Ze={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ut(n,e){if(n==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Re(n)||(n=Ki(n));const i=s(n,Ze,e);if(i.result==="error")throw new Error(i.value.map((r=>`${r.key}: ${r.message}`)).join(", "));return{filter:(r,u,h)=>i.value.evaluate(r,u,{},h),needGeometry:Dt(n),getGlobalStateRefs:()=>me(i.value.expression)}}function vt(n,e){return n<e?-1:n>e?1:0}function Dt(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let e=1;e<n.length;e++)if(Dt(n[e]))return!0;return!1}function Ki(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?Bi(n[1],n[2],"=="):e==="!="?Pa(Bi(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Bi(n[1],n[2],e):e==="any"?(i=n.slice(1),["any"].concat(i.map(Ki))):e==="all"?["all"].concat(n.slice(1).map(Ki)):e==="none"?["all"].concat(n.slice(1).map(Ki).map(Pa)):e==="in"?Kn(n[1],n.slice(2)):e==="!in"?Pa(Kn(n[1],n.slice(2))):e==="has"?Ln(n[1]):e!=="!has"||Pa(Ln(n[1]));var i}function Bi(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function Kn(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((i=>typeof i!=typeof e[0]))?["filter-in-large",n,["literal",e.sort(vt)]]:["filter-in-small",n,["literal",e]]}}function Ln(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Pa(n){return["!",n]}function ds(n){const e=typeof n;if(e==="number"||e==="boolean"||e==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let u="[";for(const h of n)u+=`${ds(h)},`;return`${u}]`}const i=Object.keys(n).sort();let r="{";for(let u=0;u<i.length;u++)r+=`${JSON.stringify(i[u])}:${ds(n[i[u]])},`;return`${r}}`}function wl(n){let e="";for(const i of ti)e+=`/${ds(n[i])}`;return e}function bl(n){const e=n.value;return e?[new Ee(n.key,e,"constants have been deprecated as of v8")]:[]}function xi(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function zr(n){if(Array.isArray(n))return n.map(zr);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=zr(n[i]);return e}return xi(n)}function Bn(n){const e=n.key,i=n.value,r=n.valueSpec||{},u=n.objectElementValidators||{},h=n.style,c=n.styleSpec,_=n.validateSpec;let y=[];const k=Et(i);if(k!=="object")return[new Ee(e,i,`object expected, ${k} found`)];for(const P in i){const E=P.split(".")[0],D=ja(r,E)||r["*"];let A;if(ja(u,E))A=u[E];else if(ja(r,E)){if(i[P]===void 0)continue;A=_}else if(u["*"])A=u["*"];else{if(!r["*"]){y.push(new Ee(e,i[P],`unknown property "${P}"`));continue}A=_}y=y.concat(A({key:(e&&`${e}.`)+P,value:i[P],valueSpec:D,style:h,styleSpec:c,object:i,objectKey:P,validateSpec:_},i))}for(const P in r)u[P]||r[P].required&&r[P].default===void 0&&i[P]===void 0&&y.push(new Ee(e,i,`missing required property "${P}"`));return y}function wi(n){const e=n.value,i=n.valueSpec,r=n.style,u=n.styleSpec,h=n.key,c=n.arrayElementValidator||n.validateSpec;if(Et(e)!=="array")return[new Ee(h,e,`array expected, ${Et(e)} found`)];if(i.length&&e.length!==i.length)return[new Ee(h,e,`array length ${i.length} expected, length ${e.length} found`)];let _={type:i.value,values:i.values};u.$version<7&&(_.function=i.function),Et(i.value)==="object"&&(_=i.value);let y=[];for(let k=0;k<e.length;k++)y=y.concat(c({array:e,arrayIndex:k,value:e[k],valueSpec:_,validateSpec:n.validateSpec,style:r,styleSpec:u,key:`${h}[${k}]`}));return y}function dr(n){const e=n.key,i=n.value,r=n.valueSpec;let u=Et(i);return u==="number"&&i!=i&&(u="NaN"),u!=="number"?[new Ee(e,i,`number expected, ${u} found`)]:"minimum"in r&&i<r.minimum?[new Ee(e,i,`${i} is less than the minimum value ${r.minimum}`)]:"maximum"in r&&i>r.maximum?[new Ee(e,i,`${i} is greater than the maximum value ${r.maximum}`)]:[]}function hs(n){const e=n.valueSpec,i=xi(n.value.type);let r,u,h,c={};const _=i!=="categorical"&&n.value.property===void 0,y=!_,k=Et(n.value.stops)==="array"&&Et(n.value.stops[0])==="array"&&Et(n.value.stops[0][0])==="object",P=Bn({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(A){if(i==="identity")return[new Ee(A.key,A.value,'identity function may not have a "stops" property')];let O=[];const $=A.value;return O=O.concat(wi({key:A.key,value:$,valueSpec:A.valueSpec,validateSpec:A.validateSpec,style:A.style,styleSpec:A.styleSpec,arrayElementValidator:E})),Et($)==="array"&&$.length===0&&O.push(new Ee(A.key,$,"array must have at least one stop")),O},default:function(A){return A.validateSpec({key:A.key,value:A.value,valueSpec:e,validateSpec:A.validateSpec,style:A.style,styleSpec:A.styleSpec})}}});return i==="identity"&&_&&P.push(new Ee(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||P.push(new Ee(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!ss(n.valueSpec)&&P.push(new Ee(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(y&&!Ga(n.valueSpec)?P.push(new Ee(n.key,n.value,"property functions not supported")):_&&!so(n.valueSpec)&&P.push(new Ee(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!k||n.value.property!==void 0||P.push(new Ee(n.key,n.value,'"property" property is required')),P;function E(A){let O=[];const $=A.value,N=A.key;if(Et($)!=="array")return[new Ee(N,$,`array expected, ${Et($)} found`)];if($.length!==2)return[new Ee(N,$,`array length 2 expected, length ${$.length} found`)];if(k){if(Et($[0])!=="object")return[new Ee(N,$,`object expected, ${Et($[0])} found`)];if($[0].zoom===void 0)return[new Ee(N,$,"object stop key must have zoom")];if($[0].value===void 0)return[new Ee(N,$,"object stop key must have value")];if(h&&h>xi($[0].zoom))return[new Ee(N,$[0].zoom,"stop zoom values must appear in ascending order")];xi($[0].zoom)!==h&&(h=xi($[0].zoom),u=void 0,c={}),O=O.concat(Bn({key:`${N}[0]`,value:$[0],valueSpec:{zoom:{}},validateSpec:A.validateSpec,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{zoom:dr,value:D}}))}else O=O.concat(D({key:`${N}[0]`,value:$[0],validateSpec:A.validateSpec,style:A.style,styleSpec:A.styleSpec},$));return uo(zr($[1]))?O.concat([new Ee(`${N}[1]`,$[1],"expressions are not allowed in function stops.")]):O.concat(A.validateSpec({key:`${N}[1]`,value:$[1],valueSpec:e,validateSpec:A.validateSpec,style:A.style,styleSpec:A.styleSpec}))}function D(A,O){const $=Et(A.value),N=xi(A.value),H=A.value!==null?A.value:O;if(r){if($!==r)return[new Ee(A.key,H,`${$} stop domain type must match previous stop domain type ${r}`)]}else r=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new Ee(A.key,H,"stop domain value must be a number, string, or boolean")];if($!=="number"&&i!=="categorical"){let ne=`number expected, ${$} found`;return Ga(e)&&i===void 0&&(ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ee(A.key,H,ne)]}return i!=="categorical"||$!=="number"||isFinite(N)&&Math.floor(N)===N?i!=="categorical"&&$==="number"&&u!==void 0&&N<u?[new Ee(A.key,H,"stop domain values must appear in ascending order")]:(u=N,i==="categorical"&&N in c?[new Ee(A.key,H,"stop domain values must be unique")]:(c[N]=!0,[])):[new Ee(A.key,H,`integer expected, found ${N}`)]}}function hr(n){const e=(n.expressionContext==="property"?C:s)(zr(n.value),n.valueSpec);if(e.result==="error")return e.value.map((r=>new Ee(`${n.key}${r.key}`,n.value,r.message)));const i=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new Ee(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!ao(i))return[new Ee(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!ao(i))return[new Ee(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!jo(i,["zoom","feature-state"]))return[new Ee(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!ia(i))return[new Ee(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Fo(n){const e=n.key,i=n.value,r=Et(i);return r!=="string"?[new Ee(e,i,`color expected, ${r} found`)]:Lt.parse(String(i))?[]:[new Ee(e,i,`color expected, "${i}" found`)]}function qa(n){const e=n.key,i=n.value,r=n.valueSpec,u=[];return Array.isArray(r.values)?r.values.indexOf(xi(i))===-1&&u.push(new Ee(e,i,`expected one of [${r.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(r.values).indexOf(xi(i))===-1&&u.push(new Ee(e,i,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function Ir(n){return Re(zr(n.value))?hr(hn({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):kl(n)}function kl(n){const e=n.value,i=n.key;if(Et(e)!=="array")return[new Ee(i,e,`array expected, ${Et(e)} found`)];const r=n.styleSpec;let u,h=[];if(e.length<1)return[new Ee(i,e,"filter array must have at least 1 element")];switch(h=h.concat(qa({key:`${i}[0]`,value:e[0],valueSpec:r.filter_operator,style:n.style,styleSpec:n.styleSpec})),xi(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&xi(e[1])==="$type"&&h.push(new Ee(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&h.push(new Ee(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Et(e[1]),u!=="string"&&h.push(new Ee(`${i}[1]`,e[1],`string expected, ${u} found`)));for(let c=2;c<e.length;c++)u=Et(e[c]),xi(e[1])==="$type"?h=h.concat(qa({key:`${i}[${c}]`,value:e[c],valueSpec:r.geometry_type,style:n.style,styleSpec:n.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&h.push(new Ee(`${i}[${c}]`,e[c],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let c=1;c<e.length;c++)h=h.concat(kl({key:`${i}[${c}]`,value:e[c],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":u=Et(e[1]),e.length!==2?h.push(new Ee(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&h.push(new Ee(`${i}[1]`,e[1],`string expected, ${u} found`))}return h}function Yu(n,e){const i=n.key,r=n.validateSpec,u=n.style,h=n.styleSpec,c=n.value,_=n.objectKey,y=h[`${e}_${n.layerType}`];if(!y)return[];const k=_.match(/^(.*)-transition$/);if(e==="paint"&&k&&y[k[1]]&&y[k[1]].transition)return r({key:i,value:c,valueSpec:h.transition,style:u,styleSpec:h});const P=n.valueSpec||y[_];if(!P)return[new Ee(i,c,`unknown property "${_}"`)];let E;if(Et(c)==="string"&&Ga(P)&&!P.tokens&&(E=/^{([^}]+)}$/.exec(c)))return[new Ee(i,c,`"${_}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(E[1])} }\`.`)];const D=[];return n.layerType==="symbol"&&_==="text-font"&&ls(zr(c))&&xi(c.type)==="identity"&&D.push(new Ee(i,c,'"text-font" does not support identity functions')),D.concat(r({key:n.key,value:c,valueSpec:P,style:u,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:_}))}function Ju(n){return Yu(n,"paint")}function Qu(n){return Yu(n,"layout")}function ed(n){let e=[];const i=n.value,r=n.key,u=n.style,h=n.styleSpec;if(Et(i)!=="object")return[new Ee(r,i,`object expected, ${Et(i)} found`)];i.type||i.ref||e.push(new Ee(r,i,'either "type" or "ref" is required'));let c=xi(i.type);const _=xi(i.ref);if(i.id){const y=xi(i.id);for(let k=0;k<n.arrayIndex;k++){const P=u.layers[k];xi(P.id)===y&&e.push(new Ee(r,i.id,`duplicate layer id "${i.id}", previously used at line ${P.id.__line__}`))}}if("ref"in i){let y;["type","source","source-layer","filter","layout"].forEach((k=>{k in i&&e.push(new Ee(r,i[k],`"${k}" is prohibited for ref layers`))})),u.layers.forEach((k=>{xi(k.id)===_&&(y=k)})),y?y.ref?e.push(new Ee(r,i.ref,"ref cannot reference another ref layer")):c=xi(y.type):e.push(new Ee(r,i.ref,`ref layer "${_}" not found`))}else if(c!=="background")if(i.source){const y=u.sources&&u.sources[i.source],k=y&&xi(y.type);y?k==="vector"&&c==="raster"?e.push(new Ee(r,i.source,`layer "${i.id}" requires a raster source`)):k!=="raster-dem"&&c==="hillshade"||k!=="raster-dem"&&c==="color-relief"?e.push(new Ee(r,i.source,`layer "${i.id}" requires a raster-dem source`)):k==="raster"&&c!=="raster"?e.push(new Ee(r,i.source,`layer "${i.id}" requires a vector source`)):k!=="vector"||i["source-layer"]?k==="raster-dem"&&c!=="hillshade"&&c!=="color-relief"?e.push(new Ee(r,i.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):c!=="line"||!i.paint||!i.paint["line-gradient"]||k==="geojson"&&y.lineMetrics||e.push(new Ee(r,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ee(r,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Ee(r,i.source,`source "${i.source}" not found`))}else e.push(new Ee(r,i,'missing required property "source"'));return e=e.concat(Bn({key:r,value:i,valueSpec:h.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${r}.type`,value:i.type,valueSpec:h.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:i,objectKey:"type"}),filter:Ir,layout:y=>Bn({layer:i,key:y.key,value:y.value,style:y.style,styleSpec:y.styleSpec,validateSpec:y.validateSpec,objectElementValidators:{"*":k=>Qu(hn({layerType:c},k))}}),paint:y=>Bn({layer:i,key:y.key,value:y.value,style:y.style,styleSpec:y.styleSpec,validateSpec:y.validateSpec,objectElementValidators:{"*":k=>Ju(hn({layerType:c},k))}})}})),e}function ho(n){const e=n.value,i=n.key,r=Et(e);return r!=="string"?[new Ee(i,e,`string expected, ${r} found`)]:[]}const lu={promoteId:function({key:n,value:e}){if(Et(e)==="string")return ho({key:n,value:e});{const i=[];for(const r in e)i.push(...ho({key:`${n}.${r}`,value:e[r]}));return i}}};function uu(n){const e=n.value,i=n.key,r=n.styleSpec,u=n.style,h=n.validateSpec;if(!e.type)return[new Ee(i,e,'"type" is required')];const c=xi(e.type);let _;switch(c){case"vector":case"raster":return _=Bn({key:i,value:e,valueSpec:r[`source_${c.replace("-","_")}`],style:n.style,styleSpec:r,objectElementValidators:lu,validateSpec:h}),_;case"raster-dem":return _=(function(y){var k;const P=(k=y.sourceName)!==null&&k!==void 0?k:"",E=y.value,D=y.styleSpec,A=D.source_raster_dem,O=y.style;let $=[];const N=Et(E);if(E===void 0)return $;if(N!=="object")return $.push(new Ee("source_raster_dem",E,`object expected, ${N} found`)),$;const H=xi(E.encoding)==="custom",ne=["redFactor","greenFactor","blueFactor","baseShift"],K=y.value.encoding?`"${y.value.encoding}"`:"Default";for(const J in E)!H&&ne.includes(J)?$.push(new Ee(J,E[J],`In "${P}": "${J}" is only valid when "encoding" is set to "custom". ${K} encoding found`)):A[J]?$=$.concat(y.validateSpec({key:J,value:E[J],valueSpec:A[J],validateSpec:y.validateSpec,style:O,styleSpec:D})):$.push(new Ee(J,E[J],`unknown property "${J}"`));return $})({sourceName:i,value:e,style:n.style,styleSpec:r,validateSpec:h}),_;case"geojson":if(_=Bn({key:i,value:e,valueSpec:r.source_geojson,style:u,styleSpec:r,validateSpec:h,objectElementValidators:lu}),e.cluster)for(const y in e.clusterProperties){const[k,P]=e.clusterProperties[y],E=typeof k=="string"?[k,["accumulated"],["get",y]]:k;_.push(...hr({key:`${i}.${y}.map`,value:P,expressionContext:"cluster-map"})),_.push(...hr({key:`${i}.${y}.reduce`,value:E,expressionContext:"cluster-reduce"}))}return _;case"video":return Bn({key:i,value:e,valueSpec:r.source_video,style:u,validateSpec:h,styleSpec:r});case"image":return Bn({key:i,value:e,valueSpec:r.source_image,style:u,validateSpec:h,styleSpec:r});case"canvas":return[new Ee(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qa({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function zs(n){const e=n.value,i=n.styleSpec,r=i.light,u=n.style;let h=[];const c=Et(e);if(e===void 0)return h;if(c!=="object")return h=h.concat([new Ee("light",e,`object expected, ${c} found`)]),h;for(const _ in e){const y=_.match(/^(.*)-transition$/);h=h.concat(y&&r[y[1]]&&r[y[1]].transition?n.validateSpec({key:_,value:e[_],valueSpec:i.transition,validateSpec:n.validateSpec,style:u,styleSpec:i}):r[_]?n.validateSpec({key:_,value:e[_],valueSpec:r[_],validateSpec:n.validateSpec,style:u,styleSpec:i}):[new Ee(_,e[_],`unknown property "${_}"`)])}return h}function td(n){const e=n.value,i=n.styleSpec,r=i.sky,u=n.style,h=Et(e);if(e===void 0)return[];if(h!=="object")return[new Ee("sky",e,`object expected, ${h} found`)];let c=[];for(const _ in e)c=c.concat(r[_]?n.validateSpec({key:_,value:e[_],valueSpec:r[_],style:u,styleSpec:i}):[new Ee(_,e[_],`unknown property "${_}"`)]);return c}function du(n){const e=n.value,i=n.styleSpec,r=i.terrain,u=n.style;let h=[];const c=Et(e);if(e===void 0)return h;if(c!=="object")return h=h.concat([new Ee("terrain",e,`object expected, ${c} found`)]),h;for(const _ in e)h=h.concat(r[_]?n.validateSpec({key:_,value:e[_],valueSpec:r[_],validateSpec:n.validateSpec,style:u,styleSpec:i}):[new Ee(_,e[_],`unknown property "${_}"`)]);return h}function hu(n){let e=[];const i=n.value,r=n.key;if(Array.isArray(i)){const u=[],h=[];for(const c in i)i[c].id&&u.includes(i[c].id)&&e.push(new Ee(r,i,`all the sprites' ids must be unique, but ${i[c].id} is duplicated`)),u.push(i[c].id),i[c].url&&h.includes(i[c].url)&&e.push(new Ee(r,i,`all the sprites' URLs must be unique, but ${i[c].url} is duplicated`)),h.push(i[c].url),e=e.concat(Bn({key:`${r}[${c}]`,value:i[c],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return e}return ho({key:r,value:i})}function id(n){return!!n&&n.constructor===Object}function cu(n){return id(n.value)?[]:[new Ee(n.key,n.value,`object expected, ${Et(n.value)} found`)]}const fu={"*":()=>[],array:wi,boolean:function(n){const e=n.value,i=n.key,r=Et(e);return r!=="boolean"?[new Ee(i,e,`boolean expected, ${r} found`)]:[]},number:dr,color:Fo,constants:bl,enum:qa,filter:Ir,function:hs,layer:ed,object:Bn,source:uu,light:zs,sky:td,terrain:du,projection:function(n){const e=n.value,i=n.styleSpec,r=i.projection,u=n.style,h=Et(e);if(e===void 0)return[];if(h!=="object")return[new Ee("projection",e,`object expected, ${h} found`)];let c=[];for(const _ in e)c=c.concat(r[_]?n.validateSpec({key:_,value:e[_],valueSpec:r[_],style:u,styleSpec:i}):[new Ee(_,e[_],`unknown property "${_}"`)]);return c},projectionDefinition:function(n){const e=n.key;let i=n.value;i=i instanceof String?i.valueOf():i;const r=Et(i);return r!=="array"||(function(u){return Array.isArray(u)&&u.length===3&&typeof u[0]=="string"&&typeof u[1]=="string"&&typeof u[2]=="number"})(i)||(function(u){return!!["interpolate","step","literal"].includes(u[0])})(i)?["array","string"].includes(r)?[]:[new Ee(e,i,`projection expected, invalid type "${r}" found`)]:[new Ee(e,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:ho,formatted:function(n){return ho(n).length===0?[]:hr(n)},resolvedImage:function(n){return ho(n).length===0?[]:hr(n)},padding:function(n){const e=n.key,i=n.value;if(Et(i)==="array"){if(i.length<1||i.length>4)return[new Ee(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const r={type:"number"};let u=[];for(let h=0;h<i.length;h++)u=u.concat(n.validateSpec({key:`${e}[${h}]`,value:i[h],validateSpec:n.validateSpec,valueSpec:r}));return u}return dr({key:e,value:i,valueSpec:{}})},numberArray:function(n){const e=n.key,i=n.value;if(Et(i)==="array"){const r={type:"number"};if(i.length<1)return[new Ee(e,i,"array length at least 1 expected, length 0 found")];let u=[];for(let h=0;h<i.length;h++)u=u.concat(n.validateSpec({key:`${e}[${h}]`,value:i[h],validateSpec:n.validateSpec,valueSpec:r}));return u}return dr({key:e,value:i,valueSpec:{}})},colorArray:function(n){const e=n.key,i=n.value;if(Et(i)==="array"){if(i.length<1)return[new Ee(e,i,"array length at least 1 expected, length 0 found")];let r=[];for(let u=0;u<i.length;u++)r=r.concat(Fo({key:`${e}[${u}]`,value:i[u]}));return r}return Fo({key:e,value:i})},variableAnchorOffsetCollection:function(n){const e=n.key,i=n.value,r=Et(i),u=n.styleSpec;if(r!=="array"||i.length<1||i.length%2!=0)return[new Ee(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let h=[];for(let c=0;c<i.length;c+=2)h=h.concat(qa({key:`${e}[${c}]`,value:i[c],valueSpec:u.layout_symbol["text-anchor"]})),h=h.concat(wi({key:`${e}[${c+1}]`,value:i[c+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:u}));return h},sprite:hu,state:cu,fontFaces:function(n){const e=n.key,i=n.value,r=n.validateSpec,u=n.styleSpec,h=n.style;if(!id(i))return[new Ee(e,i,`object expected, ${Et(i)} found`)];const c=[];for(const _ in i){const y=i[_],k=Et(y);if(k==="string")c.push(...ho({key:`${e}.${_}`,value:y}));else if(k==="array"){const P={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[E,D]of y.entries())c.push(...Bn({key:`${e}.${_}[${E}]`,value:D,valueSpec:P,styleSpec:u,style:h,validateSpec:r}))}else c.push(new Ee(`${e}.${_}`,y,`string or array expected, ${k} found`))}return c}};function co(n){const e=n.value,i=n.valueSpec,r=n.styleSpec;return n.validateSpec=co,i.expression&&ls(xi(e))?hs(n):i.expression&&uo(zr(e))?hr(n):i.type&&fu[i.type]?fu[i.type](n):Bn(hn({},n,{valueSpec:i.type?r[i.type]:i}))}function nd(n){const e=n.value,i=n.key,r=ho(n);return r.length||(e.indexOf("{fontstack}")===-1&&r.push(new Ee(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&r.push(new Ee(i,e,'"glyphs" url must include a "{range}" token'))),r}function La(n,e=Se){let i=[];return i=i.concat(co({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,validateSpec:co,objectElementValidators:{glyphs:nd,"*":()=>[]}})),n.constants&&(i=i.concat(bl({key:"constants",value:n.constants}))),ad(i)}function Za(n){return function(e){return n(Object.assign({},e,{validateSpec:co}))}}function ad(n){return[].concat(n).sort(((e,i)=>e.line-i.line))}function Ha(n){return function(...e){return ad(n.apply(this,e))}}La.source=Ha(Za(uu)),La.sprite=Ha(Za(hu)),La.glyphs=Ha(Za(nd)),La.light=Ha(Za(zs)),La.sky=Ha(Za(td)),La.terrain=Ha(Za(du)),La.state=Ha(Za(cu)),La.layer=Ha(Za(ed)),La.filter=Ha(Za(Ir)),La.paintProperty=Ha(Za(Ju)),La.layoutProperty=Ha(Za(Qu));const qd={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class Is{constructor(e,i){this._globalState=i,this.setValue(e)}evaluate(){var e;return(e=this._literalValue)!==null&&e!==void 0?e:this._compiledValue.evaluate({})}setValue(e){if(e==null||e==="visible"||e==="none")return this._literalValue=e==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const i=s(e,qd,this._globalState);if(i.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(i.value.map((r=>`${r.key}: ${r.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=i.value,this._globalStateRefs=me(i.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const Ds=Se,pn=La,As=pn.light,rd=pn.sky,Zd=pn.paintProperty,Hd=pn.layoutProperty;function cs(n,e){let i=!1;if(e&&e.length)for(const r of e)n.fire(new Ht(new Error(r.message))),i=!0;return i}class fs{constructor(e,i,r){const u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const c=new Int32Array(this.arrayBuffer);e=c[0],this.d=(i=c[1])+2*(r=c[2]);for(let y=0;y<this.d*this.d;y++){const k=c[3+y],P=c[3+y+1];u.push(k===P?null:c.subarray(k,P))}const _=c[3+u.length+1];this.keys=c.subarray(c[3+u.length],_),this.bboxes=c.subarray(_),this.insert=this._insertReadonly}else{this.d=i+2*r;for(let c=0;c<this.d*this.d;c++)u.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=e,this.padding=r,this.scale=i/e,this.uid=0;const h=r/i*e;this.min=-h,this.max=e+h}insert(e,i,r,u,h){this._forEachCell(i,r,u,h,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(h)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,i,r,u,h,c){this.cells[h].push(c)}query(e,i,r,u,h){const c=this.min,_=this.max;if(e<=c&&i<=c&&_<=r&&_<=u&&!h)return Array.prototype.slice.call(this.keys);{const y=[];return this._forEachCell(e,i,r,u,this._queryCell,y,{},h),y}}_queryCell(e,i,r,u,h,c,_,y){const k=this.cells[h];if(k!==null){const P=this.keys,E=this.bboxes;for(let D=0;D<k.length;D++){const A=k[D];if(_[A]===void 0){const O=4*A;(y?y(E[O+0],E[O+1],E[O+2],E[O+3]):e<=E[O+2]&&i<=E[O+3]&&r>=E[O+0]&&u>=E[O+1])?(_[A]=!0,c.push(P[A])):_[A]=!1}}}}_forEachCell(e,i,r,u,h,c,_,y){const k=this._convertToCellCoord(e),P=this._convertToCellCoord(i),E=this._convertToCellCoord(r),D=this._convertToCellCoord(u);for(let A=k;A<=E;A++)for(let O=P;O<=D;O++){const $=this.d*O+A;if((!y||y(this._convertFromCellCoord(A),this._convertFromCellCoord(O),this._convertFromCellCoord(A+1),this._convertFromCellCoord(O+1)))&&h.call(this,e,i,r,u,$,c,_,y))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,i=3+this.cells.length+1+1;let r=0;for(let c=0;c<this.cells.length;c++)r+=this.cells[c].length;const u=new Int32Array(i+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;let h=i;for(let c=0;c<e.length;c++){const _=e[c];u[3+c]=h,u.set(_,h),h+=_.length}return u[3+e.length]=h,u.set(this.keys,h),h+=this.keys.length,u[3+e.length+1]=h,u.set(this.bboxes,h),h+=this.bboxes.length,u.buffer}static serialize(e,i){const r=e.toArrayBuffer();return i&&i.push(r),{buffer:r}}static deserialize(e){return new fs(e.buffer)}}const Wa={};function ot(n,e,i={}){if(Wa[n])throw new Error(`${n} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),Wa[n]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}ot("Object",Object),ot("Set",Set),ot("TransferableGridIndex",fs),ot("Color",Lt),ot("Error",Error),ot("AJAXError",ge),ot("ResolvedImage",Pn),ot("StylePropertyFunction",B),ot("StyleExpression",us,{omit:["_evaluator"]}),ot("ZoomDependentExpression",x),ot("ZoomConstantExpression",m),ot("CompoundExpression",mn,{omit:["_evaluate"]});for(const n in no)no[n]._classRegistryKey||ot(`Expression_${n}`,no[n]);function Sl(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function mu(n){return n.$name||n.constructor._classRegistryKey}function ms(n){return!(function(e){if(e===null||typeof e!="object")return!1;const i=mu(e);return!(!i||i==="Object")})(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||Sl(n)||sa(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function Rs(n,e){if(ms(n))return(Sl(n)||sa(n))&&e&&e.push(n),ArrayBuffer.isView(n)&&e&&e.push(n.buffer),n instanceof ImageData&&e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const h=[];for(const c of n)h.push(Rs(c,e));return h}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const i=mu(n);if(!i)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!Wa[i])throw new Error(`${i} is not registered.`);const{klass:r}=Wa[i],u=r.serialize?r.serialize(n,e):{};if(r.serialize){if(e&&u===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const h in n){if(!n.hasOwnProperty(h)||Wa[i].omit.indexOf(h)>=0)continue;const c=n[h];u[h]=Wa[i].shallow.indexOf(h)>=0?c:Rs(c,e)}n instanceof Error&&(u.message=n.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(u.$name=i),u}function js(n){if(ms(n))return n;if(Array.isArray(n))return n.map(js);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const e=mu(n)||"Object";if(!Wa[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=Wa[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const r=Object.create(i.prototype);for(const u of Object.keys(n)){if(u==="$name")continue;const h=n[u];r[u]=Wa[e].shallow.indexOf(u)>=0?h:js(h)}return r}class pu{constructor(){this.first=!0}update(e,i){const r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}function Fs(n){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))}function _u(n){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))}function od(n){return/\s/u.test(String.fromCodePoint(n))}function ps(n){for(const e of n)if(_u(e.codePointAt(0)))return!0;return!1}function Wd(n){for(const e of n)if(!sd(e.codePointAt(0)))return!1;return!0}function Tl(n){const e=n.map((i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}})).filter((i=>i));return new RegExp(e.join("|"),"u")}const Pl=Tl(["Arab","Dupl","Mong","Ougr","Syrc"]);function sd(n){return!Pl.test(String.fromCodePoint(n))}function gu(n){return!(_u(n)||(e=n,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(e))));var e}const ld=Tl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function yu(n){return ld.test(String.fromCodePoint(n))}function vu(n,e){return!(!e&&yu(n)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(n)))}function ud(n){for(const e of n)if(yu(e.codePointAt(0)))return!0;return!1}const fo=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){if(fo.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(n,e){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(n.pluginStatus!=="loading")return this.setState(n),n;const i=n.pluginURL,r=new Promise((h=>{this.loadScriptResolve=h}));e(i);const u=new Promise((h=>setTimeout((()=>h()),this.TIMEOUT)));if(yield Promise.race([r,u]),this.isParsed()){const h={pluginStatus:"loaded",pluginURL:i};return this.setState(h),h}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${i}`)}))}};class oi{constructor(e,i){this.isSupportedScript=Kd,this.zoom=e,i?(this.now=i.now||0,this.fadeDuration=i.fadeDuration||0,this.zoomHistory=i.zoomHistory||new pu,this.transition=i.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pu,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*i}}}function Kd(n){return(function(e,i){for(const r of e)if(!vu(r.codePointAt(0),i))return!1;return!0})(n,fo.getRTLTextPluginStatus()==="loaded")}const Bs="-transition";class Ll{constructor(e,i,r){this.property=e,this.value=i,this.expression=(function(u,h,c){if(ls(u))return new B(u,h);if(uo(u)){const _=C(u,h,c);if(_.result==="error")throw new Error(_.value.map((y=>`${y.key}: ${y.message}`)).join(", "));return _.value}{let _=u;return h.type==="color"&&typeof u=="string"?_=Lt.parse(u):h.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?h.type!=="numberArray"||typeof u!="number"&&!Array.isArray(u)?h.type!=="colorArray"||typeof u!="string"&&!Array.isArray(u)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?_=on.parse(u):h.type==="projectionDefinition"&&typeof u=="string"&&(_=ji.parse(u)):_=rt.parse(u):_=qt.parse(u):_=mt.parse(u),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>_}}})(i===void 0?e.specification.default:i,e.specification,r)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,i,r){return this.property.possiblyEvaluate(this,e,i,r)}}class Ml{constructor(e,i){this.property=e,this.value=new Ll(e,void 0,i)}transitioned(e,i){return new dd(this.property,this.value,i,mi({},e.transition,this.transition),e.now)}untransitioned(){return new dd(this.property,this.value,null,{},0)}}class xu{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=i}getValue(e){return nn(this._values[e].value.value)}setValue(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ml(this._values[e].property,this._globalState)),this._values[e].value=new Ll(this._values[e].property,i===null?void 0:nn(i),this._globalState)}getTransition(e){return nn(this._values[e].transition)}setTransition(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ml(this._values[e].property,this._globalState)),this._values[e].transition=nn(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const r=this.getValue(i);r!==void 0&&(e[i]=r);const u=this.getTransition(i);u!==void 0&&(e[`${i}${Bs}`]=u)}return e}transitioned(e,i){const r=new hd(this._properties);for(const u of Object.keys(this._values))r._values[u]=this._values[u].transitioned(e,i._values[u]);return r}untransitioned(){const e=new hd(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class dd{constructor(e,i,r,u,h){this.property=e,this.value=i,this.begin=h+u.delay||0,this.end=this.begin+u.duration||0,e.specification.transition&&(u.delay||u.duration)&&(this.prior=r)}possiblyEvaluate(e,i,r){const u=e.now||0,h=this.value.possiblyEvaluate(e,i,r),c=this.prior;if(c){if(u>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(u<this.begin)return c.possiblyEvaluate(e,i,r);{const _=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(c.possiblyEvaluate(e,i,r),h,Ni(_))}}return h}}class hd{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,r){const u=new Os(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(e,i,r);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class cd{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=i}hasValue(e){return this._values[e].value!==void 0}getValue(e){return nn(this._values[e].value)}setValue(e,i){this._values[e]=new Ll(this._values[e].property,i===null?void 0:nn(i),this._globalState)}serialize(){const e={};for(const i of Object.keys(this._values)){const r=this.getValue(i);r!==void 0&&(e[i]=r)}return e}possiblyEvaluate(e,i,r){const u=new Os(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(e,i,r);return u}}class Ka{constructor(e,i,r){this.property=e,this.value=i,this.parameters=r}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,r,u){return this.property.evaluate(this.value,this.parameters,e,i,r,u)}}class Os{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ht{constructor(e){this.specification=e}possiblyEvaluate(e,i){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(i)}interpolate(e,i,r){const u=si[this.specification.type];return u?u(e,i,r):e}}class ft{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,r,u){return new Ka(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},r,u)}:e.expression,i)}interpolate(e,i,r){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new Ka(this,{kind:"constant",value:void 0},e.parameters);const u=si[this.specification.type];if(u){const h=u(e.value.value,i.value.value,r);return new Ka(this,{kind:"constant",value:h},e.parameters)}return e}evaluate(e,i,r,u,h,c){return e.kind==="constant"?e.value:e.evaluate(i,r,u,h,c)}}class $s extends ft{possiblyEvaluate(e,i,r,u){if(e.value===void 0)return new Ka(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const h=e.expression.evaluate(i,null,{},r,u),c=e.property.specification.type==="resolvedImage"&&typeof h!="string"?h.name:h,_=this._calculate(c,c,c,i);return new Ka(this,{kind:"constant",value:_},i)}if(e.expression.kind==="camera"){const h=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new Ka(this,{kind:"constant",value:h},i)}return new Ka(this,e.expression,i)}evaluate(e,i,r,u,h,c){if(e.kind==="source"){const _=e.evaluate(i,r,u,h,c);return this._calculate(_,_,_,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},r,u),e.evaluate({zoom:Math.floor(i.zoom)},r,u),e.evaluate({zoom:Math.floor(i.zoom)+1},r,u),i):e.value}_calculate(e,i,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:r,to:i}}interpolate(e){return e}}class Cl{constructor(e){this.specification=e}possiblyEvaluate(e,i,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const h=e.expression.evaluate(i,null,{},r,u);return this._calculate(h,h,h,i)}return this._calculate(e.expression.evaluate(new oi(Math.floor(i.zoom-1),i)),e.expression.evaluate(new oi(Math.floor(i.zoom),i)),e.expression.evaluate(new oi(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:r,to:i}}interpolate(e){return e}}class El{constructor(e){this.specification=e}possiblyEvaluate(e,i,r,u){return!!e.expression.evaluate(i,null,{},r,u)}interpolate(){return!1}}class Xn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const r=e[i];r.specification.overridable&&this.overridableProperties.push(i);const u=this.defaultPropertyValues[i]=new Ll(r,void 0,void 0),h=this.defaultTransitionablePropertyValues[i]=new Ml(r,void 0);this.defaultTransitioningPropertyValues[i]=h.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=u.possiblyEvaluate({})}}}ot("DataDrivenProperty",ft),ot("DataConstantProperty",ht),ot("CrossFadedDataDrivenProperty",$s),ot("CrossFadedProperty",Cl),ot("ColorRampProperty",El);class Ma extends Vt{constructor(e,i,r){if(super(),this.id=e.id,this.type=e.type,this._globalState=r,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this._visibilityExpression=(function(u,h){return new Is(u,h)})(this.visibility,r),e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=ut(e.filter,r)),i.layout&&(this._unevaluatedLayout=new cd(i.layout,r)),i.paint)){this._transitionablePaint=new xu(i.paint,r);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Os(i.paint)}}setFilter(e){this.filter=e,this._featureFilter=ut(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;for(const i of this._visibilityExpression.getGlobalStateRefs())e.add(i);if(this._unevaluatedLayout)for(const i in this._unevaluatedLayout._values){const r=this._unevaluatedLayout._values[i];for(const u of r.getGlobalStateRefs())e.add(u)}for(const i of this._featureFilter.getGlobalStateRefs())e.add(i);return e}getPaintAffectingGlobalStateRefs(){var e;const i=new globalThis.Map;if(this._transitionablePaint)for(const r in this._transitionablePaint._values){const u=this._transitionablePaint._values[r].value;for(const h of u.getGlobalStateRefs()){const c=(e=i.get(h))!==null&&e!==void 0?e:[];c.push({name:r,value:u.value}),i.set(h,c)}}return i}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(e,i,r={}){if(i==null||!this._validate(Hd,`layers.${this.id}.layout.${e}`,e,i,r))return e==="visibility"?(this.visibility=i,this._visibilityExpression.setValue(i),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(e,i)}getPaintProperty(e){return e.endsWith(Bs)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,r={}){if(i!=null&&this._validate(Zd,`layers.${this.id}.paint.${e}`,e,i,r))return!1;if(e.endsWith(Bs))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const u=this._transitionablePaint._values[e],h=u.property.specification["property-type"]==="cross-faded-data-driven",c=u.value.isDataDriven(),_=u.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const y=this._transitionablePaint._values[e].value;return y.isDataDriven()||c||h||this._handleOverridablePaintPropertyUpdate(e,_,y)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,i,r){return!1}isHidden(e=this.minzoom,i=!1){return!!(this.minzoom&&e<(i?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ia(e,((i,r)=>!(i===void 0||r==="layout"&&!Object.keys(i).length||r==="paint"&&!Object.keys(i).length)))}_validate(e,i,r,u,h={}){return(!h||h.validate!==!1)&&cs(this,e.call(pn,{key:i,layerType:this.type,objectKey:r,value:u,styleSpec:Se,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Ka&&Ga(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}let wu;var fd={get paint(){return wu=wu||new Xn({"raster-opacity":new ht(Se.paint_raster["raster-opacity"]),"raster-hue-rotate":new ht(Se.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ht(Se.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ht(Se.paint_raster["raster-brightness-max"]),"raster-saturation":new ht(Se.paint_raster["raster-saturation"]),"raster-contrast":new ht(Se.paint_raster["raster-contrast"]),"raster-resampling":new ht(Se.paint_raster["raster-resampling"]),"raster-fade-duration":new ht(Se.paint_raster["raster-fade-duration"])})}};class Xd extends Ma{constructor(e,i){super(e,fd,i)}}const Yd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Vs{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Gi(n,e=1){let i=0,r=0;return{members:n.map((u=>{const h=Yd[u.type].BYTES_PER_ELEMENT,c=i=Bo(i,Math.max(e,h)),_=u.components||1;return r=Math.max(r,h),i+=h*_,{name:u.name,type:u.type,components:_,offset:c}})),size:Bo(i,Math.max(r,e)),alignment:e}}function Bo(n,e){return Math.ceil(n/e)*e}class Ns extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,i)}emplace(e,i,r){const u=2*e;return this.int16[u+0]=i,this.int16[u+1]=r,e}}Ns.prototype.bytesPerElement=4,ot("StructArrayLayout2i4",Ns);class zl extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,r)}emplace(e,i,r,u){const h=3*e;return this.int16[h+0]=i,this.int16[h+1]=r,this.int16[h+2]=u,e}}zl.prototype.bytesPerElement=6,ot("StructArrayLayout3i6",zl);class bu extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,r,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,r,u)}emplace(e,i,r,u,h){const c=4*e;return this.int16[c+0]=i,this.int16[c+1]=r,this.int16[c+2]=u,this.int16[c+3]=h,e}}bu.prototype.bytesPerElement=8,ot("StructArrayLayout4i8",bu);class Il extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,r,u,h,c)}emplace(e,i,r,u,h,c,_){const y=6*e;return this.int16[y+0]=i,this.int16[y+1]=r,this.int16[y+2]=u,this.int16[y+3]=h,this.int16[y+4]=c,this.int16[y+5]=_,e}}Il.prototype.bytesPerElement=12,ot("StructArrayLayout2i4i12",Il);class ku extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,r,u,h,c)}emplace(e,i,r,u,h,c,_){const y=4*e,k=8*e;return this.int16[y+0]=i,this.int16[y+1]=r,this.uint8[k+4]=u,this.uint8[k+5]=h,this.uint8[k+6]=c,this.uint8[k+7]=_,e}}ku.prototype.bytesPerElement=8,ot("StructArrayLayout2i4ub8",ku);class Us extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,i)}emplace(e,i,r){const u=2*e;return this.float32[u+0]=i,this.float32[u+1]=r,e}}Us.prototype.bytesPerElement=8,ot("StructArrayLayout2f8",Us);class Dr extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c,_,y,k,P){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,r,u,h,c,_,y,k,P)}emplace(e,i,r,u,h,c,_,y,k,P,E){const D=10*e;return this.uint16[D+0]=i,this.uint16[D+1]=r,this.uint16[D+2]=u,this.uint16[D+3]=h,this.uint16[D+4]=c,this.uint16[D+5]=_,this.uint16[D+6]=y,this.uint16[D+7]=k,this.uint16[D+8]=P,this.uint16[D+9]=E,e}}Dr.prototype.bytesPerElement=20,ot("StructArrayLayout10ui20",Dr);class Dl extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c,_,y){const k=this.length;return this.resize(k+1),this.emplace(k,e,i,r,u,h,c,_,y)}emplace(e,i,r,u,h,c,_,y,k){const P=8*e;return this.uint16[P+0]=i,this.uint16[P+1]=r,this.uint16[P+2]=u,this.uint16[P+3]=h,this.uint16[P+4]=c,this.uint16[P+5]=_,this.uint16[P+6]=y,this.uint16[P+7]=k,e}}Dl.prototype.bytesPerElement=16,ot("StructArrayLayout8ui16",Dl);class Gs extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c,_,y,k,P,E,D){const A=this.length;return this.resize(A+1),this.emplace(A,e,i,r,u,h,c,_,y,k,P,E,D)}emplace(e,i,r,u,h,c,_,y,k,P,E,D,A){const O=12*e;return this.int16[O+0]=i,this.int16[O+1]=r,this.int16[O+2]=u,this.int16[O+3]=h,this.uint16[O+4]=c,this.uint16[O+5]=_,this.uint16[O+6]=y,this.uint16[O+7]=k,this.int16[O+8]=P,this.int16[O+9]=E,this.int16[O+10]=D,this.int16[O+11]=A,e}}Gs.prototype.bytesPerElement=24,ot("StructArrayLayout4i4ui4i24",Gs);class Al extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,r)}emplace(e,i,r,u){const h=3*e;return this.float32[h+0]=i,this.float32[h+1]=r,this.float32[h+2]=u,e}}Al.prototype.bytesPerElement=12,ot("StructArrayLayout3f12",Al);class qs extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}qs.prototype.bytesPerElement=4,ot("StructArrayLayout1ul4",qs);class Su extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c,_,y,k){const P=this.length;return this.resize(P+1),this.emplace(P,e,i,r,u,h,c,_,y,k)}emplace(e,i,r,u,h,c,_,y,k,P){const E=10*e,D=5*e;return this.int16[E+0]=i,this.int16[E+1]=r,this.int16[E+2]=u,this.int16[E+3]=h,this.int16[E+4]=c,this.int16[E+5]=_,this.uint32[D+3]=y,this.uint16[E+8]=k,this.uint16[E+9]=P,e}}Su.prototype.bytesPerElement=20,ot("StructArrayLayout6i1ul2ui20",Su);class _s extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,r,u,h,c)}emplace(e,i,r,u,h,c,_){const y=6*e;return this.int16[y+0]=i,this.int16[y+1]=r,this.int16[y+2]=u,this.int16[y+3]=h,this.int16[y+4]=c,this.int16[y+5]=_,e}}_s.prototype.bytesPerElement=12,ot("StructArrayLayout2i2i2i12",_s);class Oo extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h){const c=this.length;return this.resize(c+1),this.emplace(c,e,i,r,u,h)}emplace(e,i,r,u,h,c){const _=4*e,y=8*e;return this.float32[_+0]=i,this.float32[_+1]=r,this.float32[_+2]=u,this.int16[y+6]=h,this.int16[y+7]=c,e}}Oo.prototype.bytesPerElement=16,ot("StructArrayLayout2f1f2i16",Oo);class Tu extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,r,u,h,c)}emplace(e,i,r,u,h,c,_){const y=16*e,k=4*e,P=8*e;return this.uint8[y+0]=i,this.uint8[y+1]=r,this.float32[k+1]=u,this.float32[k+2]=h,this.int16[P+6]=c,this.int16[P+7]=_,e}}Tu.prototype.bytesPerElement=16,ot("StructArrayLayout2ub2f2i16",Tu);class Zs extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,r)}emplace(e,i,r,u){const h=3*e;return this.uint16[h+0]=i,this.uint16[h+1]=r,this.uint16[h+2]=u,e}}Zs.prototype.bytesPerElement=6,ot("StructArrayLayout3ui6",Zs);class $o extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c,_,y,k,P,E,D,A,O,$,N,H){const ne=this.length;return this.resize(ne+1),this.emplace(ne,e,i,r,u,h,c,_,y,k,P,E,D,A,O,$,N,H)}emplace(e,i,r,u,h,c,_,y,k,P,E,D,A,O,$,N,H,ne){const K=24*e,J=12*e,oe=48*e;return this.int16[K+0]=i,this.int16[K+1]=r,this.uint16[K+2]=u,this.uint16[K+3]=h,this.uint32[J+2]=c,this.uint32[J+3]=_,this.uint32[J+4]=y,this.uint16[K+10]=k,this.uint16[K+11]=P,this.uint16[K+12]=E,this.float32[J+7]=D,this.float32[J+8]=A,this.uint8[oe+36]=O,this.uint8[oe+37]=$,this.uint8[oe+38]=N,this.uint32[J+10]=H,this.int16[K+22]=ne,e}}$o.prototype.bytesPerElement=48,ot("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",$o);class Pu extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,r,u,h,c,_,y,k,P,E,D,A,O,$,N,H,ne,K,J,oe,de,we,Ve,je,Ne,Ye,qe){const Be=this.length;return this.resize(Be+1),this.emplace(Be,e,i,r,u,h,c,_,y,k,P,E,D,A,O,$,N,H,ne,K,J,oe,de,we,Ve,je,Ne,Ye,qe)}emplace(e,i,r,u,h,c,_,y,k,P,E,D,A,O,$,N,H,ne,K,J,oe,de,we,Ve,je,Ne,Ye,qe,Be){const ze=32*e,at=16*e;return this.int16[ze+0]=i,this.int16[ze+1]=r,this.int16[ze+2]=u,this.int16[ze+3]=h,this.int16[ze+4]=c,this.int16[ze+5]=_,this.int16[ze+6]=y,this.int16[ze+7]=k,this.uint16[ze+8]=P,this.uint16[ze+9]=E,this.uint16[ze+10]=D,this.uint16[ze+11]=A,this.uint16[ze+12]=O,this.uint16[ze+13]=$,this.uint16[ze+14]=N,this.uint16[ze+15]=H,this.uint16[ze+16]=ne,this.uint16[ze+17]=K,this.uint16[ze+18]=J,this.uint16[ze+19]=oe,this.uint16[ze+20]=de,this.uint16[ze+21]=we,this.uint16[ze+22]=Ve,this.uint32[at+12]=je,this.float32[at+13]=Ne,this.float32[at+14]=Ye,this.uint16[ze+30]=qe,this.uint16[ze+31]=Be,e}}Pu.prototype.bytesPerElement=64,ot("StructArrayLayout8i15ui1ul2f2ui64",Pu);class Rl extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}Rl.prototype.bytesPerElement=4,ot("StructArrayLayout1f4",Rl);class jl extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,r)}emplace(e,i,r,u){const h=3*e;return this.uint16[6*e+0]=i,this.float32[h+1]=r,this.float32[h+2]=u,e}}jl.prototype.bytesPerElement=12,ot("StructArrayLayout1ui2f12",jl);class Lu extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,r)}emplace(e,i,r,u){const h=4*e;return this.uint32[2*e+0]=i,this.uint16[h+2]=r,this.uint16[h+3]=u,e}}Lu.prototype.bytesPerElement=8,ot("StructArrayLayout1ul2ui8",Lu);class f extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,i)}emplace(e,i,r){const u=2*e;return this.uint16[u+0]=i,this.uint16[u+1]=r,e}}f.prototype.bytesPerElement=4,ot("StructArrayLayout2ui4",f);class t extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}t.prototype.bytesPerElement=2,ot("StructArrayLayout1ui2",t);class a extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,r,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,r,u)}emplace(e,i,r,u,h){const c=4*e;return this.float32[c+0]=i,this.float32[c+1]=r,this.float32[c+2]=u,this.float32[c+3]=h,e}}a.prototype.bytesPerElement=16,ot("StructArrayLayout4f16",a);class l extends Vs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new I(this.anchorPointX,this.anchorPointY)}}l.prototype.size=20;class d extends Su{get(e){return new l(this,e)}}ot("CollisionBoxArray",d);class p extends Vs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}p.prototype.size=48;class g extends $o{get(e){return new p(this,e)}}ot("PlacedSymbolArray",g);class b extends Vs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}b.prototype.size=64;class S extends Pu{get(e){return new b(this,e)}}ot("SymbolInstanceArray",S);class M extends Rl{getoffsetX(e){return this.float32[1*e+0]}}ot("GlyphOffsetArray",M);class z extends zl{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}ot("SymbolLineVertexArray",z);class F extends Vs{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}F.prototype.size=12;class j extends jl{get(e){return new F(this,e)}}ot("TextAnchorOffsetArray",j);class V extends Vs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}V.prototype.size=8;class Z extends Lu{get(e){return new V(this,e)}}ot("FeatureIndexArray",Z);class Q extends Ns{}class te extends Ns{}class ee extends Ns{}class ae extends Il{}class he extends ku{}class ie extends Us{}class ue extends Dr{}class _e extends Dl{}class se extends Gs{}class ye extends Al{}class Ie extends qs{}class Te extends _s{}class Le extends Tu{}class Ce extends Zs{}class Ke extends f{}const Xe=Gi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ue}=Xe;class Je{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,i,r,u){const h=this.segments[this.segments.length-1];return e>Je.MAX_VERTEX_ARRAY_LENGTH&&Qi(`Max vertices per segment is ${Je.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Je.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!h||h.vertexLength+e>Je.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==u?this.createNewSegment(i,r,u):h}createNewSegment(e,i,r){const u={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0,vaos:{}};return r!==void 0&&(u.sortKey=r),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(u),u}getOrCreateLatestSegment(e,i,r){return this.prepareSegment(0,e,i,r)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,r,u){return new Je([{vertexOffset:e,primitiveOffset:i,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])}}function wt(n,e){return 256*(n=kt(Math.floor(n),0,255))+kt(Math.floor(e),0,255)}Je.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ot("SegmentVector",Je);const Qt=Gi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),_i=Gi([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var li,bi,ui,Oi={exports:{}},ki={exports:{}},_n={exports:{}},Xi=(function(){if(ui)return Oi.exports;ui=1;var n=(li||(li=1,ki.exports=function(i,r){var u,h,c,_,y,k,P,E;for(h=i.length-(u=3&i.length),c=r,y=3432918353,k=461845907,E=0;E<h;)P=255&i.charCodeAt(E)|(255&i.charCodeAt(++E))<<8|(255&i.charCodeAt(++E))<<16|(255&i.charCodeAt(++E))<<24,++E,c=27492+(65535&(_=5*(65535&(c=(c^=P=(65535&(P=(P=(65535&P)*y+(((P>>>16)*y&65535)<<16)&4294967295)<<15|P>>>17))*k+(((P>>>16)*k&65535)<<16)&4294967295)<<13|c>>>19))+((5*(c>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(P=0,u){case 3:P^=(255&i.charCodeAt(E+2))<<16;case 2:P^=(255&i.charCodeAt(E+1))<<8;case 1:c^=P=(65535&(P=(P=(65535&(P^=255&i.charCodeAt(E)))*y+(((P>>>16)*y&65535)<<16)&4294967295)<<15|P>>>17))*k+(((P>>>16)*k&65535)<<16)&4294967295}return c^=i.length,c=2246822507*(65535&(c^=c>>>16))+((2246822507*(c>>>16)&65535)<<16)&4294967295,c=3266489909*(65535&(c^=c>>>13))+((3266489909*(c>>>16)&65535)<<16)&4294967295,(c^=c>>>16)>>>0}),ki.exports),e=(bi||(bi=1,_n.exports=function(i,r){for(var u,h=i.length,c=r^h,_=0;h>=4;)u=1540483477*(65535&(u=255&i.charCodeAt(_)|(255&i.charCodeAt(++_))<<8|(255&i.charCodeAt(++_))<<16|(255&i.charCodeAt(++_))<<24))+((1540483477*(u>>>16)&65535)<<16),c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),h-=4,++_;switch(h){case 3:c^=(255&i.charCodeAt(_+2))<<16;case 2:c^=(255&i.charCodeAt(_+1))<<8;case 1:c=1540483477*(65535&(c^=255&i.charCodeAt(_)))+((1540483477*(c>>>16)&65535)<<16)}return c=1540483477*(65535&(c^=c>>>13))+((1540483477*(c>>>16)&65535)<<16),(c^=c>>>15)>>>0}),_n.exports);return Oi.exports=n,Oi.exports.murmur3=n,Oi.exports.murmur2=e,Oi.exports})(),qi=R(Xi);class Mn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,r,u){this.ids.push(mo(e)),this.positions.push(i,r,u)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=mo(e);let r=0,u=this.ids.length-1;for(;r<u;){const c=r+u>>1;this.ids[c]>=i?u=c:r=c+1}const h=[];for(;this.ids[r]===i;)h.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return h}static serialize(e,i){const r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Ar(r,u,0,r.length-1),i&&i.push(r.buffer,u.buffer),{ids:r,positions:u}}static deserialize(e){const i=new Mn;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function mo(n){const e=+n;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:qi(String(n))}function Ar(n,e,i,r){for(;i<r;){const u=n[i+r>>1];let h=i-1,c=r+1;for(;;){do h++;while(n[h]<u);do c--;while(n[c]>u);if(h>=c)break;cr(n,h,c),cr(e,3*h,3*c),cr(e,3*h+1,3*c+1),cr(e,3*h+2,3*c+2)}c-i<r-c?(Ar(n,e,i,c),i=c+1):(Ar(n,e,c+1,r),r=c)}}function cr(n,e,i){const r=n[e];n[e]=n[i],n[i]=r}ot("FeaturePositionMap",Mn);class na{constructor(e,i){this.gl=e.gl,this.location=i}}class Vo extends na{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Hs extends na{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class No extends na{constructor(e,i){super(e,i),this.current=Lt.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Ca=new Float32Array(16);function fr(n){return[wt(255*n.r,255*n.g),wt(255*n.b,255*n.a)]}class Xa{constructor(e,i,r){this.value=e,this.uniformNames=i.map((u=>`u_${u}`)),this.type=r}setUniform(e,i,r){e.set(r.constantOr(this.value))}getBinding(e,i,r){return this.type==="color"?new No(e,i):new Vo(e,i)}}class Ya{constructor(e,i){this.uniformNames=i.map((r=>`u_${r}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,i){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,i.y,i.height,i.width]}setUniform(e,i,r,u){let h=null;u==="u_pattern_to"?h=this.patternTo:u==="u_pattern_from"?h=this.patternFrom:u==="u_dasharray_to"?h=this.dashTo:u==="u_dasharray_from"?h=this.dashFrom:u==="u_pixel_ratio_to"?h=this.pixelRatioTo:u==="u_pixel_ratio_from"&&(h=this.pixelRatioFrom),h!==null&&e.set(h)}getBinding(e,i,r){return r.substr(0,9)==="u_pattern"||r.substr(0,12)==="u_dasharray_"?new Hs(e,i):new Vo(e,i)}}class ci{constructor(e,i,r,u){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=i.map((h=>({name:`a_${h}`,type:"Float32",components:r==="color"?2:1,offset:0}))),this.paintVertexArray=new u}populatePaintArray(e,i,r){const u=this.paintVertexArray.length,h=this.expression.evaluate(new oi(0,r),i,{},r.canonical,[],r.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(u,e,h)}updatePaintArray(e,i,r,u,h){const c=this.expression.evaluate(new oi(0,h),r,u);this._setPaintValue(e,i,c)}_setPaintValue(e,i,r){if(this.type==="color"){const u=fr(r);for(let h=e;h<i;h++)this.paintVertexArray.emplace(h,u[0],u[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class di{constructor(e,i,r,u,h,c){this.expression=e,this.uniformNames=i.map((_=>`u_${_}_t`)),this.type=r,this.useIntegerZoom=u,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=i.map((_=>({name:`a_${_}`,type:"Float32",components:r==="color"?4:2,offset:0}))),this.paintVertexArray=new c}populatePaintArray(e,i,r){const u=this.expression.evaluate(new oi(this.zoom,r),i,{},r.canonical,[],r.formattedSection),h=this.expression.evaluate(new oi(this.zoom+1,r),i,{},r.canonical,[],r.formattedSection),c=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(c,e,u,h)}updatePaintArray(e,i,r,u,h){const c=this.expression.evaluate(new oi(this.zoom,h),r,u),_=this.expression.evaluate(new oi(this.zoom+1,h),r,u);this._setPaintValue(e,i,c,_)}_setPaintValue(e,i,r,u){if(this.type==="color"){const h=fr(r),c=fr(u);for(let _=e;_<i;_++)this.paintVertexArray.emplace(_,h[0],h[1],c[0],c[1])}else{for(let h=e;h<i;h++)this.paintVertexArray.emplace(h,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const r=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,u=kt(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)}getBinding(e,i,r){return new Vo(e,i)}}class ln{constructor(e,i,r,u,h,c){this.expression=e,this.type=i,this.useIntegerZoom=r,this.zoom=u,this.layerId=c,this.zoomInPaintVertexArray=new h,this.zoomOutPaintVertexArray=new h}populatePaintArray(e,i,r){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,this.getPositionIds(i),r)}updatePaintArray(e,i,r,u,h){this._setPaintValues(e,i,this.getPositionIds(r),h)}_setPaintValues(e,i,r,u){const h=this.getPositions(u);if(!h||!r)return;const c=h[r.min],_=h[r.mid],y=h[r.max];if(c&&_&&y)for(let k=e;k<i;k++)this.emplace(this.zoomInPaintVertexArray,k,_,c),this.emplace(this.zoomOutPaintVertexArray,k,_,y)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const i=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,i,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,i,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class un extends ln{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return Qt.members}emplace(e,i,r,u){e.emplace(i,r.tlbr[0],r.tlbr[1],r.tlbr[2],r.tlbr[3],u.tlbr[0],u.tlbr[1],u.tlbr[2],u.tlbr[3],r.pixelRatio,u.pixelRatio)}}class md extends ln{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return _i.members}emplace(e,i,r,u){e.emplace(i,0,r.y,r.height,r.width,0,u.y,u.height,u.width)}}class pd{constructor(e,i,r){this.binders={},this._buffers=[];const u=[];for(const h in e.paint._values){if(!r(h))continue;const c=e.paint.get(h);if(!(c instanceof Ka&&Ga(c.property.specification)))continue;const _=Jd(h,e.type),y=c.value,k=c.property.specification.type,P=c.property.useIntegerZoom,E=c.property.specification["property-type"],D=E==="cross-faded"||E==="cross-faded-data-driven";if(y.kind==="constant")this.binders[h]=D?new Ya(y.value,_):new Xa(y.value,_,k),u.push(`/u_${h}`);else if(y.kind==="source"||D){const A=_d(h,k,"source");this.binders[h]=D?h==="line-dasharray"?new md(y,k,P,i,A,e.id):new un(y,k,P,i,A,e.id):new ci(y,_,k,A),u.push(`/a_${h}`)}else{const A=_d(h,k,"composite");this.binders[h]=new di(y,_,k,P,i,A),u.push(`/z_${h}`)}}this.cacheKey=u.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof ci||i instanceof di?i.maxValue:0}populatePaintArrays(e,i,r){for(const u in this.binders){const h=this.binders[u];(h instanceof ci||h instanceof di||h instanceof ln)&&h.populatePaintArray(e,i,r)}}setConstantPatternPositions(e,i){for(const r in this.binders){const u=this.binders[r];u instanceof Ya&&u.setConstantPatternPositions(e,i)}}setConstantDashPositions(e,i){for(const r in this.binders){const u=this.binders[r];u instanceof Ya&&u.setConstantDashPositions(e,i)}}updatePaintArrays(e,i,r,u,h){let c=!1;for(const _ in e){const y=i.getPositions(_);for(const k of y){const P=r.feature(k.index);for(const E in this.binders){const D=this.binders[E];if((D instanceof ci||D instanceof di||D instanceof ln)&&D.expression.isStateDependent===!0){const A=u.paint.get(E);D.expression=A.value,D.updatePaintArray(k.start,k.end,P,e[_],h),c=!0}}}}return c}defines(){const e=[];for(const i in this.binders){const r=this.binders[i];(r instanceof Xa||r instanceof Ya)&&e.push(...r.uniformNames.map((u=>`#define HAS_UNIFORM_${u}`)))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const r=this.binders[i];if(r instanceof ci||r instanceof di)for(let u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof ln){const u=r.getVertexAttributes();for(const h of u)e.push(h.name)}}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const r=this.binders[i];if(r instanceof Xa||r instanceof Ya||r instanceof di)for(const u of r.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const r=[];for(const u in this.binders){const h=this.binders[u];if(h instanceof Xa||h instanceof Ya||h instanceof di){for(const c of h.uniformNames)if(i[c]){const _=h.getBinding(e,i[c],c);r.push({name:c,property:u,binding:_})}}}return r}setUniforms(e,i,r,u){for(const{name:h,property:c,binding:_}of i)this.binders[c].setUniform(_,u,r.get(c),h)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const r=this.binders[i];if(e&&r instanceof ln){const u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof ci||r instanceof di)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const i in this.binders){const r=this.binders[i];(r instanceof ci||r instanceof di||r instanceof ln)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof ci||i instanceof di||i instanceof ln)&&i.destroy()}}}class Uo{constructor(e,i,r=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new pd(u,i,r);this.needsUpload=!1,this._featureMap=new Mn,this._bufferOffset=0}populatePaintArrays(e,i,r,u){for(const h in this.programConfigurations)this.programConfigurations[h].populatePaintArrays(e,i,u);i.id!==void 0&&this._featureMap.add(i.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,r,u){for(const h of r)this.needsUpload=this.programConfigurations[h.id].updatePaintArrays(e,this._featureMap,i,h,u)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Jd(n,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}function _d(n,e,i){const r={color:{source:Us,composite:a},number:{source:Rl,composite:Us}},u=(function(h){return{"line-pattern":{source:ue,composite:ue},"fill-pattern":{source:ue,composite:ue},"fill-extrusion-pattern":{source:ue,composite:ue},"line-dasharray":{source:_e,composite:_e}}[h]})(n);return u&&u[i]||r[e][i]}ot("ConstantBinder",Xa),ot("CrossFadedConstantBinder",Ya),ot("SourceExpressionBinder",ci),ot("CrossFadedPatternBinder",un),ot("CrossFadedDasharrayBinder",md),ot("CompositeExpressionBinder",di),ot("ProgramConfiguration",pd,{omit:["_buffers"]}),ot("ProgramConfigurationSet",Uo);const Mu=Math.pow(2,14)-1,po=-Mu-1;function _o(n){const e=$t/n.extent,i=n.loadGeometry();for(let r=0;r<i.length;r++){const u=i[r];for(let h=0;h<u.length;h++){const c=u[h],_=Math.round(c.x*e),y=Math.round(c.y*e);c.x=kt(_,po,Mu),c.y=kt(y,po,Mu),(_<c.x||_>c.x+1||y<c.y||y>c.y+1)&&Qi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function go(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?_o(n):[]}}const Cu=-32768;function Eu(n,e,i,r,u){n.emplaceBack(Cu+8*e+r,Cu+8*i+u)}class Fl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new te,this.indexArray=new Ce,this.segments=new Je,this.programConfigurations=new Uo(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,r){const u=this.layers[0],h=[];let c=null,_=!1,y=u.type==="heatmap";if(u.type==="circle"){const P=u;c=P.layout.get("circle-sort-key"),_=!c.isConstant(),y=y||P.paint.get("circle-pitch-alignment")==="map"}const k=y?i.subdivisionGranularity.circle:1;for(const{feature:P,id:E,index:D,sourceLayerIndex:A}of e){const O=this.layers[0]._featureFilter.needGeometry,$=go(P,O);if(!this.layers[0]._featureFilter.filter(new oi(this.zoom),$,r))continue;const N=_?c.evaluate($,{},r):void 0,H={id:E,properties:P.properties,type:P.type,sourceLayerIndex:A,index:D,geometry:O?$.geometry:_o(P),patterns:{},sortKey:N};h.push(H)}_&&h.sort(((P,E)=>P.sortKey-E.sortKey));for(const P of h){const{geometry:E,index:D,sourceLayerIndex:A}=P,O=e[D].feature;this.addFeature(P,E,D,r,k),i.featureIndex.insert(O,E,D,A,this.index)}}update(e,i,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:r})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ue),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,r,u,h=1){let c;switch(h){case 1:c=[0,7];break;case 3:c=[0,2,5,7];break;case 5:c=[0,1,3,4,6,7];break;case 7:c=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${h}; valid values are 1, 3, 5, 7.`)}const _=c.length;for(const y of i)for(const k of y){const P=k.x,E=k.y;if(P<0||P>=$t||E<0||E>=$t)continue;const D=this.segments.prepareSegment(_*_,this.layoutVertexArray,this.indexArray,e.sortKey),A=D.vertexLength;for(let O=0;O<_;O++)for(let $=0;$<_;$++)Eu(this.layoutVertexArray,P,E,c[$],c[O]);for(let O=0;O<_-1;O++)for(let $=0;$<_-1;$++){const N=A+O*_+$,H=A+(O+1)*_+$;this.indexArray.emplaceBack(N,H+1,N+1),this.indexArray.emplaceBack(N,H,H+1)}D.vertexLength+=_*_,D.primitiveLength+=(_-1)*(_-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:{},canonical:u})}}function Bl(n,e){for(let i=0;i<n.length;i++)if(Ol(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Ol(n,e[i]))return!0;return!!Qd(n,e)}function gd(n,e,i){return!!Ol(n,e)||!!eh(e,n,i)}function Yh(n,e){if(n.length===1)return Qh(e,n[0]);for(let i=0;i<e.length;i++){const r=e[i];for(let u=0;u<r.length;u++)if(Ol(n,r[u]))return!0}for(let i=0;i<n.length;i++)if(Qh(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Qd(n,e[i]))return!0;return!1}function _m(n,e,i){if(n.length>1){if(Qd(n,e))return!0;for(let r=0;r<e.length;r++)if(eh(e[r],n,i))return!0}for(let r=0;r<n.length;r++)if(eh(n[r],e,i))return!0;return!1}function Qd(n,e){if(n.length===0||e.length===0)return!1;for(let i=0;i<n.length-1;i++){const r=n[i],u=n[i+1];for(let h=0;h<e.length-1;h++)if(gm(r,u,e[h],e[h+1]))return!0}return!1}function gm(n,e,i,r){return Un(n,i,r)!==Un(e,i,r)&&Un(n,e,i)!==Un(n,e,r)}function eh(n,e,i){const r=i*i;if(e.length===1)return n.distSqr(e[0])<r;for(let u=1;u<e.length;u++)if(Jh(n,e[u-1],e[u])<r)return!0;return!1}function Jh(n,e,i){const r=e.distSqr(i);if(r===0)return n.distSqr(e);const u=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/r;return n.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function Qh(n,e){let i,r,u,h=!1;for(let c=0;c<n.length;c++){i=n[c];for(let _=0,y=i.length-1;_<i.length;y=_++)r=i[_],u=i[y],r.y>e.y!=u.y>e.y&&e.x<(u.x-r.x)*(e.y-r.y)/(u.y-r.y)+r.x&&(h=!h)}return h}function Ol(n,e){let i=!1;for(let r=0,u=n.length-1;r<n.length;u=r++){const h=n[r],c=n[u];h.y>e.y!=c.y>e.y&&e.x<(c.x-h.x)*(e.y-h.y)/(c.y-h.y)+h.x&&(i=!i)}return i}function ym(n,e,i){const r=i[0],u=i[2];if(n.x<r.x&&e.x<r.x||n.x>u.x&&e.x>u.x||n.y<r.y&&e.y<r.y||n.y>u.y&&e.y>u.y)return!1;const h=Un(n,e,i[0]);return h!==Un(n,e,i[1])||h!==Un(n,e,i[2])||h!==Un(n,e,i[3])}function $l(n,e,i){const r=e.paint.get(n).value;return r.kind==="constant"?r.value:i.programConfigurations.get(e.id).getMaxValue(n)}function yd(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function vd(n,e,i,r,u){if(!e[0]&&!e[1])return n;const h=I.convert(e)._mult(u);i==="viewport"&&h._rotate(-r);const c=[];for(let _=0;_<n.length;_++)c.push(n[_].sub(h));return c}function vm(n){const e=[];for(let i=0;i<n.length;i++){const r=n[i],u=e.at(-1);(i===0||u&&!r.equals(u))&&e.push(r)}return e}function xm({queryGeometry:n,size:e},i){return gd(n,i,e)}function wm({queryGeometry:n,size:e,transform:i,unwrappedTileID:r,getElevation:u},h){return gd(n,h,e*(i.projectTileCoordinates(h.x,h.y,r,u).signedDistanceFromCamera/i.cameraToCenterDistance))}function bm({queryGeometry:n,size:e,transform:i,unwrappedTileID:r,getElevation:u},h){const c=i.projectTileCoordinates(h.x,h.y,r,u).signedDistanceFromCamera,_=e*(i.cameraToCenterDistance/c);return gd(n,th(h,i,r,u),_)}function km({queryGeometry:n,size:e,transform:i,unwrappedTileID:r,getElevation:u},h){return gd(n,th(h,i,r,u),e)}function ec({queryGeometry:n,size:e,transform:i,unwrappedTileID:r,getElevation:u,pitchAlignment:h="map",pitchScale:c="map"},_){const y=h==="map"?c==="map"?xm:wm:c==="map"?bm:km,k={queryGeometry:n,size:e,transform:i,unwrappedTileID:r,getElevation:u};for(const P of _)for(const E of P)if(y(k,E))return!0;return!1}function th(n,e,i,r){const u=e.projectTileCoordinates(n.x,n.y,i,r).point;return new I((.5*u.x+.5)*e.width,(.5*-u.y+.5)*e.height)}let tc,ic;ot("CircleBucket",Fl,{omit:["layers"]});var Sm={get paint(){return ic=ic||new Xn({"circle-radius":new ft(Se.paint_circle["circle-radius"]),"circle-color":new ft(Se.paint_circle["circle-color"]),"circle-blur":new ft(Se.paint_circle["circle-blur"]),"circle-opacity":new ft(Se.paint_circle["circle-opacity"]),"circle-translate":new ht(Se.paint_circle["circle-translate"]),"circle-translate-anchor":new ht(Se.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ht(Se.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ht(Se.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ft(Se.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ft(Se.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ft(Se.paint_circle["circle-stroke-opacity"])})},get layout(){return tc=tc||new Xn({"circle-sort-key":new ft(Se.layout_circle["circle-sort-key"])})}};class Tm extends Ma{constructor(e,i){super(e,Sm,i)}createBucket(e){return new Fl(e)}queryRadius(e){const i=e;return $l("circle-radius",this,i)+$l("circle-stroke-width",this,i)+yd(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:r,geometry:u,transform:h,pixelsToTileUnits:c,unwrappedTileID:_,getElevation:y}){const k=vd(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-h.bearingInRadians,c),P=this.paint.get("circle-radius").evaluate(i,r)+this.paint.get("circle-stroke-width").evaluate(i,r),E=this.paint.get("circle-pitch-scale"),D=this.paint.get("circle-pitch-alignment");let A,O;return D==="map"?(A=k,O=P*c):(A=(function($,N,H,ne){return $.map((K=>th(K,N,H,ne)))})(k,h,_,y),O=P),ec({queryGeometry:A,size:O,transform:h,unwrappedTileID:_,getElevation:y,pitchAlignment:D,pitchScale:E},u)}}class nc extends Fl{}let ac;ot("HeatmapBucket",nc,{omit:["layers"]});var Pm={get paint(){return ac=ac||new Xn({"heatmap-radius":new ft(Se.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ft(Se.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ht(Se.paint_heatmap["heatmap-intensity"]),"heatmap-color":new El(Se.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ht(Se.paint_heatmap["heatmap-opacity"])})}};function ih(n,{width:e,height:i},r,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*i*r)throw new RangeError(`mismatched image size. expected: ${u.length} but got: ${e*i*r}`)}else u=new Uint8Array(e*i*r);return n.width=e,n.height=i,n.data=u,n}function rc(n,{width:e,height:i},r){if(e===n.width&&i===n.height)return;const u=ih({},{width:e,height:i},r);nh(n,u,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,i)},r),n.width=e,n.height=i,n.data=u.data}function nh(n,e,i,r,u,h){if(u.width===0||u.height===0)return e;if(u.width>n.width||u.height>n.height||i.x>n.width-u.width||i.y>n.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||r.x>e.width-u.width||r.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const c=n.data,_=e.data;if(c===_)throw new Error("srcData equals dstData, so image is already copied");for(let y=0;y<u.height;y++){const k=((i.y+y)*n.width+i.x)*h,P=((r.y+y)*e.width+r.x)*h;for(let E=0;E<u.width*h;E++)_[P+E]=c[k+E]}return e}class zu{constructor(e,i){ih(this,e,1,i)}resize(e){rc(this,e,1)}clone(){return new zu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,r,u,h){nh(e,i,r,u,h,1)}}class ma{constructor(e,i){ih(this,e,4,i)}resize(e){rc(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ma({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,r,u,h){nh(e,i,r,u,h,4)}setPixel(e,i,r){const u=4*(e*this.width+i);this.data[u+0]=Math.round(255*r.r/r.a),this.data[u+1]=Math.round(255*r.g/r.a),this.data[u+2]=Math.round(255*r.b/r.a),this.data[u+3]=Math.round(255*r.a)}}function oc(n){const e={},i=n.resolution||256,r=n.clips?n.clips.length:1,u=n.image||new ma({width:i,height:r});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const h=(c,_,y)=>{e[n.evaluationKey]=y;const k=n.expression.evaluate(e);u.setPixel(c/4/i,_/4,k)};if(n.clips)for(let c=0,_=0;c<r;++c,_+=4*i)for(let y=0,k=0;y<i;y++,k+=4){const P=y/(i-1),{start:E,end:D}=n.clips[c];h(_,k,E*(1-P)+D*P)}else for(let c=0,_=0;c<i;c++,_+=4)h(0,_,c/(i-1));return u}ot("AlphaImage",zu),ot("RGBAImage",ma);const ah="big-fb";class Lm extends Ma{createBucket(e){return new nc(e)}constructor(e,i){super(e,Pm,i),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=oc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ah)&&this.heatmapFbos.delete(ah)}queryRadius(e){return $l("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:r,geometry:u,transform:h,pixelsToTileUnits:c,unwrappedTileID:_,getElevation:y}){return ec({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(i,r)*c,transform:h,unwrappedTileID:_,getElevation:y},u)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let sc;var Mm={get paint(){return sc=sc||new Xn({"hillshade-illumination-direction":new ht(Se.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new ht(Se.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new ht(Se.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ht(Se.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ht(Se.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ht(Se.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ht(Se.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new ht(Se.paint_hillshade["hillshade-method"])})}};class Cm extends Ma{constructor(e,i){super(e,Mm,i),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,i=this.paint.get("hillshade-illumination-altitude").values,r=this.paint.get("hillshade-highlight-color").values,u=this.paint.get("hillshade-shadow-color").values;const h=Math.max(e.length,i.length,r.length,u.length);e=e.concat(Array(h-e.length).fill(e.at(-1))),i=i.concat(Array(h-i.length).fill(i.at(-1))),r=r.concat(Array(h-r.length).fill(r.at(-1))),u=u.concat(Array(h-u.length).fill(u.at(-1)));const c=i.map($r);return{directionRadians:e.map($r),altitudeRadians:c,shadowColor:u,highlightColor:r}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let lc;var Em={get paint(){return lc=lc||new Xn({"color-relief-opacity":new ht(Se["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new El(Se["paint_color-relief"]["color-relief-color"])})}};class rh{constructor(e,i,r,u){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(i,u)}update(e,i,r){const{width:u,height:h}=e,c=!(this.size&&this.size[0]===u&&this.size[1]===h||r),{context:_}=this,{gl:y}=_;if(this.useMipmap=!!(i&&i.useMipmap),y.bindTexture(y.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!i||i.premultiply!==!1)),c)this.size=[u,h],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||sa(e)?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,e):y.texImage2D(y.TEXTURE_2D,0,this.format,u,h,0,this.format,y.UNSIGNED_BYTE,e.data);else{const{x:k,y:P}=r||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||sa(e)?y.texSubImage2D(y.TEXTURE_2D,0,k,P,y.RGBA,y.UNSIGNED_BYTE,e):y.texSubImage2D(y.TEXTURE_2D,0,k,P,u,h,y.RGBA,y.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&y.generateMipmap(y.TEXTURE_2D),_.pixelStoreUnpackFlipY.setDefault(),_.pixelStoreUnpack.setDefault(),_.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,i,r){const{context:u}=this,{gl:h}=u;h.bindTexture(h.TEXTURE_2D,this.texture),r!==h.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=h.LINEAR),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,r||e),this.filter=e),i!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class uc{constructor(e,i,r,u=1,h=1,c=1,_=0){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(r&&!["mapbox","terrarium","custom"].includes(r))return void Qi(`"${r}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const y=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),r){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=u,this.greenFactor=h,this.blueFactor=c,this.baseShift=_;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<y;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(y,k)]=this.data[this._idx(y-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,y)]=this.data[this._idx(k,y-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(y,-1)]=this.data[this._idx(y-1,0)],this.data[this._idx(-1,y)]=this.data[this._idx(0,y-1)],this.data[this._idx(y,y)]=this.data[this._idx(y-1,y-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<y;k++)for(let P=0;P<y;P++){const E=this.get(k,P);E>this.max&&(this.max=E),E<this.min&&(this.min=E)}}get(e,i){const r=new Uint8Array(this.data.buffer),u=4*this._idx(e,i);return this.unpack(r[u],r[u+1],r[u+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${e}, y: ${i}, dim: ${this.dim}`);return(i+1)*this.stride+(e+1)}unpack(e,i,r){return e*this.redFactor+i*this.greenFactor+r*this.blueFactor-this.baseShift}pack(e){return dc(e,this.getUnpackVector())}getPixels(){return new ma({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,h=i*this.dim+this.dim,c=r*this.dim,_=r*this.dim+this.dim;switch(i){case-1:u=h-1;break;case 1:h=u+1}switch(r){case-1:c=_-1;break;case 1:_=c+1}const y=-i*this.dim,k=-r*this.dim;for(let P=c;P<_;P++)for(let E=u;E<h;E++)this.data[this._idx(E,P)]=e.data[this._idx(E+y,P+k)]}}function dc(n,e){const i=e[0],r=e[1],u=e[2],h=e[3],c=Math.min(i,r,u),_=Math.round((n+h)/c);return{r:Math.floor(_*c/i)%256,g:Math.floor(_*c/r)%256,b:Math.floor(_*c/u)%256}}ot("DEMData",uc);class zm extends Ma{constructor(e,i){super(e,Em,i)}_createColorRamp(e){const i={elevationStops:[],colorStops:[]},r=this._transitionablePaint._values["color-relief-color"].value.expression;if(r instanceof m&&r._styleExpression.expression instanceof Ci){this.colorRampExpression=r;const c=r._styleExpression.expression;i.elevationStops=c.labels,i.colorStops=[];for(const _ of i.elevationStops)i.colorStops.push(c.evaluate({globals:{elevation:_}}))}if(i.elevationStops.length<1&&(i.elevationStops=[0],i.colorStops=[Lt.transparent]),i.elevationStops.length<2&&(i.elevationStops.push(i.elevationStops[0]+1),i.colorStops.push(i.colorStops[0])),i.elevationStops.length<=e)return i;const u={elevationStops:[],colorStops:[]},h=(i.elevationStops.length-1)/(e-1);for(let c=0;c<i.elevationStops.length-.5;c+=h)u.elevationStops.push(i.elevationStops[Math.round(c)]),u.colorStops.push(i.colorStops[Math.round(c)]);return Qi(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${i.elevationStops.length}`),u}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,i,r){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const u=this._createColorRamp(i),h=new ma({width:u.colorStops.length,height:1}),c=new ma({width:u.colorStops.length,height:1});for(let _=0;_<u.elevationStops.length;_++){const y=dc(u.elevationStops[_],r);c.setPixel(0,_,new Lt(y.r/255,y.g/255,y.b/255,1)),h.setPixel(0,_,u.colorStops[_])}return this.colorRampTextures={elevationTexture:new rh(e,c,e.gl.RGBA),colorTexture:new rh(e,h,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const Im=Gi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Dm}=Im;function xd(n,e,i){const r=i.patternDependencies;let u=!1;for(const h of e){const c=h.paint.get(`${n}-pattern`);c.isConstant()||(u=!0);const _=c.constantOr(null);_&&(u=!0,r[_.to]=!0,r[_.from]=!0)}return u}function oh(n,e,i,r,u){const{zoom:h}=r,c=u.patternDependencies;for(const _ of e){const y=_.paint.get(`${n}-pattern`).value;if(y.kind!=="constant"){let k=y.evaluate({zoom:h-1},i,{},u.availableImages),P=y.evaluate({zoom:h},i,{},u.availableImages),E=y.evaluate({zoom:h+1},i,{},u.availableImages);k=k&&k.name?k.name:k,P=P&&P.name?P.name:P,E=E&&E.name?E.name:E,c[k]=!0,c[P]=!0,c[E]=!0,i.patterns[_.id]={min:k,mid:P,max:E}}}return i}function hc(n,e,i,r,u){let h;if(u===(function(c,_,y,k){let P=0;for(let E=_,D=y-k;E<y;E+=k)P+=(c[D]-c[E])*(c[E+1]+c[D+1]),D=E;return P})(n,e,i,r)>0)for(let c=e;c<i;c+=r)h=pc(c/r|0,n[c],n[c+1],h);else for(let c=i-r;c>=e;c-=r)h=pc(c/r|0,n[c],n[c+1],h);return h&&Vl(h,h.next)&&(Ru(h),h=h.next),h}function Ws(n,e){if(!n)return n;e||(e=n);let i,r=n;do if(i=!1,r.steiner||!Vl(r,r.next)&&Yi(r.prev,r,r.next)!==0)r=r.next;else{if(Ru(r),r=e=r.prev,r===r.next)break;i=!0}while(i||r!==e);return e}function Iu(n,e,i,r,u,h,c){if(!n)return;!c&&h&&(function(y,k,P,E){let D=y;do D.z===0&&(D.z=sh(D.x,D.y,k,P,E)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==y);D.prevZ.nextZ=null,D.prevZ=null,(function(A){let O,$=1;do{let N,H=A;A=null;let ne=null;for(O=0;H;){O++;let K=H,J=0;for(let de=0;de<$&&(J++,K=K.nextZ,K);de++);let oe=$;for(;J>0||oe>0&&K;)J!==0&&(oe===0||!K||H.z<=K.z)?(N=H,H=H.nextZ,J--):(N=K,K=K.nextZ,oe--),ne?ne.nextZ=N:A=N,N.prevZ=ne,ne=N;H=K}ne.nextZ=null,$*=2}while(O>1)})(D)})(n,r,u,h);let _=n;for(;n.prev!==n.next;){const y=n.prev,k=n.next;if(h?Rm(n,r,u,h):Am(n))e.push(y.i,n.i,k.i),Ru(n),n=k.next,_=k.next;else if((n=k)===_){c?c===1?Iu(n=jm(Ws(n),e),e,i,r,u,h,2):c===2&&Fm(n,e,i,r,u,h):Iu(Ws(n),e,i,r,u,h,1);break}}}function Am(n){const e=n.prev,i=n,r=n.next;if(Yi(e,i,r)>=0)return!1;const u=e.x,h=i.x,c=r.x,_=e.y,y=i.y,k=r.y,P=Math.min(u,h,c),E=Math.min(_,y,k),D=Math.max(u,h,c),A=Math.max(_,y,k);let O=r.next;for(;O!==e;){if(O.x>=P&&O.x<=D&&O.y>=E&&O.y<=A&&Du(u,_,h,y,c,k,O.x,O.y)&&Yi(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function Rm(n,e,i,r){const u=n.prev,h=n,c=n.next;if(Yi(u,h,c)>=0)return!1;const _=u.x,y=h.x,k=c.x,P=u.y,E=h.y,D=c.y,A=Math.min(_,y,k),O=Math.min(P,E,D),$=Math.max(_,y,k),N=Math.max(P,E,D),H=sh(A,O,e,i,r),ne=sh($,N,e,i,r);let K=n.prevZ,J=n.nextZ;for(;K&&K.z>=H&&J&&J.z<=ne;){if(K.x>=A&&K.x<=$&&K.y>=O&&K.y<=N&&K!==u&&K!==c&&Du(_,P,y,E,k,D,K.x,K.y)&&Yi(K.prev,K,K.next)>=0||(K=K.prevZ,J.x>=A&&J.x<=$&&J.y>=O&&J.y<=N&&J!==u&&J!==c&&Du(_,P,y,E,k,D,J.x,J.y)&&Yi(J.prev,J,J.next)>=0))return!1;J=J.nextZ}for(;K&&K.z>=H;){if(K.x>=A&&K.x<=$&&K.y>=O&&K.y<=N&&K!==u&&K!==c&&Du(_,P,y,E,k,D,K.x,K.y)&&Yi(K.prev,K,K.next)>=0)return!1;K=K.prevZ}for(;J&&J.z<=ne;){if(J.x>=A&&J.x<=$&&J.y>=O&&J.y<=N&&J!==u&&J!==c&&Du(_,P,y,E,k,D,J.x,J.y)&&Yi(J.prev,J,J.next)>=0)return!1;J=J.nextZ}return!0}function jm(n,e){let i=n;do{const r=i.prev,u=i.next.next;!Vl(r,u)&&fc(r,i,i.next,u)&&Au(r,u)&&Au(u,r)&&(e.push(r.i,i.i,u.i),Ru(i),Ru(i.next),i=n=u),i=i.next}while(i!==n);return Ws(i)}function Fm(n,e,i,r,u,h){let c=n;do{let _=c.next.next;for(;_!==c.prev;){if(c.i!==_.i&&Nm(c,_)){let y=mc(c,_);return c=Ws(c,c.next),y=Ws(y,y.next),Iu(c,e,i,r,u,h,0),void Iu(y,e,i,r,u,h,0)}_=_.next}c=c.next}while(c!==n)}function Bm(n,e){let i=n.x-e.x;return i===0&&(i=n.y-e.y,i===0)&&(i=(n.next.y-n.y)/(n.next.x-n.x)-(e.next.y-e.y)/(e.next.x-e.x)),i}function Om(n,e){const i=(function(u,h){let c=h;const _=u.x,y=u.y;let k,P=-1/0;if(Vl(u,c))return c;do{if(Vl(u,c.next))return c.next;if(y<=c.y&&y>=c.next.y&&c.next.y!==c.y){const $=c.x+(y-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if($<=_&&$>P&&(P=$,k=c.x<c.next.x?c:c.next,$===_))return k}c=c.next}while(c!==h);if(!k)return null;const E=k,D=k.x,A=k.y;let O=1/0;c=k;do{if(_>=c.x&&c.x>=D&&_!==c.x&&cc(y<A?_:P,y,D,A,y<A?P:_,y,c.x,c.y)){const $=Math.abs(y-c.y)/(_-c.x);Au(c,u)&&($<O||$===O&&(c.x>k.x||c.x===k.x&&$m(k,c)))&&(k=c,O=$)}c=c.next}while(c!==E);return k})(n,e);if(!i)return e;const r=mc(i,n);return Ws(r,r.next),Ws(i,i.next)}function $m(n,e){return Yi(n.prev,n,e.prev)<0&&Yi(e.next,n,n.next)<0}function sh(n,e,i,r,u){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*u|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Vm(n){let e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function cc(n,e,i,r,u,h,c,_){return(u-c)*(e-_)>=(n-c)*(h-_)&&(n-c)*(r-_)>=(i-c)*(e-_)&&(i-c)*(h-_)>=(u-c)*(r-_)}function Du(n,e,i,r,u,h,c,_){return!(n===c&&e===_)&&cc(n,e,i,r,u,h,c,_)}function Nm(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!(function(i,r){let u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==r.i&&u.next.i!==r.i&&fc(u,u.next,i,r))return!0;u=u.next}while(u!==i);return!1})(n,e)&&(Au(n,e)&&Au(e,n)&&(function(i,r){let u=i,h=!1;const c=(i.x+r.x)/2,_=(i.y+r.y)/2;do u.y>_!=u.next.y>_&&u.next.y!==u.y&&c<(u.next.x-u.x)*(_-u.y)/(u.next.y-u.y)+u.x&&(h=!h),u=u.next;while(u!==i);return h})(n,e)&&(Yi(n.prev,n,e.prev)||Yi(n,e.prev,e))||Vl(n,e)&&Yi(n.prev,n,n.next)>0&&Yi(e.prev,e,e.next)>0)}function Yi(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function Vl(n,e){return n.x===e.x&&n.y===e.y}function fc(n,e,i,r){const u=bd(Yi(n,e,i)),h=bd(Yi(n,e,r)),c=bd(Yi(i,r,n)),_=bd(Yi(i,r,e));return u!==h&&c!==_||!(u!==0||!wd(n,i,e))||!(h!==0||!wd(n,r,e))||!(c!==0||!wd(i,n,r))||!(_!==0||!wd(i,e,r))}function wd(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function bd(n){return n>0?1:n<0?-1:0}function Au(n,e){return Yi(n.prev,n,n.next)<0?Yi(n,e,n.next)>=0&&Yi(n,n.prev,e)>=0:Yi(n,e,n.prev)<0||Yi(n,n.next,e)<0}function mc(n,e){const i=lh(n.i,n.x,n.y),r=lh(e.i,e.x,e.y),u=n.next,h=e.prev;return n.next=e,e.prev=n,i.next=u,u.prev=i,r.next=i,i.prev=r,h.next=r,r.prev=h,r}function pc(n,e,i,r){const u=lh(n,e,i);return r?(u.next=r.next,u.prev=r,r.next.prev=u,r.next=u):(u.prev=u,u.next=u),u}function Ru(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function lh(n,e,i){return{i:n,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Nl{constructor(e,i){if(i>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=i}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class kd{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}kd.noSubdivision=new kd({fill:new Nl(0,0),line:new Nl(0,0),tile:new Nl(0,0),stencil:new Nl(0,0),circle:1}),ot("SubdivisionGranularityExpression",Nl),ot("SubdivisionGranularitySetting",kd);const Ul=-32768,ju=32767;class Um{constructor(e,i){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=$t/e,this._canonical=i}_getKey(e,i){return(e+=32768)<<16|i+32768}_vertexToIndex(e,i){if(e<-32768||i<-32768||e>32767||i>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const r=0|Math.round(e),u=0|Math.round(i),h=this._getKey(r,u);if(this._vertexDictionary.has(h))return this._vertexDictionary.get(h);const c=this._vertexBuffer.length/2;return this._vertexDictionary.set(h,c),this._vertexBuffer.push(r,u),c}_subdivideTrianglesScanline(e){if(this._granularity<2)return(function(u,h){const c=[];for(let _=0;_<h.length;_+=3){const y=h[_],k=h[_+1],P=h[_+2],E=u[2*y],D=u[2*y+1];(u[2*k]-E)*(u[2*P+1]-D)-(u[2*k+1]-D)*(u[2*P]-E)>0?(c.push(y),c.push(P),c.push(k)):(c.push(y),c.push(k),c.push(P))}return c})(this._vertexBuffer,e);const i=[],r=e.length;for(let u=0;u<r;u+=3){const h=[e[u+0],e[u+1],e[u+2]],c=[this._vertexBuffer[2*e[u+0]+0],this._vertexBuffer[2*e[u+0]+1],this._vertexBuffer[2*e[u+1]+0],this._vertexBuffer[2*e[u+1]+1],this._vertexBuffer[2*e[u+2]+0],this._vertexBuffer[2*e[u+2]+1]];let _=1/0,y=1/0,k=-1/0,P=-1/0;for(let $=0;$<3;$++){const N=c[2*$],H=c[2*$+1];_=Math.min(_,N),k=Math.max(k,N),y=Math.min(y,H),P=Math.max(P,H)}if(_===k||y===P)continue;const E=Math.floor(_/this._granularityCellSize),D=Math.ceil(k/this._granularityCellSize),A=Math.floor(y/this._granularityCellSize),O=Math.ceil(P/this._granularityCellSize);if(E!==D||A!==O)for(let $=A;$<O;$++){const N=this._scanlineGenerateVertexRingForCellRow($,c,h);Gm(this._vertexBuffer,N,i)}else i.push(...h)}return i}_scanlineGenerateVertexRingForCellRow(e,i,r){const u=e*this._granularityCellSize,h=u+this._granularityCellSize,c=[];for(let _=0;_<3;_++){const y=i[2*_],k=i[2*_+1],P=i[2*(_+1)%6],E=i[(2*(_+1)+1)%6],D=i[2*(_+2)%6],A=i[(2*(_+2)+1)%6],O=P-y,$=E-k,N=O===0,H=$===0,ne=(u-k)/$,K=(h-k)/$,J=Math.min(ne,K),oe=Math.max(ne,K);if(!H&&(J>=1||oe<=0)||H&&(k<u||k>h)){E>=u&&E<=h&&c.push(r[(_+1)%3]);continue}!H&&J>0&&c.push(this._vertexToIndex(y+O*J,k+$*J));const de=y+O*Math.max(J,0),we=y+O*Math.min(oe,1);N||this._generateIntraEdgeVertices(c,y,k,P,E,de,we),!H&&oe<1&&c.push(this._vertexToIndex(y+O*oe,k+$*oe)),(H||E>=u&&E<=h)&&c.push(r[(_+1)%3]),!H&&(E<=u||E>=h)&&this._generateInterEdgeVertices(c,y,k,P,E,D,A,we,u,h)}return c}_generateIntraEdgeVertices(e,i,r,u,h,c,_){const y=u-i,k=h-r,P=k===0,E=P?Math.min(i,u):Math.min(c,_),D=P?Math.max(i,u):Math.max(c,_),A=Math.floor(E/this._granularityCellSize)+1,O=Math.ceil(D/this._granularityCellSize)-1;if(P?i<u:c<_)for(let $=A;$<=O;$++){const N=$*this._granularityCellSize;e.push(this._vertexToIndex(N,r+k*(N-i)/y))}else for(let $=O;$>=A;$--){const N=$*this._granularityCellSize;e.push(this._vertexToIndex(N,r+k*(N-i)/y))}}_generateInterEdgeVertices(e,i,r,u,h,c,_,y,k,P){const E=h-r,D=c-u,A=_-h,O=(k-h)/A,$=(P-h)/A,N=Math.min(O,$),H=Math.max(O,$),ne=u+D*N;let K=Math.floor(Math.min(ne,y)/this._granularityCellSize)+1,J=Math.ceil(Math.max(ne,y)/this._granularityCellSize)-1,oe=y<ne;const de=A===0;if(de&&(_===k||_===P))return;if(de||N>=1||H<=0){const Ve=r-_,je=c+(i-c)*Math.min((k-_)/Ve,(P-_)/Ve);K=Math.floor(Math.min(je,y)/this._granularityCellSize)+1,J=Math.ceil(Math.max(je,y)/this._granularityCellSize)-1,oe=y<je}const we=E>0?P:k;if(oe)for(let Ve=K;Ve<=J;Ve++)e.push(this._vertexToIndex(Ve*this._granularityCellSize,we));else for(let Ve=J;Ve>=K;Ve--)e.push(this._vertexToIndex(Ve*this._granularityCellSize,we))}_generateOutline(e){const i=[];for(const r of e){const u=Ks(r,this._granularity,!0),h=this._pointArrayToIndices(u),c=[];for(let _=1;_<h.length;_++)c.push(h[_-1]),c.push(h[_]);i.push(c)}return i}_handlePoles(e){let i=!1,r=!1;this._canonical&&(this._canonical.y===0&&(i=!0),this._canonical.y===(1<<this._canonical.z)-1&&(r=!0)),(i||r)&&this._fillPoles(e,i,r)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let i=0;i<e.length;i+=2){const r=e[i+1];r===Ul&&(e[i+1]=-32767),r===ju&&(e[i+1]=32766)}}_generatePoleQuad(e,i,r,u,h,c){u>h!=(c===Ul)?(e.push(i),e.push(r),e.push(this._vertexToIndex(u,c)),e.push(r),e.push(this._vertexToIndex(h,c)),e.push(this._vertexToIndex(u,c))):(e.push(r),e.push(i),e.push(this._vertexToIndex(u,c)),e.push(this._vertexToIndex(h,c)),e.push(r),e.push(this._vertexToIndex(u,c)))}_fillPoles(e,i,r){const u=this._vertexBuffer,h=$t,c=e.length;for(let _=2;_<c;_+=3){const y=e[_-2],k=e[_-1],P=e[_],E=u[2*y],D=u[2*y+1],A=u[2*k],O=u[2*k+1],$=u[2*P],N=u[2*P+1];i&&(D===0&&O===0&&this._generatePoleQuad(e,y,k,E,A,Ul),O===0&&N===0&&this._generatePoleQuad(e,k,P,A,$,Ul),N===0&&D===0&&this._generatePoleQuad(e,P,y,$,E,Ul)),r&&(D===h&&O===h&&this._generatePoleQuad(e,y,k,E,A,ju),O===h&&N===h&&this._generatePoleQuad(e,k,P,A,$,ju),N===h&&D===h&&this._generatePoleQuad(e,P,y,$,E,ju))}}_initializeVertices(e){for(let i=0;i<e.length;i+=2)this._vertexToIndex(e[i],e[i+1])}subdividePolygonInternal(e,i){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:r,holeIndices:u}=(function(_){const y=[],k=[];for(const P of _)if(P.length!==0){P!==_[0]&&y.push(k.length/2);for(let E=0;E<P.length;E++)k.push(P[E].x),k.push(P[E].y)}return{flattened:k,holeIndices:y}})(e);let h;this._initializeVertices(r);try{const _=(function(k,P,E=2){const D=P&&P.length,A=D?P[0]*E:k.length;let O=hc(k,0,A,E,!0);const $=[];if(!O||O.next===O.prev)return $;let N,H,ne;if(D&&(O=(function(K,J,oe,de){const we=[];for(let Ve=0,je=J.length;Ve<je;Ve++){const Ne=hc(K,J[Ve]*de,Ve<je-1?J[Ve+1]*de:K.length,de,!1);Ne===Ne.next&&(Ne.steiner=!0),we.push(Vm(Ne))}we.sort(Bm);for(let Ve=0;Ve<we.length;Ve++)oe=Om(we[Ve],oe);return oe})(k,P,O,E)),k.length>80*E){N=k[0],H=k[1];let K=N,J=H;for(let oe=E;oe<A;oe+=E){const de=k[oe],we=k[oe+1];de<N&&(N=de),we<H&&(H=we),de>K&&(K=de),we>J&&(J=we)}ne=Math.max(K-N,J-H),ne=ne!==0?32767/ne:0}return Iu(O,$,E,N,H,ne,0),$})(r,u),y=this._convertIndices(r,_);h=this._subdivideTrianglesScanline(y)}catch(_){console.error(_)}let c=[];return i&&(c=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(h),{verticesFlattened:this._vertexBuffer,indicesTriangles:h,indicesLineList:c}}_convertIndices(e,i){const r=[];for(let u=0;u<i.length;u++)r.push(this._vertexToIndex(e[2*i[u]],e[2*i[u]+1]));return r}_pointArrayToIndices(e){const i=[];for(let r=0;r<e.length;r++){const u=e[r];i.push(this._vertexToIndex(u.x,u.y))}return i}}function _c(n,e,i,r=!0){return new Um(i,e).subdividePolygonInternal(n,r)}function Ks(n,e,i=!1){if(!n||n.length<1)return[];if(n.length<2)return[];const r=n[0],u=n[n.length-1],h=i&&(r.x!==u.x||r.y!==u.y);if(e<2)return h?[...n,n[0]]:[...n];const c=Math.floor($t/e),_=[];_.push(new I(n[0].x,n[0].y));const y=n.length,k=h?y:y-1;for(let P=0;P<k;P++){const E=n[P],D=P<y-1?n[P+1]:n[0],A=E.x,O=E.y,$=D.x,N=D.y,H=A!==$,ne=O!==N;if(!H&&!ne)continue;const K=$-A,J=N-O,oe=Math.abs(K),de=Math.abs(J);let we=A,Ve=O;for(;;){const Ne=K>0?(Math.floor(we/c)+1)*c:(Math.ceil(we/c)-1)*c,Ye=J>0?(Math.floor(Ve/c)+1)*c:(Math.ceil(Ve/c)-1)*c,qe=Math.abs(we-Ne),Be=Math.abs(Ve-Ye),ze=Math.abs(we-$),at=Math.abs(Ve-N),tt=H?qe/oe:Number.POSITIVE_INFINITY,lt=ne?Be/de:Number.POSITIVE_INFINITY;if((ze<=qe||!H)&&(at<=Be||!ne))break;if(tt<lt&&H||!ne){we=Ne,Ve+=J*tt;const et=new I(we,Math.round(Ve));_[_.length-1].x===et.x&&_[_.length-1].y===et.y||_.push(et)}else{we+=K*lt,Ve=Ye;const et=new I(Math.round(we),Ve);_[_.length-1].x===et.x&&_[_.length-1].y===et.y||_.push(et)}}const je=new I($,N);_[_.length-1].x===je.x&&_[_.length-1].y===je.y||_.push(je)}return _}function Gm(n,e,i){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let r=0,u=n[2*e[0]];for(let y=1;y<e.length;y++){const k=n[2*e[y]];k<u&&(u=k,r=y)}const h=e.length;let c=r,_=(c+1)%h;for(;;){const y=c-1>=0?c-1:h-1,k=(_+1)%h,P=n[2*e[y]],E=n[2*e[k]],D=n[2*e[c]],A=n[2*e[c]+1],O=n[2*e[_]+1];let $=!1;if(P<E)$=!0;else if(P>E)$=!1;else{const N=O-A,H=-(n[2*e[_]]-D),ne=A<O?1:-1;((P-D)*N+(n[2*e[y]+1]-A)*H)*ne>((E-D)*N+(n[2*e[k]+1]-A)*H)*ne&&($=!0)}if($){const N=e[y],H=e[c],ne=e[_];N!==H&&N!==ne&&H!==ne&&i.push(ne,H,N),c--,c<0&&(c=h-1)}else{const N=e[k],H=e[c],ne=e[_];N!==H&&N!==ne&&H!==ne&&i.push(ne,H,N),_++,_>=h&&(_=0)}if(y===k)break}}function gc(n,e,i,r,u,h,c,_,y){const k=u.length/2,P=c&&_&&y;if(k<Je.MAX_VERTEX_ARRAY_LENGTH){const E=e.prepareSegment(k,i,r),D=E.vertexLength;for(let $=0;$<h.length;$+=3)r.emplaceBack(D+h[$],D+h[$+1],D+h[$+2]);let A,O;E.vertexLength+=k,E.primitiveLength+=h.length/3,P&&(O=c.prepareSegment(k,i,_),A=O.vertexLength,O.vertexLength+=k);for(let $=0;$<u.length;$+=2)n(u[$],u[$+1]);if(P)for(let $=0;$<y.length;$++){const N=y[$];for(let H=1;H<N.length;H+=2)_.emplaceBack(A+N[H-1],A+N[H]);O.primitiveLength+=N.length/2}}else(function(E,D,A,O,$,N){const H=[];for(let de=0;de<O.length/2;de++)H.push(-1);const ne={count:0};let K=0,J=E.getOrCreateLatestSegment(D,A),oe=J.vertexLength;for(let de=2;de<$.length;de+=3){const we=$[de-2],Ve=$[de-1],je=$[de];let Ne=H[we]<K,Ye=H[Ve]<K,qe=H[je]<K;J.vertexLength+((Ne?1:0)+(Ye?1:0)+(qe?1:0))>Je.MAX_VERTEX_ARRAY_LENGTH&&(J=E.createNewSegment(D,A),K=ne.count,Ne=!0,Ye=!0,qe=!0,oe=0);const Be=Fu(H,O,N,ne,we,Ne,J),ze=Fu(H,O,N,ne,Ve,Ye,J),at=Fu(H,O,N,ne,je,qe,J);A.emplaceBack(oe+Be-K,oe+ze-K,oe+at-K),J.primitiveLength++}})(e,i,r,u,h,n),P&&(function(E,D,A,O,$,N){const H=[];for(let de=0;de<O.length/2;de++)H.push(-1);const ne={count:0};let K=0,J=E.getOrCreateLatestSegment(D,A),oe=J.vertexLength;for(let de=0;de<$.length;de++){const we=$[de];for(let Ve=1;Ve<$[de].length;Ve+=2){const je=we[Ve-1],Ne=we[Ve];let Ye=H[je]<K,qe=H[Ne]<K;J.vertexLength+((Ye?1:0)+(qe?1:0))>Je.MAX_VERTEX_ARRAY_LENGTH&&(J=E.createNewSegment(D,A),K=ne.count,Ye=!0,qe=!0,oe=0);const Be=Fu(H,O,N,ne,je,Ye,J),ze=Fu(H,O,N,ne,Ne,qe,J);A.emplaceBack(oe+Be-K,oe+ze-K),J.primitiveLength++}}})(c,i,_,u,y,n),e.forceNewSegmentOnNextPrepare(),c?.forceNewSegmentOnNextPrepare()}function Fu(n,e,i,r,u,h,c){if(h){const _=r.count;return i(e[2*u],e[2*u+1]),n[u]=r.count,r.count++,c.vertexLength++,_}return n[u]}class uh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new ee,this.indexArray=new Ce,this.indexArray2=new Ke,this.programConfigurations=new Uo(e.layers,e.zoom),this.segments=new Je,this.segments2=new Je,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,r){this.hasDependencies=xd("fill",this.layers,i);const u=this.layers[0].layout.get("fill-sort-key"),h=!u.isConstant(),c=[];for(const{feature:_,id:y,index:k,sourceLayerIndex:P}of e){const E=this.layers[0]._featureFilter.needGeometry,D=go(_,E);if(!this.layers[0]._featureFilter.filter(new oi(this.zoom),D,r))continue;const A=h?u.evaluate(D,{},r,i.availableImages):void 0,O={id:y,properties:_.properties,type:_.type,sourceLayerIndex:P,index:k,geometry:E?D.geometry:_o(_),patterns:{},sortKey:A};c.push(O)}h&&c.sort(((_,y)=>_.sortKey-y.sortKey));for(const _ of c){const{geometry:y,index:k,sourceLayerIndex:P}=_;if(this.hasDependencies){const E=oh("fill",this.layers,_,{zoom:this.zoom},i);this.patternFeatures.push(E)}else this.addFeature(_,y,k,r,{},i.subdivisionGranularity);i.featureIndex.insert(e[k].feature,y,k,P,this.index)}}update(e,i,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:r})}addFeatures(e,i,r){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,i,r,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Dm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,r,u,h,c){for(const _ of Qr(i,500)){const y=_c(_,u,c.fill.getGranularityForZoomLevel(u.z)),k=this.layoutVertexArray;gc(((P,E)=>{k.emplaceBack(P,E)}),this.segments,this.layoutVertexArray,this.indexArray,y.verticesFlattened,y.indicesTriangles,this.segments2,this.indexArray2,y.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:h,canonical:u})}}let yc,vc;ot("FillBucket",uh,{omit:["layers","patternFeatures"]});var qm={get paint(){return vc=vc||new Xn({"fill-antialias":new ht(Se.paint_fill["fill-antialias"]),"fill-opacity":new ft(Se.paint_fill["fill-opacity"]),"fill-color":new ft(Se.paint_fill["fill-color"]),"fill-outline-color":new ft(Se.paint_fill["fill-outline-color"]),"fill-translate":new ht(Se.paint_fill["fill-translate"]),"fill-translate-anchor":new ht(Se.paint_fill["fill-translate-anchor"]),"fill-pattern":new $s(Se.paint_fill["fill-pattern"])})},get layout(){return yc=yc||new Xn({"fill-sort-key":new ft(Se.layout_fill["fill-sort-key"])})}};class Zm extends Ma{constructor(e,i){super(e,qm,i)}recalculate(e,i){super.recalculate(e,i);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new uh(e)}queryRadius(){return yd(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:i,transform:r,pixelsToTileUnits:u}){return Yh(vd(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-r.bearingInRadians,u),i)}isTileClipped(){return!0}}const Hm=Gi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Wm=Gi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Km}=Hm;class Bu{constructor(e,i,r,u,h){this.properties={},this.extent=r,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=h,e.readFields(Xm,this,i)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos,r=[];let u,h=1,c=0,_=0,y=0;for(;e.pos<i;){if(c<=0){const k=e.readVarint();h=7&k,c=k>>3}if(c--,h===1||h===2)_+=e.readSVarint(),y+=e.readSVarint(),h===1&&(u&&r.push(u),u=[]),u&&u.push(new I(_,y));else{if(h!==7)throw new Error(`unknown command ${h}`);u&&u.push(u[0].clone())}}return u&&r.push(u),r}bbox(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos;let r=1,u=0,h=0,c=0,_=1/0,y=-1/0,k=1/0,P=-1/0;for(;e.pos<i;){if(u<=0){const E=e.readVarint();r=7&E,u=E>>3}if(u--,r===1||r===2)h+=e.readSVarint(),c+=e.readSVarint(),h<_&&(_=h),h>y&&(y=h),c<k&&(k=c),c>P&&(P=c);else if(r!==7)throw new Error(`unknown command ${r}`)}return[_,k,y,P]}toGeoJSON(e,i,r){const u=this.extent*Math.pow(2,r),h=this.extent*e,c=this.extent*i,_=this.loadGeometry();function y(D){return[360*(D.x+h)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(D.y+c)/u)*Math.PI))-90]}function k(D){return D.map(y)}let P;if(this.type===1){const D=[];for(const O of _)D.push(O[0]);const A=k(D);P=D.length===1?{type:"Point",coordinates:A[0]}:{type:"MultiPoint",coordinates:A}}else if(this.type===2){const D=_.map(k);P=D.length===1?{type:"LineString",coordinates:D[0]}:{type:"MultiLineString",coordinates:D}}else{if(this.type!==3)throw new Error("unknown feature type");{const D=xc(_),A=[];for(const O of D)A.push(O.map(k));P=A.length===1?{type:"Polygon",coordinates:A[0]}:{type:"MultiPolygon",coordinates:A}}}const E={type:"Feature",geometry:P,properties:this.properties};return this.id!=null&&(E.id=this.id),E}}function Xm(n,e,i){n===1?e.id=i.readVarint():n===2?(function(r,u){const h=r.readVarint()+r.pos;for(;r.pos<h;){const c=u._keys[r.readVarint()],_=u._values[r.readVarint()];u.properties[c]=_}})(i,e):n===3?e.type=i.readVarint():n===4&&(e._geometry=i.pos)}function xc(n){const e=n.length;if(e<=1)return[n];const i=[];let r,u;for(let h=0;h<e;h++){const c=Ym(n[h]);c!==0&&(u===void 0&&(u=c<0),u===c<0?(r&&i.push(r),r=[n[h]]):r&&r.push(n[h]))}return r&&i.push(r),i}function Ym(n){let e=0;for(let i,r,u=0,h=n.length,c=h-1;u<h;c=u++)i=n[u],r=n[c],e+=(r.x-i.x)*(i.y+r.y);return e}Bu.types=["Unknown","Point","LineString","Polygon"];class Jm{constructor(e,i){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Qm,this,i),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const i=this._pbf.readVarint()+this._pbf.pos;return new Bu(this._pbf,i,this.extent,this._keys,this._values)}}function Qm(n,e,i){n===15?e.version=i.readVarint():n===1?e.name=i.readString():n===5?e.extent=i.readVarint():n===2?e._features.push(i.pos):n===3?e._keys.push(i.readString()):n===4&&e._values.push((function(r){let u=null;const h=r.readVarint()+r.pos;for(;r.pos<h;){const c=r.readVarint()>>3;u=c===1?r.readString():c===2?r.readFloat():c===3?r.readDouble():c===4?r.readVarint64():c===5?r.readVarint():c===6?r.readSVarint():c===7?r.readBoolean():null}if(u==null)throw new Error("unknown feature value");return u})(i))}class wc{constructor(e,i){this.layers=e.readFields(ep,{},i)}}function ep(n,e,i){if(n===3){const r=new Jm(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r)}}const dh=Math.pow(2,13);function Ou(n,e,i,r,u,h,c,_){n.emplaceBack(e,i,2*Math.floor(r*dh)+c,u*dh*2,h*dh*2,Math.round(_))}class hh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new ae,this.centroidVertexArray=new Q,this.indexArray=new Ce,this.programConfigurations=new Uo(e.layers,e.zoom),this.segments=new Je,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,r){this.features=[],this.hasDependencies=xd("fill-extrusion",this.layers,i);for(const{feature:u,id:h,index:c,sourceLayerIndex:_}of e){const y=this.layers[0]._featureFilter.needGeometry,k=go(u,y);if(!this.layers[0]._featureFilter.filter(new oi(this.zoom),k,r))continue;const P={id:h,sourceLayerIndex:_,index:c,geometry:y?k.geometry:_o(u),properties:u.properties,type:u.type,patterns:{}};this.hasDependencies?this.features.push(oh("fill-extrusion",this.layers,P,{zoom:this.zoom},i)):this.addFeature(P,P.geometry,c,r,{},i.subdivisionGranularity),i.featureIndex.insert(u,P.geometry,c,_,this.index,!0)}}addFeatures(e,i,r){for(const u of this.features){const{geometry:h}=u;this.addFeature(u,h,u.index,i,r,e.subdivisionGranularity)}}update(e,i,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:r})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Km),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Wm.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,i,r,u,h,c){for(const _ of Qr(i,500)){const y={x:0,y:0,sampleCount:0},k=this.layoutVertexArray.length;this.processPolygon(y,u,e,_,c);const P=this.layoutVertexArray.length-k,E=Math.floor(y.x/y.sampleCount),D=Math.floor(y.y/y.sampleCount);for(let A=0;A<P;A++)this.centroidVertexArray.emplaceBack(E,D)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:h,canonical:u})}processPolygon(e,i,r,u,h){if(u.length<1||bc(u[0]))return;for(const E of u)E.length!==0&&tp(e,E);const c={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},_=h.fill.getGranularityForZoomLevel(i.z),y=Bu.types[r.type]==="Polygon";for(const E of u){if(E.length===0||bc(E))continue;const D=Ks(E,_,y);this._generateSideFaces(D,c)}if(!y)return;const k=_c(u,i,_,!1),P=this.layoutVertexArray;gc(((E,D)=>{Ou(P,E,D,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles)}_generateSideFaces(e,i){let r=0;for(let u=1;u<e.length;u++){const h=e[u],c=e[u-1];if(ip(h,c))continue;i.segment.vertexLength+4>Je.MAX_VERTEX_ARRAY_LENGTH&&(i.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const _=h.sub(c)._perp()._unit(),y=c.dist(h);r+y>32768&&(r=0),Ou(this.layoutVertexArray,h.x,h.y,_.x,_.y,0,0,r),Ou(this.layoutVertexArray,h.x,h.y,_.x,_.y,0,1,r),r+=y,Ou(this.layoutVertexArray,c.x,c.y,_.x,_.y,0,0,r),Ou(this.layoutVertexArray,c.x,c.y,_.x,_.y,0,1,r);const k=i.segment.vertexLength;this.indexArray.emplaceBack(k,k+2,k+1),this.indexArray.emplaceBack(k+1,k+2,k+3),i.segment.vertexLength+=4,i.segment.primitiveLength+=2}}}function tp(n,e){for(let i=0;i<e.length;i++){const r=e[i];i===e.length-1&&e[0].x===r.x&&e[0].y===r.y||(n.x+=r.x,n.y+=r.y,n.sampleCount++)}}function ip(n,e){return n.x===e.x&&(n.x<0||n.x>$t)||n.y===e.y&&(n.y<0||n.y>$t)}function bc(n){return n.every((e=>e.x<0))||n.every((e=>e.x>$t))||n.every((e=>e.y<0))||n.every((e=>e.y>$t))}let kc;ot("FillExtrusionBucket",hh,{omit:["layers","features"]});var np={get paint(){return kc=kc||new Xn({"fill-extrusion-opacity":new ht(Se["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ft(Se["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ht(Se["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ht(Se["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $s(Se["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ft(Se["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ft(Se["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ht(Se["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class ap extends Ma{constructor(e,i){super(e,np,i)}createBucket(e){return new hh(e)}queryRadius(){return yd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:r,geometry:u,transform:h,pixelsToTileUnits:c,pixelPosMatrix:_}){const y=vd(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-h.bearingInRadians,c),k=this.paint.get("fill-extrusion-height").evaluate(i,r),P=this.paint.get("fill-extrusion-base").evaluate(i,r),E=(function(A,O){const $=[];for(const N of A){const H=[N.x,N.y,0,1];bn(H,H,O),$.push(new I(H[0]/H[3],H[1]/H[3]))}return $})(y,_),D=(function(A,O,$,N){const H=[],ne=[],K=N[8]*O,J=N[9]*O,oe=N[10]*O,de=N[11]*O,we=N[8]*$,Ve=N[9]*$,je=N[10]*$,Ne=N[11]*$;for(const Ye of A){const qe=[],Be=[];for(const ze of Ye){const at=ze.x,tt=ze.y,lt=N[0]*at+N[4]*tt+N[12],et=N[1]*at+N[5]*tt+N[13],ct=N[2]*at+N[6]*tt+N[14],Nt=N[3]*at+N[7]*tt+N[15],At=ct+oe,Si=Nt+de,Vn=lt+we,en=et+Ve,Ti=ct+je,gi=Nt+Ne,Xt=new I((lt+K)/Si,(et+J)/Si);Xt.z=At/Si,qe.push(Xt);const $i=new I(Vn/gi,en/gi);$i.z=Ti/gi,Be.push($i)}H.push(qe),ne.push(Be)}return[H,ne]})(u,P,k,_);return(function(A,O,$){let N=1/0;Yh($,O)&&(N=Sc($,O[0]));for(let H=0;H<O.length;H++){const ne=O[H],K=A[H];for(let J=0;J<ne.length-1;J++){const oe=ne[J],de=[oe,ne[J+1],K[J+1],K[J],oe];Bl($,de)&&(N=Math.min(N,Sc($,de)))}}return N!==1/0&&N})(D[0],D[1],E)}}function $u(n,e){return n.x*e.x+n.y*e.y}function Sc(n,e){if(n.length===1){let i=0;const r=e[i++];let u;for(;!u||r.equals(u);)if(u=e[i++],!u)return 1/0;for(;i<e.length;i++){const h=e[i],c=n[0],_=u.sub(r),y=h.sub(r),k=c.sub(r),P=$u(_,_),E=$u(_,y),D=$u(y,y),A=$u(k,_),O=$u(k,y),$=P*D-E*E,N=(D*A-E*O)/$,H=(P*O-E*A)/$,ne=r.z*(1-N-H)+u.z*N+h.z*H;if(isFinite(ne))return ne}return 1/0}{let i=1/0;for(const r of e)i=Math.min(i,r.z);return i}}const rp=Gi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:op}=rp,sp=Gi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:lp}=sp,up=Math.cos(Math.PI/180*37.5),Tc=Math.pow(2,14)/.5;class ch{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((i=>{this.gradients[i.id]={}})),this.layoutVertexArray=new he,this.layoutVertexArray2=new ie,this.indexArray=new Ce,this.programConfigurations=new Uo(e.layers,e.zoom),this.segments=new Je,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,r){this.hasDependencies=xd("line",this.layers,i)||this.hasLineDasharray(this.layers);const u=this.layers[0].layout.get("line-sort-key"),h=!u.isConstant(),c=[];for(const{feature:_,id:y,index:k,sourceLayerIndex:P}of e){const E=this.layers[0]._featureFilter.needGeometry,D=go(_,E);if(!this.layers[0]._featureFilter.filter(new oi(this.zoom),D,r))continue;const A=h?u.evaluate(D,{},r):void 0,O={id:y,properties:_.properties,type:_.type,sourceLayerIndex:P,index:k,geometry:E?D.geometry:_o(_),patterns:{},dashes:{},sortKey:A};c.push(O)}h&&c.sort(((_,y)=>_.sortKey-y.sortKey));for(const _ of c){const{geometry:y,index:k,sourceLayerIndex:P}=_;this.hasDependencies?(xd("line",this.layers,i)?oh("line",this.layers,_,{zoom:this.zoom},i):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,_,this.zoom,i),this.patternFeatures.push(_)):this.addFeature(_,y,k,r,{},{},i.subdivisionGranularity),i.featureIndex.insert(e[k].feature,y,k,P,this.index)}}update(e,i,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:r,dashPositions:u})}addFeatures(e,i,r,u){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,i,r,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,lp)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,op),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,r,u,h,c,_){const y=this.layers[0].layout,k=y.get("line-join").evaluate(e,{}),P=y.get("line-cap"),E=y.get("line-miter-limit"),D=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const A of i)this.addLine(A,e,k,P,E,D,u,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:h,dashPositions:c,canonical:u})}addLine(e,i,r,u,h,c,_,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=Ks(e,_?y.line.getGranularityForZoomLevel(_.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let K=0;K<e.length-1;K++)this.totalDistance+=e[K].dist(e[K+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k=Bu.types[i.type]==="Polygon";let P=e.length;for(;P>=2&&e[P-1].equals(e[P-2]);)P--;let E=0;for(;E<P-1&&e[E].equals(e[E+1]);)E++;if(P<(k?3:2))return;r==="bevel"&&(h=1.05);const D=this.overscaling<=16?122880/(512*this.overscaling):0,A=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let O,$,N,H,ne;this.e1=this.e2=-1,k&&(O=e[P-2],ne=e[E].sub(O)._unit()._perp());for(let K=E;K<P;K++){if(N=K===P-1?k?e[E+1]:void 0:e[K+1],N&&e[K].equals(N))continue;ne&&(H=ne),O&&($=O),O=e[K],ne=N?N.sub(O)._unit()._perp():H,H=H||ne;let J=H.add(ne);J.x===0&&J.y===0||J._unit();const oe=H.x*ne.x+H.y*ne.y,de=J.x*ne.x+J.y*ne.y,we=de!==0?1/de:1/0,Ve=2*Math.sqrt(2-2*de),je=de<up&&$&&N,Ne=H.x*ne.y-H.y*ne.x>0;if(je&&K>E){const Be=O.dist($);if(Be>2*D){const ze=O.sub(O.sub($)._mult(D/Be)._round());this.updateDistance($,ze),this.addCurrentVertex(ze,H,0,0,A),$=ze}}const Ye=$&&N;let qe=Ye?r:k?"butt":u;if(Ye&&qe==="round"&&(we<c?qe="miter":we<=2&&(qe="fakeround")),qe==="miter"&&we>h&&(qe="bevel"),qe==="bevel"&&(we>2&&(qe="flipbevel"),we<h&&(qe="miter")),$&&this.updateDistance($,O),qe==="miter")J._mult(we),this.addCurrentVertex(O,J,0,0,A);else if(qe==="flipbevel"){if(we>100)J=ne.mult(-1);else{const Be=we*H.add(ne).mag()/H.sub(ne).mag();J._perp()._mult(Be*(Ne?-1:1))}this.addCurrentVertex(O,J,0,0,A),this.addCurrentVertex(O,J.mult(-1),0,0,A)}else if(qe==="bevel"||qe==="fakeround"){const Be=-Math.sqrt(we*we-1),ze=Ne?Be:0,at=Ne?0:Be;if($&&this.addCurrentVertex(O,H,ze,at,A),qe==="fakeround"){const tt=Math.round(180*Ve/Math.PI/20);for(let lt=1;lt<tt;lt++){let et=lt/tt;if(et!==.5){const Nt=et-.5;et+=et*Nt*(et-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*Nt*Nt+(.848013+oe*(.215638*oe-1.06021)))}const ct=ne.sub(H)._mult(et)._add(H)._unit()._mult(Ne?-1:1);this.addHalfVertex(O,ct.x,ct.y,!1,Ne,0,A)}}N&&this.addCurrentVertex(O,ne,-ze,-at,A)}else if(qe==="butt")this.addCurrentVertex(O,J,0,0,A);else if(qe==="square"){const Be=$?1:-1;this.addCurrentVertex(O,J,Be,Be,A)}else qe==="round"&&($&&(this.addCurrentVertex(O,H,0,0,A),this.addCurrentVertex(O,H,1,1,A,!0)),N&&(this.addCurrentVertex(O,ne,-1,-1,A,!0),this.addCurrentVertex(O,ne,0,0,A)));if(je&&K<P-1){const Be=O.dist(N);if(Be>2*D){const ze=O.add(N.sub(O)._mult(D/Be)._round());this.updateDistance(O,ze),this.addCurrentVertex(ze,ne,0,0,A),O=ze}}}}addCurrentVertex(e,i,r,u,h,c=!1){const _=i.y*u-i.x,y=-i.y-i.x*u;this.addHalfVertex(e,i.x+i.y*r,i.y-i.x*r,c,!1,r,h),this.addHalfVertex(e,_,y,c,!0,-u,h),this.distance>Tc/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,i,r,u,h,c))}addHalfVertex({x:e,y:i},r,u,h,c,_,y){const k=.5*(this.lineClips?this.scaledDistance*(Tc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(h?1:0),(i<<1)+(c?1:0),Math.round(63*r)+128,Math.round(63*u)+128,1+(_===0?0:_<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=y.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,P,this.e2),y.primitiveLength++),c?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}hasLineDasharray(e){for(const i of e){const r=i.paint.get("line-dasharray");if(r&&!r.isConstant())return!0}return!1}addLineDashDependencies(e,i,r,u){for(const h of e){const c=h.paint.get("line-dasharray");if(!c||c.value.kind==="constant")continue;const _=h.layout.get("line-cap")==="round",y={dasharray:c.value.evaluate({zoom:r-1},i,{}),round:_},k={dasharray:c.value.evaluate({zoom:r},i,{}),round:_},P={dasharray:c.value.evaluate({zoom:r+1},i,{}),round:_},E=`${y.dasharray.join(",")},${y.round}`,D=`${k.dasharray.join(",")},${k.round}`,A=`${P.dasharray.join(",")},${P.round}`;u.dashDependencies[E]=y,u.dashDependencies[D]=k,u.dashDependencies[A]=P,i.dashes[h.id]={min:E,mid:D,max:A}}}}let Pc,Lc;ot("LineBucket",ch,{omit:["layers","patternFeatures"]});var Mc={get paint(){return Lc=Lc||new Xn({"line-opacity":new ft(Se.paint_line["line-opacity"]),"line-color":new ft(Se.paint_line["line-color"]),"line-translate":new ht(Se.paint_line["line-translate"]),"line-translate-anchor":new ht(Se.paint_line["line-translate-anchor"]),"line-width":new ft(Se.paint_line["line-width"]),"line-gap-width":new ft(Se.paint_line["line-gap-width"]),"line-offset":new ft(Se.paint_line["line-offset"]),"line-blur":new ft(Se.paint_line["line-blur"]),"line-dasharray":new $s(Se.paint_line["line-dasharray"]),"line-pattern":new $s(Se.paint_line["line-pattern"]),"line-gradient":new El(Se.paint_line["line-gradient"])})},get layout(){return Pc=Pc||new Xn({"line-cap":new ht(Se.layout_line["line-cap"]),"line-join":new ft(Se.layout_line["line-join"]),"line-miter-limit":new ht(Se.layout_line["line-miter-limit"]),"line-round-limit":new ht(Se.layout_line["line-round-limit"]),"line-sort-key":new ft(Se.layout_line["line-sort-key"])})}};class dp extends ft{possiblyEvaluate(e,i){return i=new oi(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(e,i)}evaluate(e,i,r,u){return i=mi({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(e,i,r,u)}}let Sd;class hp extends Ma{constructor(e,i){super(e,Mc,i),this.gradientVersion=0,Sd||(Sd=new dp(Mc.paint.properties["line-width"].specification),Sd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!(function(r){return r._styleExpression!==void 0})(i)&&i._styleExpression.expression instanceof or,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,i){super.recalculate(e,i),this.paint._values["line-floorwidth"]=Sd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new ch(e)}queryRadius(e){const i=e,r=Cc($l("line-width",this,i),$l("line-gap-width",this,i)),u=$l("line-offset",this,i);return r/2+Math.abs(u)+yd(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:r,geometry:u,transform:h,pixelsToTileUnits:c}){const _=vd(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-h.bearingInRadians,c),y=c/2*Cc(this.paint.get("line-width").evaluate(i,r),this.paint.get("line-gap-width").evaluate(i,r)),k=this.paint.get("line-offset").evaluate(i,r);return k&&(u=(function(P,E){const D=[];for(let A=0;A<P.length;A++){const O=vm(P[A]),$=[];for(let N=0;N<O.length;N++){const H=O[N],ne=O[N-1],K=O[N+1],J=N===0?new I(0,0):H.sub(ne)._unit()._perp(),oe=N===O.length-1?new I(0,0):K.sub(H)._unit()._perp(),de=J._add(oe)._unit(),we=de.x*oe.x+de.y*oe.y;we!==0&&de._mult(1/we),$.push(de._mult(E)._add(H))}D.push($)}return D})(u,k*c)),(function(P,E,D){for(let A=0;A<E.length;A++){const O=E[A];if(P.length>=3){for(let $=0;$<O.length;$++)if(Ol(P,O[$]))return!0}if(_m(P,O,D))return!0}return!1})(_,u,y)}isTileClipped(){return!0}}function Cc(n,e){return e>0?e+2*n:n}const cp=Gi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),fp=Gi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Gi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const mp=Gi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Gi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ec=Gi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),pp=Gi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function _p(n,e,i){return n.sections.forEach((r=>{r.text=(function(u,h,c){const _=h.layout.get("text-transform").evaluate(c,{});return _==="uppercase"?u=u.toLocaleUpperCase():_==="lowercase"&&(u=u.toLocaleLowerCase()),fo.applyArabicShaping&&(u=fo.applyArabicShaping(u)),u})(r.text,e,i)})),n}Gi([{name:"triangle",components:3,type:"Uint16"}]),Gi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Gi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Gi([{type:"Float32",name:"offsetX"}]),Gi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Gi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var gn=24;const Vu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},gp={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},yp={40:!0};function zc(n,e,i,r,u,h){if("fontStack"in e){const c=i[e.fontStack],_=c&&c[n];return _?_.metrics.advance*e.scale+u:0}{const c=r[e.imageName];return c?c.displaySize[0]*e.scale*gn/h+u:0}}function Ic(n,e,i,r){const u=Math.pow(n-e,2);return r?n<e?u/2:2*u:u+Math.abs(i)*i}function vp(n,e,i){let r=0;return n===10&&(r-=1e4),i&&(r+=150),n!==40&&n!==65288||(r+=50),e!==41&&e!==65289||(r+=50),r}function Dc(n,e,i,r,u,h){let c=null,_=Ic(e,i,u,h);for(const y of r){const k=Ic(e-y.x,i,u,h)+y.badness;k<=_&&(c=y,_=k)}return{index:n,x:e,priorBreak:c,badness:_}}function Ac(n){return n?Ac(n.priorBreak).concat(n.index):[]}class Gl{constructor(e="",i=[],r=[]){this.text=e,this.sections=i,this.sectionIndex=r,this.imageSectionID=null}static fromFeature(e,i){const r=new Gl;for(let u=0;u<e.sections.length;u++){const h=e.sections[u];h.image?r.addImageSection(h):r.addTextSection(h,i)}return r}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=(function(e){let i="",r={premature:!0,value:void 0};const u=e[Symbol.iterator]();let h=u.next();const c=e[Symbol.iterator]();c.next();let _=c.next();for(;!h.done;)i+=!_.done&&gu(_.value.codePointAt(0))&&!Vu[_.value]||!r.premature&&gu(r.value.codePointAt(0))&&!Vu[r.value]||!Vu[h.value]?h.value:Vu[h.value],r={value:h.value,premature:!1},h=u.next(),_=c.next();return i})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),i=e?e[0].length:0,r=this.text.match(/\S\s*$/),u=r?r[0].length-1:0;this.text=this.text.substring(i,this.text.length-u),this.sectionIndex=this.sectionIndex.slice(i,this.sectionIndex.length-u)}substring(e,i){const r=[...this.text].slice(e,i).join(""),u=this.sectionIndex.slice(e,i);return new Gl(r,this.sections,u)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,i)=>Math.max(e,this.sections[i].scale)),0)}getMaxImageSize(e){let i=0,r=0;for(let u=0;u<this.length();u++){const h=this.getSection(u);if("imageName"in h){const c=e[h.imageName];if(!c)continue;const _=c.displaySize;i=Math.max(i,_[0]),r=Math.max(r,_[1])}}return{maxImageWidth:i,maxImageHeight:r}}addTextSection(e,i){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||i});const r=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>r)))}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void Qi("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:i}),this.sectionIndex.push(this.sections.length-1)):Qi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,i,r,u,h){const c=[],_=this.determineAverageLineWidth(e,i,r,u,h),y=this.hasZeroWidthSpaces();let k=0,P=0;const E=this.text[Symbol.iterator]();let D=E.next();const A=this.text[Symbol.iterator]();A.next();let O=A.next();const $=this.text[Symbol.iterator]();$.next(),$.next();let N=$.next();for(;!D.done;){const H=this.getSection(P),ne=D.value.codePointAt(0);if(od(ne)||(k+=zc(ne,H,r,u,e,h)),!O.done){const K=Fs(ne),J=O.value.codePointAt(0);(gp[ne]||K||"imageName"in H||!N.done&&yp[J])&&c.push(Dc(P+1,k,_,c,vp(ne,J,K&&y),!1))}P++,D=E.next(),O=A.next(),N=$.next()}return Ac(Dc(this.length(),k,_,c,0,!0))}determineAverageLineWidth(e,i,r,u,h){let c=0,_=0;for(const y of this.text){const k=this.getSection(_);c+=zc(y.codePointAt(0),k,r,u,e,h),_++}return c/Math.max(1,Math.ceil(c/i))}}const fh=4294967296,Rc=1/fh,jc=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Td{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,i,r=this.length){for(;this.pos<r;){const u=this.readVarint(),h=u>>3,c=this.pos;this.type=7&u,e(h,i,this),this.pos===c&&this.skip(u)}return i}readMessage(e,i){return this.readFields(e,i,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*fh;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*fh;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const i=this.buf;let r,u;return u=i[this.pos++],r=127&u,u<128?r:(u=i[this.pos++],r|=(127&u)<<7,u<128?r:(u=i[this.pos++],r|=(127&u)<<14,u<128?r:(u=i[this.pos++],r|=(127&u)<<21,u<128?r:(u=i[this.pos],r|=(15&u)<<28,(function(h,c,_){const y=_.buf;let k,P;if(P=y[_.pos++],k=(112&P)>>4,P<128||(P=y[_.pos++],k|=(127&P)<<3,P<128)||(P=y[_.pos++],k|=(127&P)<<10,P<128)||(P=y[_.pos++],k|=(127&P)<<17,P<128)||(P=y[_.pos++],k|=(127&P)<<24,P<128)||(P=y[_.pos++],k|=(1&P)<<31,P<128))return ql(h,k,c);throw new Error("Expected varint not more than 10 bytes")})(r,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,i=this.pos;return this.pos=e,e-i>=12&&jc?jc.decode(this.buf.subarray(i,e)):(function(r,u,h){let c="",_=u;for(;_<h;){const y=r[_];let k,P,E,D=null,A=y>239?4:y>223?3:y>191?2:1;if(_+A>h)break;A===1?y<128&&(D=y):A===2?(k=r[_+1],(192&k)==128&&(D=(31&y)<<6|63&k,D<=127&&(D=null))):A===3?(k=r[_+1],P=r[_+2],(192&k)==128&&(192&P)==128&&(D=(15&y)<<12|(63&k)<<6|63&P,(D<=2047||D>=55296&&D<=57343)&&(D=null))):A===4&&(k=r[_+1],P=r[_+2],E=r[_+3],(192&k)==128&&(192&P)==128&&(192&E)==128&&(D=(15&y)<<18|(63&k)<<12|(63&P)<<6|63&E,(D<=65535||D>=1114112)&&(D=null))),D===null?(D=65533,A=1):D>65535&&(D-=65536,c+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),c+=String.fromCharCode(D),_+=A}return c})(this.buf,i,e)}readBytes(){const e=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,e);return this.pos=e,i}readPackedVarint(e=[],i){const r=this.readPackedEnd();for(;this.pos<r;)e.push(this.readVarint(i));return e}readPackedSVarint(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const i=7&e;if(i===0)for(;this.buf[this.pos++]>127;);else if(i===2)this.pos=this.readVarint()+this.pos;else if(i===5)this.pos+=4;else{if(i!==1)throw new Error(`Unimplemented type: ${i}`);this.pos+=8}}writeTag(e,i){this.writeVarint(e<<3|i)}realloc(e){let i=this.length||16;for(;i<this.pos+e;)i*=2;if(i!==this.length){const r=new Uint8Array(i);r.set(this.buf),this.buf=r,this.dataView=new DataView(r.buffer),this.length=i}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Rc),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Rc),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?(function(i,r){let u,h;if(i>=0?(u=i%4294967296|0,h=i/4294967296|0):(u=~(-i%4294967296),h=~(-i/4294967296),4294967295^u?u=u+1|0:(u=0,h=h+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),(function(c,_,y){y.buf[y.pos++]=127&c|128,c>>>=7,y.buf[y.pos++]=127&c|128,c>>>=7,y.buf[y.pos++]=127&c|128,c>>>=7,y.buf[y.pos++]=127&c|128,y.buf[y.pos]=127&(c>>>=7)})(u,0,r),(function(c,_){const y=(7&c)<<4;_.buf[_.pos++]|=y|((c>>>=3)?128:0),c&&(_.buf[_.pos++]=127&c|((c>>>=7)?128:0),c&&(_.buf[_.pos++]=127&c|((c>>>=7)?128:0),c&&(_.buf[_.pos++]=127&c|((c>>>=7)?128:0),c&&(_.buf[_.pos++]=127&c|((c>>>=7)?128:0),c&&(_.buf[_.pos++]=127&c)))))})(h,r)})(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const i=this.pos;this.pos=(function(u,h,c){for(let _,y,k=0;k<h.length;k++){if(_=h.charCodeAt(k),_>55295&&_<57344){if(!y){_>56319||k+1===h.length?(u[c++]=239,u[c++]=191,u[c++]=189):y=_;continue}if(_<56320){u[c++]=239,u[c++]=191,u[c++]=189,y=_;continue}_=y-55296<<10|_-56320|65536,y=null}else y&&(u[c++]=239,u[c++]=191,u[c++]=189,y=null);_<128?u[c++]=_:(_<2048?u[c++]=_>>6|192:(_<65536?u[c++]=_>>12|224:(u[c++]=_>>18|240,u[c++]=_>>12&63|128),u[c++]=_>>6&63|128),u[c++]=63&_|128)}return c})(this.buf,e,this.pos);const r=this.pos-i;r>=128&&Fc(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const i=e.length;this.writeVarint(i),this.realloc(i);for(let r=0;r<i;r++)this.buf[this.pos++]=e[r]}writeRawMessage(e,i){this.pos++;const r=this.pos;e(i,this);const u=this.pos-r;u>=128&&Fc(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u}writeMessage(e,i,r){this.writeTag(e,2),this.writeRawMessage(i,r)}writePackedVarint(e,i){i.length&&this.writeMessage(e,xp,i)}writePackedSVarint(e,i){i.length&&this.writeMessage(e,wp,i)}writePackedBoolean(e,i){i.length&&this.writeMessage(e,Sp,i)}writePackedFloat(e,i){i.length&&this.writeMessage(e,bp,i)}writePackedDouble(e,i){i.length&&this.writeMessage(e,kp,i)}writePackedFixed32(e,i){i.length&&this.writeMessage(e,Tp,i)}writePackedSFixed32(e,i){i.length&&this.writeMessage(e,Pp,i)}writePackedFixed64(e,i){i.length&&this.writeMessage(e,Lp,i)}writePackedSFixed64(e,i){i.length&&this.writeMessage(e,Mp,i)}writeBytesField(e,i){this.writeTag(e,2),this.writeBytes(i)}writeFixed32Field(e,i){this.writeTag(e,5),this.writeFixed32(i)}writeSFixed32Field(e,i){this.writeTag(e,5),this.writeSFixed32(i)}writeFixed64Field(e,i){this.writeTag(e,1),this.writeFixed64(i)}writeSFixed64Field(e,i){this.writeTag(e,1),this.writeSFixed64(i)}writeVarintField(e,i){this.writeTag(e,0),this.writeVarint(i)}writeSVarintField(e,i){this.writeTag(e,0),this.writeSVarint(i)}writeStringField(e,i){this.writeTag(e,2),this.writeString(i)}writeFloatField(e,i){this.writeTag(e,5),this.writeFloat(i)}writeDoubleField(e,i){this.writeTag(e,1),this.writeDouble(i)}writeBooleanField(e,i){this.writeVarintField(e,+i)}}function ql(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function Fc(n,e,i){const r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(r);for(let u=i.pos-1;u>=n;u--)i.buf[u+r]=i.buf[u]}function xp(n,e){for(let i=0;i<n.length;i++)e.writeVarint(n[i])}function wp(n,e){for(let i=0;i<n.length;i++)e.writeSVarint(n[i])}function bp(n,e){for(let i=0;i<n.length;i++)e.writeFloat(n[i])}function kp(n,e){for(let i=0;i<n.length;i++)e.writeDouble(n[i])}function Sp(n,e){for(let i=0;i<n.length;i++)e.writeBoolean(n[i])}function Tp(n,e){for(let i=0;i<n.length;i++)e.writeFixed32(n[i])}function Pp(n,e){for(let i=0;i<n.length;i++)e.writeSFixed32(n[i])}function Lp(n,e){for(let i=0;i<n.length;i++)e.writeFixed64(n[i])}function Mp(n,e){for(let i=0;i<n.length;i++)e.writeSFixed64(n[i])}function Cp(n,e,i){n===1&&i.readMessage(Ep,e)}function Ep(n,e,i){if(n===3){const{id:r,bitmap:u,width:h,height:c,left:_,top:y,advance:k}=i.readMessage(zp,{});e.push({id:r,bitmap:new zu({width:h+6,height:c+6},u),metrics:{width:h,height:c,left:_,top:y,advance:k}})}}function zp(n,e,i){n===1?e.id=i.readVarint():n===2?e.bitmap=i.readBytes():n===3?e.width=i.readVarint():n===4?e.height=i.readVarint():n===5?e.left=i.readSVarint():n===6?e.top=i.readSVarint():n===7&&(e.advance=i.readVarint())}function Bc(n){let e=0,i=0;for(const c of n)e+=c.w*c.h,i=Math.max(i,c.w);n.sort(((c,_)=>_.h-c.h));const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let u=0,h=0;for(const c of n)for(let _=r.length-1;_>=0;_--){const y=r[_];if(!(c.w>y.w||c.h>y.h)){if(c.x=y.x,c.y=y.y,h=Math.max(h,c.y+c.h),u=Math.max(u,c.x+c.w),c.w===y.w&&c.h===y.h){const k=r.pop();k&&_<r.length&&(r[_]=k)}else c.h===y.h?(y.x+=c.w,y.w-=c.w):c.w===y.w?(y.y+=c.h,y.h-=c.h):(r.push({x:y.x+c.w,y:y.y,w:y.w-c.w,h:c.h}),y.y+=c.h,y.h-=c.h);break}}return{w:u,h,fill:e/(u*h)||0}}class mh{constructor(e,{pixelRatio:i,version:r,stretchX:u,stretchY:h,content:c,textFitWidth:_,textFitHeight:y}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=u,this.stretchY=h,this.content=c,this.version=r,this.textFitWidth=_,this.textFitHeight=y}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Oc{constructor(e,i){const r={},u={};this.haveRenderCallbacks=[];const h=[];this.addImages(e,r,h),this.addImages(i,u,h);const{w:c,h:_}=Bc(h),y=new ma({width:c||1,height:_||1});for(const k in e){const P=e[k],E=r[k].paddedRect;ma.copy(P.data,y,{x:0,y:0},{x:E.x+1,y:E.y+1},P.data)}for(const k in i){const P=i[k],E=u[k].paddedRect,D=E.x+1,A=E.y+1,O=P.data.width,$=P.data.height;ma.copy(P.data,y,{x:0,y:0},{x:D,y:A},P.data),ma.copy(P.data,y,{x:0,y:$-1},{x:D,y:A-1},{width:O,height:1}),ma.copy(P.data,y,{x:0,y:0},{x:D,y:A+$},{width:O,height:1}),ma.copy(P.data,y,{x:O-1,y:0},{x:D-1,y:A},{width:1,height:$}),ma.copy(P.data,y,{x:0,y:0},{x:D+O,y:A},{width:1,height:$})}this.image=y,this.iconPositions=r,this.patternPositions=u}addImages(e,i,r){for(const u in e){const h=e[u],c={x:0,y:0,w:h.data.width+2,h:h.data.height+2};r.push(c),i[u]=new mh(c,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),i),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),i)}patchUpdatedImage(e,i,r){if(!e||!i||e.version===i.version)return;e.version=i.version;const[u,h]=e.tl;r.update(i.data,void 0,{x:u,y:h})}}var gs;function Pd(n,e,i,r,u,h,c,_,y,k,P,E,D,A,O){const $=Gl.fromFeature(n,u);let N;E===v.az.vertical&&$.verticalizePunctuation();let H=$.determineLineBreaks(k,h,e,r,A);const{processBidirectionalText:ne,processStyledBidirectionalText:K}=fo;if(ne&&$.sections.length===1){N=[],H=H.map((we=>$.toCodeUnitIndex(we)));const de=ne($.toString(),H);for(const we of de){const Ve=[...we].map((()=>0));N.push(new Gl(we,$.sections,Ve))}}else if(K){N=[],H=H.map((je=>$.toCodeUnitIndex(je)));let de=0;const we=[];for(const je of $.text)we.push(...Array(je.length).fill($.sectionIndex[de])),de++;const Ve=K($.text,we,H);for(const je of Ve){const Ne=[];let Ye="";for(const qe of je[0])Ne.push(je[1][Ye.length]),Ye+=qe;N.push(new Gl(je[0],$.sections,Ne))}}else N=(function(de,we){const Ve=[];let je=0;for(const Ne of we)Ve.push(de.substring(je,Ne)),je=Ne;return je<de.length()&&Ve.push(de.substring(je,de.length())),Ve})($,H);const J=[],oe={positionedLines:J,text:$.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:E,iconsInText:!1,verticalizable:!1};return(function(de,we,Ve,je,Ne,Ye,qe,Be,ze,at,tt,lt){let et=0,ct=0,Nt=0,At=0;const Si=Be==="right"?1:Be==="left"?0:.5,Vn=gn/lt;let en=0;for(const Xt of Ne){Xt.trim();const $i=Xt.getMaxScale(),Zi={positionedGlyphs:[],lineOffset:0};de.positionedLines[en]=Zi;const fi=Zi.positionedGlyphs;let pa=0;if(!Xt.length()){ct+=Ye,++en;continue}const Nn=Ip(je,Xt,Vn);let _a=0;for(const xn of Xt.text){const zi=Xt.getSection(_a),tn=xn.codePointAt(0),Vi=Dp(ze,tt,tn),wn={glyph:tn,imageName:null,x:et,y:ct+-17,vertical:Vi,scale:1,fontStack:"",sectionIndex:Xt.getSectionIndex(_a),metrics:null,rect:null};let Zo;if("fontStack"in zi){if(Zo=Ap(zi,tn,Vi,Nn,we,Ve),!Zo)continue;wn.fontStack=zi.fontStack}else{if(de.iconsInText=!0,zi.scale*=Vn,Zo=Rp(zi,Vi,$i,Nn,je),!Zo)continue;pa=Math.max(pa,Zo.imageOffset),wn.imageName=zi.imageName}const{rect:Fr,metrics:Wu,baselineOffset:bs}=Zo;wn.y+=bs,wn.scale=zi.scale,wn.metrics=Wu,wn.rect=Fr,fi.push(wn),Vi?(de.verticalizable=!0,et+=("imageName"in zi?Wu.advance:gn)*zi.scale+at):et+=Wu.advance*zi.scale+at,_a++}fi.length!==0&&(Nt=Math.max(et-at,Nt),jp(fi,0,fi.length-1,Si)),et=0,Zi.lineOffset=Math.max(pa,($i-1)*gn);const mr=Ye*$i+pa;ct+=mr,At=Math.max(mr,At),++en}const{horizontalAlign:Ti,verticalAlign:gi}=ph(qe);(function(Xt,$i,Zi,fi,pa,Nn,_a,mr,xn){const zi=($i-Zi)*pa;let tn=0;tn=Nn!==_a?-mr*fi- -17:-fi*xn*_a+.5*_a;for(const Vi of Xt)for(const wn of Vi.positionedGlyphs)wn.x+=zi,wn.y+=tn})(de.positionedLines,Si,Ti,gi,Nt,At,Ye,ct,Ne.length),de.top+=-gi*ct,de.bottom=de.top+ct,de.left+=-Ti*Nt,de.right=de.left+Nt})(oe,e,i,r,N,c,_,y,E,k,D,O),!(function(de){for(const we of de)if(we.positionedGlyphs.length!==0)return!1;return!0})(J)&&oe}function ph(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function Ip(n,e,i){const r=e.getMaxScale()*gn,{maxImageWidth:u,maxImageHeight:h}=e.getMaxImageSize(n),c=Math.max(r,h*i);return{verticalLineContentWidth:Math.max(r,u*i),horizontalLineContentHeight:c}}function $c(n){switch(n){case"top":return 0;case"center":return .5;default:return 1}}function Dp(n,e,i){return!(n===v.az.horizontal||!e&&!_u(i)||e&&(od(i)||(r=i,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(r)))));var r}function Ap(n,e,i,r,u,h){const c=h[n.fontStack],_=(function(k,P,E,D){if(k&&k.rect)return k;const A=P[E.fontStack],O=A&&A[D];return O?{rect:null,metrics:O.metrics}:null})(c&&c[e],u,n,e);if(_===null)return null;let y;if(i)y=r.verticalLineContentWidth-n.scale*gn;else{const k=$c(n.verticalAlign);y=(r.horizontalLineContentHeight-n.scale*gn)*k}return{rect:_.rect,metrics:_.metrics,baselineOffset:y}}function Rp(n,e,i,r,u){const h=u[n.imageName];if(!h)return null;const c=h.paddedRect,_=h.displaySize,y={width:_[0],height:_[1],left:1,top:-3,advance:e?_[1]:_[0]};let k;if(e)k=r.verticalLineContentWidth-_[1]*n.scale;else{const P=$c(n.verticalAlign);k=(r.horizontalLineContentHeight-_[1]*n.scale)*P}return{rect:c,metrics:y,baselineOffset:k,imageOffset:(e?_[0]:_[1])*n.scale-gn*i}}function jp(n,e,i,r){if(r===0)return;const u=n[i],h=(n[i].x+u.metrics.advance*u.scale)*r;for(let c=e;c<=i;c++)n[c].x-=h}function Fp(n,e,i){const{horizontalAlign:r,verticalAlign:u}=ph(i),h=e[0]-n.displaySize[0]*r,c=e[1]-n.displaySize[1]*u;return{image:n,top:c,bottom:c+n.displaySize[1],left:h,right:h+n.displaySize[0]}}function Vc(n){var e,i;let r=n.left,u=n.top,h=n.right-r,c=n.bottom-u;const _=(e=n.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",y=(i=n.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",k=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(y==="proportional"){if(_==="stretchOnly"&&h/c<k||_==="proportional"){const P=Math.ceil(c*k);r*=P/h,h=P}}else if(_==="proportional"&&y==="stretchOnly"&&k!==0&&h/c>k){const P=Math.ceil(h/k);u*=P/c,c=P}return{x1:r,y1:u,x2:r+h,y2:u+c}}function Nc(n,e,i,r,u,h){const c=n.image;let _;if(c.content){const N=c.content,H=c.pixelRatio||1;_=[N[0]/H,N[1]/H,c.displaySize[0]-N[2]/H,c.displaySize[1]-N[3]/H]}const y=e.left*h,k=e.right*h;let P,E,D,A;i==="width"||i==="both"?(A=u[0]+y-r[3],E=u[0]+k+r[1]):(A=u[0]+(y+k-c.displaySize[0])/2,E=A+c.displaySize[0]);const O=e.top*h,$=e.bottom*h;return i==="height"||i==="both"?(P=u[1]+O-r[0],D=u[1]+$+r[2]):(P=u[1]+(O+$-c.displaySize[1])/2,D=P+c.displaySize[1]),{image:c,top:P,right:E,bottom:D,left:A,collisionPadding:_}}ot("ImagePosition",mh),ot("ImageAtlas",Oc),v.az=void 0,(gs=v.az||(v.az={}))[gs.none=0]="none",gs[gs.horizontal=1]="horizontal",gs[gs.vertical=2]="vertical",gs[gs.horizontalOnly=3]="horizontalOnly";const Go=128,ys=32640;function Uc(n,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new oi(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:r,interpolationType:u}=i;let h=0;for(;h<r.length&&r[h]<=n;)h++;h=Math.max(0,h-1);let c=h;for(;c<r.length&&r[c]<n+1;)c++;c=Math.min(r.length-1,c);const _=r[h],y=r[c];return i.kind==="composite"?{kind:"composite",minZoom:_,maxZoom:y,interpolationType:u}:{kind:"camera",minZoom:_,maxZoom:y,minSize:i.evaluate(new oi(_)),maxSize:i.evaluate(new oi(y)),interpolationType:u}}}function _h(n,e,i){let r="never";const u=n.get(e);return u?r=u:n.get(i)&&(r="always"),r}const Bp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ld(n,e,i,r,u,h,c,_,y,k,P,E,D){const A=_?Math.min(ys,Math.round(_[0])):0,O=_?Math.min(ys,Math.round(_[1])):0;n.emplaceBack(e,i,Math.round(32*r),Math.round(32*u),h,c,(A<<1)+(y?1:0),O,16*k,16*P,256*E,256*D)}function gh(n,e,i){n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i)}function Op(n){for(const e of n.sections)if(ud(e.text))return!0;return!1}class yh{constructor(e){this.layoutVertexArray=new se,this.indexArray=new Ce,this.programConfigurations=e,this.segments=new Je,this.dynamicLayoutVertexArray=new ye,this.opacityVertexArray=new Ie,this.hasVisibleVertices=!1,this.placedSymbolArray=new g}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,fp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Bp,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ot("SymbolBuffers",yh);class vh{constructor(e,i,r){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new r,this.segments=new Je,this.collisionVertexArray=new Le}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,mp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ot("CollisionBuffers",vh);class Zl{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((c=>c.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Uc(this.zoom,i["text-size"]),this.iconSizeData=Uc(this.zoom,i["icon-size"]);const r=this.layers[0].layout,u=r.get("symbol-sort-key"),h=r.get("symbol-z-order");this.canOverlap=_h(r,"text-overlap","text-allow-overlap")!=="never"||_h(r,"icon-overlap","icon-allow-overlap")!=="never"||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&!u.isConstant(),this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map((c=>v.az[c]))),this.stateDependentLayerIds=this.layers.filter((c=>c.isStateDependent())).map((c=>c.id)),this.sourceID=e.sourceID}createArrays(){this.text=new yh(new Uo(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new yh(new Uo(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new M,this.lineVertexArray=new z,this.symbolInstances=new S,this.textAnchorOffsets=new j}calculateGlyphDependencies(e,i,r,u,h){for(const c of e)if(i[c.codePointAt(0)]=!0,(r||u)&&h){const _=Vu[c];_&&(i[_.codePointAt(0)]=!0)}}populate(e,i,r){const u=this.layers[0],h=u.layout,c=h.get("text-font"),_=h.get("text-field"),y=h.get("icon-image"),k=(_.value.kind!=="constant"||_.value.value instanceof Rn&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(c.value.kind!=="constant"||c.value.value.length>0),P=y.value.kind!=="constant"||!!y.value.value||Object.keys(y.parameters).length>0,E=h.get("symbol-sort-key");if(this.features=[],!k&&!P)return;const D=i.iconDependencies,A=i.glyphDependencies,O=i.availableImages,$=new oi(this.zoom);for(const{feature:N,id:H,index:ne,sourceLayerIndex:K}of e){const J=u._featureFilter.needGeometry,oe=go(N,J);if(!u._featureFilter.filter($,oe,r))continue;let de,we;if(J||(oe.geometry=_o(N)),k){const je=u.getValueAndResolveTokens("text-field",oe,r,O),Ne=Rn.factory(je),Ye=this.hasRTLText=this.hasRTLText||Op(Ne);(!Ye||fo.getRTLTextPluginStatus()==="unavailable"||Ye&&fo.isParsed())&&(de=_p(Ne,u,oe))}if(P){const je=u.getValueAndResolveTokens("icon-image",oe,r,O);we=je instanceof Pn?je:Pn.fromString(je)}if(!de&&!we)continue;const Ve=this.sortFeaturesByKey?E.evaluate(oe,{},r):void 0;if(this.features.push({id:H,text:de,icon:we,index:ne,sourceLayerIndex:K,geometry:oe.geometry,properties:N.properties,type:Bu.types[N.type],sortKey:Ve}),we&&(D[we.name]=!0),de){const je=c.evaluate(oe,{},r).join(","),Ne=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.az.vertical)>=0;for(const Ye of de.sections)if(Ye.image)D[Ye.image.name]=!0;else{const qe=ps(de.toString()),Be=Ye.fontStack||je,ze=A[Be]=A[Be]||{};this.calculateGlyphDependencies(Ye.text,ze,Ne,this.allowVerticalPlacement,qe)}}}h.get("symbol-placement")==="line"&&(this.features=(function(N){const H={},ne={},K=[];let J=0;function oe(je){K.push(N[je]),J++}function de(je,Ne,Ye){const qe=ne[je];return delete ne[je],ne[Ne]=qe,K[qe].geometry[0].pop(),K[qe].geometry[0]=K[qe].geometry[0].concat(Ye[0]),qe}function we(je,Ne,Ye){const qe=H[Ne];return delete H[Ne],H[je]=qe,K[qe].geometry[0].shift(),K[qe].geometry[0]=Ye[0].concat(K[qe].geometry[0]),qe}function Ve(je,Ne,Ye){const qe=Ye?Ne[0][Ne[0].length-1]:Ne[0][0];return`${je}:${qe.x}:${qe.y}`}for(let je=0;je<N.length;je++){const Ne=N[je],Ye=Ne.geometry,qe=Ne.text?Ne.text.toString():null;if(!qe){oe(je);continue}const Be=Ve(qe,Ye),ze=Ve(qe,Ye,!0);if(Be in ne&&ze in H&&ne[Be]!==H[ze]){const at=we(Be,ze,Ye),tt=de(Be,ze,K[at].geometry);delete H[Be],delete ne[ze],ne[Ve(qe,K[tt].geometry,!0)]=tt,K[at].geometry=null}else Be in ne?de(Be,ze,Ye):ze in H?we(Be,ze,Ye):(oe(je),H[Be]=J-1,ne[ze]=J-1)}return K.filter((je=>je.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((N,H)=>N.sortKey-H.sortKey))}update(e,i,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:r}),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:r}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const r=this.lineVertexArray.length;if(e.segment!==void 0){let u=e.dist(i[e.segment+1]),h=e.dist(i[e.segment]);const c={};for(let _=e.segment+1;_<i.length;_++)c[_]={x:i[_].x,y:i[_].y,tileUnitDistanceFromAnchor:u},_<i.length-1&&(u+=i[_+1].dist(i[_]));for(let _=e.segment||0;_>=0;_--)c[_]={x:i[_].x,y:i[_].y,tileUnitDistanceFromAnchor:h},_>0&&(h+=i[_-1].dist(i[_]));for(let _=0;_<i.length;_++){const y=c[_];this.lineVertexArray.emplaceBack(y.x,y.y,y.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(e,i,r,u,h,c,_,y,k,P,E,D){const A=e.indexArray,O=e.layoutVertexArray,$=e.segments.prepareSegment(4*i.length,O,A,this.canOverlap?c.sortKey:void 0),N=this.glyphOffsetArray.length,H=$.vertexLength,ne=this.allowVerticalPlacement&&_===v.az.vertical?Math.PI/2:0,K=c.text&&c.text.sections;for(let J=0;J<i.length;J++){const{tl:oe,tr:de,bl:we,br:Ve,tex:je,pixelOffsetTL:Ne,pixelOffsetBR:Ye,minFontScaleX:qe,minFontScaleY:Be,glyphOffset:ze,isSDF:at,sectionIndex:tt}=i[J],lt=$.vertexLength,et=ze[1];Ld(O,y.x,y.y,oe.x,et+oe.y,je.x,je.y,r,at,Ne.x,Ne.y,qe,Be),Ld(O,y.x,y.y,de.x,et+de.y,je.x+je.w,je.y,r,at,Ye.x,Ne.y,qe,Be),Ld(O,y.x,y.y,we.x,et+we.y,je.x,je.y+je.h,r,at,Ne.x,Ye.y,qe,Be),Ld(O,y.x,y.y,Ve.x,et+Ve.y,je.x+je.w,je.y+je.h,r,at,Ye.x,Ye.y,qe,Be),gh(e.dynamicLayoutVertexArray,y,ne),A.emplaceBack(lt,lt+2,lt+1),A.emplaceBack(lt+1,lt+2,lt+3),$.vertexLength+=4,$.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ze[0]),J!==i.length-1&&tt===i[J+1].sectionIndex||e.programConfigurations.populatePaintArrays(O.length,c,c.index,{imagePositions:{},canonical:D,formattedSection:K&&K[tt]})}e.placedSymbolArray.emplaceBack(y.x,y.y,N,this.glyphOffsetArray.length-N,H,k,P,y.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],_,0,!1,0,E)}_addCollisionDebugVertex(e,i,r,u,h,c){return i.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,h,Math.round(c.x),Math.round(c.y))}addCollisionDebugVertices(e,i,r,u,h,c,_){const y=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),k=y.vertexLength,P=h.layoutVertexArray,E=h.collisionVertexArray,D=_.anchorX,A=_.anchorY;this._addCollisionDebugVertex(P,E,c,D,A,new I(e,i)),this._addCollisionDebugVertex(P,E,c,D,A,new I(r,i)),this._addCollisionDebugVertex(P,E,c,D,A,new I(r,u)),this._addCollisionDebugVertex(P,E,c,D,A,new I(e,u)),y.vertexLength+=4;const O=h.indexArray;O.emplaceBack(k,k+1),O.emplaceBack(k+1,k+2),O.emplaceBack(k+2,k+3),O.emplaceBack(k+3,k),y.primitiveLength+=4}addDebugCollisionBoxes(e,i,r,u){for(let h=e;h<i;h++){const c=this.collisionBoxArray.get(h);this.addCollisionDebugVertices(c.x1,c.y1,c.x2,c.y2,u?this.textCollisionBox:this.iconCollisionBox,c.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vh(Te,Ec.members,Ke),this.iconCollisionBox=new vh(Te,Ec.members,Ke);for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(e,i,r,u,h,c,_,y,k){const P={};for(let E=i;E<r;E++){const D=e.get(E);P.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},P.textFeatureIndex=D.featureIndex;break}for(let E=u;E<h;E++){const D=e.get(E);P.verticalTextBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},P.verticalTextFeatureIndex=D.featureIndex;break}for(let E=c;E<_;E++){const D=e.get(E);P.iconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},P.iconFeatureIndex=D.featureIndex;break}for(let E=y;E<k;E++){const D=e.get(E);P.verticalIconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},P.verticalIconFeatureIndex=D.featureIndex;break}return P}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const r=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const r=e.placedSymbolArray.get(i),u=r.vertexStartIndex+4*r.numGlyphs;for(let h=r.vertexStartIndex;h<u;h+=4)e.indexArray.emplaceBack(h,h+2,h+1),e.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),r=Math.cos(e),u=[],h=[],c=[];for(let _=0;_<this.symbolInstances.length;++_){c.push(_);const y=this.symbolInstances.get(_);u.push(0|Math.round(i*y.anchorX+r*y.anchorY)),h.push(y.featureIndex)}return c.sort(((_,y)=>u[_]-u[y]||h[y]-h[_])),c}addToSortKeyRanges(e,i){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===i?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const r=this.symbolInstances.get(i);this.featureSortOrder.push(r.featureIndex),[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach(((u,h,c)=>{u>=0&&c.indexOf(u)===h&&this.addIndicesForPlacedSymbol(this.text,u)})),r.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,r.verticalPlacedTextSymbolIndex),r.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.placedIconSymbolIndex),r.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Gc,qc;ot("SymbolBucket",Zl,{omit:["layers","collisionBoxArray","features","compareText"]}),Zl.MAX_GLYPHS=65535,Zl.addDynamicAttributes=gh;var xh={get paint(){return qc=qc||new Xn({"icon-opacity":new ft(Se.paint_symbol["icon-opacity"]),"icon-color":new ft(Se.paint_symbol["icon-color"]),"icon-halo-color":new ft(Se.paint_symbol["icon-halo-color"]),"icon-halo-width":new ft(Se.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ft(Se.paint_symbol["icon-halo-blur"]),"icon-translate":new ht(Se.paint_symbol["icon-translate"]),"icon-translate-anchor":new ht(Se.paint_symbol["icon-translate-anchor"]),"text-opacity":new ft(Se.paint_symbol["text-opacity"]),"text-color":new ft(Se.paint_symbol["text-color"],{runtimeType:An,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new ft(Se.paint_symbol["text-halo-color"]),"text-halo-width":new ft(Se.paint_symbol["text-halo-width"]),"text-halo-blur":new ft(Se.paint_symbol["text-halo-blur"]),"text-translate":new ht(Se.paint_symbol["text-translate"]),"text-translate-anchor":new ht(Se.paint_symbol["text-translate-anchor"])})},get layout(){return Gc=Gc||new Xn({"symbol-placement":new ht(Se.layout_symbol["symbol-placement"]),"symbol-spacing":new ht(Se.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ht(Se.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ft(Se.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ht(Se.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ht(Se.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ht(Se.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ht(Se.layout_symbol["icon-ignore-placement"]),"icon-optional":new ht(Se.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ht(Se.layout_symbol["icon-rotation-alignment"]),"icon-size":new ft(Se.layout_symbol["icon-size"]),"icon-text-fit":new ht(Se.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ht(Se.layout_symbol["icon-text-fit-padding"]),"icon-image":new ft(Se.layout_symbol["icon-image"]),"icon-rotate":new ft(Se.layout_symbol["icon-rotate"]),"icon-padding":new ft(Se.layout_symbol["icon-padding"]),"icon-keep-upright":new ht(Se.layout_symbol["icon-keep-upright"]),"icon-offset":new ft(Se.layout_symbol["icon-offset"]),"icon-anchor":new ft(Se.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ht(Se.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ht(Se.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ht(Se.layout_symbol["text-rotation-alignment"]),"text-field":new ft(Se.layout_symbol["text-field"]),"text-font":new ft(Se.layout_symbol["text-font"]),"text-size":new ft(Se.layout_symbol["text-size"]),"text-max-width":new ft(Se.layout_symbol["text-max-width"]),"text-line-height":new ht(Se.layout_symbol["text-line-height"]),"text-letter-spacing":new ft(Se.layout_symbol["text-letter-spacing"]),"text-justify":new ft(Se.layout_symbol["text-justify"]),"text-radial-offset":new ft(Se.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ht(Se.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ft(Se.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ft(Se.layout_symbol["text-anchor"]),"text-max-angle":new ht(Se.layout_symbol["text-max-angle"]),"text-writing-mode":new ht(Se.layout_symbol["text-writing-mode"]),"text-rotate":new ft(Se.layout_symbol["text-rotate"]),"text-padding":new ht(Se.layout_symbol["text-padding"]),"text-keep-upright":new ht(Se.layout_symbol["text-keep-upright"]),"text-transform":new ft(Se.layout_symbol["text-transform"]),"text-offset":new ft(Se.layout_symbol["text-offset"]),"text-allow-overlap":new ht(Se.layout_symbol["text-allow-overlap"]),"text-overlap":new ht(Se.layout_symbol["text-overlap"]),"text-ignore-placement":new ht(Se.layout_symbol["text-ignore-placement"]),"text-optional":new ht(Se.layout_symbol["text-optional"])})}};class Zc{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Gn,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ot("FormatSectionOverride",Zc,{omit:["defaultValue"]});class Md extends Ma{constructor(e,i){super(e,xh,i)}recalculate(e,i){if(super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const r=this.layout.get("text-writing-mode");if(r){const u=[];for(const h of r)u.indexOf(h)<0&&u.push(h);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,i,r,u){const h=this.layout.get(e).evaluate(i,{},r,u),c=this._unevaluatedLayout._values[e];return c.isDataDriven()||uo(c.value)||!h?h:(function(_,y){return y.replace(/{([^{}]+)}/g,((k,P)=>_&&P in _?String(_[P]):""))})(i.properties,h)}createBucket(e){return new Zl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of xh.paint.overridableProperties){if(!Md.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),r=new Zc(i),u=new us(r,i.property.specification);let h=null;h=i.value.kind==="constant"||i.value.kind==="source"?new m("source",u):new x("composite",u,i.value.zoomStops),this.paint._values[e]=new Ka(i.property,h,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,r){return!(!this.layout||i.isDataDriven()||r.isDataDriven())&&Md.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const r=e.get("text-field"),u=xh.paint.properties[i];let h=!1;const c=_=>{for(const y of _)if(u.overrides&&u.overrides.hasOverride(y))return void(h=!0)};if(r.value.kind==="constant"&&r.value.value instanceof Rn)c(r.value.value.sections);else if(r.value.kind==="source"||r.value.kind==="composite"){const _=k=>{h||(k instanceof ua&&Rt(k.value)===Vr?c(k.value.sections):k instanceof zo?c(k.sections):k.eachChild(_))},y=r.value;y._styleExpression&&_(y._styleExpression.expression)}return h}}let Hc;var $p={get paint(){return Hc=Hc||new Xn({"background-color":new ht(Se.paint_background["background-color"]),"background-pattern":new Cl(Se.paint_background["background-pattern"]),"background-opacity":new ht(Se.paint_background["background-opacity"])})}};class Vp extends Ma{constructor(e,i){super(e,$p,i)}}class Np extends Ma{constructor(e,i){super(e,{},i),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Up{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Gp={once:!0},wh=63710088e-1;class vs{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vs(Wi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,r=this.lat*i,u=e.lat*i,h=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*i);return wh*Math.acos(Math.min(h,1))}static convert(e){if(e instanceof vs)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new vs(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new vs(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Wc=2*Math.PI*wh;function Kc(n){return Wc*Math.cos(n*Math.PI/180)}function Xc(n){return(180+n)/360}function Yc(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Jc(n,e){return n/Kc(e)}function Qc(n){return 360*n-180}function Cd(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function ef(n,e){return n*Kc(Cd(e))}class Nu{constructor(e,i,r=0){this.x=+e,this.y=+i,this.z=+r}static fromLngLat(e,i=0){const r=vs.convert(e);return new Nu(Xc(r.lng),Yc(r.lat),Jc(i,r.lat))}toLngLat(){return new vs(Qc(this.x),Cd(this.y))}toAltitude(){return ef(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Wc*(e=Cd(this.y),1/Math.cos(e*Math.PI/180));var e}}function tf(n,e,i){var r=2*Math.PI*6378137/256/Math.pow(2,i);return[n*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}class bh{constructor(e,i,r){if(!(function(u,h,c){return!(u<0||u>25||c<0||c>=Math.pow(2,u)||h<0||h>=Math.pow(2,u))})(e,i,r))throw new Error(`x=${i}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=i,this.y=r,this.key=Hl(0,e,e,i,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i,r){const u=(function(c,_,y){var k=tf(256*c,256*(_=Math.pow(2,y)-_-1),y),P=tf(256*(c+1),256*(_+1),y);return k[0]+","+k[1]+","+P[0]+","+P[1]})(this.x,this.y,this.z),h=(function(c,_,y){let k,P="";for(let E=c;E>0;E--)k=1<<E-1,P+=(_&k?1:0)+(y&k?2:0);return P})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,h).replace(/{bbox-epsg-3857}/g,u)}isChildOf(e){const i=this.z-e.z;return i>0&&e.x===this.x>>i&&e.y===this.y>>i}getTilePoint(e){const i=Math.pow(2,this.z);return new I((e.x*i-this.x)*$t,(e.y*i-this.y)*$t)}toString(){return`${this.z}/${this.x}/${this.y}`}}class nf{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Hl(e,i.z,i.z,i.x,i.y)}}class Ja{constructor(e,i,r,u,h){if(this.terrainRttPosMatrix32f=null,e<r)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${r}`);this.overscaledZ=e,this.wrap=i,this.canonical=new bh(r,+u,+h),this.key=Hl(i,e,r,u,h)}clone(){return new Ja(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?new Ja(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ja(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,i){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?Hl(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y):Hl(this.wrap*+i,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap||this.overscaledZ-e.overscaledZ<=0)return!1;if(e.overscaledZ===0)return this.overscaledZ>0;const i=this.canonical.z-e.canonical.z;return!(i<0)&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Ja(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new Ja(i,this.wrap,i,r,u),new Ja(i,this.wrap,i,r+1,u),new Ja(i,this.wrap,i,r,u+1),new Ja(i,this.wrap,i,r+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ja(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ja(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new nf(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Nu(e.x-this.wrap,e.y))}}function Hl(n,e,i,r,u){(n*=2)<0&&(n=-1*n-1);const h=1<<i;return(h*h*n+h*u+r).toString(36)+i.toString(36)+e.toString(36)}function kh(n,e){return e?n.properties[e]:n.id}function qp(n,e){const i={id:n.id};if(e.removeAllProperties&&(delete n.removeProperties,delete n.addOrUpdateProperties,delete e.removeProperties),e.removeProperties)for(const r of e.removeProperties){const u=n.addOrUpdateProperties.findIndex((h=>h.key===r));u>-1&&n.addOrUpdateProperties.splice(u,1)}return(n.removeAllProperties||e.removeAllProperties)&&(i.removeAllProperties=!0),(n.removeProperties||e.removeProperties)&&(i.removeProperties=[...n.removeProperties||[],...e.removeProperties||[]]),(n.addOrUpdateProperties||e.addOrUpdateProperties)&&(i.addOrUpdateProperties=[...n.addOrUpdateProperties||[],...e.addOrUpdateProperties||[]]),(n.newGeometry||e.newGeometry)&&(i.newGeometry=e.newGeometry||n.newGeometry),i}function af(n){var e,i;if(!n)return{};const r={};return r.removeAll=n.removeAll,r.remove=new Set(n.remove||[]),r.add=new Map((e=n.add)===null||e===void 0?void 0:e.map((u=>[u.id,u]))),r.update=new Map((i=n.update)===null||i===void 0?void 0:i.map((u=>[u.id,u]))),r}ot("CanonicalTileID",bh),ot("OverscaledTileID",Ja,{omit:["terrainRttPosMatrix32f"]});class Xs{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const i=new Xs;return i.extend(e(new I(this.minX,this.minY))),i.extend(e(new I(this.maxX,this.minY))),i.extend(e(new I(this.minX,this.maxY))),i.extend(e(new I(this.maxX,this.maxY))),i}static fromPoints(e){const i=new Xs;for(const r of e)i.extend(r);return i}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class rf{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const r=e[i];this._stringToNumber[r]=i,this._numberToString[i]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class of{constructor(e,i,r,u,h){this.type="Feature",this._vectorTileFeature=e,this._x=r,this._y=u,this._z=i,this.properties=e.properties,this.id=h}projectPoint(e,i,r,u){return[360*(e.x+i)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+r)/u)*Math.PI))-90]}projectLine(e,i,r,u){return e.map((h=>this.projectPoint(h,i,r,u)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,i=e.extent*Math.pow(2,this._z),r=e.extent*this._x,u=e.extent*this._y,h=e.loadGeometry();switch(e.type){case 1:{const c=[];for(const y of h)c.push(y[0]);const _=this.projectLine(c,r,u,i);this._geometry=c.length===1?{type:"Point",coordinates:_[0]}:{type:"MultiPoint",coordinates:_};break}case 2:{const c=h.map((_=>this.projectLine(_,r,u,i)));this._geometry=c.length===1?{type:"LineString",coordinates:c[0]}:{type:"MultiLineString",coordinates:c};break}case 3:{const c=xc(h),_=[];for(const y of c)_.push(y.map((k=>this.projectLine(k,r,u,i))));this._geometry=_.length===1?{type:"Polygon",coordinates:_[0]}:{type:"MultiPolygon",coordinates:_};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&i!=="_x"&&i!=="_y"&&i!=="_z"&&(e[i]=this[i]);return e}}class Wl{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,i,r){this._name=e,this.dataBuffer=i,typeof r=="number"?this._size=r:(this.nullabilityBuffer=r,this._size=r.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class Ed extends Wl{}class Sh extends Ed{getValueFromBuffer(e){return this.dataBuffer[e]}}class Th extends Ed{getValueFromBuffer(e){return this.dataBuffer[e]}}class sf extends Wl{delta;constructor(e,i,r,u){super(e,i,u),this.delta=r}}class Ph extends sf{constructor(e,i,r,u){super(e,Int32Array.of(i),r,u)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class Lh extends Wl{constructor(e,i,r){super(e,Int32Array.of(i),r)}getValueFromBuffer(e){return this.dataBuffer[0]}}class Zp{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,i,r,u,h=4096){this._name=e,this._geometryVector=i,this._idVector=r,this._propertyVectors=u,this._extent=h}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((i=>[i.name,i])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let i=0;for(;i<this.numFeatures;){let r;this.idVector&&(r=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(i)):this.idVector.getValue(i));const u=e?.next().value,h={};for(const c of this.propertyVectors){if(!c)continue;const _=c.name,y=c.getValue(i);y!==null&&(h[_]=y)}i++,yield{id:r,geometry:u,properties:h}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],i=this.geometryVector.getGeometries();for(let r=0;r<this.numFeatures;r++){let u;this.idVector&&(u=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(r)):this.idVector.getValue(r));const h={coordinates:i[r],type:this.geometryVector.geometryType(r)},c={};for(const _ of this.propertyVectors){if(!_)continue;const y=_.name,k=_.getValue(r);k!==null&&(c[y]=k)}e.push({id:u,geometry:h,properties:c})}return e}containsMaxSaveIntegerValues(e){return e instanceof Sh||e instanceof Lh&&e instanceof Ph||e instanceof Th}}class Hp{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var Ft,qo,On,Rr,Ys,Ea,yn,vn,lf,Qa;function Cn(n,e,i){const r=new Int32Array(i);let u=0,h=e.get();for(let c=0;c<r.length;c++){let _=n[h++],y=127&_;_<128||(_=n[h++],y|=(127&_)<<7,_<128||(_=n[h++],y|=(127&_)<<14,_<128||(_=n[h++],y|=(127&_)<<21,_<128||(_=n[h++],y|=(15&_)<<28)))),r[u++]=y}return e.set(h),r}function zd(n,e,i){const r=new BigInt64Array(i);for(let u=0;u<r.length;u++)r[u]=Kp(n,e);return r}function Wp(n,e){let i,r;return r=n[e.get()],e.increment(),i=127&r,r<128?i:(r=n[e.get()],e.increment(),i|=(127&r)<<7,r<128?i:(r=n[e.get()],e.increment(),i|=(127&r)<<14,r<128?i:(r=n[e.get()],e.increment(),i|=(127&r)<<21,r<128?i:(r=n[e.get()],i|=(15&r)<<28,(function(u,h,c){let _,y;if(y=h[c.get()],c.increment(),_=(112&y)>>4,y<128||(y=h[c.get()],c.increment(),_|=(127&y)<<3,y<128)||(y=h[c.get()],c.increment(),_|=(127&y)<<10,y<128)||(y=h[c.get()],c.increment(),_|=(127&y)<<17,y<128)||(y=h[c.get()],c.increment(),_|=(127&y)<<24,y<128)||(y=h[c.get()],c.increment(),_|=(1&y)<<31,y<128))return 4294967296*_+(u>>>0);throw new Error("Expected varint not more than 10 bytes")})(i,n,e)))))}function uf(n,e,i,r){throw new Error("FastPFor is not implemented yet.")}function Js(n){return n>>>1^-(1&n)}function Kl(n){return n>>1n^-(1n&n)}function Kp(n,e){let i=0n,r=0,u=e.get();for(;u<n.length;){const h=n[u++];if(i|=BigInt(127&h)<<BigInt(r),!(128&h))break;if(r+=7,r>=64)throw new Error("Varint too long")}return e.set(u),i}function df(n,e,i){const r=new Int32Array(i);let u=0;for(let h=0;h<e;h++){const c=n[h];r.fill(n[h+e],u,u+c),u+=c}return r}function hf(n,e,i){const r=new BigInt64Array(i);let u=0;for(let h=0;h<e;h++){const c=Number(n[h]);r.fill(n[h+e],u,u+c),u+=c}return r}function cf(n,e,i){const r=new Float64Array(i);let u=0;for(let h=0;h<e;h++){const c=n[h];r.fill(n[h+e],u,u+c),u+=c}return r}function Mh(n){const e=n.length/4*4;let i=1;if(e>=4)for(let r=n[0];i<e-4;i+=4)r=n[i]+=r,r=n[i+1]+=r,r=n[i+2]+=r,r=n[i+3]+=r;for(;i!=n.length;)n[i]+=n[i-1],++i}function ff(n){n[0]=n[0]>>>1^-(1&n[0]),n[1]=n[1]>>>1^-(1&n[1]);const e=n.length/4*4;let i=2;if(e>=4)for(;i<e-4;i+=4){const r=n[i],u=n[i+1],h=n[i+2],c=n[i+3];n[i]=(r>>>1^-(1&r))+n[i-2],n[i+1]=(u>>>1^-(1&u))+n[i-1],n[i+2]=(h>>>1^-(1&h))+n[i],n[i+3]=(c>>>1^-(1&c))+n[i+1]}for(;i!=n.length;i+=2)n[i]=(n[i]>>>1^-(1&n[i]))+n[i-2],n[i+1]=(n[i+1]>>>1^-(1&n[i+1]))+n[i-1]}(function(n){n.NONE="NONE",n.DELTA="DELTA",n.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",n.RLE="RLE",n.MORTON="MORTON",n.PDE="PDE"})(Ft||(Ft={})),(function(n){n.NONE="NONE",n.FAST_PFOR="FAST_PFOR",n.VARINT="VARINT",n.ALP="ALP"})(qo||(qo={})),(function(n){n.PRESENT="PRESENT",n.DATA="DATA",n.OFFSET="OFFSET",n.LENGTH="LENGTH"})(On||(On={}));class Ch{_dictionaryType;_offsetType;_lengthType;constructor(e,i,r){this._dictionaryType=e,this._offsetType=i,this._lengthType=r}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function aa(n,e){const i=(function(r,u){const h=r[u.get()],c=Object.values(On)[h>>4];let _=null;switch(c){case On.DATA:_=new Ch(Object.values(Rr)[15&h]);break;case On.OFFSET:_=new Ch(null,Object.values(Ys)[15&h]);break;case On.LENGTH:_=new Ch(null,null,Object.values(Ea)[15&h])}u.increment();const y=r[u.get()],k=Object.values(Ft)[y>>5],P=Object.values(Ft)[y>>2&7],E=Object.values(qo)[3&y];u.increment();const D=Cn(r,u,2),A=D[0];return{physicalStreamType:c,logicalStreamType:_,logicalLevelTechnique1:k,logicalLevelTechnique2:P,physicalLevelTechnique:E,numValues:A,byteLength:D[1],decompressedCount:A}})(n,e);return i.logicalLevelTechnique1===Ft.MORTON?(function(r,u,h){const c=Cn(u,h,2);return{physicalStreamType:r.physicalStreamType,logicalStreamType:r.logicalStreamType,logicalLevelTechnique1:r.logicalLevelTechnique1,logicalLevelTechnique2:r.logicalLevelTechnique2,physicalLevelTechnique:r.physicalLevelTechnique,numValues:r.numValues,byteLength:r.byteLength,decompressedCount:r.decompressedCount,numBits:c[0],coordinateShift:c[1]}})(i,n,e):Ft.RLE!==i.logicalLevelTechnique1&&Ft.RLE!==i.logicalLevelTechnique2||qo.NONE===i.physicalLevelTechnique?i:(function(r,u,h){const c=Cn(u,h,2);return{physicalStreamType:r.physicalStreamType,logicalStreamType:r.logicalStreamType,logicalLevelTechnique1:r.logicalLevelTechnique1,logicalLevelTechnique2:r.logicalLevelTechnique2,physicalLevelTechnique:r.physicalLevelTechnique,numValues:r.numValues,byteLength:r.byteLength,decompressedCount:c[1],runs:c[0],numRleValues:c[1]}})(i,n,e)}(function(n){n.NONE="NONE",n.SINGLE="SINGLE",n.SHARED="SHARED",n.VERTEX="VERTEX",n.MORTON="MORTON",n.FSST="FSST"})(Rr||(Rr={})),(function(n){n.VERTEX="VERTEX",n.INDEX="INDEX",n.STRING="STRING",n.KEY="KEY"})(Ys||(Ys={})),(function(n){n.VAR_BINARY="VAR_BINARY",n.GEOMETRIES="GEOMETRIES",n.PARTS="PARTS",n.RINGS="RINGS",n.TRIANGLES="TRIANGLES",n.SYMBOL="SYMBOL",n.DICTIONARY="DICTIONARY"})(Ea||(Ea={})),(function(n){n[n.FLAT=0]="FLAT",n[n.CONST=1]="CONST",n[n.SEQUENCE=2]="SEQUENCE",n[n.DICTIONARY=3]="DICTIONARY",n[n.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(yn||(yn={}));class jr{values;_size;constructor(e,i){this.values=e,this._size=i}get(e){const i=Math.floor(e/8);return(this.values[i]>>e%8&1)==1}set(e,i){const r=Math.floor(e/8);this.values[r]=this.values[r]|(i?1:0)<<e%8}getInt(e){const i=Math.floor(e/8);return this.values[i]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function ra(n,e,i,r,u){return(function(h,c,_){switch(c.logicalLevelTechnique1){case Ft.DELTA:return c.logicalLevelTechnique2===Ft.RLE?(function(y,k,P){const E=new Int32Array(P);let D=0,A=0;for(let O=0;O<k;O++){const $=y[O],N=Js(y[O+k]);for(let H=0;H<$;H++)A+=N,E[D++]=A}return E})(h,c.runs,c.numRleValues):((function(y){y[0]=y[0]>>>1^-(1&y[0]);const k=y.length/4*4;let P=1;if(k>=4)for(;P<k-4;P+=4){const E=y[P],D=y[P+1],A=y[P+2],O=y[P+3];y[P]=(E>>>1^-(1&E))+y[P-1],y[P+1]=(D>>>1^-(1&D))+y[P],y[P+2]=(A>>>1^-(1&A))+y[P+1],y[P+3]=(O>>>1^-(1&O))+y[P+2]}for(;P!=y.length;++P)y[P]=(y[P]>>>1^-(1&y[P]))+y[P-1]})(h),h);case Ft.RLE:return(function(y,k,P){return P?(function(E,D,A){const O=new Int32Array(A);let $=0;for(let N=0;N<D;N++){const H=E[N];let ne=E[N+D];ne=ne>>>1^-(1&ne),O.fill(ne,$,$+H),$+=H}return O})(y,k.runs,k.numRleValues):df(y,k.runs,k.numRleValues)})(h,c,_);case Ft.MORTON:return Mh(h),h;case Ft.COMPONENTWISE_DELTA:return ff(h),h;case Ft.NONE:return _&&(function(y){for(let k=0;k<y.length;k++){const P=y[k];y[k]=P>>>1^-(1&P)}})(h),h;default:throw new Error(`The specified Logical level technique is not supported: ${c.logicalLevelTechnique1}`)}})(Id(n,e,i),i,r)}function xs(n,e,i){return(function(r,u){if(u.logicalLevelTechnique1===Ft.DELTA&&u.logicalLevelTechnique2===Ft.NONE)return(function(c){const _=new Int32Array(c.length+1);_[0]=0,_[1]=Js(c[0]);let y=_[1],k=2;for(;k!=_.length;++k){const P=c[k-1];y+=P>>>1^-(1&P),_[k]=_[k-1]+y}return _})(r);if(u.logicalLevelTechnique1===Ft.RLE&&u.logicalLevelTechnique2===Ft.NONE)return(function(c,_,y){const k=new Int32Array(y+1);k[0]=0;let P=1,E=k[0];for(let D=0;D<_;D++){const A=c[D],O=c[D+_];for(let $=P;$<P+A;$++)k[$]=O+E,E=k[$];P+=A}return k})(r,u.runs,u.numRleValues);if(u.logicalLevelTechnique1===Ft.NONE&&u.logicalLevelTechnique2===Ft.NONE){(function(c){let _=0;for(let y=0;y<c.length;y++)c[y]+=_,_=c[y]})(r);const h=new Int32Array(u.numValues+1);return h[0]=0,h.set(r,1),h}if(u.logicalLevelTechnique1===Ft.DELTA&&u.logicalLevelTechnique2===Ft.RLE){const h=(function(c,_,y){const k=new Int32Array(y+1);k[0]=0;let P=1,E=k[0];for(let D=0;D<_;D++){const A=c[D];let O=c[D+_];O=O>>>1^-(1&O);for(let $=P;$<P+A;$++)k[$]=O+E,E=k[$];P+=A}return k})(r,u.runs,u.numRleValues);return Mh(h),h}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(Id(n,e,i),i)}function Id(n,e,i){const r=i.physicalLevelTechnique;if(r===qo.FAST_PFOR)return uf();if(r===qo.VARINT)return Cn(n,e,i.numValues);if(r===qo.NONE){const u=e.get();e.add(i.byteLength);const h=n.subarray(u,e.get());return new Int32Array(h)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function Eh(n,e,i,r){const u=Id(n,e,i);if(u.length===1){const h=u[0];return r?Js(h):h}return r?(function(h){return Js(h[1])})(u):(function(h){return h[1]})(u)}function mf(n,e,i){return(function(r){if(r.length==2){const u=Js(r[1]);return[u,u]}return[Js(r[2]),Js(r[3])]})(Id(n,e,i))}function pf(n,e,i){return(function(r){if(r.length==2){const u=Kl(r[1]);return[u,u]}return[Kl(r[2]),Kl(r[3])]})(zd(n,e,i.numValues))}function _f(n,e,i,r){return(function(u,h,c){switch(h.logicalLevelTechnique1){case Ft.DELTA:return h.logicalLevelTechnique2===Ft.RLE?(function(_,y,k){const P=new BigInt64Array(k);let E=0,D=0n;for(let A=0;A<y;A++){const O=Number(_[A]),$=Kl(_[A+y]);for(let N=0;N<O;N++)D+=$,P[E++]=D}return P})(u,h.runs,h.numRleValues):((function(_){_[0]=_[0]>>1n^-(1n&_[0]);const y=_.length/4*4;let k=1;if(y>=4)for(;k<y-4;k+=4){const P=_[k],E=_[k+1],D=_[k+2],A=_[k+3];_[k]=(P>>1n^-(1n&P))+_[k-1],_[k+1]=(E>>1n^-(1n&E))+_[k],_[k+2]=(D>>1n^-(1n&D))+_[k+1],_[k+3]=(A>>1n^-(1n&A))+_[k+2]}for(;k!=_.length;++k)_[k]=(_[k]>>1n^-(1n&_[k]))+_[k-1]})(u),u);case Ft.RLE:return(function(_,y,k){return k?(function(P,E,D){const A=new BigInt64Array(D);let O=0;for(let $=0;$<E;$++){const N=Number(P[$]);let H=P[$+E];H=H>>1n^-(1n&H),A.fill(H,O,O+N),O+=N}return A})(_,y.runs,y.numRleValues):hf(_,y.runs,y.numRleValues)})(u,h,c);case Ft.NONE:return c&&(function(_){for(let y=0;y<_.length;y++){const k=_[y];_[y]=k>>1n^-(1n&k)}})(u),u;default:throw new Error(`The specified Logical level technique is not supported: ${h.logicalLevelTechnique1}`)}})(zd(n,e,i.numValues),i,r)}function gf(n,e,i,r){const u=zd(n,e,i.numValues);if(u.length===1){const h=u[0];return r?Kl(h):h}return r?(function(h){return Kl(h[1])})(u):(function(h){return h[1]})(u)}function zh(n,e,i,r,u){return(function(h,c,_,y){switch(c.logicalLevelTechnique1){case Ft.DELTA:return c.logicalLevelTechnique2===Ft.RLE&&(h=df(h,c.runs,c.numRleValues)),(function(k,P){const E=new Int32Array(k.size());let D=0;k.get(0)?(E[0]=k.get(0)?P[0]>>>1^-(1&P[0]):0,D=1):E[0]=0;let A=1;for(;A!=E.length;++A)E[A]=k.get(A)?E[A-1]+(P[D]>>>1^-(1&P[D++])):E[A-1];return E})(y,h);case Ft.RLE:return(function(k,P,E,D){const A=P;return E?(function(O,$,N){const H=new Int32Array(O.size());let ne=0;for(let K=0;K<N;K++){const J=$[K];let oe=$[K+N];oe=oe>>>1^-(1&oe);for(let de=ne;de<ne+J;de++)O.get(de)?H[de]=oe:(H[de]=0,ne++);ne+=J}return H})(D,k,A.runs):(function(O,$,N){const H=new Int32Array(O.size());let ne=0;for(let K=0;K<N;K++){const J=$[K],oe=$[K+N];for(let de=ne;de<ne+J;de++)O.get(de)?H[de]=oe:(H[de]=0,ne++);ne+=J}return H})(D,k,A.runs)})(h,c,_,y);case Ft.MORTON:return Mh(h),h;case Ft.COMPONENTWISE_DELTA:return ff(h),h;case Ft.NONE:return h=_?(function(k,P){const E=new Int32Array(k.size());let D=0,A=0;for(;A!=E.length;++A)if(k.get(A)){const O=P[D++];E[A]=O>>>1^-(1&O)}else E[A]=0;return E})(y,h):(function(k,P){const E=new Int32Array(k.size());let D=0,A=0;for(;A!=E.length;++A)E[A]=k.get(A)?P[D++]:0;return E})(y,h),h;default:throw new Error("The specified Logical level technique is not supported")}})(i.physicalLevelTechnique===qo.FAST_PFOR?uf():Cn(n,e,i.numValues),i,r,u)}function Dd(n,e,i,r){const u=n.logicalLevelTechnique1;if(u===Ft.RLE)return n.runs===1?yn.CONST:yn.FLAT;const h=e instanceof jr?e.size():e;if(u===Ft.DELTA&&n.logicalLevelTechnique2===Ft.RLE){const c=n.runs,_=2;if(n.numRleValues!==h)return yn.FLAT;if(c===1)return yn.SEQUENCE;if(c===2){const y=r.get();let k;if(n.physicalLevelTechnique===qo.VARINT)k=Cn(i,r,4);else{const P=r.get();k=new Int32Array(i.buffer,i.byteOffset+P,4)}if(r.set(y),k[2]===_&&k[3]===_)return yn.SEQUENCE}}return n.numValues===1?yn.CONST:yn.FLAT}class yf extends Ed{getValueFromBuffer(e){return this.dataBuffer[e]}}class vf extends sf{constructor(e,i,r,u){super(e,BigInt64Array.of(i),r,u)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class Xl{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,i,r){this._geometryOffsets=e,this._partOffsets=i,this._ringOffsets=r}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function Ih(n,e,i){return{x:xf(n,e)-i,y:xf(n>>1,e)-i}}function xf(n,e){let i=0;for(let r=0;r<e;r++)i|=(n&1<<2*r)>>r;return i}(function(n){n[n.POINT=0]="POINT",n[n.LINESTRING=1]="LINESTRING",n[n.POLYGON=2]="POLYGON",n[n.MULTIPOINT=3]="MULTIPOINT",n[n.MULTILINESTRING=4]="MULTILINESTRING",n[n.MULTIPOLYGON=5]="MULTIPOLYGON"})(vn||(vn={})),(function(n){n[n.POINT=0]="POINT",n[n.LINESTRING=1]="LINESTRING",n[n.POLYGON=2]="POLYGON"})(lf||(lf={})),(function(n){n[n.MORTON=0]="MORTON",n[n.VEC_2=1]="VEC_2",n[n.VEC_3=2]="VEC_3"})(Qa||(Qa={}));class Xp{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((i=>[i]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,i){return[e].concat(i)}createMultiPolygon(e){return e.flat()}}function wf(n){const e=new Array(n.numGeometries);let i=1,r=1,u=1,h=0;const c=new Xp;let _=0,y=0;const k=n.mortonSettings,P=n.topologyVector,E=P.geometryOffsets,D=P.partOffsets,A=P.ringOffsets,O=n.vertexOffsets,$=n.containsPolygonGeometry(),N=n.vertexBuffer;for(let H=0;H<n.numGeometries;H++){const ne=n.geometryType(H);if(ne===vn.POINT){if(O&&O.length!==0)if(n.vertexBufferType===Qa.VEC_2){const K=2*O[y++],J=new I(N[K],N[K+1]);e[h++]=c.createPoint(J)}else{const K=Ih(N[O[y++]],k.numBits,k.coordinateShift),J=new I(K.x,K.y);e[h++]=c.createPoint(J)}else{const K=new I(N[_++],N[_++]);e[h++]=c.createPoint(K)}E&&u++,D&&i++,A&&r++}else if(ne===vn.MULTIPOINT){const K=E[u]-E[u-1];u++;const J=new Array(K);if(O&&O.length!==0){for(let oe=0;oe<K;oe++){const de=2*O[y++];J[oe]=new I(N[de],N[de+1])}e[h++]=c.createMultiPoint(J)}else{for(let oe=0;oe<K;oe++){const de=N[_++],we=N[_++];J[oe]=new I(de,we)}e[h++]=c.createMultiPoint(J)}}else if(ne===vn.LINESTRING){let K,J=0;$?(J=A[r]-A[r-1],r++):J=D[i]-D[i-1],i++,O&&O.length!==0?(K=n.vertexBufferType===Qa.VEC_2?Ah(N,O,y,J,!1):Rh(N,O,y,J,!1,k),y+=J):(K=Dh(N,_,J,!1),_+=2*J),e[h++]=c.createLineString(K),E&&u++}else if(ne===vn.POLYGON){const K=D[i]-D[i-1];i++;const J=new Array(K-1);let oe=A[r]-A[r-1];if(r++,O&&O.length!==0){const de=n.vertexBufferType===Qa.VEC_2?Rd(N,O,y,oe):jd(N,O,y,oe,0,k);y+=oe;for(let we=0;we<J.length;we++)oe=A[r]-A[r-1],r++,J[we]=n.vertexBufferType===Qa.VEC_2?Rd(N,O,y,oe):jd(N,O,y,oe,0,k),y+=oe;e[h++]=c.createPolygon(de,J)}else{const de=Ad(N,_,oe);_+=2*oe;for(let we=0;we<J.length;we++)oe=A[r]-A[r-1],r++,J[we]=Ad(N,_,oe),_+=2*oe;e[h++]=c.createPolygon(de,J)}E&&u++}else if(ne===vn.MULTILINESTRING){const K=E[u]-E[u-1];u++;const J=new Array(K);if(O&&O.length!==0){for(let oe=0;oe<K;oe++){let de=0;$?(de=A[r]-A[r-1],r++):de=D[i]-D[i-1],i++;const we=n.vertexBufferType===Qa.VEC_2?Ah(N,O,y,de,!1):Rh(N,O,y,de,!1,k);J[oe]=we,y+=de}e[h++]=c.createMultiLineString(J)}else{for(let oe=0;oe<K;oe++){let de=0;$?(de=A[r]-A[r-1],r++):de=D[i]-D[i-1],i++,J[oe]=Dh(N,_,de,!1),_+=2*de}e[h++]=c.createMultiLineString(J)}}else{if(ne!==vn.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const K=E[u]-E[u-1];u++;const J=new Array(K);let oe=0;if(O&&O.length!==0){for(let de=0;de<K;de++){const we=D[i]-D[i-1];i++;const Ve=new Array(we-1);oe=A[r]-A[r-1],r++;const je=n.vertexBufferType===Qa.VEC_2?Rd(N,O,y,oe):jd(N,O,y,oe,0,k);y+=oe;for(let Ne=0;Ne<Ve.length;Ne++)oe=A[r]-A[r-1],r++,Ve[Ne]=n.vertexBufferType===Qa.VEC_2?Rd(N,O,y,oe):jd(N,O,y,oe,0,k),y+=oe;J[de]=c.createPolygon(je,Ve)}e[h++]=c.createMultiPolygon(J)}else{for(let de=0;de<K;de++){const we=D[i]-D[i-1];i++;const Ve=new Array(we-1);oe=A[r]-A[r-1],r++;const je=Ad(N,_,oe);_+=2*oe;for(let Ne=0;Ne<Ve.length;Ne++){const Ye=A[r]-A[r-1];r++,Ve[Ne]=Ad(N,_,Ye),_+=2*Ye}J[de]=c.createPolygon(je,Ve)}e[h++]=c.createMultiPolygon(J)}}}}return e}function Ad(n,e,i){return Dh(n,e,i,!0)}function Rd(n,e,i,r){return Ah(n,e,i,r,!0)}function jd(n,e,i,r,u,h){return Rh(n,e,i,r,!0,h)}function Dh(n,e,i,r){const u=new Array(r?i+1:i);for(let h=0;h<2*i;h+=2)u[h/2]=new I(n[e+h],n[e+h+1]);return r&&(u[u.length-1]=u[0]),u}function Ah(n,e,i,r,u){const h=new Array(u?r+1:r);for(let c=0;c<2*r;c+=2){const _=2*e[i+c/2];h[c/2]=new I(n[_],n[_+1])}return u&&(h[h.length-1]=h[0]),h}function Rh(n,e,i,r,u,h){const c=new Array(u?r+1:r);for(let _=0;_<r;_++){const y=Ih(n[e[i+_]],h.numBits,h.coordinateShift);c[_]=new I(y.x,y.y)}return u&&(c[c.length-1]=c[0]),c}class bf{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,i,r,u,h){this._vertexBufferType=e,this._topologyVector=i,this._vertexOffsets=r,this._vertexBuffer=u,this._mortonSettings=h}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=wf(this);let i=0;for(;i<this.numGeometries;)yield{coordinates:e[i],type:this.geometryType(i)},i++}getSimpleEncodedVertex(e){const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const r=Ih(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[r.x,r.y]}const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getGeometries(){return wf(this)}get mortonSettings(){return this._mortonSettings}}class kf extends bf{_numGeometries;_geometryType;constructor(e,i,r,u,h,c,_){super(r,u,h,c,_),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===vn.POLYGON||this._geometryType===vn.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class Sf extends bf{_geometryTypes;constructor(e,i,r,u,h,c){super(e,r,u,h,c),this._geometryTypes=i}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===vn.POLYGON||this.geometryType(e)===vn.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class Tf{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,i,r,u){this._triangleOffsets=e,this._indexBuffer=i,this._vertexBuffer=r,this._topologyVector=u}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),i=this._topologyVector,r=i.partOffsets,u=i.ringOffsets,h=i.geometryOffsets;let c=0,_=1,y=1,k=1;for(let P=0;P<this.numGeometries;P++)switch(this.geometryType(P)){case vn.POLYGON:{const E=r[_]-r[_-1];_++;const D=[];for(let A=0;A<E;A++){const O=u[y]-u[y-1];y++;const $=[];for(let N=0;N<O;N++){const H=this._vertexBuffer[c++],ne=this._vertexBuffer[c++];$.push(new I(H,ne))}$.length>0&&$.push($[0]),D.push($)}e[P]=D,h&&k++}break;case vn.MULTIPOLYGON:{const E=h[k]-h[k-1];k++;const D=[];for(let A=0;A<E;A++){const O=r[_]-r[_-1];_++;for(let $=0;$<O;$++){const N=u[y]-u[y-1];y++;const H=[];for(let ne=0;ne<N;ne++){const K=this._vertexBuffer[c++],J=this._vertexBuffer[c++];H.push(new I(K,J))}H.length>0&&H.push(H[0]),D.push(H)}}e[P]=D}}return e}[Symbol.iterator](){return null}}function Pf(n,e,i,r,u,h){return new Yp(n,e,i,r,u,h)}class Yp extends Tf{_numGeometries;_geometryType;constructor(e,i,r,u,h,c){super(r,u,h,c),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function Lf(n,e,i,r,u){return new Jp(n,e,i,r,u)}class Jp extends Tf{_geometryTypes;constructor(e,i,r,u,h){super(i,r,u,h),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function Qp(n,e,i,r,u){const h=aa(n,i);let c=null,_=null,y=null,k=null,P=null,E=null,D=null,A=null;if(Dd(h,r,n,i)===yn.CONST){const $=Eh(n,i,h,!1);for(let N=0;N<e-1;N++){const H=aa(n,i);switch(H.physicalStreamType){case On.LENGTH:switch(H.logicalStreamType.lengthType){case Ea.GEOMETRIES:c=xs(n,i,H);break;case Ea.PARTS:_=xs(n,i,H);break;case Ea.RINGS:y=xs(n,i,H);break;case Ea.TRIANGLES:D=xs(n,i,H)}break;case On.OFFSET:switch(H.logicalStreamType.offsetType){case Ys.VERTEX:k=ra(n,i,H,!1);break;case Ys.INDEX:A=ra(n,i,H,!1)}break;case On.DATA:Rr.VERTEX===H.logicalStreamType.dictionaryType?P=ra(n,i,H,!0):(E={numBits:H.numBits,coordinateShift:H.coordinateShift},P=ra(n,i,H,!1))}}return A!==null?c!=null||_!=null?Pf(r,$,D,A,P,new Xl(c,_,y)):Pf(r,$,D,A,P):E===null?(function(N,H,ne,K,J){return new kf(N,H,Qa.VEC_2,ne,K,J)})(r,$,new Xl(c,_,y),k,P):(function(N,H,ne,K,J,oe){return new kf(N,H,Qa.MORTON,ne,K,J,oe)})(r,$,new Xl(c,_,y),k,P,E)}const O=ra(n,i,h,!1);for(let $=0;$<e-1;$++){const N=aa(n,i);switch(N.physicalStreamType){case On.LENGTH:switch(N.logicalStreamType.lengthType){case Ea.GEOMETRIES:c=ra(n,i,N,!1);break;case Ea.PARTS:_=ra(n,i,N,!1);break;case Ea.RINGS:y=ra(n,i,N,!1);break;case Ea.TRIANGLES:D=xs(n,i,N)}break;case On.OFFSET:switch(N.logicalStreamType.offsetType){case Ys.VERTEX:k=ra(n,i,N,!1);break;case Ys.INDEX:A=ra(n,i,N,!1)}break;case On.DATA:Rr.VERTEX===N.logicalStreamType.dictionaryType?P=ra(n,i,N,!0):(E={numBits:N.numBits,coordinateShift:N.coordinateShift},P=ra(n,i,N,!1))}}return A!==null&&_===null?Lf(O,D,A,P):(c!==null?(c=jh(O,c,2),_!==null&&y!==null?(_=Mf(O,c,_,!1),y=(function($,N,H,ne){const K=new Int32Array(H[H.length-1]+1);let J=0;K[0]=J;let oe=1,de=1,we=0;for(let Ve=0;Ve<$.length;Ve++){const je=$[Ve],Ne=N[Ve+1]-N[Ve];if(je!==0&&je!==3)for(let Ye=0;Ye<Ne;Ye++){const qe=H[oe]-H[oe-1];oe++;for(let Be=0;Be<qe;Be++)J=K[de++]=J+ne[we++]}else for(let Ye=0;Ye<Ne;Ye++)K[de++]=++J,oe++}return K})(O,c,_,y)):_!==null&&(_=(function($,N,H){const ne=new Int32Array(N[N.length-1]+1);let K=0;ne[0]=K;let J=1,oe=0;for(let de=0;de<$.length;de++){const we=$[de],Ve=N[de+1]-N[de];if(we===4||we===1)for(let je=0;je<Ve;je++)K=ne[J++]=K+H[oe++];else for(let je=0;je<Ve;je++)ne[J++]=++K}return ne})(O,c,_))):_!==null&&y!==null?(_=jh(O,_,1),y=Mf(O,_,y,!0)):_!==null&&(_=jh(O,_,0)),A!==null?Lf(O,D,A,P,new Xl(c,_,y)):E===null?(function($,N,H,ne){return new Sf(Qa.VEC_2,$,N,H,ne)})(O,new Xl(c,_,y),k,P):(function($,N,H,ne,K){return new Sf(Qa.MORTON,$,N,H,ne,K)})(O,new Xl(c,_,y),k,P,E))}function jh(n,e,i){const r=new Int32Array(n.length+1);let u=0;r[0]=u;let h=0;for(let c=0;c<n.length;c++)u=r[c+1]=u+(n[c]>i?e[h++]:1);return r}function Mf(n,e,i,r){const u=new Int32Array(e[e.length-1]+1);let h=0;u[0]=h;let c=1,_=0;for(let y=0;y<n.length;y++){const k=n[y],P=e[y+1]-e[y];if(k===5||k===2||r&&(k===4||k===1))for(let E=0;E<P;E++)h=u[c++]=h+i[_++];else for(let E=0;E<P;E++)u[c++]=++h}return u}class e_ extends Wl{dataVector;constructor(e,i,r){super(e,i.getBuffer(),r),this.dataVector=i}getValueFromBuffer(e){return this.dataVector.get(e)}}class t_ extends Ed{getValueFromBuffer(e){return this.dataBuffer[e]}}class Cf extends Wl{constructor(e,i,r){super(e,BigInt64Array.of(i),r)}getValueFromBuffer(e){return this.dataBuffer[0]}}function Uu(n,e,i){return Ef(n,Math.ceil(e/8),i)}function Ef(n,e,i){const r=new Uint8Array(e);let u=0;for(;u<e;){const h=n[i.increment()];if(h<=127){const c=h+3,_=n[i.increment()],y=u+c;r.fill(_,u,y),u=y}else{const c=256-h;for(let _=0;_<c;_++)r[u++]=n[i.increment()]}}return r}const i_=new TextDecoder;function Fh(n,e,i){return i-e>=12?i_.decode(n.subarray(e,i)):(function(r,u,h){let c="",_=u;for(;_<h;){const y=r[_];let k,P,E,D=null,A=y>239?4:y>223?3:y>191?2:1;if(_+A>h)break;A===1?y<128&&(D=y):A===2?(k=r[_+1],(192&k)==128&&(D=(31&y)<<6|63&k,D<=127&&(D=null))):A===3?(k=r[_+1],P=r[_+2],(192&k)==128&&(192&P)==128&&(D=(15&y)<<12|(63&k)<<6|63&P,(D<=2047||D>=55296&&D<=57343)&&(D=null))):A===4&&(k=r[_+1],P=r[_+2],E=r[_+3],(192&k)==128&&(192&P)==128&&(192&E)==128&&(D=(15&y)<<18|(63&k)<<12|(63&P)<<6|63&E,(D<=65535||D>=1114112)&&(D=null))),D===null?(D=65533,A=1):D>65535&&(D-=65536,c+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),c+=String.fromCharCode(D),_+=A}return c})(n,e,i)}class Bh extends Wl{offsetBuffer;constructor(e,i,r,u){super(e,r,u),this.offsetBuffer=i}}class zf extends Bh{textEncoder;constructor(e,i,r,u){super(e,i,r,u??i.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return Fh(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class Yl extends Bh{indexBuffer;textEncoder;constructor(e,i,r,u,h){super(e,r,u,h??i.length),this.indexBuffer=i,this.indexBuffer=i,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const i=this.indexBuffer[e];return Fh(this.dataBuffer,this.offsetBuffer[i],this.offsetBuffer[i+1])}}class If extends Bh{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,i,r,u,h,c,_){super(e,r,u,_),this.indexBuffer=i,this.symbolOffsetBuffer=h,this.symbolTableBuffer=c,this.textEncoder=new TextEncoder}getValueFromBuffer(e){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(r,u,h){const c=[],_=new Array(u.length).fill(0);for(let y=1;y<u.length;y++)_[y]=_[y-1]+u[y-1];for(let y=0;y<h.length;y++)if(h[y]===255)c.push(h[++y]);else{const k=u[h[y]],P=_[h[y]];for(let E=0;E<k;E++)c.push(r[P+E])}return new Uint8Array(c)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const i=this.indexBuffer[e];return Fh(this.decodedDictionary,this.offsetBuffer[i],this.offsetBuffer[i+1])}offsetToLengthBuffer(e){const i=new Uint32Array(e.length-1);let r=e[0];for(let u=1;u<e.length;u++){const h=e[u];i[u-1]=h-r,r=h}return i}}function n_(n,e,i,r,u,h){return i.type==="scalarType"?(function(c,_,y,k,P,E){let D=null,A=0;if(c===0)return null;if(E.nullable){const $=aa(_,y);A=$.numValues;const N=y.get(),H=Uu(_,A,y);y.set(N+$.byteLength),D=new jr(H,$.numValues)}const O=D??k;switch(P.physicalType){case 4:case 3:return(function($,N,H,ne,K){const J=aa($,N),oe=Dd(J,K,$,N),de=ne.physicalType===3;if(oe===yn.FLAT){const we=Gu(K)?zh($,N,J,de,K):ra($,N,J,de);return new Sh(H.name,we,K)}if(oe===yn.SEQUENCE){const we=mf($,N,J);return new Ph(H.name,we[0],we[1],J.numRleValues)}{const we=Eh($,N,J,de);return new Lh(H.name,we,K)}})(_,y,E,P,O);case 9:return(function($,N,H,ne,K){let J=null,oe=null,de=null,we=null,Ve=null,je=null,Ne=null,Ye=null;for(let qe=0;qe<ne;qe++){const Be=aa(N,H);if(Be.byteLength!==0)switch(Be.physicalStreamType){case On.PRESENT:{const ze=Uu(N,Be.numValues,H);je=new jr(ze,Be.numValues);break}case On.OFFSET:oe=K!=null||je!=null?zh(N,H,Be,!1,K??je):ra(N,H,Be,!1);break;case On.LENGTH:{const ze=xs(N,H,Be);Ea.DICTIONARY===Be.logicalStreamType.lengthType?J=ze:Ea.SYMBOL===Be.logicalStreamType.lengthType?we=ze:Ne=ze;break}case On.DATA:{const ze=N.subarray(H.get(),H.get()+Be.byteLength);H.add(Be.byteLength);const at=Be.logicalStreamType.dictionaryType;Rr.FSST===at?Ve=ze:Rr.SINGLE===at||Rr.SHARED===at?de=ze:Rr.NONE===at&&(Ye=ze);break}}}return(function(qe,Be,ze,at,tt,lt,et){return Be?new If(qe,ze,at,tt,lt,Be,et):null})($,Ve,oe,J,de,we,K??je)??(function(qe,Be,ze,at,tt){return Be?tt?new Yl(qe,ze,at,Be,tt):new Yl(qe,ze,at,Be):null})($,de,oe,J,K??je)??(function(qe,Be,ze,at,tt){if(!Be||!ze)return null;if(at)return tt?new Yl(qe,at,Be,ze,tt):new Yl(qe,at,Be,ze);if(tt&&tt.size()!==Be.length-1){const lt=new Int32Array(tt.size());let et=0;for(let ct=0;ct<tt.size();ct++)lt[ct]=tt.get(ct)?et++:0;return new Yl(qe,lt,Be,ze,tt)}return tt?new zf(qe,Be,ze,tt):new zf(qe,Be,ze)})($,Ne,Ye,oe,K??je)})(E.name,_,y,E.nullable?c-1:c,D);case 0:return(function($,N,H,ne,K){const J=aa($,N),oe=J.numValues,de=N.get(),we=Gu(K)?(function(je,Ne,Ye,qe){const Be=Ef(je,Math.ceil(Ne/8),Ye),ze=new jr(Be,Ne),at=qe.size(),tt=new jr(new Uint8Array(at),at);let lt=0;for(let et=0;et<qe.size();et++){const ct=!!qe.get(et)&&ze.get(lt++);tt.set(et,ct)}return tt.getBuffer()})($,oe,N,K):Uu($,oe,N);N.set(de+J.byteLength);const Ve=new jr(we,oe);return new e_(H.name,Ve,K)})(_,y,E,0,O);case 6:case 5:return(function($,N,H,ne,K){const J=aa($,N),oe=Dd(J,ne,$,N),de=K.physicalType===5;if(oe===yn.FLAT){const we=Gu(ne)?(function(Ve,je,Ne,Ye,qe){return(function(Be,ze,at,tt){switch(ze.logicalLevelTechnique1){case Ft.DELTA:return ze.logicalLevelTechnique2===Ft.RLE&&(Be=hf(Be,ze.runs,ze.numRleValues)),(function(lt,et){const ct=new BigInt64Array(lt.size());let Nt=0;lt.get(0)?(ct[0]=lt.get(0)?et[0]>>1n^-(1n&et[0]):0n,Nt=1):ct[0]=0n;let At=1;for(;At!=ct.length;++At)ct[At]=lt.get(At)?ct[At-1]+(et[Nt]>>1n^-(1n&et[Nt++])):ct[At-1];return ct})(tt,Be);case Ft.RLE:return(function(lt,et,ct,Nt){const At=et;return ct?(function(Si,Vn,en){const Ti=new BigInt64Array(Si.size());let gi=0;for(let Xt=0;Xt<en;Xt++){const $i=Number(Vn[Xt]);let Zi=Vn[Xt+en];Zi=Zi>>1n^-(1n&Zi);for(let fi=gi;fi<gi+$i;fi++)Si.get(fi)?Ti[fi]=Zi:(Ti[fi]=0n,gi++);gi+=$i}return Ti})(Nt,lt,At.runs):(function(Si,Vn,en){const Ti=new BigInt64Array(Si.size());let gi=0;for(let Xt=0;Xt<en;Xt++){const $i=Number(Vn[Xt]),Zi=Vn[Xt+en];for(let fi=gi;fi<gi+$i;fi++)Si.get(fi)?Ti[fi]=Zi:(Ti[fi]=0n,gi++);gi+=$i}return Ti})(Nt,lt,At.runs)})(Be,ze,at,tt);case Ft.NONE:return Be=at?(function(lt,et){const ct=new BigInt64Array(lt.size());let Nt=0,At=0;for(;At!=ct.length;++At)if(lt.get(At)){const Si=et[Nt++];ct[At]=Si>>1n^-(1n&Si)}else ct[At]=0n;return ct})(tt,Be):(function(lt,et){const ct=new BigInt64Array(lt.size());let Nt=0,At=0;for(;At!=ct.length;++At)ct[At]=lt.get(At)?et[Nt++]:0n;return ct})(tt,Be),Be;default:throw new Error("The specified Logical level technique is not supported")}})(zd(Ve,je,Ne.numValues),Ne,Ye,qe)})($,N,J,de,ne):_f($,N,J,de);return new yf(H.name,we,ne)}if(oe===yn.SEQUENCE){const we=pf($,N,J);return new vf(H.name,we[0],we[1],J.numRleValues)}{const we=gf($,N,J,de);return new Cf(H.name,we,ne)}})(_,y,E,O,P);case 7:return(function($,N,H,ne){const K=aa($,N),J=Gu(ne)?(function(oe,de,we,Ve){const je=de.get(),Ne=je+Ve*Float32Array.BYTES_PER_ELEMENT,Ye=new Uint8Array(oe.subarray(je,Ne)).buffer,qe=new Float32Array(Ye);de.set(Ne);const Be=we.size(),ze=new Float32Array(Be);let at=0;for(let tt=0;tt<Be;tt++)ze[tt]=we.get(tt)?qe[at++]:0;return ze})($,N,ne,K.numValues):(function(oe,de,we){const Ve=de.get(),je=Ve+we*Float32Array.BYTES_PER_ELEMENT,Ne=new Uint8Array(oe.subarray(Ve,je)).buffer,Ye=new Float32Array(Ne);return de.set(je),Ye})($,N,K.numValues);return new t_(H.name,J,ne)})(_,y,E,O);case 8:return(function($,N,H,ne){const K=aa($,N),J=Gu(ne)?(function(oe,de,we,Ve){const je=de.get(),Ne=je+Ve*Float64Array.BYTES_PER_ELEMENT,Ye=new Uint8Array(oe.subarray(je,Ne)).buffer,qe=new Float64Array(Ye);de.set(Ne);const Be=we.size(),ze=new Float64Array(Be);let at=0;for(let tt=0;tt<Be;tt++)ze[tt]=we.get(tt)?qe[at++]:0;return ze})($,N,ne,K.numValues):(function(oe,de,we){const Ve=de.get(),je=Ve+we*Float64Array.BYTES_PER_ELEMENT,Ne=new Uint8Array(oe.subarray(Ve,je)).buffer,Ye=new Float64Array(Ne);return de.set(je),Ye})($,N,K.numValues);return new Th(H.name,J,ne)})(_,y,E,O);default:throw new Error(`The specified data type for the field is currently not supported: ${P}`)}})(r,n,e,u,i.scalarType,i):r!=1?null:(function(c,_,y,k){let P=null,E=null,D=null,A=null,O=!1;for(;!O;){const ne=aa(c,_);switch(ne.physicalStreamType){case On.LENGTH:Ea.DICTIONARY===ne.logicalStreamType.lengthType?P=xs(c,_,ne):D=xs(c,_,ne);break;case On.DATA:Rr.SINGLE===ne.logicalStreamType.dictionaryType||Rr.SHARED===ne.logicalStreamType.dictionaryType?(E=c.subarray(_.get(),_.get()+ne.byteLength),O=!0):A=c.subarray(_.get(),_.get()+ne.byteLength),_.add(ne.byteLength)}}const $=y.complexType.children,N=[];let H=0;for(const ne of $){const K=Cn(c,_,1)[0];if(K==0)continue;const J=`${y.name}${ne.name==="default"?"":":"+ne.name}`;if(K!==2||ne.type!=="scalarField"||ne.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const oe=aa(c,_),de=Uu(c,oe.numValues,_),we=aa(c,_),Ve=we.decompressedCount!==k?zh(c,_,we,!1,new jr(de,oe.numValues)):ra(c,_,we,!1);N[H++]=A?new If(J,Ve,P,E,D,A,new jr(de,oe.numValues)):new Yl(J,Ve,P,E,new jr(de,oe.numValues))}return N})(n,e,i,u)}function Gu(n){return n instanceof jr}function a_(n){if(n.name==="id")return!1;if(n.type==="scalarType"){const e=n.scalarType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(e.type==="logicalType")return!1}else if(n.type==="complexType"){const e=n.complexType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",n),!1}const r_=new TextDecoder;function Df(n,e){const i=Cn(n,e,1)[0];if(i===0)return"";const r=e.get(),u=n.subarray(r,r+i);return e.add(i),r_.decode(u)}function Af(n,e){const i=Cn(n,e,1)[0]>>>0,r=!!(4&i),u=!!(2&i),h=Cn(n,e,1)[0]>>>0,c={};if(1&i&&(c.nullable=!0),u){const _={};if(r?(_.type="logicalType",_.logicalType=h):(_.type="physicalType",_.physicalType=h),8&i){const y=Cn(n,e,1)[0]>>>0;_.children=new Array(y);for(let k=0;k<y;k++)_.children[k]=Af(n,e)}c.type="complexField",c.complexField=_}else{const _={};r?(_.type="logicalType",_.logicalType=h):(_.type="physicalType",_.physicalType=h),c.type="scalarField",c.scalarField=_}return c}function o_(n,e){const i=Cn(n,e,1)[0]>>>0,r=(function(u){switch(u){case 0:case 1:case 2:case 3:{const h={};h.nullable=!!(1&u),h.columnScope=0;const c={};return c.physicalType=u>1?6:4,c.type="physicalType",h.scalarType=c,h.type="scalarType",h}case 4:{const h={nullable:!1,columnScope:0},c={type:"physicalType",physicalType:0};return h.type="complexType",h.complexType=c,h}case 30:{const h={nullable:!1,columnScope:0},c={type:"physicalType",physicalType:1};return h.type="complexType",h.complexType=c,h}default:return(function(h){let c=null;switch(h){case 10:case 11:c=0;break;case 12:case 13:c=1;break;case 14:case 15:c=2;break;case 16:case 17:c=3;break;case 18:case 19:c=4;break;case 20:case 21:c=5;break;case 22:case 23:c=6;break;case 24:case 25:c=7;break;case 26:case 27:c=8;break;case 28:case 29:c=9;break;default:return null}const _={};_.nullable=!!(1&h),_.columnScope=0;const y={type:"physicalType"};return y.physicalType=c,_.type="scalarType",_.scalarType=y,_})(u)}})(i);if(!r)throw new Error(`Unsupported column type code: ${i}`);if((function(u){return u>=10})(i)?r.name=Df(n,e):i>=0&&i<=3?r.name="id":i===4&&(r.name="geometry"),(function(u){return u===30})(i)){const u=Cn(n,e,1)[0]>>>0,h=r.complexType;h.children=new Array(u);for(let c=0;c<u;c++)h.children[c]=Af(n,e)}return r}function s_(n,e){const i={featureTables:[]},r={};r.name=Df(n,e);const u=Cn(n,e,1)[0]>>>0,h=Cn(n,e,1)[0]>>>0;r.columns=new Array(h);for(let c=0;c<h;c++)r.columns[c]=o_(n,e);return i.featureTables.push(r),[i,u]}function l_(n,e,i,r,u,h,c=!1){const _=e.scalarType.physicalType,y=Dd(u,h,n,i);if(_===4)switch(y){case yn.FLAT:{const k=ra(n,i,u,!1);return new Sh(r,k,h)}case yn.SEQUENCE:{const k=mf(n,i,u);return new Ph(r,k[0],k[1],u.numRleValues)}case yn.CONST:{const k=Eh(n,i,u,!1);return new Lh(r,k,h)}}else switch(y){case yn.FLAT:{if(c){const P=(function(E,D,A,O){const $=(function(N,H,ne){const K=new Float64Array(H);for(let J=0;J<H;J++)K[J]=Wp(N,ne);return K})(E,A.numValues,D);return(function(N,H,ne){switch(H.logicalLevelTechnique1){case Ft.DELTA:return H.logicalLevelTechnique2===Ft.RLE&&(N=cf(N,H.runs,H.numRleValues)),(function(K){K[0]=K[0]%2==1?(K[0]+1)/-2:K[0]/2;const J=K.length/4*4;let oe=1;if(J>=4)for(;oe<J-4;oe+=4){const de=K[oe],we=K[oe+1],Ve=K[oe+2],je=K[oe+3];K[oe]=(de%2==1?(de+1)/-2:de/2)+K[oe-1],K[oe+1]=(we%2==1?(we+1)/-2:we/2)+K[oe],K[oe+2]=(Ve%2==1?(Ve+1)/-2:Ve/2)+K[oe+1],K[oe+3]=(je%2==1?(je+1)/-2:je/2)+K[oe+2]}for(;oe!=K.length;++oe)K[oe]=(K[oe]%2==1?(K[oe]+1)/-2:K[oe]/2)+K[oe-1]})(N),N;case Ft.RLE:return(function(K,J,oe){return cf(K,J.runs,J.numRleValues)})(N,H);case Ft.NONE:return N;default:throw new Error(`The specified Logical level technique is not supported: ${H.logicalLevelTechnique1}`)}})($,A)})(n,i,u);return new Th(r,P,h)}const k=_f(n,i,u,!1);return new yf(r,k,h)}case yn.SEQUENCE:{const k=pf(n,i,u);return new vf(r,k[0],k[1],u.numRleValues)}case yn.CONST:{const k=gf(n,i,u,!1);return new Cf(r,k,h)}}throw new Error("Vector type not supported for id column.")}class u_{constructor(e,i){var r;switch(this._featureData=e,this.properties=this._featureData.properties||{},(r=this._featureData.geometry)===null||r===void 0?void 0:r.type){case vn.POINT:case vn.MULTIPOINT:this.type=1;break;case vn.LINESTRING:case vn.MULTILINESTRING:this.type=2;break;case vn.POLYGON:case vn.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=i,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const i of this._featureData.geometry.coordinates){const r=[];for(const u of i)r.push(new I(u.x,u.y));e.push(r)}return e}}class d_{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new u_(this.features[e],this.extent)}}class Rf{constructor(e){this.layers={};const i=(function(r,u,h=!0){const c=new Hp(0),_=[];for(;c.get()<r.length;){const y=Cn(r,c,1)[0]>>>0,k=c.get()+y;if(k>r.length)throw new Error(`Block overruns tile: ${k} > ${r.length}`);if(Cn(r,c,1)[0]>>>0!=1){c.set(k);continue}const P=s_(r,c),E=P[1],D=P[0].featureTables[0];let A=null,O=null;const $=[];let N=0;for(const ne of D.columns){const K=ne.name;if(K==="id"){let J=null;if(ne.nullable){const de=aa(r,c),we=c.get(),Ve=Uu(r,de.numValues,c);c.set(we+de.byteLength),J=new jr(Ve,de.numValues)}const oe=aa(r,c);N=oe.decompressedCount,A=l_(r,ne,c,K,oe,J??N,h)}else if(K==="geometry"){const J=Cn(r,c,1)[0];if(N===0){const oe=c.get();N=aa(r,c).decompressedCount,c.set(oe)}O=Qp(r,J,c,N)}else{const J=a_(ne)?Cn(r,c,1)[0]:1;if(J===0&&ne.type==="scalarType")continue;const oe=n_(r,c,ne,J,N);if(oe)if(Array.isArray(oe))for(const de of oe)$.push(de);else $.push(oe)}}const H=new Zp(D.name,O,A,$,E);_.push(H),c.set(k)}return _})(new Uint8Array(e));this.layers=i.reduce(((r,u)=>Object.assign(Object.assign({},r),{[u.name]:new d_(u)})),{})}}class h_{constructor(e,i){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=i,"id"in e&&(typeof e.id=="string"?this.id=parseInt(e.id,10):typeof e.id!="number"||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],i=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const r of i){const u=[];for(const h of r)u.push(new I(h[0],h[1]));e.push(u)}return e}}const qu="_geojsonTileLayer";function c_(n,e){e.writeVarintField(15,n.version||1),e.writeStringField(1,n.name||""),e.writeVarintField(5,n.extent||4096);const i={keys:[],values:[],keycache:{},valuecache:{}};for(let h=0;h<n.length;h++)i.feature=n.feature(h),e.writeMessage(2,f_,i);const r=i.keys;for(const h of r)e.writeStringField(3,h);const u=i.values;for(const h of u)e.writeMessage(4,__,h)}function f_(n,e){if(!n.feature)return;const i=n.feature;i.id!==void 0&&e.writeVarintField(1,i.id),e.writeMessage(2,m_,n),e.writeVarintField(3,i.type),e.writeMessage(4,p_,i)}function m_(n,e){for(const i in n.feature?.properties){let r=n.feature.properties[i],u=n.keycache[i];if(r==null)continue;u===void 0&&(n.keys.push(i),u=n.keys.length-1,n.keycache[i]=u),e.writeVarint(u),typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"&&(r=JSON.stringify(r));const h=typeof r+":"+r;let c=n.valuecache[h];c===void 0&&(n.values.push(r),c=n.values.length-1,n.valuecache[h]=c),e.writeVarint(c)}}function Oh(n,e){return(e<<3)+(7&n)}function jf(n){return n<<1^n>>31}function p_(n,e){const i=n.loadGeometry(),r=n.type;let u=0,h=0;for(const c of i){let _=1;r===1&&(_=c.length),e.writeVarint(Oh(1,_));const y=r===3?c.length-1:c.length;for(let k=0;k<y;k++){k===1&&r!==1&&e.writeVarint(Oh(2,y-1));const P=c[k].x-u,E=c[k].y-h;e.writeVarint(jf(P)),e.writeVarint(jf(E)),u+=P,h+=E}n.type===3&&e.writeVarint(Oh(7,1))}}function __(n,e){const i=typeof n;i==="string"?e.writeStringField(1,n):i==="boolean"?e.writeBooleanField(7,n):i==="number"&&(n%1!=0?e.writeDoubleField(3,n):n<0?e.writeSVarintField(6,n):e.writeVarintField(5,n))}class Ff{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new fs($t,16,0),this.grid3D=new fs($t,16,0),this.featureIndexArray=new Z,this.promoteId=i}insert(e,i,r,u,h,c){const _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,h);const y=c?this.grid3D:this.grid;for(let k=0;k<i.length;k++){const P=i[k],E=[1/0,1/0,-1/0,-1/0];for(let D=0;D<P.length;D++){const A=P[D];E[0]=Math.min(E[0],A.x),E[1]=Math.min(E[1],A.y),E[2]=Math.max(E[2],A.x),E[3]=Math.max(E[3],A.y)}E[0]<$t&&E[1]<$t&&E[2]>=0&&E[3]>=0&&y.insert(_,E[0],E[1],E[2],E[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new wc(new Td(this.rawTileData)).layers:new Rf(this.rawTileData).layers,this.sourceLayerCoder=new rf(this.vtLayers?Object.keys(this.vtLayers).sort():[qu])),this.vtLayers}query(e,i,r,u){this.loadVTLayers();const h=e.params,c=$t/e.tileSize/e.scale,_=ut(h.filter,h.globalState),y=e.queryGeometry,k=e.queryPadding*c,P=Xs.fromPoints(y),E=this.grid.query(P.minX-k,P.minY-k,P.maxX+k,P.maxY+k),D=Xs.fromPoints(e.cameraQueryGeometry).expandBy(k),A=this.grid3D.query(D.minX,D.minY,D.maxX,D.maxY,((N,H,ne,K)=>(function(J,oe,de,we,Ve){for(const Ne of J)if(oe<=Ne.x&&de<=Ne.y&&we>=Ne.x&&Ve>=Ne.y)return!0;const je=[new I(oe,de),new I(oe,Ve),new I(we,Ve),new I(we,de)];if(J.length>2){for(const Ne of je)if(Ol(J,Ne))return!0}for(let Ne=0;Ne<J.length-1;Ne++)if(ym(J[Ne],J[Ne+1],je))return!0;return!1})(e.cameraQueryGeometry,N-k,H-k,ne+k,K+k)));for(const N of A)E.push(N);E.sort(g_);const O={};let $;for(let N=0;N<E.length;N++){const H=E[N];if(H===$)continue;$=H;const ne=this.featureIndexArray.get(H);let K=null;this.loadMatchingFeature(O,ne.bucketIndex,ne.sourceLayerIndex,ne.featureIndex,_,h.layers,h.availableImages,i,r,u,((J,oe,de)=>(K||(K=_o(J)),oe.queryIntersectsFeature({queryGeometry:y,feature:J,featureState:de,geometry:K,zoom:this.z,transform:e.transform,pixelsToTileUnits:c,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return O}loadMatchingFeature(e,i,r,u,h,c,_,y,k,P,E){const D=this.bucketLayerIDs[i];if(c&&!D.some((N=>c.has(N))))return;const A=this.sourceLayerCoder.decode(r),O=this.vtLayers[A].feature(u);if(h.needGeometry){const N=go(O,!0);if(!h.filter(new oi(this.tileID.overscaledZ),N,this.tileID.canonical))return}else if(!h.filter(new oi(this.tileID.overscaledZ),O))return;const $=this.getId(O,A);for(let N=0;N<D.length;N++){const H=D[N];if(c&&!c.has(H))continue;const ne=y[H];if(!ne)continue;let K={};$&&P&&(K=P.getState(ne.sourceLayer||qu,$));const J=mi({},k[H]);J.paint=Bf(J.paint,ne.paint,O,K,_),J.layout=Bf(J.layout,ne.layout,O,K,_);const oe=!E||E(O,ne,K);if(!oe)continue;const de=new of(O,this.z,this.x,this.y,$);de.layer=J;let we=e[H];we===void 0&&(we=e[H]=[]),we.push({featureIndex:u,feature:de,intersectionZ:oe})}}lookupSymbolFeatures(e,i,r,u,h,c,_,y){const k={};this.loadVTLayers();const P=ut(h.filterSpec,h.globalState);for(const E of e)this.loadMatchingFeature(k,r,u,E,P,c,_,y,i);return k}hasLayer(e){for(const i of this.bucketLayerIDs)for(const r of i)if(e===r)return!0;return!1}getId(e,i){var r;let u=e.id;return this.promoteId&&(u=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof u=="boolean"&&(u=Number(u)),u===void 0&&(!((r=e.properties)===null||r===void 0)&&r.cluster)&&this.promoteId&&(u=Number(e.properties.cluster_id))),u}}function Bf(n,e,i,r,u){return dn(n,((h,c)=>{const _=e instanceof Os?e.get(c):null;return _&&_.evaluate?_.evaluate(i,r,u):_}))}function g_(n,e){return e-n}function Of(n,e,i,r,u){const h=[];for(let c=0;c<n.length;c++){const _=n[c];let y;for(let k=0;k<_.length-1;k++){let P=_[k],E=_[k+1];P.x<e&&E.x<e||(P.x<e?P=new I(e,P.y+(e-P.x)/(E.x-P.x)*(E.y-P.y))._round():E.x<e&&(E=new I(e,P.y+(e-P.x)/(E.x-P.x)*(E.y-P.y))._round()),P.y<i&&E.y<i||(P.y<i?P=new I(P.x+(i-P.y)/(E.y-P.y)*(E.x-P.x),i)._round():E.y<i&&(E=new I(P.x+(i-P.y)/(E.y-P.y)*(E.x-P.x),i)._round()),P.x>=r&&E.x>=r||(P.x>=r?P=new I(r,P.y+(r-P.x)/(E.x-P.x)*(E.y-P.y))._round():E.x>=r&&(E=new I(r,P.y+(r-P.x)/(E.x-P.x)*(E.y-P.y))._round()),P.y>=u&&E.y>=u||(P.y>=u?P=new I(P.x+(u-P.y)/(E.y-P.y)*(E.x-P.x),u)._round():E.y>=u&&(E=new I(P.x+(u-P.y)/(E.y-P.y)*(E.x-P.x),u)._round()),y&&P.equals(y[y.length-1])||(y=[P],h.push(y)),y.push(E)))))}}return h}function $f(n,e,i,r,u){switch(e){case 1:return(function(h,c,_,y){const k=[];for(const P of h)for(const E of P){const D=y===0?E.x:E.y;D>=c&&D<=_&&k.push([E])}return k})(n,i,r,u);case 2:return Vf(n,i,r,u,!1);case 3:return Vf(n,i,r,u,!0)}return[]}function y_(n,e,i,r,u){const h=r===0?v_:x_;let c=[];const _=[];for(let P=0;P<n.length-1;P++){const E=n[P],D=n[P+1],A=r===0?E.x:E.y,O=r===0?D.x:D.y;let $=!1;A<e?O>e&&c.push(h(E,D,e)):A>i?O<i&&c.push(h(E,D,i)):c.push(E),O<e&&A>=e&&(c.push(h(E,D,e)),$=!0),O>i&&A<=i&&(c.push(h(E,D,i)),$=!0),!u&&$&&(_.push(c),c=[])}const y=n.length-1,k=r===0?n[y].x:n[y].y;return k>=e&&k<=i&&c.push(n[y]),u&&c.length>0&&!c[0].equals(c[c.length-1])&&c.push(new I(c[0].x,c[0].y)),c.length>0&&_.push(c),_}function Vf(n,e,i,r,u){const h=[];for(const c of n){const _=y_(c,e,i,r,u);_.length>0&&h.push(..._)}return h}function v_(n,e,i){return new I(i,n.y+(i-n.x)/(e.x-n.x)*(e.y-n.y))}function x_(n,e,i){return new I(n.x+(i-n.y)/(e.y-n.y)*(e.x-n.x),i)}ot("FeatureIndex",Ff,{omit:["rawTileData","sourceLayerCoder"]});class ws extends I{constructor(e,i,r,u){super(e,i),this.angle=r,u!==void 0&&(this.segment=u)}clone(){return new ws(this.x,this.y,this.angle,this.segment)}}function Nf(n,e,i,r,u){if(e.segment===void 0||i===0)return!0;let h=e,c=e.segment+1,_=0;for(;_>-i/2;){if(c--,c<0)return!1;_-=n[c].dist(h),h=n[c]}_+=n[c].dist(n[c+1]),c++;const y=[];let k=0;for(;_<i/2;){const P=n[c],E=n[c+1];if(!E)return!1;let D=n[c-1].angleTo(P)-P.angleTo(E);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),y.push({distance:_,angleDelta:D}),k+=D;_-y[0].distance>r;)k-=y.shift().angleDelta;if(k>u)return!1;c++,_+=P.dist(E)}return!0}function Uf(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function Gf(n,e,i){return n?.6*e*i:0}function qf(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function w_(n,e,i,r,u,h){const c=Gf(i,u,h),_=qf(i,r)*h;let y=0;const k=Uf(n)/2;for(let P=0;P<n.length-1;P++){const E=n[P],D=n[P+1],A=E.dist(D);if(y+A>k){const O=(k-y)/A,$=si.number(E.x,D.x,O),N=si.number(E.y,D.y,O),H=new ws($,N,D.angleTo(E),P);return H._round(),!c||Nf(n,H,_,c,e)?H:void 0}y+=A}}function b_(n,e,i,r,u,h,c,_,y){const k=Gf(r,h,c),P=qf(r,u),E=P*c,D=n[0].x===0||n[0].x===y||n[0].y===0||n[0].y===y;return e-E<e/4&&(e=E+e/4),Zf(n,D?e/2*_%e:(P/2+2*h)*c*_%e,e,k,i,E,D,!1,y)}function Zf(n,e,i,r,u,h,c,_,y){const k=h/2,P=Uf(n);let E=0,D=e-i,A=[];for(let O=0;O<n.length-1;O++){const $=n[O],N=n[O+1],H=$.dist(N),ne=N.angleTo($);for(;D+i<E+H;){D+=i;const K=(D-E)/H,J=si.number($.x,N.x,K),oe=si.number($.y,N.y,K);if(J>=0&&J<y&&oe>=0&&oe<y&&D-k>=0&&D+k<=P){const de=new ws(J,oe,ne,O);de._round(),r&&!Nf(n,de,h,r,u)||A.push(de)}}E+=H}return _||A.length||c||(A=Zf(n,E/2,i,r,u,h,c,!0,y)),A}function Hf(n,e,i,r){const u=[],h=n.image,c=h.pixelRatio,_=h.paddedRect.w-2,y=h.paddedRect.h-2;let k={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const P=h.stretchX||[[0,_]],E=h.stretchY||[[0,y]],D=(ze,at)=>ze+at[1]-at[0],A=P.reduce(D,0),O=E.reduce(D,0),$=_-A,N=y-O;let H=0,ne=A,K=0,J=O,oe=0,de=$,we=0,Ve=N;if(h.content&&r){const ze=h.content,at=ze[2]-ze[0],tt=ze[3]-ze[1];(h.textFitWidth||h.textFitHeight)&&(k=Vc(n)),H=Fd(P,0,ze[0]),K=Fd(E,0,ze[1]),ne=Fd(P,ze[0],ze[2]),J=Fd(E,ze[1],ze[3]),oe=ze[0]-H,we=ze[1]-K,de=at-ne,Ve=tt-J}const je=k.x1,Ne=k.y1,Ye=k.x2-je,qe=k.y2-Ne,Be=(ze,at,tt,lt)=>{const et=Bd(ze.stretch-H,ne,Ye,je),ct=Od(ze.fixed-oe,de,ze.stretch,A),Nt=Bd(at.stretch-K,J,qe,Ne),At=Od(at.fixed-we,Ve,at.stretch,O),Si=Bd(tt.stretch-H,ne,Ye,je),Vn=Od(tt.fixed-oe,de,tt.stretch,A),en=Bd(lt.stretch-K,J,qe,Ne),Ti=Od(lt.fixed-we,Ve,lt.stretch,O),gi=new I(et,Nt),Xt=new I(Si,Nt),$i=new I(Si,en),Zi=new I(et,en),fi=new I(ct/c,At/c),pa=new I(Vn/c,Ti/c),Nn=e*Math.PI/180;if(Nn){const xn=Math.sin(Nn),zi=Math.cos(Nn),tn=[zi,-xn,xn,zi];gi._matMult(tn),Xt._matMult(tn),Zi._matMult(tn),$i._matMult(tn)}const _a=ze.stretch+ze.fixed,mr=at.stretch+at.fixed;return{tl:gi,tr:Xt,bl:Zi,br:$i,tex:{x:h.paddedRect.x+1+_a,y:h.paddedRect.y+1+mr,w:tt.stretch+tt.fixed-_a,h:lt.stretch+lt.fixed-mr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fi,pixelOffsetBR:pa,minFontScaleX:de/c/Ye,minFontScaleY:Ve/c/qe,isSDF:i}};if(r&&(h.stretchX||h.stretchY)){const ze=Wf(P,$,A),at=Wf(E,N,O);for(let tt=0;tt<ze.length-1;tt++){const lt=ze[tt],et=ze[tt+1];for(let ct=0;ct<at.length-1;ct++)u.push(Be(lt,at[ct],et,at[ct+1]))}}else u.push(Be({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:_+1},{fixed:0,stretch:y+1}));return u}function Fd(n,e,i){let r=0;for(const u of n)r+=Math.max(e,Math.min(i,u[1]))-Math.max(e,Math.min(i,u[0]));return r}function Wf(n,e,i){const r=[{fixed:-1,stretch:0}];for(const[u,h]of n){const c=r[r.length-1];r.push({fixed:u-c.stretch,stretch:c.stretch}),r.push({fixed:u-c.stretch,stretch:c.stretch+(h-u)})}return r.push({fixed:e+1,stretch:i}),r}function Bd(n,e,i,r){return n/e*i+r}function Od(n,e,i,r){return n-e*i/r}ot("Anchor",ws);class $d{constructor(e,i,r,u,h,c,_,y,k,P){var E;if(this.boxStartIndex=e.length,k){let D=c.top,A=c.bottom;const O=c.collisionPadding;O&&(D-=O[1],A+=O[3]);let $=A-D;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{const D=!((E=c.image)===null||E===void 0)&&E.content&&(c.image.textFitWidth||c.image.textFitHeight)?Vc(c):{x1:c.left,y1:c.top,x2:c.right,y2:c.bottom};D.y1=D.y1*_-y[0],D.y2=D.y2*_+y[2],D.x1=D.x1*_-y[3],D.x2=D.x2*_+y[1];const A=c.collisionPadding;if(A&&(D.x1-=A[0]*_,D.y1-=A[1]*_,D.x2+=A[2]*_,D.y2+=A[3]*_),P){const O=new I(D.x1,D.y1),$=new I(D.x2,D.y1),N=new I(D.x1,D.y2),H=new I(D.x2,D.y2),ne=P*Math.PI/180;O._rotate(ne),$._rotate(ne),N._rotate(ne),H._rotate(ne),D.x1=Math.min(O.x,$.x,N.x,H.x),D.x2=Math.max(O.x,$.x,N.x,H.x),D.y1=Math.min(O.y,$.y,N.y,H.y),D.y2=Math.max(O.y,$.y,N.y,H.y)}e.emplaceBack(i.x,i.y,D.x1,D.y1,D.x2,D.y2,r,u,h)}this.boxEndIndex=e.length}}class k_{constructor(e=[],i=(r,u)=>r<u?-1:r>u?1:0){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:r}=this,u=i[e];for(;e>0;){const h=e-1>>1,c=i[h];if(r(u,c)>=0)break;i[e]=c,e=h}i[e]=u}_down(e){const{data:i,compare:r}=this,u=this.length>>1,h=i[e];for(;e<u;){let c=1+(e<<1);const _=c+1;if(_<this.length&&r(i[_],i[c])<0&&(c=_),r(i[c],h)>=0)break;i[e]=i[c],e=c}i[e]=h}}function S_(n,e=1,i=!1){const r=Xs.fromPoints(n[0]),u=Math.min(r.width(),r.height());let h=u/2;const c=new k_([],T_),{minX:_,minY:y,maxX:k,maxY:P}=r;if(u===0)return new I(_,y);for(let A=_;A<k;A+=u)for(let O=y;O<P;O+=u)c.push(new Jl(A+h,O+h,h,n));let E=(function(A){let O=0,$=0,N=0;const H=A[0];for(let ne=0,K=H.length,J=K-1;ne<K;J=ne++){const oe=H[ne],de=H[J],we=oe.x*de.y-de.x*oe.y;$+=(oe.x+de.x)*we,N+=(oe.y+de.y)*we,O+=3*we}return new Jl($/O,N/O,0,A)})(n),D=c.length;for(;c.length;){const A=c.pop();(A.d>E.d||!E.d)&&(E=A,i&&console.log("found best %d after %d probes",Math.round(1e4*A.d)/1e4,D)),A.max-E.d<=e||(h=A.h/2,c.push(new Jl(A.p.x-h,A.p.y-h,h,n)),c.push(new Jl(A.p.x+h,A.p.y-h,h,n)),c.push(new Jl(A.p.x-h,A.p.y+h,h,n)),c.push(new Jl(A.p.x+h,A.p.y+h,h,n)),D+=4)}return i&&(console.log(`num probes: ${D}`),console.log(`best distance: ${E.d}`)),E.p}function T_(n,e){return e.max-n.max}function Jl(n,e,i,r){this.p=new I(n,e),this.h=i,this.d=(function(u,h){let c=!1,_=1/0;for(let y=0;y<h.length;y++){const k=h[y];for(let P=0,E=k.length,D=E-1;P<E;D=P++){const A=k[P],O=k[D];A.y>u.y!=O.y>u.y&&u.x<(O.x-A.x)*(u.y-A.y)/(O.y-A.y)+A.x&&(c=!c),_=Math.min(_,Jh(u,A,O))}}return(c?1:-1)*Math.sqrt(_)})(this.p,r),this.max=this.d+this.h*Math.SQRT2}var $n;v.aP=void 0,($n=v.aP||(v.aP={}))[$n.center=1]="center",$n[$n.left=2]="left",$n[$n.right=3]="right",$n[$n.top=4]="top",$n[$n.bottom=5]="bottom",$n[$n["top-left"]=6]="top-left",$n[$n["top-right"]=7]="top-right",$n[$n["bottom-left"]=8]="bottom-left",$n[$n["bottom-right"]=9]="bottom-right";const $h=Number.POSITIVE_INFINITY;function Kf(n,e){return e[1]!==$h?(function(i,r,u){let h=0,c=0;switch(r=Math.abs(r),u=Math.abs(u),i){case"top-right":case"top-left":case"top":c=u-7;break;case"bottom-right":case"bottom-left":case"bottom":c=7-u}switch(i){case"top-right":case"bottom-right":case"right":h=-r;break;case"top-left":case"bottom-left":case"left":h=r}return[h,c]})(n,e[0],e[1]):(function(i,r){let u=0,h=0;r<0&&(r=0);const c=r/Math.SQRT2;switch(i){case"top-right":case"top-left":h=c-7;break;case"bottom-right":case"bottom-left":h=7-c;break;case"bottom":h=7-r;break;case"top":h=r-7}switch(i){case"top-right":case"bottom-right":u=-c;break;case"top-left":case"bottom-left":u=c;break;case"left":u=r;break;case"right":u=-r}return[u,h]})(n,e[0])}function Xf(n,e,i){var r;const u=n.layout,h=(r=u.get("text-variable-anchor-offset"))===null||r===void 0?void 0:r.evaluate(e,{},i);if(h){const _=h.values,y=[];for(let k=0;k<_.length;k+=2){const P=y[k]=_[k],E=_[k+1].map((D=>D*gn));P.startsWith("top")?E[1]-=7:P.startsWith("bottom")&&(E[1]+=7),y[k+1]=E}return new on(y)}const c=u.get("text-variable-anchor");if(c){let _;_=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[u.get("text-radial-offset").evaluate(e,{},i)*gn,$h]:u.get("text-offset").evaluate(e,{},i).map((k=>k*gn));const y=[];for(const k of c)y.push(k,Kf(k,_));return new on(y)}return null}function Vh(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function P_(n,e,i,r,u,h,c,_,y,k,P,E){let D=h.textMaxSize.evaluate(e,{});D===void 0&&(D=c);const A=n.layers[0].layout,O=A.get("icon-offset").evaluate(e,{},P),$=Jf(i.horizontal),N=c/24,H=n.tilePixelRatio*N,ne=n.tilePixelRatio*D/24,K=n.tilePixelRatio*_,J=n.tilePixelRatio*A.get("symbol-spacing"),oe=A.get("text-padding")*n.tilePixelRatio,de=(function(tt,lt,et,ct=1){const Nt=tt.get("icon-padding").evaluate(lt,{},et),At=Nt&&Nt.values;return[At[0]*ct,At[1]*ct,At[2]*ct,At[3]*ct]})(A,e,P,n.tilePixelRatio),we=A.get("text-max-angle")/180*Math.PI,Ve=A.get("text-rotation-alignment")!=="viewport"&&A.get("symbol-placement")!=="point",je=A.get("icon-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",Ne=A.get("symbol-placement"),Ye=J/2,qe=A.get("icon-text-fit");let Be;r&&qe!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(Be=Nc(r,i.vertical,qe,A.get("icon-text-fit-padding"),O,N)),$&&(r=Nc(r,$,qe,A.get("icon-text-fit-padding"),O,N)));const ze=P?E.line.getGranularityForZoomLevel(P.z):1,at=(tt,lt)=>{lt.x<0||lt.x>=$t||lt.y<0||lt.y>=$t||(function(et,ct,Nt,At,Si,Vn,en,Ti,gi,Xt,$i,Zi,fi,pa,Nn,_a,mr,xn,zi,tn,Vi,wn,Zo,Fr,Wu){const bs=et.addToLineVertexArray(ct,Nt);let Qs,Ql,eu,tu,im=0,nm=0,am=0,rm=0,Kh=-1,Xh=-1;const Ho={};let om=qi("");if(et.allowVerticalPlacement&&At.vertical){const Yn=Ti.layout.get("text-rotate").evaluate(Vi,{},Fr)+90;eu=new $d(gi,ct,Xt,$i,Zi,At.vertical,fi,pa,Nn,Yn),en&&(tu=new $d(gi,ct,Xt,$i,Zi,en,mr,xn,Nn,Yn))}if(Si){const Yn=Ti.layout.get("icon-rotate").evaluate(Vi,{}),er=Ti.layout.get("icon-text-fit")!=="none",el=Hf(Si,Yn,Zo,er),Or=en?Hf(en,Yn,Zo,er):void 0;Ql=new $d(gi,ct,Xt,$i,Zi,Si,mr,xn,!1,Yn),im=4*el.length;const tl=et.iconSizeData;let yo=null;tl.kind==="source"?(yo=[Go*Ti.layout.get("icon-size").evaluate(Vi,{})],yo[0]>ys&&Qi(`${et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):tl.kind==="composite"&&(yo=[Go*wn.compositeIconSizes[0].evaluate(Vi,{},Fr),Go*wn.compositeIconSizes[1].evaluate(Vi,{},Fr)],(yo[0]>ys||yo[1]>ys)&&Qi(`${et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),et.addSymbols(et.icon,el,yo,tn,zi,Vi,v.az.none,ct,bs.lineStartIndex,bs.lineLength,-1,Fr),Kh=et.icon.placedSymbolArray.length-1,Or&&(nm=4*Or.length,et.addSymbols(et.icon,Or,yo,tn,zi,Vi,v.az.vertical,ct,bs.lineStartIndex,bs.lineLength,-1,Fr),Xh=et.icon.placedSymbolArray.length-1)}const sm=Object.keys(At.horizontal);for(const Yn of sm){const er=At.horizontal[Yn];if(!Qs){om=qi(er.text);const Or=Ti.layout.get("text-rotate").evaluate(Vi,{},Fr);Qs=new $d(gi,ct,Xt,$i,Zi,er,fi,pa,Nn,Or)}const el=er.positionedLines.length===1;if(am+=Yf(et,ct,er,Vn,Ti,Nn,Vi,_a,bs,At.vertical?v.az.horizontal:v.az.horizontalOnly,el?sm:[Yn],Ho,Kh,wn,Fr),el)break}At.vertical&&(rm+=Yf(et,ct,At.vertical,Vn,Ti,Nn,Vi,_a,bs,v.az.vertical,["vertical"],Ho,Xh,wn,Fr));const C_=Qs?Qs.boxStartIndex:et.collisionBoxArray.length,E_=Qs?Qs.boxEndIndex:et.collisionBoxArray.length,z_=eu?eu.boxStartIndex:et.collisionBoxArray.length,I_=eu?eu.boxEndIndex:et.collisionBoxArray.length,D_=Ql?Ql.boxStartIndex:et.collisionBoxArray.length,A_=Ql?Ql.boxEndIndex:et.collisionBoxArray.length,R_=tu?tu.boxStartIndex:et.collisionBoxArray.length,j_=tu?tu.boxEndIndex:et.collisionBoxArray.length;let Br=-1;const Nd=(Yn,er)=>Yn&&Yn.circleDiameter?Math.max(Yn.circleDiameter,er):er;Br=Nd(Qs,Br),Br=Nd(eu,Br),Br=Nd(Ql,Br),Br=Nd(tu,Br);const lm=Br>-1?1:0;lm&&(Br*=Wu/gn),et.glyphOffsetArray.length>=Zl.MAX_GLYPHS&&Qi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Vi.sortKey!==void 0&&et.addToSortKeyRanges(et.symbolInstances.length,Vi.sortKey);const F_=Xf(Ti,Vi,Fr),[B_,O_]=(function(Yn,er){const el=Yn.length,Or=er?.values;if(Or?.length>0)for(let tl=0;tl<Or.length;tl+=2){const yo=Or[tl+1];Yn.emplaceBack(v.aP[Or[tl]],yo[0],yo[1])}return[el,Yn.length]})(et.textAnchorOffsets,F_);et.symbolInstances.emplaceBack(ct.x,ct.y,Ho.right>=0?Ho.right:-1,Ho.center>=0?Ho.center:-1,Ho.left>=0?Ho.left:-1,Ho.vertical||-1,Kh,Xh,om,C_,E_,z_,I_,D_,A_,R_,j_,Xt,am,rm,im,nm,lm,0,fi,Br,B_,O_)})(n,lt,tt,i,r,u,Be,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,H,[oe,oe,oe,oe],Ve,y,K,de,je,O,e,h,k,P,c)};if(Ne==="line")for(const tt of Of(e.geometry,0,0,$t,$t)){const lt=Ks(tt,ze),et=b_(lt,J,we,i.vertical||$,r,24,ne,n.overscaling,$t);for(const ct of et)$&&L_(n,$.text,Ye,ct)||at(lt,ct)}else if(Ne==="line-center"){for(const tt of e.geometry)if(tt.length>1){const lt=Ks(tt,ze),et=w_(lt,we,i.vertical||$,r,24,ne);et&&at(lt,et)}}else if(e.type==="Polygon")for(const tt of Qr(e.geometry,0)){const lt=S_(tt,16);at(Ks(tt[0],ze,!0),new ws(lt.x,lt.y,0))}else if(e.type==="LineString")for(const tt of e.geometry){const lt=Ks(tt,ze);at(lt,new ws(lt[0].x,lt[0].y,0))}else if(e.type==="Point")for(const tt of e.geometry)for(const lt of tt)at([lt],new ws(lt.x,lt.y,0))}function Yf(n,e,i,r,u,h,c,_,y,k,P,E,D,A,O){const $=(function(ne,K,J,oe,de,we,Ve,je){const Ne=oe.layout.get("text-rotate").evaluate(we,{})*Math.PI/180,Ye=[];for(const qe of K.positionedLines)for(const Be of qe.positionedGlyphs){if(!Be.rect)continue;const ze=Be.rect||{};let at=4,tt=!0,lt=1,et=0;const ct=(de||je)&&Be.vertical,Nt=Be.metrics.advance*Be.scale/2;if(je&&K.verticalizable&&(et=qe.lineOffset/2-(Be.imageName?-(gn-Be.metrics.width*Be.scale)/2:(Be.scale-1)*gn)),Be.imageName){const xn=Ve[Be.imageName];tt=xn.sdf,lt=xn.pixelRatio,at=1/lt}const At=de?[Be.x+Nt,Be.y]:[0,0];let Si=de?[0,0]:[Be.x+Nt+J[0],Be.y+J[1]-et],Vn=[0,0];ct&&(Vn=Si,Si=[0,0]);const en=Be.metrics.isDoubleResolution?2:1,Ti=(Be.metrics.left-at)*Be.scale-Nt+Si[0],gi=(-Be.metrics.top-at)*Be.scale+Si[1],Xt=Ti+ze.w/en*Be.scale/lt,$i=gi+ze.h/en*Be.scale/lt,Zi=new I(Ti,gi),fi=new I(Xt,gi),pa=new I(Ti,$i),Nn=new I(Xt,$i);if(ct){const xn=new I(-Nt,Nt- -17),zi=-Math.PI/2,tn=12-Nt,Vi=new I(22-tn,-(Be.imageName?tn:0)),wn=new I(...Vn);Zi._rotateAround(zi,xn)._add(Vi)._add(wn),fi._rotateAround(zi,xn)._add(Vi)._add(wn),pa._rotateAround(zi,xn)._add(Vi)._add(wn),Nn._rotateAround(zi,xn)._add(Vi)._add(wn)}if(Ne){const xn=Math.sin(Ne),zi=Math.cos(Ne),tn=[zi,-xn,xn,zi];Zi._matMult(tn),fi._matMult(tn),pa._matMult(tn),Nn._matMult(tn)}const _a=new I(0,0),mr=new I(0,0);Ye.push({tl:Zi,tr:fi,bl:pa,br:Nn,tex:ze,writingMode:K.writingMode,glyphOffset:At,sectionIndex:Be.sectionIndex,isSDF:tt,pixelOffsetTL:_a,pixelOffsetBR:mr,minFontScaleX:0,minFontScaleY:0})}return Ye})(0,i,_,u,h,c,r,n.allowVerticalPlacement),N=n.textSizeData;let H=null;N.kind==="source"?(H=[Go*u.layout.get("text-size").evaluate(c,{})],H[0]>ys&&Qi(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):N.kind==="composite"&&(H=[Go*A.compositeTextSizes[0].evaluate(c,{},O),Go*A.compositeTextSizes[1].evaluate(c,{},O)],(H[0]>ys||H[1]>ys)&&Qi(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,$,H,_,h,c,k,e,y.lineStartIndex,y.lineLength,D,O);for(const ne of P)E[ne]=n.text.placedSymbolArray.length-1;return 4*$.length}function Jf(n){for(const e in n)return n[e];return null}function L_(n,e,i,r){const u=n.compareText;if(e in u){const h=u[e];for(let c=h.length-1;c>=0;c--)if(r.dist(h[c])<i)return!0}else u[e]=[];return u[e].push(r),!1}const Qf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Nh{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,r]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=r>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const h=Qf[15&r];if(!h)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(e,2,1),[_]=new Uint32Array(e,4,1);return new Nh(_,c,h,e)}constructor(e,i=64,r=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const h=Qf.indexOf(this.ArrayType),c=2*e*this.ArrayType.BYTES_PER_ELEMENT,_=e*this.IndexArrayType.BYTES_PER_ELEMENT,y=(8-_%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${r}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+_+y,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+c+_+y),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+_+y,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=i,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Uh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,r,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:c,nodeSize:_}=this,y=[0,h.length-1,0],k=[];for(;y.length;){const P=y.pop()||0,E=y.pop()||0,D=y.pop()||0;if(E-D<=_){for(let N=D;N<=E;N++){const H=c[2*N],ne=c[2*N+1];H>=e&&H<=r&&ne>=i&&ne<=u&&k.push(h[N])}continue}const A=D+E>>1,O=c[2*A],$=c[2*A+1];O>=e&&O<=r&&$>=i&&$<=u&&k.push(h[A]),(P===0?e<=O:i<=$)&&(y.push(D),y.push(A-1),y.push(1-P)),(P===0?r>=O:u>=$)&&(y.push(A+1),y.push(E),y.push(1-P))}return k}within(e,i,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:h,nodeSize:c}=this,_=[0,u.length-1,0],y=[],k=r*r;for(;_.length;){const P=_.pop()||0,E=_.pop()||0,D=_.pop()||0;if(E-D<=c){for(let N=D;N<=E;N++)tm(h[2*N],h[2*N+1],e,i)<=k&&y.push(u[N]);continue}const A=D+E>>1,O=h[2*A],$=h[2*A+1];tm(O,$,e,i)<=k&&y.push(u[A]),(P===0?e-r<=O:i-r<=$)&&(_.push(D),_.push(A-1),_.push(1-P)),(P===0?e+r>=O:i+r>=$)&&(_.push(A+1),_.push(E),_.push(1-P))}return y}}function Uh(n,e,i,r,u,h){if(u-r<=i)return;const c=r+u>>1;em(n,e,c,r,u,h),Uh(n,e,i,r,c-1,1-h),Uh(n,e,i,c+1,u,1-h)}function em(n,e,i,r,u,h){for(;u>r;){if(u-r>600){const k=u-r+1,P=i-r+1,E=Math.log(k),D=.5*Math.exp(2*E/3),A=.5*Math.sqrt(E*D*(k-D)/k)*(P-k/2<0?-1:1);em(n,e,i,Math.max(r,Math.floor(i-P*D/k+A)),Math.min(u,Math.floor(i+(k-P)*D/k+A)),h)}const c=e[2*i+h];let _=r,y=u;for(Zu(n,e,r,i),e[2*u+h]>c&&Zu(n,e,r,u);_<y;){for(Zu(n,e,_,y),_++,y--;e[2*_+h]<c;)_++;for(;e[2*y+h]>c;)y--}e[2*r+h]===c?Zu(n,e,r,y):(y++,Zu(n,e,y,u)),y<=i&&(r=y+1),i<=y&&(u=y-1)}}function Zu(n,e,i,r){Gh(n,i,r),Gh(e,2*i,2*r),Gh(e,2*i+1,2*r+1)}function Gh(n,e,i){const r=n[e];n[e]=n[i],n[i]=r}function tm(n,e,i,r){const u=n-i,h=e-r;return u*u+h*h}var qh;v.cH=void 0,(qh=v.cH||(v.cH={})).create="create",qh.load="load",qh.fullLoad="fullLoad";let Vd=null,Hu=[];const Zh=1e3/60,Hh="loadTime",Wh="fullLoadTime",M_={mark(n){performance.mark(n)},frame(n){const e=n;Vd!=null&&Hu.push(e-Vd),Vd=e},clearMetrics(){Vd=null,Hu=[],performance.clearMeasures(Hh),performance.clearMeasures(Wh);for(const n in v.cH)performance.clearMarks(v.cH[n])},getPerformanceMetrics(){performance.measure(Hh,v.cH.create,v.cH.load),performance.measure(Wh,v.cH.create,v.cH.fullLoad);const n=performance.getEntriesByName(Hh)[0].duration,e=performance.getEntriesByName(Wh)[0].duration,i=Hu.length,r=1/(Hu.reduce(((h,c)=>h+c),0)/i/1e3),u=Hu.filter((h=>h>Zh)).reduce(((h,c)=>h+(c-Zh)/Zh),0);return{loadTime:n,fullLoadTime:e,fps:r,percentDroppedFrames:u/(i+u)*100,totalFrames:i}}};v.$=le,v.A=He,v.B=cs,v.C=pn,v.D=ht,v.E=Vt,v.F=function([n,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:n*Math.cos(e)*Math.sin(i),y:n*Math.sin(e)*Math.sin(i),z:n*Math.cos(i)}},v.G=si,v.H=oi,v.I=mh,v.J=rd,v.K=function(n){if(hi==null){const e=n.navigator?n.navigator.userAgent:null;hi=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return hi},v.L=class{constructor(n,e){this.target=n,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Up((()=>this.process())),this.subscription=yr(this.target,"message",(i=>this.receive(i)),!1),this.globalScope=oa(self)?n:window}registerMessageHandler(n,e){this.messageHandlers[n]=e}unregisterMessageHandler(n){delete this.messageHandlers[n]}sendAsync(n,e){return new Promise(((i,r)=>{const u=Math.round(1e18*Math.random()).toString(36).substring(0,10),h=e?yr(e.signal,"abort",(()=>{h?.unsubscribe(),delete this.resolveRejects[u];const y={id:u,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(y)}),Gp):null;this.resolveRejects[u]={resolve:y=>{h?.unsubscribe(),i(y)},reject:y=>{h?.unsubscribe(),r(y)}};const c=[],_=Object.assign(Object.assign({},n),{id:u,sourceMapId:this.mapId,origin:location.origin,data:Rs(n.data,c)});this.target.postMessage(_,{transfer:c})}))}receive(n){const e=n.data,i=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[i];const r=this.abortControllers[i];return delete this.abortControllers[i],void(r&&r.abort())}if(oa(self)||e.mustQueue)return this.tasks[i]=e,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,e)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),e=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(n,e)}processTask(n,e){return o(this,void 0,void 0,(function*(){if(e.type==="<response>"){const u=this.resolveRejects[n];return delete this.resolveRejects[n],u?void(e.error?u.reject(js(e.error)):u.resolve(js(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=js(e.data),r=new AbortController;this.abortControllers[n]=r;try{const u=yield this.messageHandlers[e.type](e.sourceMapId,i,r);this.completeTask(n,null,u)}catch(u){this.completeTask(n,u)}}))}completeTask(n,e,i){const r=[];delete this.abortControllers[n];const u={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?Rs(e):null,data:Rs(i,r)};this.target.postMessage(u,{transfer:r})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.M=ve,v.N=function(){var n=new He(16);return He!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},v.O=function(n,e,i){var r,u,h,c,_,y,k,P,E,D,A,O,$=i[0],N=i[1],H=i[2];return e===n?(n[12]=e[0]*$+e[4]*N+e[8]*H+e[12],n[13]=e[1]*$+e[5]*N+e[9]*H+e[13],n[14]=e[2]*$+e[6]*N+e[10]*H+e[14],n[15]=e[3]*$+e[7]*N+e[11]*H+e[15]):(u=e[1],h=e[2],c=e[3],_=e[4],y=e[5],k=e[6],P=e[7],E=e[8],D=e[9],A=e[10],O=e[11],n[0]=r=e[0],n[1]=u,n[2]=h,n[3]=c,n[4]=_,n[5]=y,n[6]=k,n[7]=P,n[8]=E,n[9]=D,n[10]=A,n[11]=O,n[12]=r*$+_*N+E*H+e[12],n[13]=u*$+y*N+D*H+e[13],n[14]=h*$+k*N+A*H+e[14],n[15]=c*$+P*N+O*H+e[15]),n},v.P=I,v.Q=function(n,e,i){var r=i[0],u=i[1],h=i[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*u,n[5]=e[5]*u,n[6]=e[6]*u,n[7]=e[7]*u,n[8]=e[8]*h,n[9]=e[9]*h,n[10]=e[10]*h,n[11]=e[11]*h,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},v.R=ma,v.S=function(n,e,i){var r=e[0],u=e[1],h=e[2],c=e[3],_=e[4],y=e[5],k=e[6],P=e[7],E=e[8],D=e[9],A=e[10],O=e[11],$=e[12],N=e[13],H=e[14],ne=e[15],K=i[0],J=i[1],oe=i[2],de=i[3];return n[0]=K*r+J*_+oe*E+de*$,n[1]=K*u+J*y+oe*D+de*N,n[2]=K*h+J*k+oe*A+de*H,n[3]=K*c+J*P+oe*O+de*ne,n[4]=(K=i[4])*r+(J=i[5])*_+(oe=i[6])*E+(de=i[7])*$,n[5]=K*u+J*y+oe*D+de*N,n[6]=K*h+J*k+oe*A+de*H,n[7]=K*c+J*P+oe*O+de*ne,n[8]=(K=i[8])*r+(J=i[9])*_+(oe=i[10])*E+(de=i[11])*$,n[9]=K*u+J*y+oe*D+de*N,n[10]=K*h+J*k+oe*A+de*H,n[11]=K*c+J*P+oe*O+de*ne,n[12]=(K=i[12])*r+(J=i[13])*_+(oe=i[14])*E+(de=i[15])*$,n[13]=K*u+J*y+oe*D+de*N,n[14]=K*h+J*k+oe*A+de*H,n[15]=K*c+J*P+oe*O+de*ne,n},v.T=rh,v.U=function(n,e){const i={};for(let r=0;r<e.length;r++){const u=e[r];u in n&&(i[u]=n[u])}return i},v.V=vs,v.W=Wi,v.X=Yc,v.Y=Xc,v.Z=fe,v._=o,v.a=Y,v.a$=zn,v.a0=it,v.a1=gr,v.a2=Ja,v.a3=Qc,v.a4=Cd,v.a5=$t,v.a6=function(n,e,i){if(!n)return e||{};if(!e)return n||{};const r=af(n),u=af(e);(function(c,_){_.removeAll&&(c.add.clear(),c.update.clear(),c.remove.clear(),_.remove.clear());for(const y of _.remove)c.add.delete(y),c.update.delete(y);for(const[y,k]of _.update){const P=c.update.get(y);P&&(_.update.set(y,qp(P,k)),c.update.delete(y))}})(r,u);const h={};if((r.removeAll||u.removeAll)&&(h.removeAll=!0),h.remove=new Set([...r.remove,...u.remove]),h.add=new Map([...r.add,...u.add]),h.update=new Map([...r.update,...u.update]),h.remove.size&&h.add.size)for(const c of h.add.keys())h.remove.delete(c);return(function(c){const _={};return c.removeAll&&(_.removeAll=c.removeAll),c.remove&&(_.remove=Array.from(c.remove)),c.add&&(_.add=Array.from(c.add.values())),c.update&&(_.update=Array.from(c.update.values())),_})(h)},v.a7=function(n,e){const i=new Map;if(n==null||n.type==null)return i;if(n.type==="Feature"){const r=kh(n,e);return r==null?void 0:(i.set(r,n),i)}if(n.type==="FeatureCollection"){const r=new Set;for(const u of n.features){const h=kh(u,e);if(h==null||r.has(h))return;r.add(h),i.set(h,u)}return i}},v.a8=function(n,e,i){var r,u;const h=[];if(e.removeAll)n.clear();else if(e.remove)for(const c of e.remove){const _=n.get(c);_&&(h.push(_.geometry),n.delete(c))}if(e.add)for(const c of e.add){const _=kh(c,i);if(_==null)continue;const y=n.get(_);y&&h.push(y.geometry),h.push(c.geometry),n.set(_,c)}if(e.update)for(const c of e.update){const _=n.get(c.id);if(!_)continue;const y=!!c.newGeometry,k=c.removeAllProperties||((r=c.removeProperties)===null||r===void 0?void 0:r.length)>0||((u=c.addOrUpdateProperties)===null||u===void 0?void 0:u.length)>0;if(!y&&!k)continue;h.push(_.geometry);const P=Object.assign({},_);if(n.set(c.id,P),y&&(h.push(c.newGeometry),P.geometry=c.newGeometry),k){if(P.properties=c.removeAllProperties?{}:Object.assign({},P.properties||{}),c.removeProperties)for(const E of c.removeProperties)delete P.properties[E];if(c.addOrUpdateProperties)for(const{key:E,value:D}of c.addOrUpdateProperties)P.properties[E]=D}}return h},v.a9=Nu,v.aA=function(n,{uSize:e,uSizeT:i},{lowerSize:r,upperSize:u}){return n.kind==="source"?r/Go:n.kind==="composite"?si.number(r/Go,u/Go,i):e},v.aB=function(n,e){var i=e[0],r=e[1],u=e[2],h=e[3],c=e[4],_=e[5],y=e[6],k=e[7],P=e[8],E=e[9],D=e[10],A=e[11],O=e[12],$=e[13],N=e[14],H=e[15],ne=i*_-r*c,K=i*y-u*c,J=i*k-h*c,oe=r*y-u*_,de=r*k-h*_,we=u*k-h*y,Ve=P*$-E*O,je=P*N-D*O,Ne=P*H-A*O,Ye=E*N-D*$,qe=E*H-A*$,Be=D*H-A*N,ze=ne*Be-K*qe+J*Ye+oe*Ne-de*je+we*Ve;return ze?(n[0]=(_*Be-y*qe+k*Ye)*(ze=1/ze),n[1]=(u*qe-r*Be-h*Ye)*ze,n[2]=($*we-N*de+H*oe)*ze,n[3]=(D*de-E*we-A*oe)*ze,n[4]=(y*Ne-c*Be-k*je)*ze,n[5]=(i*Be-u*Ne+h*je)*ze,n[6]=(N*J-O*we-H*K)*ze,n[7]=(P*we-D*J+A*K)*ze,n[8]=(c*qe-_*Ne+k*Ve)*ze,n[9]=(r*Ne-i*qe-h*Ve)*ze,n[10]=(O*de-$*J+H*ne)*ze,n[11]=(E*J-P*de-A*ne)*ze,n[12]=(_*je-c*Ye-y*Ve)*ze,n[13]=(i*Ye-r*je+u*Ve)*ze,n[14]=($*K-O*oe-N*ne)*ze,n[15]=(P*oe-E*K+D*ne)*ze,n):null},v.aC=Hi,v.aD=function(n){var e=n[0],i=n[1];return Math.sqrt(e*e+i*i)},v.aE=function(n){return n[0]=0,n[1]=0,n},v.aF=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n},v.aG=gh,v.aH=bn,v.aI=function(n,e,i,r){const u=e.y-n.y,h=e.x-n.x,c=r.y-i.y,_=r.x-i.x,y=c*h-_*u;if(y===0)return null;const k=(_*(n.y-i.y)-c*(n.x-i.x))/y;return new I(n.x+k*h,n.y+k*u)},v.aJ=Of,v.aK=Bl,v.aL=function(n){let e=1/0,i=1/0,r=-1/0,u=-1/0;for(const h of n)e=Math.min(e,h.x),i=Math.min(i,h.y),r=Math.max(r,h.x),u=Math.max(u,h.y);return[e,i,r,u]},v.aM=gn,v.aN=pt,v.aO=function(n,e,i,r,u=!1){if(!i[0]&&!i[1])return[0,0];const h=u?r==="map"?-n.bearingInRadians:0:r==="viewport"?n.bearingInRadians:0;if(h){const c=Math.sin(h),_=Math.cos(h);i=[i[0]*_-i[1]*c,i[0]*c+i[1]*_]}return[u?i[0]:pt(e,i[0],n.zoom),u?i[1]:pt(e,i[1],n.zoom)]},v.aQ=_h,v.aR=Vh,v.aS=ph,v.aT=Nh,v.aU=Gi,v.aV=kd,v.aW=Q,v.aX=Je,v.aY=Ce,v.aZ=In,v.a_=ef,v.aa=Xs,v.ab=25,v.ac=bh,v.ad=n=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((i=>{e.onloadstart=()=>{i(e)};for(const r of n){const u=window.document.createElement("source");$e(r)||(e.crossOrigin="Anonymous"),u.src=r,e.appendChild(u)}}))},v.ae=Ee,v.af=function(){return ga++},v.ag=d,v.ah=Zl,v.ai=qu,v.aj=ut,v.ak=go,v.al=of,v.am=function(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((i,r,u,h)=>{const c=u||h;return e[r]=!c||c.toLowerCase(),""})),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e},v.an=kt,v.ao=85.051129,v.ap=$r,v.aq=function(n){return Math.pow(2,n)},v.ar=Bt,v.as=Jc,v.at=function(n){return Math.log(n)/Math.LN2},v.au=function(n){var e=n[0],i=n[1];return e*e+i*i},v.av=function(n){if(!n.length)return new Set;const e=Math.max(...n.map((y=>y.canonical.z)));let i=1/0,r=-1/0,u=1/0,h=-1/0;const c=[];for(const y of n){const{x:k,y:P,z:E}=y.canonical,D=Math.pow(2,e-E),A=k*D,O=P*D;c.push({id:y,x:A,y:O}),A<i&&(i=A),A>r&&(r=A),O<u&&(u=O),O>h&&(h=O)}const _=new Set;for(const y of c)y.x!==i&&y.x!==r&&y.y!==u&&y.y!==h||_.add(y.id);return _},v.aw=function(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||r-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x},v.ax=class{constructor(n,e){this.max=n,this.onRemove=e,this.reset()}reset(){for(const n in this.data)for(const e of this.data[n])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(n,e,i){const r=n.wrapped().key;this.data[r]===void 0&&(this.data[r]=[]);const u={value:e,timeout:void 0};if(i!==void 0&&(u.timeout=setTimeout((()=>{this.remove(n,u)}),i)),this.data[r].push(u),this.order.push(r),this.order.length>this.max){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const e=this.data[n].shift();return e.timeout&&clearTimeout(e.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),e.value}getByKey(n){const e=this.data[n];return e?e[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,e){if(!this.has(n))return this;const i=n.wrapped().key,r=e===void 0?0:this.data[i].indexOf(e),u=this.data[i][r];return this.data[i].splice(r,1),u.timeout&&clearTimeout(u.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(u.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(n){const e=[];for(const i in this.data)for(const r of this.data[i])n(r.value)||e.push(r);for(const i of e)this.remove(i.value.tileID,i)}},v.ay=function(n,e){let i=0,r=0;if(n.kind==="constant")r=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:u,minZoom:h,maxZoom:c}=n,_=u?kt(Ci.interpolationFactor(u,e,h,c),0,1):0;n.kind==="camera"?r=si.number(n.minSize,n.maxSize,_):i=_}return{uSizeT:i,uSize:r}},v.b=sa,v.b$=No,v.b0=En,v.b1=function(n){var e=new He(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e},v.b2=function(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n},v.b3=function(n,e){var i=e[0],r=e[1],u=e[2],h=i*i+r*r+u*u;return h>0&&(h=1/Math.sqrt(h)),n[0]=e[0]*h,n[1]=e[1]*h,n[2]=e[2]*h,n},v.b4=Pi,v.b5=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]},v.b6=function(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n[3]=e[3]*i[3],n},v.b7=Ot,v.b8=function(n,e,i){const r=e[0]*i[0]+e[1]*i[1]+e[2]*i[2];return r===0?null:(-(n[0]*i[0]+n[1]*i[1]+n[2]*i[2])-i[3])/r},v.b9=Jn,v.bA=function(n,e,i,r){return n[0]=e[0]+i[0]*r,n[1]=e[1]+i[1]*r,n[2]=e[2]+i[2]*r,n},v.bB=Ji,v.bC=function(n,e,i){var r=i[0],u=i[1],h=i[2],c=i[3],_=e[0],y=e[1],k=e[2],P=u*k-h*y,E=h*_-r*k,D=r*y-u*_;return n[0]=_+c*(P+=P)+u*(D+=D)-h*(E+=E),n[1]=y+c*E+h*P-r*D,n[2]=k+c*D+r*E-u*P,n},v.bD=function(n,e,i){const r=(function(y){var k=y[3],P=y[4],E=y[5],D=y[6],A=y[7],O=y[8];return y[0]*(O*P-E*A)+y[1]*(-O*k+E*D)+y[2]*(A*k-P*D)})([n[0],n[1],n[2],e[0],e[1],e[2],i[0],i[1],i[2]]);if(r===0)return null;const u=Pi([],[e[0],e[1],e[2]],[i[0],i[1],i[2]]),h=Pi([],[i[0],i[1],i[2]],[n[0],n[1],n[2]]),c=Pi([],[n[0],n[1],n[2]],[e[0],e[1],e[2]]),_=zn([],u,-n[3]);return En(_,_,zn([],h,-e[3])),En(_,_,zn([],c,-i[3])),zn(_,_,1/r),_},v.bE=wh,v.bF=function(){return new Float64Array(4)},v.bG=function(n,e,i,r){var u=[],h=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],h[0]=u[0]*Math.cos(r)-u[1]*Math.sin(r),h[1]=u[0]*Math.sin(r)+u[1]*Math.cos(r),h[2]=u[2],n[0]=h[0]+i[0],n[1]=h[1]+i[1],n[2]=h[2]+i[2],n},v.bH=function(n,e,i,r){var u=[],h=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],h[0]=u[0],h[1]=u[1]*Math.cos(r)-u[2]*Math.sin(r),h[2]=u[1]*Math.sin(r)+u[2]*Math.cos(r),n[0]=h[0]+i[0],n[1]=h[1]+i[1],n[2]=h[2]+i[2],n},v.bI=function(n,e,i,r){var u=[],h=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],h[0]=u[2]*Math.sin(r)+u[0]*Math.cos(r),h[1]=u[1],h[2]=u[2]*Math.cos(r)-u[0]*Math.sin(r),n[0]=h[0]+i[0],n[1]=h[1]+i[1],n[2]=h[2]+i[2],n},v.bJ=function(n,e,i){var r=Math.sin(i),u=Math.cos(i),h=e[0],c=e[1],_=e[2],y=e[3],k=e[8],P=e[9],E=e[10],D=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=h*u-k*r,n[1]=c*u-P*r,n[2]=_*u-E*r,n[3]=y*u-D*r,n[8]=h*r+k*u,n[9]=c*r+P*u,n[10]=_*r+E*u,n[11]=y*r+D*u,n},v.bK=function(n,e){const i=Ut(n,360),r=Ut(e,360),u=r-i,h=r>i?u-360:u+360;return Math.abs(u)<Math.abs(h)?u:h},v.bL=function(n){return n[0]=0,n[1]=0,n[2]=0,n},v.bM=function(n,e,i,r){const u=Math.sqrt(n*n+e*e),h=Math.sqrt(i*i+r*r);n/=u,e/=u,i/=h,r/=h;const c=Math.acos(n*i+e*r);return-e*i+n*r>0?c:-c},v.bN=function(n,e){const i=Ut(n,2*Math.PI),r=Ut(e,2*Math.PI);return Math.min(Math.abs(i-r),Math.abs(i-r+2*Math.PI),Math.abs(i-r-2*Math.PI))},v.bO=function(){const n={},e=Se.$version;for(const i in Se.$root){const r=Se.$root[i];if(r.required){let u=null;u=i==="version"?e:r.type==="array"?[]:{},u!=null&&(n[i]=u)}}return n},v.bP=Me,v.bQ=pu,v.bR=function n(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(!n(e[r],i[r]))return!1;return!0}if(typeof e=="object"&&e!==null&&i!==null){if(typeof i!="object"||Object.keys(e).length!==Object.keys(i).length)return!1;for(const r in e)if(!n(e[r],i[r]))return!1;return!0}return e===i},v.bS=function(n){n=n.slice();const e=Object.create(null);for(let i=0;i<n.length;i++)e[n[i].id]=n[i];for(let i=0;i<n.length;i++)"ref"in n[i]&&(n[i]=an(n[i],e[n[i].ref]));return n},v.bT=function(n,e){if(n.type==="custom")return new Np(n,e);switch(n.type){case"background":return new Vp(n,e);case"circle":return new Tm(n,e);case"color-relief":return new zm(n,e);case"fill":return new Zm(n,e);case"fill-extrusion":return new ap(n,e);case"heatmap":return new Lm(n,e);case"hillshade":return new Cm(n,e);case"line":return new hp(n,e);case"raster":return new Xd(n,e);case"symbol":return new Md(n,e)}},v.bU=n=>n.type==="raster",v.bV=nn,v.bW=function(n,e){if(!n)return[{command:"setStyle",args:[e]}];let i=[];try{if(!yt(n.version,e.version))return[{command:"setStyle",args:[e]}];yt(n.center,e.center)||i.push({command:"setCenter",args:[e.center]}),yt(n.state,e.state)||i.push({command:"setGlobalState",args:[e.state]}),yt(n.centerAltitude,e.centerAltitude)||i.push({command:"setCenterAltitude",args:[e.centerAltitude]}),yt(n.zoom,e.zoom)||i.push({command:"setZoom",args:[e.zoom]}),yt(n.bearing,e.bearing)||i.push({command:"setBearing",args:[e.bearing]}),yt(n.pitch,e.pitch)||i.push({command:"setPitch",args:[e.pitch]}),yt(n.roll,e.roll)||i.push({command:"setRoll",args:[e.roll]}),yt(n.sprite,e.sprite)||i.push({command:"setSprite",args:[e.sprite]}),yt(n.glyphs,e.glyphs)||i.push({command:"setGlyphs",args:[e.glyphs]}),yt(n.transition,e.transition)||i.push({command:"setTransition",args:[e.transition]}),yt(n.light,e.light)||i.push({command:"setLight",args:[e.light]}),yt(n.terrain,e.terrain)||i.push({command:"setTerrain",args:[e.terrain]}),yt(n.sky,e.sky)||i.push({command:"setSky",args:[e.sky]}),yt(n.projection,e.projection)||i.push({command:"setProjection",args:[e.projection]});const r={},u=[];(function(c,_,y,k){let P;for(P in _=_||{},c=c||{})Object.prototype.hasOwnProperty.call(c,P)&&(Object.prototype.hasOwnProperty.call(_,P)||ii(P,y,k));for(P in _)Object.prototype.hasOwnProperty.call(_,P)&&(Object.prototype.hasOwnProperty.call(c,P)?yt(c[P],_[P])||(c[P].type==="geojson"&&_[P].type==="geojson"&&ni(c,_,P)?Wt(y,{command:"setGeoJSONSourceData",args:[P,_[P].data]}):vi(P,_,y,k)):rn(P,_,y))})(n.sources,e.sources,u,r);const h=[];n.layers&&n.layers.forEach((c=>{"source"in c&&r[c.source]?i.push({command:"removeLayer",args:[c.id]}):h.push(c)})),i=i.concat(u),(function(c,_,y){_=_||[];const k=(c=c||[]).map(vo),P=_.map(vo),E=c.reduce(Dn,{}),D=_.reduce(Dn,{}),A=k.slice(),O=Object.create(null);let $,N,H,ne,K;for(let J=0,oe=0;J<k.length;J++)$=k[J],Object.prototype.hasOwnProperty.call(D,$)?oe++:(Wt(y,{command:"removeLayer",args:[$]}),A.splice(A.indexOf($,oe),1));for(let J=0,oe=0;J<P.length;J++)$=P[P.length-1-J],A[A.length-1-J]!==$&&(Object.prototype.hasOwnProperty.call(E,$)?(Wt(y,{command:"removeLayer",args:[$]}),A.splice(A.lastIndexOf($,A.length-oe),1)):oe++,ne=A[A.length-J],Wt(y,{command:"addLayer",args:[D[$],ne]}),A.splice(A.length-J,0,$),O[$]=!0);for(let J=0;J<P.length;J++)if($=P[J],N=E[$],H=D[$],!O[$]&&!yt(N,H))if(yt(N.source,H.source)&&yt(N["source-layer"],H["source-layer"])&&yt(N.type,H.type)){for(K in Ui(N.layout,H.layout,y,$,null,"setLayoutProperty"),Ui(N.paint,H.paint,y,$,null,"setPaintProperty"),yt(N.filter,H.filter)||Wt(y,{command:"setFilter",args:[$,H.filter]}),yt(N.minzoom,H.minzoom)&&yt(N.maxzoom,H.maxzoom)||Wt(y,{command:"setLayerZoomRange",args:[$,H.minzoom,H.maxzoom]}),N)Object.prototype.hasOwnProperty.call(N,K)&&K!=="layout"&&K!=="paint"&&K!=="filter"&&K!=="metadata"&&K!=="minzoom"&&K!=="maxzoom"&&(K.indexOf("paint.")===0?Ui(N[K],H[K],y,$,K.slice(6),"setPaintProperty"):yt(N[K],H[K])||Wt(y,{command:"setLayerProperty",args:[$,K,H[K]]}));for(K in H)Object.prototype.hasOwnProperty.call(H,K)&&!Object.prototype.hasOwnProperty.call(N,K)&&K!=="layout"&&K!=="paint"&&K!=="filter"&&K!=="metadata"&&K!=="minzoom"&&K!=="maxzoom"&&(K.indexOf("paint.")===0?Ui(N[K],H[K],y,$,K.slice(6),"setPaintProperty"):yt(N[K],H[K])||Wt(y,{command:"setLayerProperty",args:[$,K,H[K]]}))}else Wt(y,{command:"removeLayer",args:[$]}),ne=A[A.lastIndexOf($)+1],Wt(y,{command:"addLayer",args:[H,ne]})})(h,e.layers,i)}catch(r){console.warn("Unable to compute style diff:",r),i=[{command:"setStyle",args:[e]}]}return i},v.bX=function(n){const e=[],i=n.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},v.bY=dn,v.bZ=Ia,v.b_=class extends na{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},v.ba=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n},v.bb=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]},v.bc=nf,v.bd=Hl,v.be=function(n,e,i,r,u){var h=1/Math.tan(e/2);if(n[0]=h/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,u!=null&&u!==1/0){var c=1/(r-u);n[10]=(u+r)*c,n[14]=2*u*r*c}else n[10]=-1,n[14]=-2*r;return n},v.bf=function(n){var e=new He(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},v.bg=function(n,e,i){var r=Math.sin(i),u=Math.cos(i),h=e[0],c=e[1],_=e[2],y=e[3],k=e[4],P=e[5],E=e[6],D=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=h*u+k*r,n[1]=c*u+P*r,n[2]=_*u+E*r,n[3]=y*u+D*r,n[4]=k*u-h*r,n[5]=P*u-c*r,n[6]=E*u-_*r,n[7]=D*u-y*r,n},v.bh=function(n,e,i){var r=Math.sin(i),u=Math.cos(i),h=e[4],c=e[5],_=e[6],y=e[7],k=e[8],P=e[9],E=e[10],D=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=h*u+k*r,n[5]=c*u+P*r,n[6]=_*u+E*r,n[7]=y*u+D*r,n[8]=k*u-h*r,n[9]=P*u-c*r,n[10]=E*u-_*r,n[11]=D*u-y*r,n},v.bi=function(){const n=new Float32Array(16);return Bt(n),n},v.bj=function(){const n=new Float64Array(16);return Bt(n),n},v.bk=function(){return new Float64Array(16)},v.bl=function(n,e,i){const r=new Float64Array(4);return Ji(r,n,e-90,i),r},v.bm=function(n,e,i,r){var u,h,c,_,y,k=e[0],P=e[1],E=e[2],D=e[3],A=i[0],O=i[1],$=i[2],N=i[3];return(h=k*A+P*O+E*$+D*N)<0&&(h=-h,A=-A,O=-O,$=-$,N=-N),1-h>We?(u=Math.acos(h),c=Math.sin(u),_=Math.sin((1-r)*u)/c,y=Math.sin(r*u)/c):(_=1-r,y=r),n[0]=_*k+y*A,n[1]=_*P+y*O,n[2]=_*E+y*$,n[3]=_*D+y*N,n},v.bn=function(n){const e=new Float64Array(9);(function(h,c){var _=c[0],y=c[1],k=c[2],P=c[3],E=_+_,D=y+y,A=k+k,O=_*E,$=y*E,N=y*D,H=k*E,ne=k*D,K=k*A,J=P*E,oe=P*D,de=P*A;h[0]=1-N-K,h[3]=$-de,h[6]=H+oe,h[1]=$+de,h[4]=1-O-K,h[7]=ne-J,h[2]=H-oe,h[5]=ne+J,h[8]=1-O-N})(e,n);const i=In(-Math.asin(kt(e[2],-1,1)));let r,u;return Math.hypot(e[5],e[8])<.001?(r=0,u=-In(Math.atan2(e[3],e[4]))):(r=In(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),u=In(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:r,pitch:i+90,bearing:u}},v.bo=function(n,e){return n.roll==e.roll&&n.pitch==e.pitch&&n.bearing==e.bearing},v.bp=Lt,v.bq=Vo,v.br=Ul,v.bs=ju,v.bt=Nl,v.bu=Ri,v.bv=Ni,v.bw=ji,v.bx=function(n,e,i,r,u){return Ri(r,u,kt((n-e)/(i-e),0,1))},v.by=Ut,v.bz=function(){return new Float64Array(3)},v.c=pe,v.c$=function(n,e,i,r,u){return o(this,void 0,void 0,(function*(){if(it())try{return yield gr(n,e,i,r,u)}catch{}return(function(h,c,_,y,k){const P=h.width,E=h.height;ya&&Qn||(ya=new OffscreenCanvas(P,E),Qn=ya.getContext("2d",{willReadFrequently:!0})),ya.width=P,ya.height=E,Qn.drawImage(h,0,0,P,E);const D=Qn.getImageData(c,_,y,k);return Qn.clearRect(0,0,P,E),D.data})(n,e,i,r,u)}))},v.c0=class extends na{constructor(n,e){super(n,e),this.current=Ca}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},v.c1=Hs,v.c2=class extends na{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},v.c3=class extends na{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},v.c4=bt,v.c5=function(n,e){var i=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=i,n[2]=0,n[3]=-i,n[4]=r,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},v.c6=function(n,e,i){var r=e[0],u=e[1],h=e[2];return n[0]=r*i[0]+u*i[3]+h*i[6],n[1]=r*i[1]+u*i[4]+h*i[7],n[2]=r*i[2]+u*i[5]+h*i[8],n},v.c7=function(n,e,i,r,u,h,c){var _=1/(e-i),y=1/(r-u),k=1/(h-c);return n[0]=-2*_,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*y,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*k,n[11]=0,n[12]=(e+i)*_,n[13]=(u+r)*y,n[14]=(c+h)*k,n[15]=1,n},v.c8=class extends na{constructor(n,e){super(n,e),this.current=new Array}set(n){if(n!=this.current){this.current=n;const e=new Float32Array(4*n.length);for(let i=0;i<n.length;i++)e[4*i]=n[i].r,e[4*i+1]=n[i].g,e[4*i+2]=n[i].b,e[4*i+3]=n[i].a;this.gl.uniform4fv(this.location,e)}}},v.c9=class extends na{constructor(n,e){super(n,e),this.current=new Array}set(n){if(n!=this.current){this.current=n;const e=new Float32Array(n);this.gl.uniform1fv(this.location,e)}}},v.cA=function(n,e){return xe[e]&&"touches"in n},v.cB=function(n){return xe[n]||G[n]},v.cC=function(n,e,i){var r=e[0],u=e[1];return n[0]=i[0]*r+i[4]*u+i[12],n[1]=i[1]*r+i[5]*u+i[13],n},v.cD=function(n,e){const{x:i,y:r}=Nu.fromLngLat(e);return!(n<0||n>25||r<0||r>=1||i<0||i>=1)},v.cE=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},v.cF=class extends zl{},v.cG=M_,v.cI=ge,v.cJ=function(n,e){pe.REGISTERED_PROTOCOLS[n]=e},v.cK=function(n){delete pe.REGISTERED_PROTOCOLS[n]},v.cL=function(n,e){const i={};for(let u=0;u<n.length;u++){const h=e&&e[n[u].id]||wl(n[u]);e&&(e[n[u].id]=h);let c=i[h];c||(c=i[h]=[]),c.push(n[u])}const r=[];for(const u in i)r.push(i[u]);return r},v.cM=ot,v.cN=rf,v.cO=Ff,v.cP=Oc,v.cQ=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=$t/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const e=n.bucket.layers[0],i=e.layout,r=e._unevaluatedLayout._values,u={layoutIconSize:r["icon-size"].possiblyEvaluate(new oi(n.bucket.zoom+1),n.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new oi(n.bucket.zoom+1),n.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new oi(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:P}=n.bucket.textSizeData;u.compositeTextSizes=[r["text-size"].possiblyEvaluate(new oi(k),n.canonical),r["text-size"].possiblyEvaluate(new oi(P),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:P}=n.bucket.iconSizeData;u.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new oi(k),n.canonical),r["icon-size"].possiblyEvaluate(new oi(P),n.canonical)]}const h=i.get("text-line-height")*gn,c=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",_=i.get("text-keep-upright"),y=i.get("text-size");for(const k of n.bucket.features){const P=i.get("text-font").evaluate(k,{},n.canonical).join(","),E=y.evaluate(k,{},n.canonical),D=u.layoutTextSize.evaluate(k,{},n.canonical),A=u.layoutIconSize.evaluate(k,{},n.canonical),O={horizontal:{},vertical:void 0},$=k.text;let N,H=[0,0];if($){const J=$.toString(),oe=i.get("text-letter-spacing").evaluate(k,{},n.canonical)*gn,de=Wd(J)?oe:0,we=i.get("text-anchor").evaluate(k,{},n.canonical),Ve=Xf(e,k,n.canonical);if(!Ve){const qe=i.get("text-radial-offset").evaluate(k,{},n.canonical);H=qe?Kf(we,[qe*gn,$h]):i.get("text-offset").evaluate(k,{},n.canonical).map((Be=>Be*gn))}let je=c?"center":i.get("text-justify").evaluate(k,{},n.canonical);const Ne=i.get("symbol-placement")==="point"?i.get("text-max-width").evaluate(k,{},n.canonical)*gn:1/0,Ye=()=>{n.bucket.allowVerticalPlacement&&ps(J)&&(O.vertical=Pd($,n.glyphMap,n.glyphPositions,n.imagePositions,P,Ne,h,we,"left",de,H,v.az.vertical,!0,D,E))};if(!c&&Ve){const qe=new Set;if(je==="auto")for(let ze=0;ze<Ve.values.length;ze+=2)qe.add(Vh(Ve.values[ze]));else qe.add(je);let Be=!1;for(const ze of qe)if(!O.horizontal[ze])if(Be)O.horizontal[ze]=O.horizontal[0];else{const at=Pd($,n.glyphMap,n.glyphPositions,n.imagePositions,P,Ne,h,"center",ze,de,H,v.az.horizontal,!1,D,E);at&&(O.horizontal[ze]=at,Be=at.positionedLines.length===1)}Ye()}else{je==="auto"&&(je=Vh(we));const qe=Pd($,n.glyphMap,n.glyphPositions,n.imagePositions,P,Ne,h,we,je,de,H,v.az.horizontal,!1,D,E);qe&&(O.horizontal[je]=qe),Ye(),ps(J)&&c&&_&&(O.vertical=Pd($,n.glyphMap,n.glyphPositions,n.imagePositions,P,Ne,h,we,je,de,H,v.az.vertical,!1,D,E))}}let ne=!1;if(k.icon&&k.icon.name){const J=n.imageMap[k.icon.name];J&&(N=Fp(n.imagePositions[k.icon.name],i.get("icon-offset").evaluate(k,{},n.canonical),i.get("icon-anchor").evaluate(k,{},n.canonical)),ne=!!J.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=ne:n.bucket.sdfIcons!==ne&&Qi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(J.pixelRatio!==n.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const K=Jf(O.horizontal)||O.vertical;n.bucket.iconsInText=!!K&&K.iconsInText,(K||N)&&P_(n.bucket,k,O,N,n.imageMap,u,D,A,H,ne,n.canonical,n.subdivisionGranularity)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},v.cR=uh,v.cS=hh,v.cT=ch,v.cU=function(n){const e=new Td;return(function(i,r){for(const u in i.layers)r.writeMessage(3,c_,i.layers[u])})(n,e),e.finish()},v.cV=function(n,e,i,r,u,h){let c=$f(n,e,i,u,0);return c=$f(c,e,r,h,1),c},v.cW=class{constructor(n){this.maxEntries=n,this.map=new Map}get(n){const e=this.map.get(n);return e!==void 0&&(this.map.delete(n),this.map.set(n,e)),e}set(n,e){if(this.map.has(n))this.map.delete(n);else if(this.map.size>=this.maxEntries){const i=this.map.keys().next().value;this.map.delete(i)}this.map.set(n,e)}clear(){this.map.clear()}},v.cX=wc,v.cY=Td,v.cZ=Rf,v.c_=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},v.ca=class extends Oo{},v.cb=pp,v.cc=class extends Zs{},v.cd=ah,v.ce=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},v.cf=oc,v.cg=function(n,e,i){var r=e[0],u=e[1],h=e[2],c=i[3]*r+i[7]*u+i[11]*h+i[15];return n[0]=(i[0]*r+i[4]*u+i[8]*h+i[12])/(c=c||1),n[1]=(i[1]*r+i[5]*u+i[9]*h+i[13])/c,n[2]=(i[2]*r+i[6]*u+i[10]*h+i[14])/c,n},v.ch=class extends bu{},v.ci=class extends t{},v.cj=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]},v.ck=function(n,e){var i=n[0],r=n[1],u=n[2],h=n[3],c=n[4],_=n[5],y=n[6],k=n[7],P=n[8],E=n[9],D=n[10],A=n[11],O=n[12],$=n[13],N=n[14],H=n[15],ne=e[0],K=e[1],J=e[2],oe=e[3],de=e[4],we=e[5],Ve=e[6],je=e[7],Ne=e[8],Ye=e[9],qe=e[10],Be=e[11],ze=e[12],at=e[13],tt=e[14],lt=e[15];return Math.abs(i-ne)<=We*Math.max(1,Math.abs(i),Math.abs(ne))&&Math.abs(r-K)<=We*Math.max(1,Math.abs(r),Math.abs(K))&&Math.abs(u-J)<=We*Math.max(1,Math.abs(u),Math.abs(J))&&Math.abs(h-oe)<=We*Math.max(1,Math.abs(h),Math.abs(oe))&&Math.abs(c-de)<=We*Math.max(1,Math.abs(c),Math.abs(de))&&Math.abs(_-we)<=We*Math.max(1,Math.abs(_),Math.abs(we))&&Math.abs(y-Ve)<=We*Math.max(1,Math.abs(y),Math.abs(Ve))&&Math.abs(k-je)<=We*Math.max(1,Math.abs(k),Math.abs(je))&&Math.abs(P-Ne)<=We*Math.max(1,Math.abs(P),Math.abs(Ne))&&Math.abs(E-Ye)<=We*Math.max(1,Math.abs(E),Math.abs(Ye))&&Math.abs(D-qe)<=We*Math.max(1,Math.abs(D),Math.abs(qe))&&Math.abs(A-Be)<=We*Math.max(1,Math.abs(A),Math.abs(Be))&&Math.abs(O-ze)<=We*Math.max(1,Math.abs(O),Math.abs(ze))&&Math.abs($-at)<=We*Math.max(1,Math.abs($),Math.abs(at))&&Math.abs(N-tt)<=We*Math.max(1,Math.abs(N),Math.abs(tt))&&Math.abs(H-lt)<=We*Math.max(1,Math.abs(H),Math.abs(lt))},v.cl=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},v.cm=n=>n.type==="symbol",v.cn=n=>n.type==="circle",v.co=n=>n.type==="heatmap",v.cp=n=>n.type==="line",v.cq=n=>n.type==="fill",v.cr=n=>n.type==="fill-extrusion",v.cs=n=>n.type==="hillshade",v.ct=n=>n.type==="color-relief",v.cu=n=>n.type==="background",v.cv=n=>n.type==="custom",v.cw=ei,v.cx=function(n,e,i){const r=_t(e.x-i.x,e.y-i.y),u=_t(n.x-i.x,n.y-i.y),h=Math.atan2(r[0]*u[1]-r[1]*u[0],(function(c,_){return c[0]*_[0]+c[1]*_[1]})(r,u));return In(h)},v.cy=Tt,v.cz=function(n,e){return G[e]&&(n instanceof MouseEvent||n instanceof WheelEvent)},v.d=$e,v.d0=uc,v.d1=R,v.d2=class{constructor(n,e){this.layers={[qu]:this},this.name=qu,this.version=e?e.version:1,this.extent=e?e.extent:4096,this.length=n.length,this.features=n}feature(n){return new h_(this.features[n],this.extent)}},v.d3=s,v.d4=fo,v.e=mi,v.f=n=>o(void 0,void 0,void 0,(function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(e)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),v.g=ke,v.h=n=>new Promise(((e,i)=>{const r=new Image;r.onload=()=>{e(r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame((()=>{r.src=_r}))},r.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const u=new Blob([new Uint8Array(n)],{type:"image/png"});r.src=n.byteLength?URL.createObjectURL(u):_r})),v.i=oa,v.j=(n,e)=>Ge(mi(n,{type:"json"}),e),v.k=Ht,v.l=gt,v.m=Ge,v.n=(n,e)=>Ge(mi(n,{type:"arrayBuffer"}),e),v.o=function(n){return new Td(n).readFields(Cp,[])},v.p=Bc,v.q=function(n){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))},v.r=zu,v.s=yr,v.t=Xn,v.u=Se,v.v=Ds,v.w=Qi,v.x=xu,v.y=As,v.z=Bs})),T("worker",["./shared"],(function(v){class o{constructor(G,U){this.keyCache={},G&&this.replace(G,U)}replace(G,U){this._layerConfigs={},this._layers={},this.update(G,[],U)}update(G,U,Y){for(const pe of G){this._layerConfigs[pe.id]=pe;const ke=this._layers[pe.id]=v.bT(pe,Y);ke._featureFilter=v.aj(ke.filter,Y),this.keyCache[pe.id]&&delete this.keyCache[pe.id]}for(const pe of U)delete this.keyCache[pe],delete this._layerConfigs[pe],delete this._layers[pe];this.familiesBySource={};const fe=v.cL(Object.values(this._layerConfigs),this.keyCache);for(const pe of fe){const ke=pe.map((nt=>this._layers[nt.id])),ve=ke[0];if(ve.isHidden())continue;const ge=ve.source||"";let Me=this.familiesBySource[ge];Me||(Me=this.familiesBySource[ge]={});const Ge=ve.sourceLayer||v.ai;let $e=Me[Ge];$e||($e=Me[Ge]=[]),$e.push(ke)}}}class I{constructor(G){const U={},Y=[];for(const ve in G){const ge=G[ve],Me=U[ve]={};for(const Ge in ge){const $e=ge[+Ge];if(!$e||$e.bitmap.width===0||$e.bitmap.height===0)continue;const nt={x:0,y:0,w:$e.bitmap.width+2,h:$e.bitmap.height+2};Y.push(nt),Me[Ge]={rect:nt,metrics:$e.metrics}}}const{w:fe,h:pe}=v.p(Y),ke=new v.r({width:fe||1,height:pe||1});for(const ve in G){const ge=G[ve];for(const Me in ge){const Ge=ge[+Me];if(!Ge||Ge.bitmap.width===0||Ge.bitmap.height===0)continue;const $e=U[ve][Me].rect;v.r.copy(Ge.bitmap,ke,{x:0,y:0},{x:$e.x+1,y:$e.y+1},Ge.bitmap)}}this.image=ke,this.positions=U}}v.cM("GlyphAtlas",I);class R{constructor(G){this.tileID=new v.a2(G.tileID.overscaledZ,G.tileID.wrap,G.tileID.canonical.z,G.tileID.canonical.x,G.tileID.canonical.y),this.uid=G.uid,this.zoom=G.zoom,this.pixelRatio=G.pixelRatio,this.tileSize=G.tileSize,this.source=G.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=G.showCollisionBoxes,this.collectResourceTiming=!!G.collectResourceTiming,this.returnDependencies=!!G.returnDependencies,this.promoteId=G.promoteId,this.inFlightDependencies=[]}parse(G,U,Y,fe,pe){return v._(this,void 0,void 0,(function*(){this.status="parsing",this.data=G,this.collisionBoxArray=new v.ag;const ke=new v.cN(Object.keys(G.layers).sort()),ve=new v.cO(this.tileID,this.promoteId);ve.bucketLayerIDs=[];const ge={},Me={featureIndex:ve,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:Y,subdivisionGranularity:pe},Ge=U.familiesBySource[this.source];for(const ni in Ge){const Ui=G.layers[ni];if(!Ui)continue;Ui.version===1&&v.w(`Vector tile source "${this.source}" layer "${ni}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vo=ke.encode(ni),Dn=[];for(let Ee=0;Ee<Ui.length;Ee++){const hn=Ui.feature(Ee),cn=ve.getId(hn,ni);Dn.push({feature:hn,id:cn,index:Ee,sourceLayerIndex:vo})}for(const Ee of Ge[ni]){const hn=Ee[0];hn.source!==this.source&&v.w(`layer.source = ${hn.source} does not equal this.source = ${this.source}`),hn.isHidden(this.zoom,!0)||(q(Ee,this.zoom,Y),(ge[hn.id]=hn.createBucket({index:ve.bucketLayerIDs.length,layers:Ee,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vo,sourceID:this.source})).populate(Dn,Me,this.tileID.canonical),ve.bucketLayerIDs.push(Ee.map((cn=>cn.id))))}}const $e=v.bY(Me.glyphDependencies,(ni=>Object.keys(ni).map(Number)));this.inFlightDependencies.forEach((ni=>ni?.abort())),this.inFlightDependencies=[];let nt=Promise.resolve({});if(Object.keys($e).length){const ni=new AbortController;this.inFlightDependencies.push(ni),nt=fe.sendAsync({type:"GG",data:{stacks:$e,source:this.source,tileID:this.tileID,type:"glyphs"}},ni)}const dt=Object.keys(Me.iconDependencies);let gt=Promise.resolve({});if(dt.length){const ni=new AbortController;this.inFlightDependencies.push(ni),gt=fe.sendAsync({type:"GI",data:{icons:dt,source:this.source,tileID:this.tileID,type:"icons"}},ni)}const Ht=Object.keys(Me.patternDependencies);let Vt=Promise.resolve({});if(Ht.length){const ni=new AbortController;this.inFlightDependencies.push(ni),Vt=fe.sendAsync({type:"GI",data:{icons:Ht,source:this.source,tileID:this.tileID,type:"patterns"}},ni)}const Se=Me.dashDependencies;let ti=Promise.resolve({});if(Object.keys(Se).length){const ni=new AbortController;this.inFlightDependencies.push(ni),ti=fe.sendAsync({type:"GDA",data:{dashes:Se}},ni)}const[an,yt,Wt,rn]=yield Promise.all([nt,gt,Vt,ti]),ii=new I(an),vi=new v.cP(yt,Wt);for(const ni in ge){const Ui=ge[ni];Ui instanceof v.ah?(q(Ui.layers,this.zoom,Y),v.cQ({bucket:Ui,glyphMap:an,glyphPositions:ii.positions,imageMap:yt,imagePositions:vi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Me.subdivisionGranularity})):Ui.hasDependencies&&(Ui instanceof v.cR||Ui instanceof v.cS||Ui instanceof v.cT)&&(q(Ui.layers,this.zoom,Y),Ui.addFeatures(Me,this.tileID.canonical,vi.patternPositions,rn))}return this.status="done",{buckets:Object.values(ge).filter((ni=>!ni.isEmpty())),featureIndex:ve,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ii.image,imageAtlas:vi,dashPositions:rn,glyphMap:this.returnDependencies?an:null,iconMap:this.returnDependencies?yt:null,glyphPositions:this.returnDependencies?ii.positions:null}}))}}function q(xe,G,U){const Y=new v.H(G);for(const fe of xe)fe.recalculate(Y,U)}class X{constructor(G,U,Y,fe,pe){this.type=G,this.properties=Y||{},this.extent=pe,this.pointsArray=U,this.id=fe}loadGeometry(){return this.pointsArray.map((G=>G.map((U=>new v.P(U.x,U.y)))))}}class re{constructor(G,U,Y){this.version=2,this._myFeatures=G,this.name=U,this.length=G.length,this.extent=Y}feature(G){return this._myFeatures[G]}}class ce{constructor(){this.layers={}}addLayer(G){this.layers[G.name]=G}}function Ae(xe){let G=v.cU(xe);return G.byteOffset===0&&G.byteLength===G.buffer.byteLength||(G=new Uint8Array(G)),{vectorTile:xe,rawData:G.buffer}}function Pe(xe,G,U){const{extent:Y}=xe,fe=Math.pow(2,U.z-G.z),pe=(U.x-G.x*fe)*Y,ke=(U.y-G.y*fe)*Y,ve=[];for(let ge=0;ge<xe.length;ge++){const Me=xe.feature(ge);let Ge=Me.loadGeometry();for(const nt of Ge)for(const dt of nt)dt.x=dt.x*fe-pe,dt.y=dt.y*fe-ke;const $e=128;Ge=v.cV(Ge,Me.type,-$e,-$e,Y+$e,Y+$e),Ge.length!==0&&ve.push(new X(Me.type,Ge,Me.properties,Me.id,Y))}return new re(ve,xe.name,Y)}class le{constructor(G,U,Y){this.actor=G,this.layerIndex=U,this.availableImages=Y,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new v.cW(1e3)}loadVectorTile(G,U){return v._(this,void 0,void 0,(function*(){const Y=yield v.n(G.request,U);try{return{vectorTile:G.encoding!=="mlt"?new v.cX(new v.cY(Y.data)):new v.cZ(Y.data),rawData:Y.data,cacheControl:Y.cacheControl,expires:Y.expires}}catch(fe){const pe=new Uint8Array(Y.data);let ke=`Unable to parse the tile at ${G.request.url}, `;throw ke+=pe[0]===31&&pe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${fe.message}`,new Error(ke)}}))}loadTile(G){return v._(this,void 0,void 0,(function*(){const{uid:U,overzoomParameters:Y}=G;Y&&(G.request=Y.overzoomRequest);const fe=!!(G&&G.request&&G.request.collectResourceTiming)&&new v.c_(G.request),pe=new R(G);this.loading[U]=pe;const ke=new AbortController;pe.abort=ke;try{const ve=yield this.loadVectorTile(G,ke);if(delete this.loading[U],!ve)return null;if(Y){const nt=this._getOverzoomTile(G,ve.vectorTile);ve.rawData=nt.rawData,ve.vectorTile=nt.vectorTile}const ge=ve.rawData,Me={};ve.expires&&(Me.expires=ve.expires),ve.cacheControl&&(Me.cacheControl=ve.cacheControl);const Ge={};if(fe){const nt=fe.finish();nt&&(Ge.resourceTiming=JSON.parse(JSON.stringify(nt)))}pe.vectorTile=ve.vectorTile;const $e=pe.parse(ve.vectorTile,this.layerIndex,this.availableImages,this.actor,G.subdivisionGranularity);this.loaded[U]=pe,this.fetching[U]={rawTileData:ge,cacheControl:Me,resourceTiming:Ge};try{const nt=yield $e;return v.e({rawTileData:ge.slice(0),encoding:G.encoding},nt,Me,Ge)}finally{delete this.fetching[U]}}catch(ve){throw delete this.loading[U],pe.status="done",this.loaded[U]=pe,ve}}))}_getOverzoomTile(G,U){const{tileID:Y,source:fe,overzoomParameters:pe}=G,{maxZoomTileID:ke}=pe,ve=`${ke.key}_${Y.key}`,ge=this.overzoomedTileResultCache.get(ve);if(ge)return ge;const Me=new ce,Ge=this.layerIndex.familiesBySource[fe];for(const nt in Ge){const dt=U.layers[nt];if(!dt)continue;const gt=Pe(dt,ke,Y.canonical);gt.length>0&&Me.addLayer(gt)}const $e=Ae(Me);return this.overzoomedTileResultCache.set(ve,$e),$e}reloadTile(G){return v._(this,void 0,void 0,(function*(){const U=G.uid;if(!this.loaded||!this.loaded[U])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Y=this.loaded[U];if(Y.showCollisionBoxes=G.showCollisionBoxes,Y.status==="parsing"){const fe=yield Y.parse(Y.vectorTile,this.layerIndex,this.availableImages,this.actor,G.subdivisionGranularity);let pe;if(this.fetching[U]){const{rawTileData:ke,cacheControl:ve,resourceTiming:ge}=this.fetching[U];delete this.fetching[U],pe=v.e({rawTileData:ke.slice(0),encoding:G.encoding},fe,ve,ge)}else pe=fe;return pe}if(Y.status==="done"&&Y.vectorTile)return Y.parse(Y.vectorTile,this.layerIndex,this.availableImages,this.actor,G.subdivisionGranularity)}))}abortTile(G){return v._(this,void 0,void 0,(function*(){const U=this.loading,Y=G.uid;U&&U[Y]&&U[Y].abort&&(U[Y].abort.abort(),delete U[Y])}))}removeTile(G){return v._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[G.uid]&&delete this.loaded[G.uid]}))}}class it{constructor(){this.loaded={}}loadTile(G){return v._(this,void 0,void 0,(function*(){const{uid:U,encoding:Y,rawImageData:fe,redFactor:pe,greenFactor:ke,blueFactor:ve,baseShift:ge}=G,Me=fe.width+2,Ge=fe.height+2,$e=v.b(fe)?new v.R({width:Me,height:Ge},yield v.c$(fe,-1,-1,Me,Ge)):fe,nt=new v.d0(U,$e,Y,pe,ke,ve,ge);return this.loaded=this.loaded||{},this.loaded[U]=nt,nt}))}removeTile(G){const U=this.loaded,Y=G.uid;U&&U[Y]&&delete U[Y]}}var We,He,bt=(function(){if(He)return We;function xe(U,Y){if(U.length!==0){G(U[0],Y);for(var fe=1;fe<U.length;fe++)G(U[fe],!Y)}}function G(U,Y){for(var fe=0,pe=0,ke=0,ve=U.length,ge=ve-1;ke<ve;ge=ke++){var Me=(U[ke][0]-U[ge][0])*(U[ge][1]+U[ke][1]),Ge=fe+Me;pe+=Math.abs(fe)>=Math.abs(Me)?fe-Ge+Me:Me-Ge+fe,fe=Ge}fe+pe>=0!=!!Y&&U.reverse()}return He=1,We=function U(Y,fe){var pe,ke=Y&&Y.type;if(ke==="FeatureCollection")for(pe=0;pe<Y.features.length;pe++)U(Y.features[pe],fe);else if(ke==="GeometryCollection")for(pe=0;pe<Y.geometries.length;pe++)U(Y.geometries[pe],fe);else if(ke==="Feature")U(Y.geometry,fe);else if(ke==="Polygon")xe(Y.coordinates,fe);else if(ke==="MultiPolygon")for(pe=0;pe<Y.coordinates.length;pe++)xe(Y.coordinates[pe],fe);return Y}})(),Bt=v.d1(bt);const Di={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},Ot=Math.fround||(Ai=new Float32Array(1),xe=>(Ai[0]=+xe,Ai[0]));var Ai;class En{constructor(G){this.options=Object.assign(Object.create(Di),G),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(G){const{log:U,minZoom:Y,maxZoom:fe}=this.options;U&&console.time("total time");const pe=`prepare ${G.length} points`;U&&console.time(pe),this.points=G;const ke=[];for(let ge=0;ge<G.length;ge++){const Me=G[ge];if(!Me.geometry)continue;const[Ge,$e]=Me.geometry.coordinates,nt=Ot(yi(Ge)),dt=Ot(Jn($e));ke.push(nt,dt,1/0,ge,-1,1),this.options.reduce&&ke.push(0)}let ve=this.trees[fe+1]=this._createTree(ke);U&&console.timeEnd(pe);for(let ge=fe;ge>=Y;ge--){const Me=+Date.now();ve=this.trees[ge]=this._createTree(this._cluster(ve,ge)),U&&console.log("z%d: %d clusters in %dms",ge,ve.numItems,+Date.now()-Me)}return U&&console.timeEnd("total time"),this}getClusters(G,U){let Y=((G[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,G[1]));let pe=G[2]===180?180:((G[2]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,G[3]));if(G[2]-G[0]>=360)Y=-180,pe=180;else if(Y>pe){const $e=this.getClusters([Y,fe,180,ke],U),nt=this.getClusters([-180,fe,pe,ke],U);return $e.concat(nt)}const ve=this.trees[this._limitZoom(U)],ge=ve.range(yi(Y),Jn(ke),yi(pe),Jn(fe)),Me=ve.data,Ge=[];for(const $e of ge){const nt=this.stride*$e;Ge.push(Me[nt+5]>1?zn(Me,nt,this.clusterProps):this.points[Me[nt+3]])}return Ge}getChildren(G){const U=this._getOriginId(G),Y=this._getOriginZoom(G),fe="No cluster with the specified id.",pe=this.trees[Y];if(!pe)throw new Error(fe);const ke=pe.data;if(U*this.stride>=ke.length)throw new Error(fe);const ve=this.options.radius/(this.options.extent*Math.pow(2,Y-1)),ge=pe.within(ke[U*this.stride],ke[U*this.stride+1],ve),Me=[];for(const Ge of ge){const $e=Ge*this.stride;ke[$e+4]===G&&Me.push(ke[$e+5]>1?zn(ke,$e,this.clusterProps):this.points[ke[$e+3]])}if(Me.length===0)throw new Error(fe);return Me}getLeaves(G,U,Y){const fe=[];return this._appendLeaves(fe,G,U=U||10,Y=Y||0,0),fe}getTile(G,U,Y){const fe=this.trees[this._limitZoom(G)],pe=Math.pow(2,G),{extent:ke,radius:ve}=this.options,ge=ve/ke,Me=(Y-ge)/pe,Ge=(Y+1+ge)/pe,$e={features:[]};return this._addTileFeatures(fe.range((U-ge)/pe,Me,(U+1+ge)/pe,Ge),fe.data,U,Y,pe,$e),U===0&&this._addTileFeatures(fe.range(1-ge/pe,Me,1,Ge),fe.data,pe,Y,pe,$e),U===pe-1&&this._addTileFeatures(fe.range(0,Me,ge/pe,Ge),fe.data,-1,Y,pe,$e),$e.features.length?$e:null}getClusterExpansionZoom(G){let U=this._getOriginZoom(G)-1;for(;U<=this.options.maxZoom;){const Y=this.getChildren(G);if(U++,Y.length!==1)break;G=Y[0].properties.cluster_id}return U}_appendLeaves(G,U,Y,fe,pe){const ke=this.getChildren(U);for(const ve of ke){const ge=ve.properties;if(ge&&ge.cluster?pe+ge.point_count<=fe?pe+=ge.point_count:pe=this._appendLeaves(G,ge.cluster_id,Y,fe,pe):pe<fe?pe++:G.push(ve),G.length===Y)break}return pe}_createTree(G){const U=new v.aT(G.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Y=0;Y<G.length;Y+=this.stride)U.add(G[Y],G[Y+1]);return U.finish(),U.data=G,U}_addTileFeatures(G,U,Y,fe,pe,ke){for(const ve of G){const ge=ve*this.stride,Me=U[ge+5]>1;let Ge,$e,nt;if(Me)Ge=Pi(U,ge,this.clusterProps),$e=U[ge],nt=U[ge+1];else{const Ht=this.points[U[ge+3]];Ge=Ht.properties;const[Vt,Se]=Ht.geometry.coordinates;$e=yi(Vt),nt=Jn(Se)}const dt={type:1,geometry:[[Math.round(this.options.extent*($e*pe-Y)),Math.round(this.options.extent*(nt*pe-fe))]],tags:Ge};let gt;gt=Me||this.options.generateId?U[ge+3]:this.points[U[ge+3]].id,gt!==void 0&&(dt.id=gt),ke.features.push(dt)}}_limitZoom(G){return Math.max(this.options.minZoom,Math.min(Math.floor(+G),this.options.maxZoom+1))}_cluster(G,U){const{radius:Y,extent:fe,reduce:pe,minPoints:ke}=this.options,ve=Y/(fe*Math.pow(2,U)),ge=G.data,Me=[],Ge=this.stride;for(let $e=0;$e<ge.length;$e+=Ge){if(ge[$e+2]<=U)continue;ge[$e+2]=U;const nt=ge[$e],dt=ge[$e+1],gt=G.within(ge[$e],ge[$e+1],ve),Ht=ge[$e+5];let Vt=Ht;for(const Se of gt){const ti=Se*Ge;ge[ti+2]>U&&(Vt+=ge[ti+5])}if(Vt>Ht&&Vt>=ke){let Se,ti=nt*Ht,an=dt*Ht,yt=-1;const Wt=($e/Ge<<5)+(U+1)+this.points.length;for(const rn of gt){const ii=rn*Ge;if(ge[ii+2]<=U)continue;ge[ii+2]=U;const vi=ge[ii+5];ti+=ge[ii]*vi,an+=ge[ii+1]*vi,ge[ii+4]=Wt,pe&&(Se||(Se=this._map(ge,$e,!0),yt=this.clusterProps.length,this.clusterProps.push(Se)),pe(Se,this._map(ge,ii)))}ge[$e+4]=Wt,Me.push(ti/Vt,an/Vt,1/0,Wt,-1,Vt),pe&&Me.push(yt)}else{for(let Se=0;Se<Ge;Se++)Me.push(ge[$e+Se]);if(Vt>1)for(const Se of gt){const ti=Se*Ge;if(!(ge[ti+2]<=U)){ge[ti+2]=U;for(let an=0;an<Ge;an++)Me.push(ge[ti+an])}}}}return Me}_getOriginId(G){return G-this.points.length>>5}_getOriginZoom(G){return(G-this.points.length)%32}_map(G,U,Y){if(G[U+5]>1){const ke=this.clusterProps[G[U+6]];return Y?Object.assign({},ke):ke}const fe=this.points[G[U+3]].properties,pe=this.options.map(fe);return Y&&pe===fe?Object.assign({},pe):pe}}function zn(xe,G,U){return{type:"Feature",id:xe[G+3],properties:Pi(xe,G,U),geometry:{type:"Point",coordinates:[(Y=xe[G],360*(Y-.5)),bn(xe[G+1])]}};var Y}function Pi(xe,G,U){const Y=xe[G+5],fe=Y>=1e4?`${Math.round(Y/1e3)}k`:Y>=1e3?Math.round(Y/100)/10+"k":Y,pe=xe[G+6],ke=pe===-1?{}:Object.assign({},U[pe]);return Object.assign(ke,{cluster:!0,cluster_id:xe[G+3],point_count:Y,point_count_abbreviated:fe})}function yi(xe){return xe/360+.5}function Jn(xe){const G=Math.sin(xe*Math.PI/180),U=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return U<0?0:U>1?1:U}function bn(xe){const G=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(G))/Math.PI-90}function za(xe,G,U,Y){let fe=Y;const pe=G+(U-G>>1);let ke,ve=U-G;const ge=xe[G],Me=xe[G+1],Ge=xe[U],$e=xe[U+1];for(let nt=G+3;nt<U;nt+=3){const dt=Ji(xe[nt],xe[nt+1],ge,Me,Ge,$e);if(dt>fe)ke=nt,fe=dt;else if(dt===fe){const gt=Math.abs(nt-pe);gt<ve&&(ke=nt,ve=gt)}}fe>Y&&(ke-G>3&&za(xe,G,ke,Y),xe[ke+2]=fe,U-ke>3&&za(xe,ke,U,Y))}function Ji(xe,G,U,Y,fe,pe){let ke=fe-U,ve=pe-Y;if(ke!==0||ve!==0){const ge=((xe-U)*ke+(G-Y)*ve)/(ke*ke+ve*ve);ge>1?(U=fe,Y=pe):ge>0&&(U+=ke*ge,Y+=ve*ge)}return ke=xe-U,ve=G-Y,ke*ke+ve*ve}function Hi(xe,G,U,Y){const fe={id:xe??null,type:G,geometry:U,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(G==="Point"||G==="MultiPoint"||G==="LineString")_t(fe,U);else if(G==="Polygon")_t(fe,U[0]);else if(G==="MultiLineString")for(const pe of U)_t(fe,pe);else if(G==="MultiPolygon")for(const pe of U)_t(fe,pe[0]);return fe}function _t(xe,G){for(let U=0;U<G.length;U+=3)xe.minX=Math.min(xe.minX,G[U]),xe.minY=Math.min(xe.minY,G[U+1]),xe.maxX=Math.max(xe.maxX,G[U]),xe.maxY=Math.max(xe.maxY,G[U+1])}function $t(xe,G,U,Y){if(!G.geometry)return;const fe=G.geometry.coordinates;if(fe&&fe.length===0)return;const pe=G.geometry.type,ke=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2);let ve=[],ge=G.id;if(U.promoteId?ge=G.properties[U.promoteId]:U.generateId&&(ge=Y||0),pe==="Point")pt(fe,ve);else if(pe==="MultiPoint")for(const Me of fe)pt(Me,ve);else if(pe==="LineString")Ut(fe,ve,ke,!1);else if(pe==="MultiLineString"){if(U.lineMetrics){for(const Me of fe)ve=[],Ut(Me,ve,ke,!1),xe.push(Hi(ge,"LineString",ve,G.properties));return}Ri(fe,ve,ke,!1)}else if(pe==="Polygon")Ri(fe,ve,ke,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(const Me of G.geometry.geometries)$t(xe,{id:ge,geometry:Me,properties:G.properties},U,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Me of fe){const Ge=[];Ri(Me,Ge,ke,!0),ve.push(Ge)}}xe.push(Hi(ge,pe,ve,G.properties))}function pt(xe,G){G.push(Ni(xe[0]),ei(xe[1]),0)}function Ut(xe,G,U,Y){let fe,pe,ke=0;for(let ge=0;ge<xe.length;ge++){const Me=Ni(xe[ge][0]),Ge=ei(xe[ge][1]);G.push(Me,Ge,0),ge>0&&(ke+=Y?(fe*Ge-Me*pe)/2:Math.sqrt(Math.pow(Me-fe,2)+Math.pow(Ge-pe,2))),fe=Me,pe=Ge}const ve=G.length-3;G[2]=1,za(G,0,ve,U),G[ve+2]=1,G.size=Math.abs(ke),G.start=0,G.end=G.size}function Ri(xe,G,U,Y){for(let fe=0;fe<xe.length;fe++){const pe=[];Ut(xe[fe],pe,U,Y),G.push(pe)}}function Ni(xe){return xe/360+.5}function ei(xe){const G=Math.sin(xe*Math.PI/180),U=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return U<0?0:U>1?1:U}function Tt(xe,G,U,Y,fe,pe,ke,ve){if(Y/=G,pe>=(U/=G)&&ke<Y)return xe;if(ke<U||pe>=Y)return null;const ge=[];for(const Me of xe){const Ge=Me.geometry;let $e=Me.type;const nt=fe===0?Me.minX:Me.minY,dt=fe===0?Me.maxX:Me.maxY;if(nt>=U&&dt<Y){ge.push(Me);continue}if(dt<U||nt>=Y)continue;let gt=[];if($e==="Point"||$e==="MultiPoint")kt(Ge,gt,U,Y,fe);else if($e==="LineString")Wi(Ge,gt,U,Y,fe,!1,ve.lineMetrics);else if($e==="MultiLineString")ga(Ge,gt,U,Y,fe,!1);else if($e==="Polygon")ga(Ge,gt,U,Y,fe,!0);else if($e==="MultiPolygon")for(const Ht of Ge){const Vt=[];ga(Ht,Vt,U,Y,fe,!0),Vt.length&&gt.push(Vt)}if(gt.length){if(ve.lineMetrics&&$e==="LineString"){for(const Ht of gt)ge.push(Hi(Me.id,$e,Ht,Me.tags));continue}$e!=="LineString"&&$e!=="MultiLineString"||(gt.length===1?($e="LineString",gt=gt[0]):$e="MultiLineString"),$e!=="Point"&&$e!=="MultiPoint"||($e=gt.length===3?"Point":"MultiPoint"),ge.push(Hi(Me.id,$e,gt,Me.tags))}}return ge.length?ge:null}function kt(xe,G,U,Y,fe){for(let pe=0;pe<xe.length;pe+=3){const ke=xe[pe+fe];ke>=U&&ke<=Y&&dn(G,xe[pe],xe[pe+1],xe[pe+2])}}function Wi(xe,G,U,Y,fe,pe,ke){let ve=mi(xe);const ge=fe===0?Ia:nn;let Me,Ge,$e=xe.start;for(let Vt=0;Vt<xe.length-3;Vt+=3){const Se=xe[Vt],ti=xe[Vt+1],an=xe[Vt+2],yt=xe[Vt+3],Wt=xe[Vt+4],rn=fe===0?Se:ti,ii=fe===0?yt:Wt;let vi=!1;ke&&(Me=Math.sqrt(Math.pow(Se-yt,2)+Math.pow(ti-Wt,2))),rn<U?ii>U&&(Ge=ge(ve,Se,ti,yt,Wt,U),ke&&(ve.start=$e+Me*Ge)):rn>Y?ii<Y&&(Ge=ge(ve,Se,ti,yt,Wt,Y),ke&&(ve.start=$e+Me*Ge)):dn(ve,Se,ti,an),ii<U&&rn>=U&&(Ge=ge(ve,Se,ti,yt,Wt,U),vi=!0),ii>Y&&rn<=Y&&(Ge=ge(ve,Se,ti,yt,Wt,Y),vi=!0),!pe&&vi&&(ke&&(ve.end=$e+Me*Ge),G.push(ve),ve=mi(xe)),ke&&($e+=Me)}let nt=xe.length-3;const dt=xe[nt],gt=xe[nt+1],Ht=fe===0?dt:gt;Ht>=U&&Ht<=Y&&dn(ve,dt,gt,xe[nt+2]),nt=ve.length-3,pe&&nt>=3&&(ve[nt]!==ve[0]||ve[nt+1]!==ve[1])&&dn(ve,ve[0],ve[1],ve[2]),ve.length&&G.push(ve)}function mi(xe){const G=[];return G.size=xe.size,G.start=xe.start,G.end=xe.end,G}function ga(xe,G,U,Y,fe,pe){for(const ke of xe)Wi(ke,G,U,Y,fe,pe,!1)}function dn(xe,G,U,Y){xe.push(G,U,Y)}function Ia(xe,G,U,Y,fe,pe){const ke=(pe-G)/(Y-G);return dn(xe,pe,U+(fe-U)*ke,1),ke}function nn(xe,G,U,Y,fe,pe){const ke=(pe-U)/(fe-U);return dn(xe,G+(Y-G)*ke,pe,1),ke}function pr(xe,G){const U=[];for(let Y=0;Y<xe.length;Y++){const fe=xe[Y],pe=fe.type;let ke;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")ke=Qi(fe.geometry,G);else if(pe==="MultiLineString"||pe==="Polygon"){ke=[];for(const ve of fe.geometry)ke.push(Qi(ve,G))}else if(pe==="MultiPolygon"){ke=[];for(const ve of fe.geometry){const ge=[];for(const Me of ve)ge.push(Qi(Me,G));ke.push(ge)}}U.push(Hi(fe.id,pe,ke,fe.tags))}return U}function Qi(xe,G){const U=[];U.size=xe.size,xe.start!==void 0&&(U.start=xe.start,U.end=xe.end);for(let Y=0;Y<xe.length;Y+=3)U.push(xe[Y]+G,xe[Y+1],xe[Y+2]);return U}function Un(xe,G){if(xe.transformed)return xe;const U=1<<xe.z,Y=xe.x,fe=xe.y;for(const pe of xe.features){const ke=pe.geometry,ve=pe.type;if(pe.geometry=[],ve===1)for(let ge=0;ge<ke.length;ge+=2)pe.geometry.push(oa(ke[ge],ke[ge+1],G,U,Y,fe));else for(let ge=0;ge<ke.length;ge++){const Me=[];for(let Ge=0;Ge<ke[ge].length;Ge+=2)Me.push(oa(ke[ge][Ge],ke[ge][Ge+1],G,U,Y,fe));pe.geometry.push(Me)}}return xe.transformed=!0,xe}function oa(xe,G,U,Y,fe,pe){return[Math.round(U*(xe*Y-fe)),Math.round(U*(G*Y-pe))]}function hi(xe,G,U,Y,fe){const pe=G===fe.maxZoom?0:fe.tolerance/((1<<G)*fe.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:U,y:Y,z:G,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ve of xe)sa(ke,ve,pe,fe);return ke}function sa(xe,G,U,Y){const fe=G.geometry,pe=G.type,ke=[];if(xe.minX=Math.min(xe.minX,G.minX),xe.minY=Math.min(xe.minY,G.minY),xe.maxX=Math.max(xe.maxX,G.maxX),xe.maxY=Math.max(xe.maxY,G.maxY),pe==="Point"||pe==="MultiPoint")for(let ve=0;ve<fe.length;ve+=3)ke.push(fe[ve],fe[ve+1]),xe.numPoints++,xe.numSimplified++;else if(pe==="LineString")_r(ke,fe,xe,U,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(let ve=0;ve<fe.length;ve++)_r(ke,fe[ve],xe,U,pe==="Polygon",ve===0);else if(pe==="MultiPolygon")for(let ve=0;ve<fe.length;ve++){const ge=fe[ve];for(let Me=0;Me<ge.length;Me++)_r(ke,ge[Me],xe,U,!0,Me===0)}if(ke.length){let ve=G.tags||null;if(pe==="LineString"&&Y.lineMetrics){ve={};for(const Me in G.tags)ve[Me]=G.tags[Me];ve.mapbox_clip_start=fe.start/fe.size,ve.mapbox_clip_end=fe.end/fe.size}const ge={geometry:ke,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:ve};G.id!==null&&(ge.id=G.id),xe.features.push(ge)}}function _r(xe,G,U,Y,fe,pe){const ke=Y*Y;if(Y>0&&G.size<(fe?ke:Y))return void(U.numPoints+=G.length/3);const ve=[];for(let ge=0;ge<G.length;ge+=3)(Y===0||G[ge+2]>ke)&&(U.numSimplified++,ve.push(G[ge],G[ge+1])),U.numPoints++;fe&&(function(ge,Me){let Ge=0;for(let $e=0,nt=ge.length,dt=nt-2;$e<nt;dt=$e,$e+=2)Ge+=(ge[$e]-ge[dt])*(ge[$e+1]+ge[dt+1]);if(Ge>0===Me)for(let $e=0,nt=ge.length;$e<nt/2;$e+=2){const dt=ge[$e],gt=ge[$e+1];ge[$e]=ge[nt-2-$e],ge[$e+1]=ge[nt-1-$e],ge[nt-2-$e]=dt,ge[nt-1-$e]=gt}})(ve,pe),xe.push(ve)}const gr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ya{constructor(G,U){const Y=(U=this.options=(function(pe,ke){for(const ve in ke)pe[ve]=ke[ve];return pe})(Object.create(gr),U)).debug;if(Y&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");let fe=(function(pe,ke){const ve=[];if(pe.type==="FeatureCollection")for(let ge=0;ge<pe.features.length;ge++)$t(ve,pe.features[ge],ke,ge);else $t(ve,pe.type==="Feature"?pe:{geometry:pe},ke);return ve})(G,U);this.tiles={},this.tileCoords=[],Y&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=(function(pe,ke){const ve=ke.buffer/ke.extent;let ge=pe;const Me=Tt(pe,1,-1-ve,ve,0,-1,2,ke),Ge=Tt(pe,1,1-ve,2+ve,0,-1,2,ke);return(Me||Ge)&&(ge=Tt(pe,1,-ve,1+ve,0,-1,2,ke)||[],Me&&(ge=pr(Me,1).concat(ge)),Ge&&(ge=ge.concat(pr(Ge,-1)))),ge})(fe,U),fe.length&&this.splitTile(fe,0,0,0),Y&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(G,U,Y,fe,pe,ke,ve){const ge=[G,U,Y,fe],Me=this.options,Ge=Me.debug;for(;ge.length;){fe=ge.pop(),Y=ge.pop(),U=ge.pop(),G=ge.pop();const $e=1<<U,nt=Qn(U,Y,fe);let dt=this.tiles[nt];if(!dt&&(Ge>1&&console.time("creation"),dt=this.tiles[nt]=hi(G,U,Y,fe,Me),this.tileCoords.push({z:U,x:Y,y:fe}),Ge)){Ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,Y,fe,dt.numFeatures,dt.numPoints,dt.numSimplified),console.timeEnd("creation"));const vi=`z${U}`;this.stats[vi]=(this.stats[vi]||0)+1,this.total++}if(dt.source=G,pe==null){if(U===Me.indexMaxZoom||dt.numPoints<=Me.indexMaxPoints)continue}else{if(U===Me.maxZoom||U===pe)continue;if(pe!=null){const vi=pe-U;if(Y!==ke>>vi||fe!==ve>>vi)continue}}if(dt.source=null,G.length===0)continue;Ge>1&&console.time("clipping");const gt=.5*Me.buffer/Me.extent,Ht=.5-gt,Vt=.5+gt,Se=1+gt;let ti=null,an=null,yt=null,Wt=null,rn=Tt(G,$e,Y-gt,Y+Vt,0,dt.minX,dt.maxX,Me),ii=Tt(G,$e,Y+Ht,Y+Se,0,dt.minX,dt.maxX,Me);G=null,rn&&(ti=Tt(rn,$e,fe-gt,fe+Vt,1,dt.minY,dt.maxY,Me),an=Tt(rn,$e,fe+Ht,fe+Se,1,dt.minY,dt.maxY,Me),rn=null),ii&&(yt=Tt(ii,$e,fe-gt,fe+Vt,1,dt.minY,dt.maxY,Me),Wt=Tt(ii,$e,fe+Ht,fe+Se,1,dt.minY,dt.maxY,Me),ii=null),Ge>1&&console.timeEnd("clipping"),ge.push(ti||[],U+1,2*Y,2*fe),ge.push(an||[],U+1,2*Y,2*fe+1),ge.push(yt||[],U+1,2*Y+1,2*fe),ge.push(Wt||[],U+1,2*Y+1,2*fe+1)}}getTile(G,U,Y){G=+G,U=+U,Y=+Y;const fe=this.options,{extent:pe,debug:ke}=fe;if(G<0||G>24)return null;const ve=1<<G,ge=Qn(G,U=U+ve&ve-1,Y);if(this.tiles[ge])return Un(this.tiles[ge],pe);ke>1&&console.log("drilling down to z%d-%d-%d",G,U,Y);let Me,Ge=G,$e=U,nt=Y;for(;!Me&&Ge>0;)Ge--,$e>>=1,nt>>=1,Me=this.tiles[Qn(Ge,$e,nt)];return Me&&Me.source?(ke>1&&(console.log("found parent tile z%d-%d-%d",Ge,$e,nt),console.time("drilling down")),this.splitTile(Me.source,Ge,$e,nt,G,U,Y),ke>1&&console.timeEnd("drilling down"),this.tiles[ge]?Un(this.tiles[ge],pe):null):null}}function Qn(xe,G,U){return 32*((1<<xe)*U+G)+xe}class yr extends le{constructor(G,U,Y,fe=$r){super(G,U,Y),this._dataUpdateable=new Map,this._createGeoJSONIndex=fe}loadVectorTile(G,U){return v._(this,void 0,void 0,(function*(){const Y=G.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const fe=this._geoJSONIndex.getTile(Y.z,Y.x,Y.y);return fe?Ae(new v.d2(fe.features,{version:2,extent:v.a5})):null}))}loadData(G){return v._(this,void 0,void 0,(function*(){var U;(U=this._pendingRequest)===null||U===void 0||U.abort();const Y=this._startPerformance(G);this._pendingRequest=new AbortController;try{(!this._pendingData||G.request||G.data||G.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(G,this._pendingRequest));const fe=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(fe,G),this.loaded={};const pe={};return G.request&&(pe.data=fe),this._finishPerformance(Y,G,pe),pe}catch(fe){if(delete this._pendingRequest,v.Z(fe))return{abandoned:!0};throw fe}}))}_startPerformance(G){var U;if(!((U=G?.request)===null||U===void 0)&&U.collectResourceTiming)return new v.c_(G.request)}_finishPerformance(G,U,Y){if(!G)return;const fe=G.finish();fe&&(Y.resourceTiming={},Y.resourceTiming[U.source]=JSON.parse(JSON.stringify(fe)))}getData(){return v._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(G){const U=this.loaded;return U&&U[G.uid]?super.reloadTile(G):this.loadTile(G)}loadAndProcessGeoJSON(G,U){return v._(this,void 0,void 0,(function*(){let Y;if(G.request?Y=yield this.loadGeoJSONFromUrl(G.request,G.promoteId,U):G.data?Y=this._loadGeoJSONFromObject(G.data,G.promoteId):G.dataDiff&&(Y=this._loadGeoJSONFromDiff(G.dataDiff,G.promoteId,G.source)),delete this._pendingRequest,typeof Y!="object")throw new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`);return Bt(Y,!0),G.filter&&(Y=this._filterGeoJSON(Y,G.filter)),Y}))}loadGeoJSONFromUrl(G,U,Y){return v._(this,void 0,void 0,(function*(){const fe=yield v.j(G,Y);return this._dataUpdateable=v.a7(fe.data,U),fe.data}))}_loadGeoJSONFromObject(G,U){return this._dataUpdateable=v.a7(G,U),G}_loadGeoJSONFromDiff(G,U,Y){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Y}`);v.a8(this._dataUpdateable,G,U);const fe=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(fe)}_filterGeoJSON(G,U){const Y=v.d3(U,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Y.result==="error")throw new Error(Y.value.map((pe=>`${pe.key}: ${pe.message}`)).join(", "));const fe=G.features.filter((pe=>Y.value.evaluate({zoom:0},pe)));return this._toFeatureCollection(fe)}_toFeatureCollection(G){return{type:"FeatureCollection",features:G}}removeSource(G){return v._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(G){return this._geoJSONIndex.getClusterExpansionZoom(G.clusterId)}getClusterChildren(G){return this._geoJSONIndex.getChildren(G.clusterId)}getClusterLeaves(G){return this._geoJSONIndex.getLeaves(G.clusterId,G.limit,G.offset)}}function $r(xe,G){return G.cluster?new En((function({superclusterOptions:U,clusterProperties:Y}){if(!Y||!U)return U;const fe={},pe={},ke={accumulated:null,zoom:0},ve={properties:null},ge=Object.keys(Y);for(const Me of ge){const[Ge,$e]=Y[Me],nt=v.d3($e),dt=v.d3(typeof Ge=="string"?[Ge,["accumulated"],["get",Me]]:Ge);fe[Me]=nt.value,pe[Me]=dt.value}return U.map=Me=>{ve.properties=Me;const Ge={};for(const $e of ge)Ge[$e]=fe[$e].evaluate(ke,ve);return Ge},U.reduce=(Me,Ge)=>{ve.properties=Ge;for(const $e of ge)ke.accumulated=Me[$e],Me[$e]=pe[$e].evaluate(ke,ve)},U})(G)).load(xe.features):(function(U,Y){return new ya(U,Y)})(xe,G.geojsonVtOptions)}class In{constructor(G){this.self=G,this.actor=new v.L(G),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(U,Y)=>{if(this.externalWorkerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.externalWorkerSourceTypes[U]=Y},this.self.addProtocol=v.cJ,this.self.removeProtocol=v.cK,this.self.registerRTLTextPlugin=U=>{v.d4.setMethods(U)},this.actor.registerMessageHandler("LDT",((U,Y)=>this._getDEMWorkerSource(U,Y.source).loadTile(Y))),this.actor.registerMessageHandler("RDT",((U,Y)=>v._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(U,Y.source).removeTile(Y)})))),this.actor.registerMessageHandler("GCEZ",((U,Y)=>v._(this,void 0,void 0,(function*(){return this._getWorkerSource(U,Y.type,Y.source).getClusterExpansionZoom(Y)})))),this.actor.registerMessageHandler("GCC",((U,Y)=>v._(this,void 0,void 0,(function*(){return this._getWorkerSource(U,Y.type,Y.source).getClusterChildren(Y)})))),this.actor.registerMessageHandler("GCL",((U,Y)=>v._(this,void 0,void 0,(function*(){return this._getWorkerSource(U,Y.type,Y.source).getClusterLeaves(Y)})))),this.actor.registerMessageHandler("LD",((U,Y)=>this._getWorkerSource(U,Y.type,Y.source).loadData(Y))),this.actor.registerMessageHandler("GD",((U,Y)=>this._getWorkerSource(U,Y.type,Y.source).getData())),this.actor.registerMessageHandler("LT",((U,Y)=>this._getWorkerSource(U,Y.type,Y.source).loadTile(Y))),this.actor.registerMessageHandler("RT",((U,Y)=>this._getWorkerSource(U,Y.type,Y.source).reloadTile(Y))),this.actor.registerMessageHandler("AT",((U,Y)=>this._getWorkerSource(U,Y.type,Y.source).abortTile(Y))),this.actor.registerMessageHandler("RMT",((U,Y)=>this._getWorkerSource(U,Y.type,Y.source).removeTile(Y))),this.actor.registerMessageHandler("RS",((U,Y)=>v._(this,void 0,void 0,(function*(){if(!this.workerSources[U]||!this.workerSources[U][Y.type]||!this.workerSources[U][Y.type][Y.source])return;const fe=this.workerSources[U][Y.type][Y.source];delete this.workerSources[U][Y.type][Y.source],fe.removeSource!==void 0&&fe.removeSource(Y)})))),this.actor.registerMessageHandler("RM",(U=>v._(this,void 0,void 0,(function*(){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U],this.globalStates.delete(U)})))),this.actor.registerMessageHandler("SR",((U,Y)=>v._(this,void 0,void 0,(function*(){this.referrer=Y})))),this.actor.registerMessageHandler("SRPS",((U,Y)=>this._syncRTLPluginState(U,Y))),this.actor.registerMessageHandler("IS",((U,Y)=>v._(this,void 0,void 0,(function*(){this.self.importScripts(Y)})))),this.actor.registerMessageHandler("SI",((U,Y)=>this._setImages(U,Y))),this.actor.registerMessageHandler("UL",((U,Y)=>v._(this,void 0,void 0,(function*(){this._getLayerIndex(U).update(Y.layers,Y.removedIds,this._getGlobalState(U))})))),this.actor.registerMessageHandler("UGS",((U,Y)=>v._(this,void 0,void 0,(function*(){const fe=this._getGlobalState(U);for(const pe in Y)fe[pe]=Y[pe]})))),this.actor.registerMessageHandler("SL",((U,Y)=>v._(this,void 0,void 0,(function*(){this._getLayerIndex(U).replace(Y,this._getGlobalState(U))}))))}_getGlobalState(G){let U=this.globalStates.get(G);return U||(U={},this.globalStates.set(G,U)),U}_setImages(G,U){return v._(this,void 0,void 0,(function*(){this.availableImages[G]=U;for(const Y in this.workerSources[G]){const fe=this.workerSources[G][Y];for(const pe in fe)fe[pe].availableImages=U}}))}_syncRTLPluginState(G,U){return v._(this,void 0,void 0,(function*(){return yield v.d4.syncState(U,this.self.importScripts)}))}_getAvailableImages(G){let U=this.availableImages[G];return U||(U=[]),U}_getLayerIndex(G){let U=this.layerIndexes[G];return U||(U=this.layerIndexes[G]=new o),U}_getWorkerSource(G,U,Y){if(this.workerSources[G]||(this.workerSources[G]={}),this.workerSources[G][U]||(this.workerSources[G][U]={}),!this.workerSources[G][U][Y]){const fe={sendAsync:(pe,ke)=>(pe.targetMapId=G,this.actor.sendAsync(pe,ke))};switch(U){case"vector":this.workerSources[G][U][Y]=new le(fe,this._getLayerIndex(G),this._getAvailableImages(G));break;case"geojson":this.workerSources[G][U][Y]=new yr(fe,this._getLayerIndex(G),this._getAvailableImages(G));break;default:this.workerSources[G][U][Y]=new this.externalWorkerSourceTypes[U](fe,this._getLayerIndex(G),this._getAvailableImages(G))}}return this.workerSources[G][U][Y]}_getDEMWorkerSource(G,U){return this.demWorkerSources[G]||(this.demWorkerSources[G]={}),this.demWorkerSources[G][U]||(this.demWorkerSources[G][U]=new it),this.demWorkerSources[G][U]}}return v.i(self)&&(self.worker=new In(self)),In})),T("index",["exports","./shared"],(function(v,o){var I="5.15.0";function R(){var f=new o.A(4);return o.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let q,X,re;const ce={frame(f,t,a){const l=requestAnimationFrame((p=>{d(),t(p)})),{unsubscribe:d}=o.s(f.signal,"abort",(()=>{d(),cancelAnimationFrame(l),a(new o.a(f.signal.reason))}),!1)},frameAsync(f){return new Promise(((t,a)=>{this.frame(f,t,a)}))},getImageData(f,t=0){return this.getImageCanvasContext(f).getImageData(-t,-t,f.width+2*t,f.height+2*t)},getImageCanvasContext(f){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=f.width,t.height=f.height,a.drawImage(f,0,0,f.width,f.height),a},resolveURL:f=>(q||(q=document.createElement("a")),q.href=f,q.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return re!==void 0?re:!!matchMedia&&(X==null&&(X=matchMedia("(prefers-reduced-motion: reduce)")),X.matches)},set prefersReducedMotion(f){re=f}},Ae=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(f){this._frozenAt=f}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function Pe(){return Ae.getCurrentTime()}class le{static testProp(t){if(!le.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in le.docStyle)return t[a];return t[0]}static create(t,a,l){const d=window.document.createElement(t);return a!==void 0&&(d.className=a),l&&l.appendChild(d),d}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){le.docStyle&&le.selectProp&&(le.userSelect=le.docStyle[le.selectProp],le.docStyle[le.selectProp]="none")}static enableDrag(){le.docStyle&&le.selectProp&&(le.docStyle[le.selectProp]=le.userSelect)}static setTransform(t,a){t.style[le.transformProp]=a}static addEventListener(t,a,l,d={}){t.addEventListener(a,l,"passive"in d?d:d.capture)}static removeEventListener(t,a,l,d={}){t.removeEventListener(a,l,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",le.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",le.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",le.suppressClickInternal,!0)}),0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,l){const d=a.boundingClientRect;return new o.P((l.clientX-d.left)/a.x-t.clientLeft,(l.clientY-d.top)/a.y-t.clientTop)}static mousePos(t,a){const l=le.getScale(t);return le.getPoint(t,l,a)}static touchPos(t,a){const l=[],d=le.getScale(t);for(let p=0;p<a.length;p++)l.push(le.getPoint(t,d,a[p]));return l}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const a=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),l=a.querySelectorAll("script");for(const d of l)d.remove();return le.clean(a),a.innerHTML}static isPossiblyDangerous(t,a){const l=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!l.includes("javascript:")&&!l.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const a=t.children;for(const l of a)le.removeAttributes(l),le.clean(l)}static removeAttributes(t){for(const{name:a,value:l}of t.attributes)le.isPossiblyDangerous(a,l)&&t.removeAttribute(a)}}le.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,le.selectProp=le.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),le.transformProp=le.testProp(["transform","WebkitTransform"]);const it={supported:!1,testSupport:function(f){!bt&&He&&(Bt?Di(f):We=f)}};let We,He,bt=!1,Bt=!1;function Di(f){const t=f.createTexture();f.bindTexture(f.TEXTURE_2D,t);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,He),f.isContextLost())return;it.supported=!0}catch{}f.deleteTexture(t),bt=!0}var Ot;typeof document<"u"&&(He=document.createElement("img"),He.onload=()=>{We&&Di(We),We=null,Bt=!0},He.onerror=()=>{bt=!0,We=null},He.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(f){let t,a,l,d;f.resetRequestQueue=()=>{t=[],a=0,l=0,d={}},f.addThrottleControl=S=>{const M=l++;return d[M]=S,M},f.removeThrottleControl=S=>{delete d[S],g()},f.getImage=(S,M,z=!0)=>new Promise(((F,j)=>{it.supported&&(S.headers||(S.headers={}),S.headers.accept="image/webp,*/*"),o.e(S,{type:"image"}),t.push({abortController:M,requestParameters:S,supportImageRefresh:z,state:"queued",onError:V=>{j(V)},onSuccess:V=>{F(V)}}),g()}));const p=S=>o._(this,void 0,void 0,(function*(){S.state="running";const{requestParameters:M,supportImageRefresh:z,onError:F,onSuccess:j,abortController:V}=S,Z=z===!1&&!o.i(self)&&!o.g(M.url)&&(!M.headers||Object.keys(M.headers).reduce(((ee,ae)=>ee&&ae==="accept"),!0));a++;const Q=Z?b(M,V):o.m(M,V);try{const ee=yield Q;delete S.abortController,S.state="completed",ee.data instanceof HTMLImageElement||o.b(ee.data)?j(ee):ee.data&&j({data:yield(te=ee.data,typeof createImageBitmap=="function"?o.f(te):o.h(te)),cacheControl:ee.cacheControl,expires:ee.expires})}catch(ee){delete S.abortController,F(ee)}finally{a--,g()}var te})),g=()=>{const S=(()=>{for(const M of Object.keys(d))if(d[M]())return!0;return!1})()?o.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=a;M<S&&t.length>0;M++){const z=t.shift();z.abortController.signal.aborted?M--:p(z)}},b=(S,M)=>new Promise(((z,F)=>{const j=new Image,V=S.url,Z=S.credentials;Z&&Z==="include"?j.crossOrigin="use-credentials":(Z&&Z==="same-origin"||!o.d(V))&&(j.crossOrigin="anonymous"),M.signal.addEventListener("abort",(()=>{j.src="",F(new o.a(M.signal.reason))})),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,z({data:j})},j.onerror=()=>{j.onerror=j.onload=null,M.signal.aborted||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=V}))})(Ot||(Ot={})),Ot.resetRequestQueue();class Ai{constructor(t){this._transformRequestFn=t??null}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function En(f){const t=[];if(typeof f=="string")t.push({id:"default",url:f});else if(f&&f.length>0){const a=[];for(const{id:l,url:d}of f){const p=`${l}${d}`;a.indexOf(p)===-1&&(a.push(p),t.push({id:l,url:d}))}}return t}function zn(f,t,a){try{const l=new URL(f);return l.pathname+=`${t}${a}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Pi(f){const{userImage:t}=f;return!!(t&&t.render&&t.render())&&(f.data.replace(new Uint8Array(t.data.buffer)),!0)}class yi extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const t of Object.keys(this.images))this.removeImage(t);this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:l}of this.requestors)l(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const l=a.spriteData;a.data=new o.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let l=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new o.k(new Error(`Image "${t}" has invalid "stretchX" value`))),l=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new o.k(new Error(`Image "${t}" has invalid "stretchY" value`))),l=!1),this._validateContent(a.content,a)||(this.fire(new o.k(new Error(`Image "${t}" has invalid "content" value`))),l=!1),l}_validateStretch(t,a){if(!t)return!0;let l=0;for(const d of t){if(d[0]<l||d[1]<d[0]||a<d[1])return!1;l=d[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const l=a.spriteData,d=l&&l.width||a.data.width,p=l&&l.height||a.data.height;return!(t[0]<0||d<t[0]||t[1]<0||p<t[1]||t[2]<0||d<t[2]||t[3]<0||p<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,l=!0){const d=this.getImage(t);if(l&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((a,l)=>{let d=!0;if(!this.isLoaded())for(const p of t)this.images[p]||(d=!1);this.isLoaded()||d?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})}))}_getImagesForIds(t){const a={};for(const l of t){let d=this.getImage(l);d||(this.fire(new o.l("styleimagemissing",{id:l})),d=this.getImage(l)),d?a[l]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:o.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],l=this.getImage(t);if(!l)return null;if(a&&a.position.version===l.version)return a.position;if(a)a.position.version=l.version;else{const d={w:l.data.width+2,h:l.data.height+2,x:0,y:0},p=new o.I(d,l);this.patterns[t]={bin:d,position:p}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const p in this.patterns)t.push(this.patterns[p].bin);const{w:a,h:l}=o.p(t),d=this.atlasImage;d.resize({width:a||1,height:l||1});for(const p in this.patterns){const{bin:g}=this.patterns[p],b=g.x+1,S=g.y+1,M=this.getImage(p).data,z=M.width,F=M.height;o.R.copy(M,d,{x:0,y:0},{x:b,y:S},{width:z,height:F}),o.R.copy(M,d,{x:0,y:F-1},{x:b,y:S-1},{width:z,height:1}),o.R.copy(M,d,{x:0,y:0},{x:b,y:S+F},{width:z,height:1}),o.R.copy(M,d,{x:z-1,y:0},{x:b-1,y:S},{width:1,height:F}),o.R.copy(M,d,{x:0,y:0},{x:b+z,y:S},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const l=this.getImage(a);l||o.w(`Image with ID: "${a}" was not found`),Pi(l)&&this.updateImage(a,l)}}cloneImages(){const t={};for(const a in this.images){const l=this.images[a];t[a]=Object.assign(Object.assign({},l),{data:l.data?l.data.clone():null})}return t}}const Jn=1e20;function bn(f,t,a,l,d,p,g,b,S){for(let M=t;M<t+l;M++)za(f,a*p+M,p,d,g,b,S);for(let M=a;M<a+d;M++)za(f,M*p+t,1,l,g,b,S)}function za(f,t,a,l,d,p,g){p[0]=0,g[0]=-Jn,g[1]=Jn,d[0]=f[t];for(let b=1,S=0,M=0;b<l;b++){d[b]=f[t+b*a];const z=b*b;do{const F=p[S];M=(d[b]-d[F]+z-F*F)/(b-F)/2}while(M<=g[S]&&--S>-1);S++,p[S]=b,g[S]=M,g[S+1]=Jn}for(let b=0,S=0;b<l;b++){for(;g[S+1]<b;)S++;const M=p[S],z=b-M;f[t+b*a]=d[M]+z*z}}const Ji=o.v.layout_symbol["text-font"].default.join(",");class Hi{constructor(t,a,l){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={},this.lang=l}setURL(t){this.url=t}getGlyphs(t){return o._(this,void 0,void 0,(function*(){const a=[];for(const p in t)for(const g of t[p])a.push(this._getAndCacheGlyphsPromise(p,g));const l=yield Promise.all(a),d={};for(const{stack:p,id:g,glyph:b}of l)d[p]||(d[p]={}),d[p][g]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics};return d}))}_getAndCacheGlyphsPromise(t,a){return o._(this,void 0,void 0,(function*(){let l=this.entries[t];l||(l=this.entries[t]={glyphs:{},requests:{},ranges:{}});let d=l.glyphs[a];return d!==void 0?{stack:t,id:a,glyph:d}:!this.url||this._charUsesLocalIdeographFontFamily(a)?(d=l.glyphs[a]=this._drawGlyph(l,t,a),{stack:t,id:a,glyph:d}):yield this._downloadAndCacheRangePromise(t,a)}))}_downloadAndCacheRangePromise(t,a){return o._(this,void 0,void 0,(function*(){const l=this.entries[t],d=Math.floor(a/256);if(l.ranges[d])return{stack:t,id:a,glyph:null};if(!l.requests[d]){const p=Hi.loadGlyphRange(t,d,this.url,this.requestManager);l.requests[d]=p}try{const p=yield l.requests[d];for(const g in p)l.glyphs[+g]=p[+g];return l.ranges[d]=!0,{stack:t,id:a,glyph:p[a]||null}}catch(p){const g=l.glyphs[a]=this._drawGlyph(l,t,a);return this._warnOnMissingGlyphRange(g,d,a,p),{stack:t,id:a,glyph:g}}}))}_warnOnMissingGlyphRange(t,a,l,d){const p=256*a,g=p+255,b=l.toString(16).padStart(4,"0").toUpperCase();o.w(`Unable to load glyph range ${a}, ${p}-${g}. Rendering codepoint U+${b} locally instead. ${d}`)}_charUsesLocalIdeographFontFamily(t){return!!this.localIdeographFontFamily&&o.q(t)}_drawGlyph(t,a,l){const d=a===Ji&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(l),p=d?"ideographTinySDF":"tinySDF";t[p]||(t[p]=this._createTinySDF(d?this.localIdeographFontFamily:a));const g=t[p].draw(String.fromCodePoint(l));return{id:l,bitmap:new o.r({width:g.width||60,height:g.height||60},g.data),metrics:{width:g.glyphWidth/2||24,height:g.glyphHeight/2||24,left:g.glyphLeft/2+.5||0,top:g.glyphTop/2-27.5||-8,advance:g.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(t){const a=t?t.split(","):[];a.push("sans-serif");const l=a.map((d=>/[-\w]+/.test(d)?d:`'${CSS.escape(d)}'`)).join(",");return new Hi.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:this._fontWeight(a[0]),fontStyle:this._fontStyle(a[0]),lang:this.lang})}_fontStyle(t){return/italic/i.test(t)?"italic":/oblique/i.test(t)?"oblique":"normal"}_fontWeight(t){const a={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let l;for(const[d,p]of Object.entries(a))new RegExp(`\\b${d}\\b`,"i").test(t)&&(l=`${p}`);return l}destroy(){for(const t in this.entries){const a=this.entries[t];a.tinySDF&&(a.tinySDF=null),a.ideographTinySDF&&(a.ideographTinySDF=null),a.glyphs={},a.requests={},a.ranges={}}this.entries={}}}Hi.loadGlyphRange=function(f,t,a,l){return o._(this,void 0,void 0,(function*(){const d=256*t,p=d+255,g=l.transformRequest(a.replace("{fontstack}",f).replace("{range}",`${d}-${p}`),"Glyphs"),b=yield o.n(g,new AbortController);if(!b||!b.data)throw new Error(`Could not load glyph range. range: ${t}, ${d}-${p}`);const S={};for(const M of o.o(b.data))S[M.id]=M;return S}))},Hi.TinySDF=class{constructor({fontSize:f=24,buffer:t=3,radius:a=8,cutoff:l=.25,fontFamily:d="sans-serif",fontWeight:p="normal",fontStyle:g="normal",lang:b=null}={}){this.buffer=t,this.cutoff=l,this.radius=a,this.lang=b;const S=this.size=f+4*t,M=this._createCanvas(S),z=this.ctx=M.getContext("2d",{willReadFrequently:!0});z.font=`${g} ${p} ${f}px ${d}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(f){const t=document.createElement("canvas");return t.width=t.height=f,t}draw(f){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l,actualBoundingBoxLeft:d,actualBoundingBoxRight:p}=this.ctx.measureText(f),g=Math.ceil(a),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-d))),S=Math.min(this.size-this.buffer,g+Math.ceil(l)),M=b+2*this.buffer,z=S+2*this.buffer,F=Math.max(M*z,0),j=new Uint8ClampedArray(F),V={data:j,width:M,height:z,glyphWidth:b,glyphHeight:S,glyphTop:g,glyphLeft:0,glyphAdvance:t};if(b===0||S===0)return V;const{ctx:Z,buffer:Q,gridInner:te,gridOuter:ee}=this;this.lang&&(Z.lang=this.lang),Z.clearRect(Q,Q,b,S),Z.fillText(f,Q,Q+g);const ae=Z.getImageData(Q,Q,b,S);ee.fill(Jn,0,F),te.fill(0,0,F);for(let he=0;he<S;he++)for(let ie=0;ie<b;ie++){const ue=ae.data[4*(he*b+ie)+3]/255;if(ue===0)continue;const _e=(he+Q)*M+ie+Q;if(ue===1)ee[_e]=0,te[_e]=Jn;else{const se=.5-ue;ee[_e]=se>0?se*se:0,te[_e]=se<0?se*se:0}}bn(ee,0,0,M,z,M,this.f,this.v,this.z),bn(te,Q,Q,b,S,M,this.f,this.v,this.z);for(let he=0;he<F;he++){const ie=Math.sqrt(ee[he])-Math.sqrt(te[he]);j[he]=Math.round(255-255*(ie/this.radius+this.cutoff))}return V}};class _t{constructor(){this.specification=o.u.light.position}possiblyEvaluate(t,a){return o.F(t.expression.evaluate(a))}interpolate(t,a,l){return{x:o.G.number(t.x,a.x,l),y:o.G.number(t.y,a.y,l),z:o.G.number(t.z,a.z,l)}}}let $t;class pt extends o.E{constructor(t){super(),$t=$t||new o.t({anchor:new o.D(o.u.light.anchor),position:new _t,color:new o.D(o.u.light.color),intensity:new o.D(o.u.light.intensity)}),this._transitionable=new o.x($t,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(o.y,t,a))for(const l in t){const d=t[l];l.endsWith(o.z)?this._transitionable.setTransition(l.slice(0,-o.z.length),d):this._transitionable.setValue(l,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,l){return(!l||l.validate!==!1)&&o.B(this,t.call(o.C,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:o.u}))}}const Ut=new o.t({"sky-color":new o.D(o.u.sky["sky-color"]),"horizon-color":new o.D(o.u.sky["horizon-color"]),"fog-color":new o.D(o.u.sky["fog-color"]),"fog-ground-blend":new o.D(o.u.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.u.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.u.sky["atmosphere-blend"])});class Ri extends o.E{constructor(t){super(),this._transitionable=new o.x(Ut,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0))}setSky(t,a={}){if(!this._validate(o.J,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in t){const d=t[l];l.endsWith(o.z)?this._transitionable.setTransition(l.slice(0,-o.z.length),d):this._transitionable.setValue(l,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,l={}){return l?.validate!==!1&&o.B(this,t.call(o.C,o.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:o.u})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Ni{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const l=t.join(",")+String(a);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(t,a)),this.dashEntry[l]}getDashRanges(t,a,l){const d=[];let p=t.length%2==1?-t[t.length-1]*l:0,g=t[0]*l,b=!0;d.push({left:p,right:g,isDash:b,zeroLength:t[0]===0});let S=t[0];for(let M=1;M<t.length;M++){b=!b;const z=t[M];p=S*l,S+=z,g=S*l,d.push({left:p,right:g,isDash:b,zeroLength:z===0})}return d}addRoundDash(t,a,l){const d=a/2;for(let p=-l;p<=l;p++){const g=this.width*(this.nextRow+l+p);let b=0,S=t[b];for(let M=0;M<this.width;M++){M/S.right>1&&(S=t[++b]);const z=Math.abs(M-S.left),F=Math.abs(M-S.right),j=Math.min(z,F);let V;const Z=p/l*(d+1);if(S.isDash){const Q=d-Math.abs(Z);V=Math.sqrt(j*j+Q*Q)}else V=d-Math.sqrt(j*j+Z*Z);this.data[g+M]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(t){for(let b=t.length-1;b>=0;--b){const S=t[b],M=t[b+1];S.zeroLength?t.splice(b,1):M&&M.isDash===S.isDash&&(M.left=S.left,t.splice(b,1))}const a=t[0],l=t[t.length-1];a.isDash===l.isDash&&(a.left=l.left-this.width,l.right=a.right+this.width);const d=this.width*this.nextRow;let p=0,g=t[p];for(let b=0;b<this.width;b++){b/g.right>1&&(g=t[++p]);const S=Math.abs(b-g.left),M=Math.abs(b-g.right),z=Math.min(S,M);this.data[d+b]=Math.max(0,Math.min(255,(g.isDash?z:-z)+128))}}addDash(t,a){const l=a?7:0,d=2*l+1;if(this.nextRow+d>this.height)return o.w("LineAtlas out of space"),null;let p=0;for(let b=0;b<t.length;b++)p+=t[b];if(p!==0){const b=this.width/p,S=this.getDashRanges(t,this.width,b);a?this.addRoundDash(S,b,l):this.addRegularDash(S)}const g={y:this.nextRow+l,height:2*l,width:p};return this.nextRow+=d,this.dirty=!0,g}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const ei="maplibre_preloaded_worker_pool";class Tt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Tt.workerCount;)this.workers.push(new Worker(o.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[ei]}numActive(){return Object.keys(this.active).length}}const kt=Math.floor(ce.hardwareConcurrency/2);let Wi,mi;function ga(){return Wi||(Wi=new Tt),Wi}Tt.workerCount=o.K(globalThis)?Math.max(Math.min(kt,3),1):1;class dn{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const l=this.workerPool.acquire(a);for(let d=0;d<l.length;d++){const p=new o.L(l[d],a);p.name=`Worker ${d}`,this.actors.push(p)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const l=[];for(const d of this.actors)l.push(d.sendAsync({type:t,data:a}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const l of this.actors)l.registerMessageHandler(t,a)}unregisterMessageHandler(t){for(const a of this.actors)a.unregisterMessageHandler(t)}}function Ia(){return mi||(mi=new dn(ga(),o.M),mi.registerMessageHandler("GR",((f,t,a)=>o.m(t,a)))),mi}function nn(f,t){const a=o.N();return o.O(a,a,[1,1,0]),o.Q(a,a,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?o.S(a,a,f.calculatePosMatrix(t.toUnwrapped())):a}function pr(f,t,a,l,d,p,g){var b;const S=(function(j,V,Z){if(j)for(const Q of j){const te=V[Q];if(te&&te.source===Z&&te.type==="fill-extrusion")return!0}else for(const Q in V){const te=V[Q];if(te.source===Z&&te.type==="fill-extrusion")return!0}return!1})((b=d?.layers)!==null&&b!==void 0?b:null,t,f.id),M=p.maxPitchScaleFactor(),z=f.tilesIn(l,M,S);z.sort(Qi);const F=[];for(const j of z)F.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(t,a,f.getState(),j.queryGeometry,j.cameraQueryGeometry,j.scale,d,p,M,nn(p,j.tileID),g?(V,Z)=>g(j.tileID,V,Z):void 0)});return(function(j,V){for(const Z in j)for(const Q of j[Z])Un(Q,V);return j})((function(j){const V={},Z={};for(const Q of j){const te=Q.queryResults,ee=Q.wrappedTileID,ae=Z[ee]=Z[ee]||{};for(const he in te){const ie=te[he],ue=ae[he]=ae[he]||{},_e=V[he]=V[he]||[];for(const se of ie)ue[se.featureIndex]||(ue[se.featureIndex]=!0,_e.push(se))}}return V})(F),f)}function Qi(f,t){const a=f.tileID,l=t.tileID;return a.overscaledZ-l.overscaledZ||a.canonical.y-l.canonical.y||a.wrap-l.wrap||a.canonical.x-l.canonical.x}function Un(f,t){const a=f.feature,l=t.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=l}function oa(f,t,a){return o._(this,void 0,void 0,(function*(){let l=f;if(f.url?l=(yield o.j(t.transformRequest(f.url,"Source"),a)).data:yield ce.frameAsync(a),!l)return null;const d=o.U(o.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(d.vectorLayerIds=l.vector_layers.map((p=>p.id))),d}))}class hi{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof o.V?new o.V(t.lng,t.lat):o.V.convert(t),this}setSouthWest(t){return this._sw=t instanceof o.V?new o.V(t.lng,t.lat):o.V.convert(t),this}extend(t){const a=this._sw,l=this._ne;let d,p;if(t instanceof o.V)d=t,p=t;else{if(!(t instanceof hi))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(hi.convert(t)):this.extend(o.V.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(o.V.convert(t)):this;if(d=t._sw,p=t._ne,!d||!p)return this}return a||l?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new o.V(d.lng,d.lat),this._ne=new o.V(p.lng,p.lat)),this}getCenter(){return new o.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.V(this.getWest(),this.getNorth())}getSouthEast(){return new o.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:l}=o.V.convert(t);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&d}intersects(t){if(!((t=hi.convert(t)).getNorth()>=this.getSouth()&&t.getSouth()<=this.getNorth()))return!1;const a=Math.abs(this.getEast()-this.getWest()),l=Math.abs(t.getEast()-t.getWest());if(a>=360||l>=360)return!0;const d=o.W(this.getWest(),-180,180),p=o.W(this.getEast(),-180,180),g=o.W(t.getWest(),-180,180),b=o.W(t.getEast(),-180,180),S=d>=p,M=g>=b;return!(!S||!M)||(S?b>=d||g<=p:M?p>=g||d<=b:g<=p&&b>=d)}static convert(t){return t instanceof hi?t:t&&new hi(t)}static fromLngLat(t,a=0){const l=360*a/40075017,d=l/Math.cos(Math.PI/180*t.lat);return new hi(new o.V(t.lng-d,t.lat-l),new o.V(t.lng+d,t.lat+l))}adjustAntiMeridian(){const t=new o.V(this._sw.lng,this._sw.lat),a=new o.V(this._ne.lng,this._ne.lat);return new hi(t,t.lng>a.lng?new o.V(a.lng+360,a.lat):a)}}class sa{constructor(t,a,l){this.bounds=hi.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=l||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),l=Math.floor(o.Y(this.bounds.getWest())*a),d=Math.floor(o.X(this.bounds.getNorth())*a),p=Math.ceil(o.Y(this.bounds.getEast())*a),g=Math.ceil(o.X(this.bounds.getSouth())*a);return t.x>=l&&t.x<p&&t.y>=d&&t.y<g}}class _r extends o.E{constructor(t,a,l,d){if(super(),this.id=t,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.U(a,["url","scheme","tileSize","promoteId","encoding"])),this._options=o.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield oa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),t&&(o.e(this,t),t.bounds&&(this.tileBounds=new sa(t.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,o.Z(t)||this.fire(new o.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(t){return o._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(t)};l.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((p,g)=>{t.reloadPromise={resolve:p,reject:g}}))}else t.actor=this.dispatcher.getActor(),d="LT";t.abortController=new AbortController;try{const p=yield t.actor.sendAsync({type:d,data:l},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,p)}catch(p){if(delete t.abortController,t.aborted)return;if(p&&p.status!==404)throw p;this._afterTileLoadWorkerResponse(t,null)}}))}_getOverzoomParameters(t){if(t.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const a=t.tileID.scaledTo(this.maxzoom).canonical,l=a.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:a,overzoomRequest:this.map._requestManager.transformRequest(l,"Tile")}}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const l=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(l.resolve).catch(l.reject)}}abortTile(t){return o._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return o._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class gr extends o.E{constructor(t,a,l,d){super(),this.id=t,this.dispatcher=l,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},a),o.e(this,o.U(a,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield oa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(o.e(this,a),a.bounds&&(this.tileBounds=new sa(a.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,o.Z(a)||this.fire(new o.k(a))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return o.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return o._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const l=yield Ot.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&t.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const d=this.map.painter.context,p=d.gl,g=l.data;t.texture=this.map.painter.getTileTexture(g.width),t.texture?t.texture.update(g,{useMipmap:!0}):(t.texture=new o.T(d,g,p.RGBA,{useMipmap:!0}),t.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(l){if(delete t.abortController,t.aborted)t.state="unloaded";else if(l)throw t.state="errored",l}}))}abortTile(t){return o._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return o._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class ya extends gr{constructor(t,a,l,d){super(t,a,l,d),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return o._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const d=yield Ot.getImage(l,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){const p=d.data;this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const g=o.b(p)&&o.$()?p:yield this.readImageNow(p),b={type:this.type,uid:t.uid,source:this.id,rawImageData:g,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const S=yield t.actor.sendAsync({type:"LDT",data:b});t.dem=S,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}}))}readImageNow(t){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&o.a0()){const a=t.width+2,l=t.height+2;try{return new o.R({width:a,height:l},yield o.a1(t,-1,-1,a,l))}catch{}}return ce.getImageData(t,1)}))}_getNeighboringTiles(t){const a=t.canonical,l=Math.pow(2,a.z),d=(a.x-1+l)%l,p=a.x===0?t.wrap-1:t.wrap,g=(a.x+1+l)%l,b=a.x+1===l?t.wrap+1:t.wrap,S={};return S[new o.a2(t.overscaledZ,p,a.z,d,a.y).key]={backfilled:!1},S[new o.a2(t.overscaledZ,b,a.z,g,a.y).key]={backfilled:!1},a.y>0&&(S[new o.a2(t.overscaledZ,p,a.z,d,a.y-1).key]={backfilled:!1},S[new o.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},S[new o.a2(t.overscaledZ,b,a.z,g,a.y-1).key]={backfilled:!1}),a.y+1<l&&(S[new o.a2(t.overscaledZ,p,a.z,d,a.y+1).key]={backfilled:!1},S[new o.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},S[new o.a2(t.overscaledZ,b,a.z,g,a.y+1).key]={backfilled:!1}),S}unloadTile(t){return o._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}function Qn(f){return f.type==="GeometryCollection"?f.geometries.map((t=>t.coordinates)).flat(1/0):f.coordinates.flat(1/0)}function yr(f){const t=new hi;let a;switch(f.type){case"FeatureCollection":a=f.features.map((l=>Qn(l.geometry))).flat(1/0);break;case"Feature":a=Qn(f.geometry);break;default:a=Qn(f)}if(a.length==0)return t;for(let l=0;l<a.length-1;l+=2)t.extend([a[l],a[l+1]]);return t}class $r extends o.E{constructor(t,a,l,d){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=l.getActor(),this.setEventedParent(d),this._data=typeof a.data=="string"?{url:a.data}:{geojson:a.data},this._options=o.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:o.a5,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:o.a5,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(t){return t*(o.a5/this.tileSize)}_getClusterMaxZoom(t){const a=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${a}"`),a}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t,a){this._data=typeof t=="string"?{url:t}:{geojson:t},this._pendingWorkerUpdate={data:t};const l=this._updateWorkerData();return a?l:this}updateData(t,a){this._pendingWorkerUpdate.diff=o.a6(this._pendingWorkerUpdate.diff,t);const l=this._updateWorkerData();return a?l:this}getData(){return o._(this,void 0,void 0,(function*(){const t=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getBounds(){return o._(this,void 0,void 0,(function*(){return yr(yield this.getData())}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:l}})}_updateWorkerData(){return o._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void o.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:t,diff:a}=this._pendingWorkerUpdate,l=o.e({type:this.type},this.workerOptions);t!==void 0?(typeof t=="string"?(l.request=this.map._requestManager.transformRequest(ce.resolveURL(t),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=t,this._pendingWorkerUpdate.data=void 0):a&&(l.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:l});if(this._isUpdatingWorker=!1,this._removed||d.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));d.data&&(this._data={geojson:d.data});const p=this._applyDiffToSource(a),g=this._getShouldReloadTileOptions(p);let b=null;d.resourceTiming&&d.resourceTiming[this.id]&&(b=d.resourceTiming[this.id].slice(0));const S={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&o.e(S,{resourceTiming:b}),this.fire(new o.l("data",Object.assign(Object.assign({},S),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},S),{sourceDataType:"content",shouldReloadTileOptions:g})))}catch(d){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(d))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiffToSource(t){if(!t)return;const a=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const d=o.a7(this._data.geojson,a);if(!d)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:d}}if(!this._data.updateable)return;const l=o.a8(this._data.updateable,t,a);return t.removeAll||this._options.cluster?void 0:l}_getShouldReloadTileOptions(t){if(t)return{affectedBounds:t.filter(Boolean).map((a=>yr(a)))}}shouldReloadTile(t,{affectedBounds:a}){if(t.state==="loading")return!0;if(t.state==="unloaded")return!1;const{buffer:l,extent:d}=this.workerOptions.geojsonVtOptions,p=(function({x:g,y:b,z:S},M=0){const z=o.a3((g-M)/Math.pow(2,S)),F=o.a4((b+1+M)/Math.pow(2,S)),j=o.a3((g+1+M)/Math.pow(2,S)),V=o.a4((b-M)/Math.pow(2,S));return new hi([z,F],[j,V])})(t.tileID.canonical,l/d);for(const g of a)if(p.intersects(g))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(t){return o._(this,void 0,void 0,(function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const l={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const d=yield this.actor.sendAsync({type:a,data:l},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(d,this.map.painter,a==="RT")}))}abortTile(t){return o._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return o._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class In extends o.E{constructor(t,a,l,d){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=l,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}load(t){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield Ot.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,o.Z(a)||this.fire(new o.k(a))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(o.a9.fromLngLat);var l;return this.tileID=(function(d){const p=o.aa.fromPoints(d),g=p.width(),b=p.height(),S=Math.max(g,b),M=Math.max(0,Math.floor(-Math.log(S)/Math.LN2)),z=Math.pow(2,M);return new o.ac(M,Math.floor((p.minX+p.maxX)/2*z),Math.floor((p.minY+p.maxY)/2*z))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((d=>this.tileID.getTilePoint(d)._round())),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.texture||(this.texture=new o.T(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const d in this.tiles){const p=this.tiles[d];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:a,minY:l,maxX:d,maxY:p}=o.aa.fromPoints(t),g={};for(let b=0;b<=o.ab;b++){const S=Math.pow(2,b),M=Math.floor(a*S),z=Math.floor(l*S),F=Math.floor(d*S),j=Math.floor(p*S);g[b]={minTileX:M,minTileY:z,maxTileX:F,maxTileY:j}}return g}}class xe extends In{constructor(t,a,l,d){super(t,a,l,d),this.roundZoom=!0,this.type="video",this.options=a}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield o.ad(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new o.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new o.k(new o.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const d in this.tiles){const p=this.tiles[d];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class G extends In{constructor(t,a,l,d){super(t,a,l,d),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((p=>!Array.isArray(p)||p.length!==2||p.some((g=>typeof g!="number"))))||this.fire(new o.k(new o.ae(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.ae(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new o.k(new o.ae(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.ae(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.ae(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,l=a.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new o.T(a,this.canvas,l.RGBA,{premultiply:!0}),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let d=!1;for(const p in this.tiles){const g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,d=!0)}d&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const U={},Y=f=>{switch(f){case"geojson":return $r;case"image":return In;case"raster":return gr;case"raster-dem":return ya;case"vector":return _r;case"video":return xe;case"canvas":return G}return U[f]},fe="RTLPluginLoaded";class pe extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ia()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return o._(this,arguments,void 0,(function*(a,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ce.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(fe))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ke=null;function ve(){return ke||(ke=new pe),ke}var ge,Me;(function(f){f[f.Base=0]="Base",f[f.Parent=1]="Parent"})(ge||(ge={})),(function(f){f[f.Departing=0]="Departing",f[f.Incoming=1]="Incoming"})(Me||(Me={}));class Ge{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=o.af(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:a,fadingParentID:l,fadeEndTime:d}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=a,this.fadingParentID=l,this.fadeEndTime=d}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=Pe(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData,this.latestFeatureIndex.encoding=t.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(d,p){const g={};if(!p)return g;for(const b of d){const S=b.layerIds.map((M=>p.getLayer(M))).filter(Boolean);if(S.length!==0){b.layers=S,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map((M=>S.filter((z=>z.id===M))[0])));for(const M of S)g[M.id]=b}}return g})(t.buckets,a?.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const p=this.buckets[d];if(p instanceof o.ah){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const p=this.buckets[d];if(p instanceof o.ah&&p.hasRTLText){this.hasRTLText=!0,ve().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const p=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(p))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new o.ag}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const l in this.buckets){const d=this.buckets[l];d.uploadPending()&&d.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,l,d,p,g,b,S,M,z,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:p,scale:g,tileSize:this.tileSize,pixelPosMatrix:z,transform:S,params:b,queryPadding:this.queryPadding*M,getElevation:F},t,a,l):{}}querySourceFeatures(t,a){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const d=l.loadVTLayers(),p=a&&a.sourceLayer?a.sourceLayer:"",g=d[o.ai]||d[p];if(!g)return;const b=o.aj(a?.filter,a?.globalState),{z:S,x:M,y:z}=this.tileID.canonical,F={z:S,x:M,y:z};for(let j=0;j<g.length;j++){const V=g.feature(j);if(b.needGeometry){const te=o.ak(V,!0);if(!b.filter(new o.H(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!b.filter(new o.H(this.tileID.overscaledZ),V))continue;const Z=l.getId(V,p),Q=new o.al(V,S,M,z,Z);Q.tile=F,t.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const l=o.am(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let d=!1;if(this.expirationTime>l)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const p=this.expirationTime-a;p?this.expirationTime=l+Math.max(p,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const p=this.buckets[d],g=p.layers[0].sourceLayer||o.ai,b=l[g],S=t[g];if(!b||!S||Object.keys(S).length===0)continue;p.update(S,b,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const M=a&&a.style&&a.style.getLayer(d);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(p)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Pe()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=Pe()+t}setDependencies(t,a){const l={};for(const d of a)l[d]=!0;this.dependencies[t]=l}hasDependency(t,a){for(const l of t){const d=this.dependencies[l];if(d){for(const p of a)if(d[p])return!0}}return!1}}class $e{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,l){const d=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},o.e(this.stateChanges[t][d],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const p in this.state[t])p!==d&&(this.deletedStates[t][p]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const p in this.state[t][d])l[p]||(this.deletedStates[t][d][p]=null)}else for(const p in l)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][p]===null&&delete this.deletedStates[t][d][p]}removeFeatureState(t,a,l){if(this.deletedStates[t]===null)return;const d=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&a!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][l]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(l in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][l]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,a){const l=String(a),d=o.e({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const p=this.deletedStates[t][a];if(p===null)return{};for(const g in p)delete d[g]}return d}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const l={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const p={};for(const g in this.stateChanges[d])this.state[d][g]||(this.state[d][g]={}),o.e(this.state[d][g],this.stateChanges[d][g]),p[g]=this.state[d][g];l[d]=p}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const p={};if(this.deletedStates[d]===null)for(const g in this.state[d])p[g]={},this.state[d][g]={};else for(const g in this.deletedStates[d]){if(this.deletedStates[d][g]===null)this.state[d][g]={};else for(const b of Object.keys(this.deletedStates[d][g]))delete this.state[d][g][b];p[g]=this.state[d][g]}l[d]=l[d]||{},o.e(l[d],p)}this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0&&t.setFeatureState(l,a)}}const nt=89.25;function dt(f,t){const a=o.an(t.lat,-o.ao,o.ao);return new o.P(o.Y(t.lng)*f,o.X(a)*f)}function gt(f,t){return new o.a9(t.x/f,t.y/f).toLngLat()}function Ht(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(o.ap(90-f.pitch)),Math.tan(o.ap(nt-f.pitch)))}function Vt(f,t){const a=f.canonical,l=t/o.aq(a.z),d=a.x+Math.pow(2,a.z)*f.wrap,p=o.ar(new Float64Array(16));return o.O(p,p,[d*l,a.y*l,0]),o.Q(p,p,[l/o.a5,l/o.a5,1]),p}function Se(f,t,a,l,d){const p=o.a9.fromLngLat(f,t),g=d*o.as(1,f.lat),{x:b,y:S,z:M}=ti(a,l);return new o.a9(p.x+g*-b,p.y+g*-S,p.z+g*-M)}function ti(f,t){const a=o.ap(f),l=o.ap(t),d=Math.cos(-a),p=Math.sin(a);return{x:p*Math.sin(l),y:-p*Math.cos(l),z:d}}function an(f,t,a){const l=t.intersectsFrustum(f);if(!a||l===0)return l;const d=t.intersectsPlane(a);return d===0?0:l===2&&d===2?2:1}function yt(f,t,a){let l=0;const d=(a-t)/10;for(let p=0;p<10;p++)l+=d*Math.pow(Math.cos(t+(p+.5)/10*(a-t)),f);return l}function Wt(f,t){return function(a,l,d,p,g){const b=2*((f-1)/o.at(Math.cos(o.ap(nt-g))/Math.cos(o.ap(nt)))-1),S=Math.acos(d/p),M=2*yt(b-1,0,o.ap(g/2)),z=Math.min(o.ap(nt),S+o.ap(g/2)),F=yt(b-1,Math.min(z,S-o.ap(g/2)),z),j=Math.atan(l/d),V=Math.hypot(l,d);let Z=a;return Z+=o.at(p/V/Math.max(.5,Math.cos(o.ap(g/2)))),Z+=b*o.at(Math.cos(j))/2,Z-=o.at(Math.max(1,F/M/t))/2,Z}}const rn=Wt(9.314,3);function ii(f,t){const a=(t.roundZoom?Math.round:Math.floor)(f.zoom+o.at(f.tileSize/t.tileSize));return Math.max(0,a)}function vi(f,t){const a=f.getCameraFrustum(),l=f.getClippingPlane(),d=f.screenPointToMercatorCoordinate(f.getCameraPoint()),p=o.a9.fromLngLat(f.center,f.elevation);d.z=p.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const g=f.getCoveringTilesDetailsProvider(),b=g.allowVariableZoom(f,t),S=ii(f,t),M=t.minzoom||0,z=t.maxzoom!==void 0?t.maxzoom:f.maxZoom,F=Math.min(Math.max(0,S),z),j=Math.pow(2,F),V=[j*d.x,j*d.y,0],Z=[j*p.x,j*p.y,0],Q=Math.hypot(p.x-d.x,p.y-d.y),te=Math.abs(p.z-d.z),ee=Math.hypot(Q,te),ae=ue=>({zoom:0,x:0,y:0,wrap:ue,fullyVisible:!1}),he=[],ie=[];if(f.renderWorldCopies&&g.allowWorldCopies())for(let ue=1;ue<=3;ue++)he.push(ae(-ue)),he.push(ae(ue));for(he.push(ae(0));he.length>0;){const ue=he.pop(),_e=ue.x,se=ue.y;let ye=ue.fullyVisible;const Ie={x:_e,y:se,z:ue.zoom},Te=g.getTileBoundingVolume(Ie,ue.wrap,f.elevation,t);if(!ye){const Xe=an(a,Te,l);if(Xe===0)continue;ye=Xe===2}const Le=g.distanceToTile2d(d.x,d.y,Ie,Te);let Ce=S;b&&(Ce=(t.calculateTileZoom||rn)(f.zoom+o.at(f.tileSize/t.tileSize),Le,te,ee,f.fov)),Ce=(t.roundZoom?Math.round:Math.floor)(Ce),Ce=Math.max(0,Ce);const Ke=Math.min(Ce,z);if(ue.wrap=g.getWrap(p,Ie,ue.wrap),ue.zoom>=Ke){if(ue.zoom<M)continue;const Xe=F-ue.zoom,Ue=V[0]-.5-(_e<<Xe),Je=V[1]-.5-(se<<Xe),wt=t.reparseOverscaled?Math.max(ue.zoom,Ce):ue.zoom;ie.push({tileID:new o.a2(ue.zoom===z?wt:ue.zoom,ue.wrap,ue.zoom,_e,se),distanceSq:o.au([Z[0]-.5-_e,Z[1]-.5-se]),tileDistanceToCamera:Math.sqrt(Ue*Ue+Je*Je)})}else for(let Xe=0;Xe<4;Xe++)he.push({zoom:ue.zoom+1,x:(_e<<1)+Xe%2,y:(se<<1)+(Xe>>1),wrap:ue.wrap,fullyVisible:ye})}return ie.sort(((ue,_e)=>ue.distanceSq-_e.distanceSq)).map((ue=>ue.tileID))}const ni=o.aa.fromPoints([new o.P(0,0),new o.P(o.a5,o.a5)]);function Ui(f){return f==="raster"||f==="image"||f==="video"}function vo(f,t,a,l,d,p,g){if(!t.hasData())return!1;const{tileID:b,fadingRole:S,fadingDirection:M,fadingParentID:z}=t;if(S===ge.Base&&M===Me.Incoming&&z)return a[z.key]=z,!0;const F=Math.max(b.overscaledZ-d,p);for(let j=b.overscaledZ-1;j>=F;j--){const V=b.scaledTo(j),Z=f.getLoadedTile(V);if(Z)return t.setCrossFadeLogic({fadingRole:ge.Base,fadingDirection:Me.Incoming,fadingParentID:Z.tileID,fadeEndTime:l+g}),Z.setCrossFadeLogic({fadingRole:ge.Parent,fadingDirection:Me.Departing,fadeEndTime:l+g}),a[V.key]=V,!0}return!1}function Dn(f,t,a,l,d,p){if(!t.hasData())return!1;const g=t.tileID.children(d);let b=Ee(f,t,g,a,l,d,p);if(b)return!0;for(const S of g)Ee(f,t,S.children(d),a,l,d,p)&&(b=!0);return b}function Ee(f,t,a,l,d,p,g){if(a[0].overscaledZ>=p)return!1;let b=!1;for(const S of a){const M=f.getLoadedTile(S);if(!M)continue;const{fadingRole:z,fadingDirection:F,fadingParentID:j}=M;z===ge.Base&&F===Me.Departing&&j||(M.setCrossFadeLogic({fadingRole:ge.Base,fadingDirection:Me.Departing,fadingParentID:t.tileID,fadeEndTime:d+g}),t.setCrossFadeLogic({fadingRole:ge.Parent,fadingDirection:Me.Incoming,fadeEndTime:d+g})),l[S.key]=S,b=!0}return b}function hn(f,t,a,l){const d=f.tileID;return!!f.selfFading||!f.hasData()&&!!t.has(d)&&(f.setSelfFadeLogic(a+l),!0)}function cn(f,t){var a;f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let l=t.tileID.canonical.x-f.tileID.canonical.x;const d=t.tileID.canonical.y-f.tileID.canonical.y,p=Math.pow(2,f.tileID.canonical.z),g=t.tileID.key;l===0&&d===0||Math.abs(d)>1||(Math.abs(l)>1&&(Math.abs(l+p)===1?l+=p:Math.abs(l-p)===1&&(l-=p)),t.dem&&f.dem&&(f.dem.backfillBorder(t.dem,l,d),!((a=f.neighboringTiles)===null||a===void 0)&&a[g]&&(f.neighboringTiles[g].backfilled=!0)))}class xo{constructor(){this._tiles={}}handleWrapJump(t){const a={};for(const l in this._tiles){const d=this._tiles[l];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+t),a[d.tileID.key]=d}this._tiles=a}setFeatureState(t,a){for(const l in this._tiles)this._tiles[l].setFeatureState(t,a)}getAllTiles(){return Object.values(this._tiles)}getAllIds(t=!1){return t?Object.values(this._tiles).map((a=>a.tileID)).sort(o.aw).map((a=>a.key)):Object.keys(this._tiles)}getTileById(t){return this._tiles[t]}setTile(t,a){this._tiles[t]=a}deleteTileById(t){delete this._tiles[t]}getLoadedTile(t){const a=this.getTileById(t.key);return a?.hasData()?a:null}isIdRenderable(t,a=!1){var l;return(l=this.getTileById(t))===null||l===void 0?void 0:l.isRenderable(a)}getRenderableIds(t=0,a){const l=[];for(const d of this.getAllIds())this.isIdRenderable(d,a)&&l.push(this.getTileById(d));return a?l.sort(((d,p)=>{const g=d.tileID,b=p.tileID,S=new o.P(g.canonical.x,g.canonical.y)._rotate(-t),M=new o.P(b.canonical.x,b.canonical.y)._rotate(-t);return g.overscaledZ-b.overscaledZ||M.y-S.y||M.x-S.x})).map((d=>d.tileID.key)):l.map((d=>d.tileID)).sort(o.aw).map((d=>d.key))}}class Gn extends o.E{constructor(t,a,l){super(),this.id=t,this.dispatcher=l,this.on("data",(d=>this._dataHandler(d))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((d,p,g,b)=>{const S=new(Y(p.type))(d,p,g,b);if(S.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${S.id}`);return S})(t,a,l,this),this._inViewTiles=new xo,this._outOfViewCache=new o.ax(0,(d=>this._unloadTile(d))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new $e,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){for(const a of this._inViewTiles.getAllTiles())a.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t),this._inViewTiles=new xo}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,l){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,l)}catch(d){t.state="errored",d.status!==404?this._source.fire(new o.k(d,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new o.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const a of this._inViewTiles.getAllTiles())a.upload(t),a.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(t){var a;return this._inViewTiles.getRenderableIds((a=this.transform)===null||a===void 0?void 0:a.bearingInRadians,t)}hasRenderableParent(t){const a=t.overscaledZ-1;if(a>=this._source.minzoom){const l=this.getLoadedTile(t.scaledTo(a));if(l)return this._inViewTiles.isIdRenderable(l.tileID.key)}return!1}reload(t,a=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const l of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(l);a&&!this._source.shouldReloadTile(d,a)||(t?this._reloadTile(l,"expired"):d.state!=="errored"&&this._reloadTile(l,"reloading"))}}}_reloadTile(t,a){return o._(this,void 0,void 0,(function*(){const l=this._inViewTiles.getTileById(t);l&&(l.state!=="loading"&&(l.state=a),yield this._loadTile(l,t,a))}))}_tileLoaded(t,a,l){t.timeAdded=Pe(),t.selfFading&&(t.fadeEndTime=t.timeAdded+this._rasterFadeDuration),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&(function(d,p){var g,b;const S=p.getRenderableIds();for(const M of S){if(!d.neighboringTiles||!d.neighboringTiles[M])continue;const z=p.getTileById(M);d.neighboringTiles[M].backfilled||cn(d,z),!((b=(g=z.neighboringTiles)===null||g===void 0?void 0:g[d.tileID.key])===null||b===void 0)&&b.backfilled||cn(z,d)}})(t,this._inViewTiles),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:t,coord:t.tileID}))}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._inViewTiles.getTileById(t)}_retainLoadedChildren(t,a){const l=this._getLoadedDescendents(a),d=new Set;for(const p of a){const g=l[p.key];if(!g?.length){d.add(p);continue}const b=p.overscaledZ+Gn.maxOverzooming,S=g.filter((F=>F.tileID.overscaledZ<=b));if(!S.length){d.add(p);continue}const M=Math.min(...S.map((F=>F.tileID.overscaledZ))),z=S.filter((F=>F.tileID.overscaledZ===M)).map((F=>F.tileID));for(const F of z)t[F.key]=F;this._areDescendentsComplete(z,M,p.overscaledZ)||d.add(p)}return d}_getLoadedDescendents(t){var a;const l={};for(const d of this._inViewTiles.getAllTiles().filter((p=>p.hasData())))for(const p of t)d.tileID.isChildOf(p)&&(l[a=p.key]||(l[a]=[])).push(d);return l}_areDescendentsComplete(t,a,l){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===a:Math.pow(4,a-l)===t.length}getLoadedTile(t){return this._inViewTiles.getLoadedTile(t)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,l=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(a*l*(this._maxTileCacheZoomLevels===null?o.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._outOfViewCache.setMaxSize(p)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);this._prevLng=t,a&&(this._inViewTiles.handleWrapJump(a),this._resetTileReloadTimers())}update(t,a){if(!this._sourceLoaded||this._paused)return;let l;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?l=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((S=>new o.a2(S.canonical.z,S.wrap,S.canonical.z,S.canonical.x,S.canonical.y))):(l=vi(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?t.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter((S=>this._source.hasTile(S))))):l=[],this.usedForTerrain&&(l=this._addTerrainIdealTiles(l));const d=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,d&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const p=ii(t,this._source),g=this._updateRetainedTiles(l,p),b=Ui(this._source.type);b&&this._rasterFadeDuration>0&&!a&&(function(S,M,z,F,j,V,Z){const Q=Pe(),te=o.av(M);for(const ee of M){const ae=S.getTileById(ee.key);ae.fadingDirection!==Me.Departing&&ae.fadeOpacity!==0||ae.resetFadeLogic(),vo(S,ae,z,Q,F,j,Z)||Dn(S,ae,z,Q,V,Z)||hn(ae,te,Q,Z)||ae.resetFadeLogic()}})(this._inViewTiles,l,g,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),b?this._cleanUpRasterTiles(g):this._cleanUpVectorTiles(g)}_cleanUpRasterTiles(t){for(const a of this._inViewTiles.getAllIds())t[a]||this._removeTile(a)}_cleanUpVectorTiles(t){for(const a of this._inViewTiles.getAllIds()){const l=this._inViewTiles.getTileById(a);t[a]?l.clearSymbolFadeHold():l.hasSymbolBuckets?l.holdingForSymbolFade()?l.symbolFadeFinished()&&this._removeTile(a):l.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(a)}}_addTerrainIdealTiles(t){const a=[];for(const l of t)if(l.canonical.z>this._source.minzoom){const d=l.scaledTo(l.canonical.z-1);a.push(d);const p=l.scaledTo(Math.max(this._source.minzoom,Math.min(l.canonical.z,5)));a.push(p)}return t.concat(a)}releaseSymbolFadeTiles(){for(const t of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(t).holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var l;const d=new Set;for(const M of t)this._addTile(M).hasData()||d.add(M);const p=t.reduce(((M,z)=>(M[z.key]=z,M)),{}),g=this._retainLoadedChildren(p,d),b={},S=Math.max(a-Gn.maxUnderzooming,this._source.minzoom);for(const M of g){let z=this._inViewTiles.getTileById(M.key),F=z?.wasRequested();for(let j=M.overscaledZ-1;j>=S;--j){const V=M.scaledTo(j);if(b[V.key])break;if(b[V.key]=!0,z=this.getTile(V),!z&&F&&(z=this._addTile(V)),z){const Z=z.hasData();if((Z||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||F)&&(p[V.key]=V),F=z.wasRequested(),Z)break}}}return p}_addTile(t){let a=this._inViewTiles.getTileById(t.key);if(a)return a;a=this._outOfViewCache.getAndRemove(t),a&&(a.resetFadeLogic(),this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null));const l=a;return a||(a=new Ge(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._inViewTiles.setTile(t.key,a),l||this._source.fire(new o.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){this._clearTileReloadTimer(t);const l=a.getExpiryTimeout();l&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),l))}_clearTileReloadTimer(t){const a=this._timers[t];a&&(clearTimeout(a),delete this._timers[t])}_resetTileReloadTimers(){for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t of this._inViewTiles.getAllIds()){const a=this._inViewTiles.getTileById(t);this._setTileReloadTimer(t,a)}}refreshTiles(t){for(const a of this._inViewTiles.getAllIds()){const l=this._inViewTiles.getTileById(a);(this._inViewTiles.isIdRenderable(a)||l.state=="errored")&&t.some((d=>d.equals(l.tileID.canonical)))&&this._reloadTile(a,"expired")}}_removeTile(t){const a=this._inViewTiles.getTileById(t);a&&(a.uses--,this._inViewTiles.deleteTileById(t),this._clearTileReloadTimer(t),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._outOfViewCache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged,t.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t of this._inViewTiles.getAllIds())this._removeTile(t);this._outOfViewCache.reset()}tilesIn(t,a,l){const d=[],p=this.transform;if(!p)return d;const g=p.getCoveringTilesDetailsProvider().allowWorldCopies(),b=l?p.getCameraQueryGeometry(t):t,S=V=>p.screenPointToMercatorCoordinate(V,this.terrain),M=this.transformBbox(t,S,!g),z=this.transformBbox(b,S,!g),F=this.getIds(),j=o.aa.fromPoints(z);for(let V=0;V<F.length;V++){const Z=this._inViewTiles.getTileById(F[V]);if(Z.holdingForSymbolFade())continue;const Q=g?[Z.tileID]:[Z.tileID.unwrapTo(-1),Z.tileID.unwrapTo(0)],te=Math.pow(2,p.zoom-Z.tileID.overscaledZ),ee=a*Z.queryPadding*o.a5/Z.tileSize/te;for(const ae of Q){const he=j.map((ie=>ae.getTilePoint(new o.a9(ie.x,ie.y))));if(he.expandBy(ee),he.intersects(ni)){const ie=M.map((_e=>ae.getTilePoint(_e))),ue=z.map((_e=>ae.getTilePoint(_e)));d.push({tile:Z,tileID:g?ae:ae.unwrapTo(0),queryGeometry:ie,cameraQueryGeometry:ue,scale:te})}}}return d}transformBbox(t,a,l){let d=t.map(a);if(l){const p=o.aa.fromPoints(t);p.shrinkBy(.001*Math.min(p.width(),p.height()));const g=p.map(a);o.aa.fromPoints(d).covers(g)||(d=d.map((b=>b.x>.5?new o.a9(b.x-1,b.y,b.z):b)))}return d}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map((l=>this._inViewTiles.getTileById(l).tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){return!!this._source.hasTransition()||!(!Ui(this._source.type)||!(function(t,a){if(a<=0)return!1;const l=Pe();for(const d of t.getAllTiles())if(d.fadeEndTime>=l)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,a,l){this._state.updateState(t=t||o.ai,a,l)}removeFeatureState(t,a,l){this._state.removeFeatureState(t=t||o.ai,a,l)}getFeatureState(t,a){return this._state.getState(t=t||o.ai,a)}setDependencies(t,a,l){const d=this._inViewTiles.getTileById(t);d&&d.setDependencies(a,l)}reloadTilesForDependencies(t,a){for(const l of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(l).hasDependency(t,a)&&this._reloadTile(l,"reloading");this._outOfViewCache.filter((l=>!l.hasDependency(t,a)))}areTilesLoaded(){for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}}Gn.maxUnderzooming=10,Gn.maxOverzooming=3;class Qe{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=o.an(t,0,1);let a=1,l=this._distances[a];const d=t*this.paddedLength+this.padding;for(;l<d&&a<this._distances.length;)l=this._distances[++a];const p=a-1,g=this._distances[p],b=l-g,S=b>0?(d-g)/b:0;return this.points[p].mult(1-S).add(this.points[a].mult(S))}}function Mt(f,t){let a=!0;return f==="always"||f!=="never"&&t!=="never"||(a=!1),a}class xt{constructor(t,a,l){const d=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(t/l),this.yCellCount=Math.ceil(a/l);for(let g=0;g<this.xCellCount*this.yCellCount;g++)d.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,l,d,p){this._forEachCell(a,l,d,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(p)}insertCircle(t,a,l,d){this._forEachCell(a-d,l-d,a+d,l+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(l),this.circles.push(d)}_insertBoxCell(t,a,l,d,p,g){this.boxCells[p].push(g)}_insertCircleCell(t,a,l,d,p,g){this.circleCells[p].push(g)}_query(t,a,l,d,p,g,b){if(l<0||t>this.width||d<0||a>this.height)return[];const S=[];if(t<=0&&a<=0&&this.width<=l&&this.height<=d){if(p)return[{key:null,x1:t,y1:a,x2:l,y2:d}];for(let M=0;M<this.boxKeys.length;M++)S.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const z=this.circles[3*M],F=this.circles[3*M+1],j=this.circles[3*M+2];S.push({key:this.circleKeys[M],x1:z-j,y1:F-j,x2:z+j,y2:F+j})}}else this._forEachCell(t,a,l,d,this._queryCell,S,{hitTest:p,overlapMode:g,seenUids:{box:{},circle:{}}},b);return S}query(t,a,l,d){return this._query(t,a,l,d,!1,null)}hitTest(t,a,l,d,p,g){return this._query(t,a,l,d,!0,p,g).length>0}hitTestCircle(t,a,l,d,p){const g=t-l,b=t+l,S=a-l,M=a+l;if(b<0||g>this.width||M<0||S>this.height)return!1;const z=[];return this._forEachCell(g,S,b,M,this._queryCellCircle,z,{hitTest:!0,overlapMode:d,circle:{x:t,y:a,radius:l},seenUids:{box:{},circle:{}}},p),z.length>0}_queryCell(t,a,l,d,p,g,b,S){const{seenUids:M,hitTest:z,overlapMode:F}=b,j=this.boxCells[p];if(j!==null){const Z=this.bboxes;for(const Q of j)if(!M.box[Q]){M.box[Q]=!0;const te=4*Q,ee=this.boxKeys[Q];if(t<=Z[te+2]&&a<=Z[te+3]&&l>=Z[te+0]&&d>=Z[te+1]&&(!S||S(ee))&&(!z||!Mt(F,ee.overlapMode))&&(g.push({key:ee,x1:Z[te],y1:Z[te+1],x2:Z[te+2],y2:Z[te+3]}),z))return!0}}const V=this.circleCells[p];if(V!==null){const Z=this.circles;for(const Q of V)if(!M.circle[Q]){M.circle[Q]=!0;const te=3*Q,ee=this.circleKeys[Q];if(this._circleAndRectCollide(Z[te],Z[te+1],Z[te+2],t,a,l,d)&&(!S||S(ee))&&(!z||!Mt(F,ee.overlapMode))){const ae=Z[te],he=Z[te+1],ie=Z[te+2];if(g.push({key:ee,x1:ae-ie,y1:he-ie,x2:ae+ie,y2:he+ie}),z)return!0}}}return!1}_queryCellCircle(t,a,l,d,p,g,b,S){const{circle:M,seenUids:z,overlapMode:F}=b,j=this.boxCells[p];if(j!==null){const Z=this.bboxes;for(const Q of j)if(!z.box[Q]){z.box[Q]=!0;const te=4*Q,ee=this.boxKeys[Q];if(this._circleAndRectCollide(M.x,M.y,M.radius,Z[te+0],Z[te+1],Z[te+2],Z[te+3])&&(!S||S(ee))&&!Mt(F,ee.overlapMode))return g.push(!0),!0}}const V=this.circleCells[p];if(V!==null){const Z=this.circles;for(const Q of V)if(!z.circle[Q]){z.circle[Q]=!0;const te=3*Q,ee=this.circleKeys[Q];if(this._circlesCollide(Z[te],Z[te+1],Z[te+2],M.x,M.y,M.radius)&&(!S||S(ee))&&!Mt(F,ee.overlapMode))return g.push(!0),!0}}}_forEachCell(t,a,l,d,p,g,b,S){const M=this._convertToXCellCoord(t),z=this._convertToYCellCoord(a),F=this._convertToXCellCoord(l),j=this._convertToYCellCoord(d);for(let V=M;V<=F;V++)for(let Z=z;Z<=j;Z++)if(p.call(this,t,a,l,d,this.xCellCount*Z+V,g,b,S))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,l,d,p,g){const b=d-t,S=p-a,M=l+g;return M*M>b*b+S*S}_circleAndRectCollide(t,a,l,d,p,g,b){const S=(g-d)/2,M=Math.abs(t-(d+S));if(M>S+l)return!1;const z=(b-p)/2,F=Math.abs(a-(p+z));if(F>z+l)return!1;if(M<=S||F<=z)return!0;const j=M-S,V=F-z;return j*j+V*V<=l*l}}function An(f,t,a){const l=o.N();if(!f){const{vecSouth:F,vecEast:j}=Da(t),V=R();V[0]=j[0],V[1]=j[1],V[2]=F[0],V[3]=F[1],d=V,(z=(g=(p=V)[0])*(M=p[3])-(S=p[2])*(b=p[1]))&&(d[0]=M*(z=1/z),d[1]=-b*z,d[2]=-S*z,d[3]=g*z),l[0]=V[0],l[1]=V[1],l[4]=V[2],l[5]=V[3]}var d,p,g,b,S,M,z;return o.Q(l,l,[1/a,1/a,1]),l}function Wo(f,t,a,l){if(f){const d=o.N();if(!t){const{vecSouth:p,vecEast:g}=Da(a);d[0]=g[0],d[1]=g[1],d[4]=p[0],d[5]=p[1]}return o.Q(d,d,[l,l,1]),d}return a.pixelsToClipSpaceMatrix}function Da(f){const t=Math.cos(f.rollInRadians),a=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),d=Math.cos(f.bearingInRadians),p=Math.sin(f.bearingInRadians),g=o.aC();g[0]=-d*l*a-p*t,g[1]=-p*l*a+d*t;const b=o.aD(g);b<1e-9?o.aE(g):o.aF(g,g,1/b);const S=o.aC();S[0]=d*l*t-p*a,S[1]=p*l*t+d*a;const M=o.aD(S);return M<1e-9?o.aE(S):o.aF(S,S,1/M),{vecEast:S,vecSouth:g}}function Pt(f,t,a,l){let d;l?(d=[f,t,l(f,t),1],o.aH(d,d,a)):(d=[f,t,0,1],vr(d,d,a));const p=d[3];return{point:new o.P(d[0]/p,d[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function wo(f,t){return .5+f/t*.5}function Vr(f,t){return f.x>=-t[0]&&f.x<=t[0]&&f.y>=-t[1]&&f.y<=t[1]}function Ko(f,t,a,l,d,p,g,b,S,M,z,F,j){const V=a?f.textSizeData:f.iconSizeData,Z=o.ay(V,t.transform.zoom),Q=[256/t.width*2+1,256/t.height*2+1],te=a?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;te.clear();const ee=f.lineVertexArray,ae=a?f.text.placedSymbolArray:f.icon.placedSymbolArray,he=t.transform.width/t.transform.height;let ie=!1;for(let ue=0;ue<ae.length;ue++){const _e=ae.get(ue);if(_e.hidden||_e.writingMode===o.az.vertical&&!ie){Yt(_e.numGlyphs,te);continue}ie=!1;const se=new o.P(_e.anchorX,_e.anchorY),ye={getElevation:j,pitchedLabelPlaneMatrix:l,lineVertexArray:ee,pitchWithMap:p,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:se,unwrappedTileID:S,width:M,height:z,translation:F},Ie=va(_e.anchorX,_e.anchorY,ye);if(!Vr(Ie.point,Q)){Yt(_e.numGlyphs,te);continue}const Te=wo(t.transform.cameraToCenterDistance,Ie.signedDistanceFromCamera),Le=o.aA(V,Z,_e),Ce=p?Le*t.transform.getPitchedTextCorrection(_e.anchorX,_e.anchorY,S)/Te:Le*Te,Ke=Nr({projectionContext:ye,pitchedLabelPlaneMatrixInverse:d,symbol:_e,fontSize:Ce,flip:!1,keepUpright:g,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:te,aspectRatio:he,rotateToLine:b});ie=Ke.useVertical,(Ke.notEnoughRoom||ie||Ke.needsFlipping&&Nr({projectionContext:ye,pitchedLabelPlaneMatrixInverse:d,symbol:_e,fontSize:Ce,flip:!0,keepUpright:g,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:te,aspectRatio:he,rotateToLine:b}).notEnoughRoom)&&Yt(_e.numGlyphs,te)}a?f.text.dynamicLayoutVertexBuffer.updateData(te):f.icon.dynamicLayoutVertexBuffer.updateData(te)}function Aa(f,t,a,l,d,p,g,b){const S=p.glyphStartIndex+p.numGlyphs,M=p.lineStartIndex,z=p.lineStartIndex+p.lineLength,F=t.getoffsetX(p.glyphStartIndex),j=t.getoffsetX(S-1),V=Sn(f*F,a,l,d,p.segment,M,z,b,g);if(!V)return null;const Z=Sn(f*j,a,l,d,p.segment,M,z,b,g);return Z?b.projectionCache.anyProjectionOccluded?null:{first:V,last:Z}:null}function bo(f,t,a,l){return f===o.az.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*l?{useVertical:!0}:(f===o.az.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function Nr(f){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:a,symbol:l,fontSize:d,flip:p,keepUpright:g,glyphOffsetArray:b,dynamicLayoutVertexArray:S,aspectRatio:M,rotateToLine:z}=f,F=d/24,j=l.lineOffsetX*F,V=l.lineOffsetY*F;let Z;if(l.numGlyphs>1){const Q=l.glyphStartIndex+l.numGlyphs,te=l.lineStartIndex,ee=l.lineStartIndex+l.lineLength,ae=Aa(F,b,j,V,p,l,z,t);if(!ae)return{notEnoughRoom:!0};const he=Ur(ae.first.point.x,ae.first.point.y,t,a),ie=Ur(ae.last.point.x,ae.last.point.y,t,a);if(g&&!p){const ue=bo(l.writingMode,he,ie,M);if(ue)return ue}Z=[ae.first];for(let ue=l.glyphStartIndex+1;ue<Q-1;ue++){const _e=Sn(F*b.getoffsetX(ue),j,V,p,l.segment,te,ee,t,z);if(!_e)return{notEnoughRoom:!0};Z.push(_e)}Z.push(ae.last)}else{if(g&&!p){const te=Kt(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ee=l.lineStartIndex+l.segment+1,ae=new o.P(t.lineVertexArray.getx(ee),t.lineVertexArray.gety(ee)),he=Kt(ae.x,ae.y,t),ie=he.signedDistanceFromCamera>0?he.point:ko(t.tileAnchorPoint,ae,te,1,t),ue=Ur(te.x,te.y,t,a),_e=Ur(ie.x,ie.y,t,a),se=bo(l.writingMode,ue,_e,M);if(se)return se}const Q=Sn(F*b.getoffsetX(l.glyphStartIndex),j,V,p,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,t,z);if(!Q||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Z=[Q]}for(const Q of Z)o.aG(S,Q.point,Q.angle);return{}}function ko(f,t,a,l,d){const p=f.add(f.sub(t)._unit()),g=Kt(p.x,p.y,d).point,b=a.sub(g);return a.add(b._mult(l/b.mag()))}function kn(f,t,a){const l=t.projectionCache;if(l.projections[f])return l.projections[f];const d=new o.P(t.lineVertexArray.getx(f),t.lineVertexArray.gety(f)),p=Kt(d.x,d.y,t);if(p.signedDistanceFromCamera>0)return l.projections[f]=p.point,l.anyProjectionOccluded=l.anyProjectionOccluded||p.isOccluded,p.point;const g=f-a.direction;return ko(a.distanceFromAnchor===0?t.tileAnchorPoint:new o.P(t.lineVertexArray.getx(g),t.lineVertexArray.gety(g)),d,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function Kt(f,t,a){const l=f+a.translation[0],d=t+a.translation[1];let p;return a.pitchWithMap?(p=Pt(l,d,a.pitchedLabelPlaneMatrix,a.getElevation),p.isOccluded=!1):(p=a.transform.projectTileCoordinates(l,d,a.unwrappedTileID,a.getElevation),p.point.x=(.5*p.point.x+.5)*a.width,p.point.y=(.5*-p.point.y+.5)*a.height),p}function Ur(f,t,a,l){if(a.pitchWithMap){const d=[f,t,0,1];return o.aH(d,d,l),a.transform.projectTileCoordinates(d[0]/d[3],d[1]/d[3],a.unwrappedTileID,a.getElevation).point}return{x:f/a.width*2-1,y:1-t/a.height*2}}function va(f,t,a){return a.transform.projectTileCoordinates(f,t,a.unwrappedTileID,a.getElevation)}function Gr(f,t,a){return f._unit()._perp()._mult(t*a)}function tr(f,t,a,l,d,p,g,b,S){if(b.projectionCache.offsets[f])return b.projectionCache.offsets[f];const M=a.add(t);if(f+S.direction<l||f+S.direction>=d)return b.projectionCache.offsets[f]=M,M;const z=kn(f+S.direction,b,S),F=Gr(z.sub(a),g,S.direction),j=a.add(F),V=z.add(F);return b.projectionCache.offsets[f]=o.aI(p,M,j,V)||M,b.projectionCache.offsets[f]}function Sn(f,t,a,l,d,p,g,b,S){const M=l?f-t:f+t;let z=M>0?1:-1,F=0;l&&(z*=-1,F=Math.PI),z<0&&(F+=Math.PI);let j,V=z>0?p+d:p+d+1;b.projectionCache.cachedAnchorPoint?j=b.projectionCache.cachedAnchorPoint:(j=Kt(b.tileAnchorPoint.x,b.tileAnchorPoint.y,b).point,b.projectionCache.cachedAnchorPoint=j);let Z,Q,te=j,ee=j,ae=0,he=0;const ie=Math.abs(M),ue=[];let _e;for(;ae+he<=ie;){if(V+=z,V<p||V>=g)return null;ae+=he,ee=te,Q=Z;const Ie={absOffsetX:ie,direction:z,distanceFromAnchor:ae,previousVertex:ee};if(te=kn(V,b,Ie),a===0)ue.push(ee),_e=te.sub(ee);else{let Te;const Le=te.sub(ee);Te=Le.mag()===0?Gr(kn(V+z,b,Ie).sub(te),a,z):Gr(Le,a,z),Q||(Q=ee.add(Te)),Z=tr(V,Te,te,p,g,Q,a,b,Ie),ue.push(Q),_e=Z.sub(Q)}he=_e.mag()}const se=_e._mult((ie-ae)/he)._add(Q||ee),ye=F+Math.atan2(te.y-ee.y,te.x-ee.x);return ue.push(se),{point:se,angle:S?ye:0,path:ue}}const Gt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Yt(f,t){for(let a=0;a<f;a++){const l=t.length;t.resize(l+4),t.float32.set(Gt,3*l)}}function vr(f,t,a){const l=t[0],d=t[1];return f[0]=a[0]*l+a[4]*d+a[12],f[1]=a[1]*l+a[5]*d+a[13],f[3]=a[3]*l+a[7]*d+a[15],f}const ai=100;class xr{constructor(t,a=new xt(t.width+200,t.height+200,25),l=new xt(t.width+200,t.height+200,25)){this.transform=t,this.grid=a,this.ignoredGrid=l,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ai,this.screenBottomBoundary=t.height+ai,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,l,d,p,g,b,S,M,z,F,j){const V=this.projectAndGetPerspectiveRatio(t.anchorPointX+S[0],t.anchorPointY+S[1],p,z,j),Z=l*V.perspectiveRatio;let Q;if(g||b)Q=this._projectCollisionBox(t,Z,d,p,g,b,S,V,z,F,j);else{const _e=V.x+(F?F.x*Z:0),se=V.y+(F?F.y*Z:0);Q={allPointsOccluded:!1,box:[_e+t.x1*Z,se+t.y1*Z,_e+t.x2*Z,se+t.y2*Z]}}const[te,ee,ae,he]=Q.box,ie=g?Q.allPointsOccluded:V.isOccluded;let ue=ie;return ue||(ue=V.perspectiveRatio<this.perspectiveRatioCutoff),ue||(ue=!this.isInsideGrid(te,ee,ae,he)),ue||a!=="always"&&this.grid.hitTest(te,ee,ae,he,a,M)?{box:[te,ee,ae,he],placeable:!1,offscreen:!1,occluded:ie}:{box:[te,ee,ae,he],placeable:!0,offscreen:this.isOffscreen(te,ee,ae,he),occluded:ie}}placeCollisionCircles(t,a,l,d,p,g,b,S,M,z,F,j,V,Z){const Q=[],te=new o.P(a.anchorX,a.anchorY),ee=this.getPerspectiveRatio(te.x,te.y,g,Z),ae=(M?p*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,g)/ee:p*ee)/o.aM,he={getElevation:Z,pitchedLabelPlaneMatrix:b,lineVertexArray:l,pitchWithMap:M,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:te,unwrappedTileID:g,width:this.transform.width,height:this.transform.height,translation:V},ie=Aa(ae,d,a.lineOffsetX*ae,a.lineOffsetY*ae,!1,a,!1,he);let ue=!1,_e=!1,se=!0;if(ie){const ye=.5*F*ee+j,Ie=new o.P(-100,-100),Te=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Le=new Qe,Ce=ie.first,Ke=ie.last;let Xe=[];for(let wt=Ce.path.length-1;wt>=1;wt--)Xe.push(Ce.path[wt]);for(let wt=1;wt<Ke.path.length;wt++)Xe.push(Ke.path[wt]);const Ue=2.5*ye;if(M){const wt=this.projectPathToScreenSpace(Xe,he);Xe=wt.some((Qt=>Qt.signedDistanceFromCamera<=0))?[]:wt.map((Qt=>Qt.point))}let Je=[];if(Xe.length>0){const wt=Xe[0].clone(),Qt=Xe[0].clone();for(let _i=1;_i<Xe.length;_i++)wt.x=Math.min(wt.x,Xe[_i].x),wt.y=Math.min(wt.y,Xe[_i].y),Qt.x=Math.max(Qt.x,Xe[_i].x),Qt.y=Math.max(Qt.y,Xe[_i].y);Je=wt.x>=Ie.x&&Qt.x<=Te.x&&wt.y>=Ie.y&&Qt.y<=Te.y?[Xe]:Qt.x<Ie.x||wt.x>Te.x||Qt.y<Ie.y||wt.y>Te.y?[]:o.aJ([Xe],Ie.x,Ie.y,Te.x,Te.y)}for(const wt of Je){Le.reset(wt,.25*ye);let Qt=0;Qt=Le.length<=.5*ye?1:Math.ceil(Le.paddedLength/Ue)+1;for(let _i=0;_i<Qt;_i++){const li=_i/Math.max(Qt-1,1),bi=Le.lerp(li),ui=bi.x+ai,Oi=bi.y+ai;Q.push(ui,Oi,ye,0);const ki=ui-ye,_n=Oi-ye,Xi=ui+ye,qi=Oi+ye;if(se=se&&this.isOffscreen(ki,_n,Xi,qi),_e=_e||this.isInsideGrid(ki,_n,Xi,qi),t!=="always"&&this.grid.hitTestCircle(ui,Oi,ye,t,z)&&(ue=!0,!S))return{circles:[],offscreen:!1,collisionDetected:ue}}}}return{circles:!S&&ue||!_e||ee<this.perspectiveRatioCutoff?[]:Q,offscreen:se,collisionDetected:ue}}projectPathToScreenSpace(t,a){const l=(function(d,p){const g=o.N();return o.aB(g,p.pitchedLabelPlaneMatrix),d.map((b=>{const S=Pt(b.x,b.y,g,p.getElevation),M=p.transform.projectTileCoordinates(S.point.x,S.point.y,p.unwrappedTileID,p.getElevation);return M.point.x=(.5*M.point.x+.5)*p.width,M.point.y=(.5*-M.point.y+.5)*p.height,M}))})(t,a);return(function(d){let p=0,g=0,b=0,S=0;for(let M=0;M<d.length;M++)d[M].isOccluded?(b=M+1,S=0):(S++,S>g&&(g=S,p=b));return d.slice(p,p+g)})(l)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],l=new o.aa;for(const F of t){const j=new o.P(F.x+ai,F.y+ai);l.extend(j),a.push(j)}const{minX:d,minY:p,maxX:g,maxY:b}=l,S=this.grid.query(d,p,g,b).concat(this.ignoredGrid.query(d,p,g,b)),M={},z={};for(const F of S){const j=F.key;if(M[j.bucketInstanceId]===void 0&&(M[j.bucketInstanceId]={}),M[j.bucketInstanceId][j.featureIndex])continue;const V=[new o.P(F.x1,F.y1),new o.P(F.x2,F.y1),new o.P(F.x2,F.y2),new o.P(F.x1,F.y2)];o.aK(a,V)&&(M[j.bucketInstanceId][j.featureIndex]=!0,z[j.bucketInstanceId]===void 0&&(z[j.bucketInstanceId]=[]),z[j.bucketInstanceId].push(j.featureIndex))}return z}insertCollisionBox(t,a,l,d,p,g){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:p,collisionGroupID:g,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,l,d,p,g){const b=l?this.ignoredGrid:this.grid,S={bucketInstanceId:d,featureIndex:p,collisionGroupID:g,overlapMode:a};for(let M=0;M<t.length;M+=4)b.insertCircle(S,t[M],t[M+1],t[M+2])}projectAndGetPerspectiveRatio(t,a,l,d,p){if(p){let g;d?(g=[t,a,d(t,a),1],o.aH(g,g,p)):(g=[t,a,0,1],vr(g,g,p));const b=g[3];return{x:(g[0]/b+1)/2*this.transform.width+ai,y:(-g[1]/b+1)/2*this.transform.height+ai,perspectiveRatio:.5+this.transform.cameraToCenterDistance/b*.5,isOccluded:!1,signedDistanceFromCamera:b}}{const g=this.transform.projectTileCoordinates(t,a,l,d);return{x:(g.point.x+1)/2*this.transform.width+ai,y:(1-g.point.y)/2*this.transform.height+ai,perspectiveRatio:.5+this.transform.cameraToCenterDistance/g.signedDistanceFromCamera*.5,isOccluded:g.isOccluded,signedDistanceFromCamera:g.signedDistanceFromCamera}}}getPerspectiveRatio(t,a,l,d){const p=this.transform.projectTileCoordinates(t,a,l,d);return .5+this.transform.cameraToCenterDistance/p.signedDistanceFromCamera*.5}isOffscreen(t,a,l,d){return l<ai||t>=this.screenRightBoundary||d<ai||a>this.screenBottomBoundary}isInsideGrid(t,a,l,d){return l>=0&&t<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=o.ar([]);return o.O(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,l,d,p,g,b,S,M,z,F){let j=1,V=0,Z=0,Q=1;const te=t.anchorPointX+b[0],ee=t.anchorPointY+b[1];if(g&&!p){const Xe=this.projectAndGetPerspectiveRatio(te+1,ee,d,M,F),Ue=Xe.x-S.x,Je=Math.atan((Xe.y-S.y)/Ue)+(Ue<0?Math.PI:0),wt=Math.sin(Je),Qt=Math.cos(Je);j=Qt,V=wt,Z=-wt,Q=Qt}else if(!g&&p){const Xe=Da(this.transform);j=Xe.vecEast[0],V=Xe.vecEast[1],Z=Xe.vecSouth[0],Q=Xe.vecSouth[1]}let ae=S.x,he=S.y,ie=a;p&&(ae=te,he=ee,ie=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),ie*=this.transform.getPitchedTextCorrection(te,ee,d),z||(ie*=o.an(.5+S.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),z&&(ae+=j*z.x*ie+Z*z.y*ie,he+=V*z.x*ie+Q*z.y*ie);const ue=t.x1*ie,_e=t.x2*ie,se=(ue+_e)/2,ye=t.y1*ie,Ie=t.y2*ie,Te=(ye+Ie)/2,Le=[{offsetX:ue,offsetY:ye},{offsetX:se,offsetY:ye},{offsetX:_e,offsetY:ye},{offsetX:_e,offsetY:Te},{offsetX:_e,offsetY:Ie},{offsetX:se,offsetY:Ie},{offsetX:ue,offsetY:Ie},{offsetX:ue,offsetY:Te}];let Ce=[];for(const{offsetX:Xe,offsetY:Ue}of Le)Ce.push(new o.P(ae+j*Xe+Z*Ue,he+V*Xe+Q*Ue));let Ke=!1;if(p){const Xe=Ce.map((Ue=>this.projectAndGetPerspectiveRatio(Ue.x,Ue.y,d,M,F)));Ke=Xe.some((Ue=>!Ue.isOccluded)),Ce=Xe.map((Ue=>new o.P(Ue.x,Ue.y)))}else Ke=!0;return{box:o.aL(Ce),allPointsOccluded:!Ke}}}class Xo{constructor(t,a,l,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):d&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Ct{constructor(t,a,l,d,p){this.text=new Xo(t?t.text:null,a,l,p),this.icon=new Xo(t?t.icon:null,a,d,p)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Li{constructor(t,a,l){this.text=t,this.icon=a,this.skipFade=l}}class Yo{constructor(t,a,l,d,p){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=l,this.bucketIndex=d,this.tileID=p}}class So{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:l=>l.collisionGroupID===a}}return this.collisionGroups[t]}}function Tn(f,t,a,l,d){const{horizontalAlign:p,verticalAlign:g}=o.aS(f);return new o.P(-(p-.5)*t+l[0]*d,-(g-.5)*a+l[1]*d)}class ks{constructor(t,a,l,d,p){this.transform=t.clone(),this.terrain=a,this.collisionIndex=new xr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new So(d),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(l,d)=>a.getElevation(t,l,d):null}getBucketParts(t,a,l,d){const p=l.getBucket(a),g=l.latestFeatureIndex;if(!p||!g||a.id!==p.layerIds[0])return;const b=l.collisionBoxArray,S=p.layers[0].layout,M=p.layers[0].paint,z=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),F=l.tileSize/o.a5,j=l.tileID.toUnwrapped(),V=S.get("text-rotation-alignment")==="map",Z=o.aN(l,1,this.transform.zoom),Q=o.aO(this.collisionIndex.transform,l,M.get("text-translate"),M.get("text-translate-anchor")),te=o.aO(this.collisionIndex.transform,l,M.get("icon-translate"),M.get("icon-translate-anchor")),ee=An(V,this.transform,Z);this.retainedQueryData[p.bucketInstanceId]=new Yo(p.bucketInstanceId,g,p.sourceLayerIndex,p.index,l.tileID);const ae={bucket:p,layout:S,translationText:Q,translationIcon:te,unwrappedTileID:j,pitchedLabelPlaneMatrix:ee,scale:z,textPixelRatio:F,holdingForFade:l.holdingForSymbolFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:o.ay(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(d)for(const he of p.sortKeyRanges){const{sortKey:ie,symbolInstanceStart:ue,symbolInstanceEnd:_e}=he;t.push({sortKey:ie,symbolInstanceStart:ue,symbolInstanceEnd:_e,parameters:ae})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:ae})}attemptAnchorPlacement(t,a,l,d,p,g,b,S,M,z,F,j,V,Z,Q,te,ee,ae,he,ie){const ue=o.aP[t.textAnchor],_e=[t.textOffset0,t.textOffset1],se=Tn(ue,l,d,_e,p),ye=this.collisionIndex.placeCollisionBox(a,j,S,M,z,b,g,te,F.predicate,he,se,ie);if((!ae||this.collisionIndex.placeCollisionBox(ae,j,S,M,z,b,g,ee,F.predicate,he,se,ie).placeable)&&ye.placeable){let Ie;if(this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(Ie=this.prevPlacement.variableOffsets[V.crossTileID].anchor),V.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[V.crossTileID]={textOffset:_e,width:l,height:d,anchor:ue,textBoxScale:p,prevAnchor:Ie},this.markUsedJustification(Z,ue,V,Q),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,Q,V),this.placedOrientations[V.crossTileID]=Q),{shift:se,placedGlyphBoxes:ye}}}placeLayerBucketPart(t,a,l){const{bucket:d,layout:p,translationText:g,translationIcon:b,unwrappedTileID:S,pitchedLabelPlaneMatrix:M,textPixelRatio:z,holdingForFade:F,collisionBoxArray:j,partiallyEvaluatedTextSize:V,collisionGroup:Z}=t.parameters,Q=p.get("text-optional"),te=p.get("icon-optional"),ee=o.aQ(p,"text-overlap","text-allow-overlap"),ae=ee==="always",he=o.aQ(p,"icon-overlap","icon-allow-overlap"),ie=he==="always",ue=p.get("text-rotation-alignment")==="map",_e=p.get("text-pitch-alignment")==="map",se=p.get("icon-text-fit")!=="none",ye=p.get("symbol-z-order")==="viewport-y",Ie=ae&&(ie||!d.hasIconData()||te),Te=ie&&(ae||!d.hasTextData()||Q);!d.collisionArrays&&j&&d.deserializeCollisionBoxes(j);const Le=this.retainedQueryData[d.bucketInstanceId].tileID,Ce=this._getTerrainElevationFunc(Le),Ke=this.transform.getFastPathSimpleProjectionMatrix(Le),Xe=(Ue,Je,wt)=>{var Qt,_i;if(a[Ue.crossTileID])return;if(F)return void(this.placements[Ue.crossTileID]=new Li(!1,!1,!1));let li=!1,bi=!1,ui=!0,Oi=null,ki={box:null,placeable:!1,offscreen:null,occluded:!1},_n={placeable:!1},Xi=null,qi=null,Mn=null,mo=0,Ar=0,cr=0;Je.textFeatureIndex?mo=Je.textFeatureIndex:Ue.useRuntimeCollisionCircles&&(mo=Ue.featureIndex),Je.verticalTextFeatureIndex&&(Ar=Je.verticalTextFeatureIndex);const na=Je.textBox;if(na){const Ca=ci=>{let di=o.az.horizontal;if(d.allowVerticalPlacement&&!ci&&this.prevPlacement){const ln=this.prevPlacement.placedOrientations[Ue.crossTileID];ln&&(this.placedOrientations[Ue.crossTileID]=ln,di=ln,this.markUsedOrientation(d,di,Ue))}return di},fr=(ci,di)=>{if(d.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&Je.verticalTextBox){for(const ln of d.writingModes)if(ln===o.az.vertical?(ki=di(),_n=ki):ki=ci(),ki&&ki.placeable)break}else ki=ci()},Xa=Ue.textAnchorOffsetStartIndex,Ya=Ue.textAnchorOffsetEndIndex;if(Ya===Xa){const ci=(di,ln)=>{const un=this.collisionIndex.placeCollisionBox(di,ee,z,Le,S,_e,ue,g,Z.predicate,Ce,void 0,Ke);return un&&un.placeable&&(this.markUsedOrientation(d,ln,Ue),this.placedOrientations[Ue.crossTileID]=ln),un};fr((()=>ci(na,o.az.horizontal)),(()=>{const di=Je.verticalTextBox;return d.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&di?ci(di,o.az.vertical):{box:null,offscreen:null}})),Ca(ki&&ki.placeable)}else{let ci=o.aP[(_i=(Qt=this.prevPlacement)===null||Qt===void 0?void 0:Qt.variableOffsets[Ue.crossTileID])===null||_i===void 0?void 0:_i.anchor];const di=(un,md,pd)=>{const Uo=un.x2-un.x1,Jd=un.y2-un.y1,_d=Ue.textBoxScale,Mu=se&&he==="never"?md:null;let po=null,_o=ee==="never"?1:2,go="never";ci&&_o++;for(let Cu=0;Cu<_o;Cu++){for(let Eu=Xa;Eu<Ya;Eu++){const Fl=d.textAnchorOffsets.get(Eu);if(ci&&Fl.textAnchor!==ci)continue;const Bl=this.attemptAnchorPlacement(Fl,un,Uo,Jd,_d,ue,_e,z,Le,S,Z,go,Ue,d,pd,g,b,Mu,Ce);if(Bl&&(po=Bl.placedGlyphBoxes,po&&po.placeable))return li=!0,Oi=Bl.shift,po}ci?ci=null:go=ee}return l&&!po&&(po={box:this.collisionIndex.placeCollisionBox(na,"always",z,Le,S,_e,ue,g,Z.predicate,Ce,void 0,Ke).box,offscreen:!1,placeable:!1,occluded:!1}),po};fr((()=>di(na,Je.iconBox,o.az.horizontal)),(()=>{const un=Je.verticalTextBox;return d.allowVerticalPlacement&&(!ki||!ki.placeable)&&Ue.numVerticalGlyphVertices>0&&un?di(un,Je.verticalIconBox,o.az.vertical):{box:null,occluded:!0,offscreen:null}})),ki&&(li=ki.placeable,ui=ki.offscreen);const ln=Ca(ki&&ki.placeable);if(!li&&this.prevPlacement){const un=this.prevPlacement.variableOffsets[Ue.crossTileID];un&&(this.variableOffsets[Ue.crossTileID]=un,this.markUsedJustification(d,un.anchor,Ue,ln))}}}if(Xi=ki,li=Xi&&Xi.placeable,ui=Xi&&Xi.offscreen,Ue.useRuntimeCollisionCircles&&Ue.centerJustifiedTextSymbolIndex>=0){const Ca=d.text.placedSymbolArray.get(Ue.centerJustifiedTextSymbolIndex),fr=o.aA(d.textSizeData,V,Ca),Xa=p.get("text-padding");qi=this.collisionIndex.placeCollisionCircles(ee,Ca,d.lineVertexArray,d.glyphOffsetArray,fr,S,M,l,_e,Z.predicate,Ue.collisionCircleDiameter,Xa,g,Ce),qi.circles.length&&qi.collisionDetected&&!l&&o.w("Collisions detected, but collision boxes are not shown"),li=ae||qi.circles.length>0&&!qi.collisionDetected,ui=ui&&qi.offscreen}if(Je.iconFeatureIndex&&(cr=Je.iconFeatureIndex),Je.iconBox){const Ca=fr=>this.collisionIndex.placeCollisionBox(fr,he,z,Le,S,_e,ue,b,Z.predicate,Ce,se&&Oi?Oi:void 0,Ke);_n&&_n.placeable&&Je.verticalIconBox?(Mn=Ca(Je.verticalIconBox),bi=Mn.placeable):(Mn=Ca(Je.iconBox),bi=Mn.placeable),ui=ui&&Mn.offscreen}const Vo=Q||Ue.numHorizontalGlyphVertices===0&&Ue.numVerticalGlyphVertices===0,Hs=te||Ue.numIconVertices===0;Vo||Hs?Hs?Vo||(bi=bi&&li):li=bi&&li:bi=li=bi&&li;const No=bi&&Mn.placeable;if(li&&Xi.placeable&&this.collisionIndex.insertCollisionBox(Xi.box,ee,p.get("text-ignore-placement"),d.bucketInstanceId,_n&&_n.placeable&&Ar?Ar:mo,Z.ID),No&&this.collisionIndex.insertCollisionBox(Mn.box,he,p.get("icon-ignore-placement"),d.bucketInstanceId,cr,Z.ID),qi&&li&&this.collisionIndex.insertCollisionCircles(qi.circles,ee,p.get("text-ignore-placement"),d.bucketInstanceId,mo,Z.ID),l&&this.storeCollisionData(d.bucketInstanceId,wt,Je,Xi,Mn,qi),Ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ue.crossTileID]=new Li((li||Ie)&&!Xi?.occluded,(bi||Te)&&!Mn?.occluded,ui||d.justReloaded),a[Ue.crossTileID]=!0};if(ye){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ue=d.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Je=Ue.length-1;Je>=0;--Je){const wt=Ue[Je];Xe(d.symbolInstances.get(wt),d.collisionArrays[wt],wt)}}else for(let Ue=t.symbolInstanceStart;Ue<t.symbolInstanceEnd;Ue++)Xe(d.symbolInstances.get(Ue),d.collisionArrays[Ue],Ue);d.justReloaded=!1}storeCollisionData(t,a,l,d,p,g){if(l.textBox||l.iconBox){let b,S;this.collisionBoxArrays.has(t)?b=this.collisionBoxArrays.get(t):(b=new Map,this.collisionBoxArrays.set(t,b)),b.has(a)?S=b.get(a):(S={text:null,icon:null},b.set(a,S)),l.textBox&&(S.text=d.box),l.iconBox&&(S.icon=p.box)}if(g){let b=this.collisionCircleArrays[t];b===void 0&&(b=this.collisionCircleArrays[t]=[]);for(let S=0;S<g.circles.length;S+=4)b.push(g.circles[S+0]-ai),b.push(g.circles[S+1]-ai),b.push(g.circles[S+2]),b.push(g.collisionDetected?1:0)}}markUsedJustification(t,a,l,d){let p;p=d===o.az.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[o.aR(a)];const g=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const b of g)b>=0&&(t.text.placedSymbolArray.get(b).crossTileID=p>=0&&b!==p?0:l.crossTileID)}markUsedOrientation(t,a,l){const d=a===o.az.horizontal||a===o.az.horizontalOnly?a:0,p=a===o.az.vertical?a:0,g=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const b of g)t.text.placedSymbolArray.get(b).placedOrientation=d;l.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=p)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let l=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(t):1,p=a?a.opacities:{},g=a?a.variableOffsets:{},b=a?a.placedOrientations:{};for(const S in this.placements){const M=this.placements[S],z=p[S];z?(this.opacities[S]=new Ct(z,d,M.text,M.icon),l=l||M.text!==z.text.placed||M.icon!==z.icon.placed):(this.opacities[S]=new Ct(null,d,M.text,M.icon,M.skipFade),l=l||M.text||M.icon)}for(const S in p){const M=p[S];if(!this.opacities[S]){const z=new Ct(M,d,!1,!1);z.isHidden()||(this.opacities[S]=z,l=l||M.text.placed||M.icon.placed)}}for(const S in g)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=g[S]);for(const S in b)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=b[S]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const l={};for(const d of a){const p=d.getBucket(t);p&&d.latestFeatureIndex&&t.id===p.layerIds[0]&&this.updateBucketOpacities(p,d.tileID,l,d.collisionBoxArray)}}updateBucketOpacities(t,a,l,d){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const p=t.layers[0],g=p.layout,b=new Ct(null,0,!1,!1,!0),S=g.get("text-allow-overlap"),M=g.get("icon-allow-overlap"),z=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),F=g.get("text-rotation-alignment")==="map",j=g.get("text-pitch-alignment")==="map",V=g.get("icon-text-fit")!=="none",Z=new Ct(null,0,S&&(M||!t.hasIconData()||g.get("icon-optional")),M&&(S||!t.hasTextData()||g.get("text-optional")),!0);!t.collisionArrays&&d&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(d);const Q=(ee,ae,he)=>{for(let ie=0;ie<ae/4;ie++)ee.opacityVertexArray.emplaceBack(he);ee.hasVisibleVertices=ee.hasVisibleVertices||he!==br},te=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ee=0;ee<t.symbolInstances.length;ee++){const ae=t.symbolInstances.get(ee),{numHorizontalGlyphVertices:he,numVerticalGlyphVertices:ie,crossTileID:ue}=ae;let _e=this.opacities[ue];l[ue]?_e=b:_e||(_e=Z,this.opacities[ue]=_e),l[ue]=!0;const se=ae.numIconVertices>0,ye=this.placedOrientations[ae.crossTileID],Ie=ye===o.az.vertical,Te=ye===o.az.horizontal||ye===o.az.horizontalOnly;if(he>0||ie>0){const Ce=To(_e.text);Q(t.text,he,Ie?br:Ce),Q(t.text,ie,Te?br:Ce);const Ke=_e.text.isHidden();[ae.rightJustifiedTextSymbolIndex,ae.centerJustifiedTextSymbolIndex,ae.leftJustifiedTextSymbolIndex].forEach((Je=>{Je>=0&&(t.text.placedSymbolArray.get(Je).hidden=Ke||Ie?1:0)})),ae.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(ae.verticalPlacedTextSymbolIndex).hidden=Ke||Te?1:0);const Xe=this.variableOffsets[ae.crossTileID];Xe&&this.markUsedJustification(t,Xe.anchor,ae,ye);const Ue=this.placedOrientations[ae.crossTileID];Ue&&(this.markUsedJustification(t,"left",ae,Ue),this.markUsedOrientation(t,Ue,ae))}if(se){const Ce=To(_e.icon),Ke=!(V&&ae.verticalPlacedIconSymbolIndex&&Ie);ae.placedIconSymbolIndex>=0&&(Q(t.icon,ae.numIconVertices,Ke?Ce:br),t.icon.placedSymbolArray.get(ae.placedIconSymbolIndex).hidden=_e.icon.isHidden()),ae.verticalPlacedIconSymbolIndex>=0&&(Q(t.icon,ae.numVerticalIconVertices,Ke?br:Ce),t.icon.placedSymbolArray.get(ae.verticalPlacedIconSymbolIndex).hidden=_e.icon.isHidden())}const Le=te&&te.has(ee)?te.get(ee):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ce=t.collisionArrays[ee];if(Ce){let Ke=new o.P(0,0);if(Ce.textBox||Ce.verticalTextBox){let Xe=!0;if(z){const Ue=this.variableOffsets[ue];Ue?(Ke=Tn(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textBoxScale),F&&Ke._rotate(j?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Xe=!1}if(Ce.textBox||Ce.verticalTextBox){let Ue;Ce.textBox&&(Ue=Ie),Ce.verticalTextBox&&(Ue=Te),qr(t.textCollisionBox.collisionVertexArray,_e.text.placed,!Xe||Ue,Le.text,Ke.x,Ke.y)}}if(Ce.iconBox||Ce.verticalIconBox){const Xe=!!(!Te&&Ce.verticalIconBox);let Ue;Ce.iconBox&&(Ue=Xe),Ce.verticalIconBox&&(Ue=!Xe),qr(t.iconCollisionBox.collisionVertexArray,_e.icon.placed,Ue,Le.icon,V?Ke.x:0,V?Ke.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const l=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*l>t}setStale(){this.stale=!0}}function qr(f,t,a,l,d,p){l&&l.length!==0||(l=[0,0,0,0]);const g=l[0]-ai,b=l[1]-ai,S=l[2]-ai,M=l[3]-ai;f.emplaceBack(t?1:0,a?1:0,d||0,p||0,g,b),f.emplaceBack(t?1:0,a?1:0,d||0,p||0,S,b),f.emplaceBack(t?1:0,a?1:0,d||0,p||0,S,M),f.emplaceBack(t?1:0,a?1:0,d||0,p||0,g,M)}const Ra=Math.pow(2,25),Mi=Math.pow(2,24),wr=Math.pow(2,17),ja=Math.pow(2,16),ir=Math.pow(2,9),Jo=Math.pow(2,8),xa=Math.pow(2,1);function To(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const t=f.placed?1:0,a=Math.floor(127*f.opacity);return a*Ra+t*Mi+a*wr+t*ja+a*ir+t*Jo+a*xa+t}const br=0;class la{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,l,d,p){const g=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(g,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,g.sort(((b,S)=>b.sortKey-S.sortKey)));this._currentPartIndex<g.length;)if(a.placeLayerBucketPart(g[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,p())return!0;return!1}}class nr{constructor(t,a,l,d,p,g,b,S){this.placement=new ks(t,a,g,b,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(t,a,l){const d=Pe(),p=()=>!this._forceFullPlacement&&Pe()-d>2;for(;this._currentPlacementIndex>=0;){const g=a[t[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(g.type==="symbol"&&(!g.minzoom||g.minzoom<=b)&&(!g.maxzoom||g.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new la(g)),this._inProgressLayer.continuePlacement(l[g.source],this.placement,this._showCollisionBoxes,g,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Lt=512/o.a5/2;class Zr{constructor(t,a,l){this.tileID=t,this.bucketInstanceId=l,this._symbolsByKey={};const d=new Map;for(let p=0;p<a.length;p++){const g=a.get(p),b=g.key,S=d.get(b);S?S.push(g):d.set(b,[g])}for(const[p,g]of d){const b={positions:g.map((S=>({x:Math.floor(S.anchorX*Lt),y:Math.floor(S.anchorY*Lt)}))),crossTileIDs:g.map((S=>S.crossTileID))};if(b.positions.length>128){const S=new o.aT(b.positions.length,16,Uint16Array);for(const{x:M,y:z}of b.positions)S.add(M,z);S.finish(),delete b.positions,b.index=S}this._symbolsByKey[p]=b}}getScaledCoordinates(t,a){const{x:l,y:d,z:p}=this.tileID.canonical,{x:g,y:b,z:S}=a.canonical,M=Lt/Math.pow(2,S-p),z=(b*o.a5+t.anchorY)*M,F=d*o.a5*Lt;return{x:Math.floor((g*o.a5+t.anchorX)*M-l*o.a5*Lt),y:Math.floor(z-F)}}findMatches(t,a,l){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let p=0;p<t.length;p++){const g=t.get(p);if(g.crossTileID)continue;const b=this._symbolsByKey[g.key];if(!b)continue;const S=this.getScaledCoordinates(g,a);if(b.index){const M=b.index.range(S.x-d,S.y-d,S.x+d,S.y+d).sort();for(const z of M){const F=b.crossTileIDs[z];if(!l[F]){l[F]=!0,g.crossTileID=F;break}}}else if(b.positions)for(let M=0;M<b.positions.length;M++){const z=b.positions[M],F=b.crossTileIDs[M];if(Math.abs(z.x-S.x)<=d&&Math.abs(z.y-S.y)<=d&&!l[F]){l[F]=!0,g.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class il{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Po{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const l in this.indexes){const d=this.indexes[l],p={};for(const g in d){const b=d[g];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+a),p[b.tileID.key]=b}this.indexes[l]=p}this.lng=t}addBucket(t,a,l){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let p=0;p<a.symbolInstances.length;p++)a.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const p in this.indexes){const g=this.indexes[p];if(Number(p)>t.overscaledZ)for(const b in g){const S=g[b];S.tileID.isChildOf(t)&&S.findMatches(a.symbolInstances,t,d)}else{const b=g[t.scaledTo(Number(p)).key];b&&b.findMatches(a.symbolInstances,t,d)}}for(let p=0;p<a.symbolInstances.length;p++){const g=a.symbolInstances.get(p);g.crossTileID||(g.crossTileID=l.generate(),d[g.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Zr(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const l of a.getCrossTileIDsLists())for(const d of l)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let a=!1;for(const l in this.indexes){const d=this.indexes[l];for(const p in d)t[d[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,d[p]),delete d[p],a=!0)}return a}}class Rn{constructor(){this.layerIndexes={},this.crossTileIDs=new il,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,l){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new Po);let p=!1;const g={};d.handleWrapJump(l);for(const b of a){const S=b.getBucket(t);S&&t.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(b.tileID,S,this.crossTileIDs)&&(p=!0),g[S.bucketInstanceId]=!0)}return d.removeStaleBuckets(g)&&(p=!0),p}pruneUnusedLayers(t){const a={};t.forEach((l=>{a[l]=!0}));for(const l in this.layerIndexes)a[l]||delete this.layerIndexes[l]}}var mt="void main() {fragColor=vec4(1.0);}";const qt={prelude:rt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:rt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:rt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:rt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:rt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:rt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:rt(mt,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:rt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:rt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:rt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:rt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:rt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:rt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:rt(mt,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:rt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:rt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:rt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:rt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:rt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:rt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:rt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:rt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:rt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:rt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:rt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:rt(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:rt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:rt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:rt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:rt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:rt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:rt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:rt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:rt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:rt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:rt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:rt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function rt(f,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=t.match(/in ([\w]+) ([\w]+)/g),d=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),p=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=p?p.concat(d):d,b={};return{fragmentSource:f=f.replace(a,((S,M,z,F,j)=>(b[j]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
in ${z} ${F} ${j};
#else
uniform ${z} ${F} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${z} ${F} ${j} = u_${j};
#endif
`))),vertexSource:t=t.replace(a,((S,M,z,F,j)=>{const V=F==="float"?"vec2":"vec4",Z=j.match(/color/)?"color":V;return b[j]?M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${z} ${V} a_${j};
out ${z} ${F} ${j};
#else
uniform ${z} ${F} u_${j};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${z} ${F} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${Z}(a_${j}, u_${j}_t);
#else
    ${z} ${F} ${j} = u_${j};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${z} ${V} a_${j};
#else
uniform ${z} ${F} u_${j};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${z} ${F} ${j} = a_${j};
#else
    ${z} ${F} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${z} ${F} ${j} = unpack_mix_${Z}(a_${j}, u_${j}_t);
#else
    ${z} ${F} ${j} = u_${j};
#endif
`})),staticAttributes:l,staticUniforms:g}}class Jt{constructor(t,a,l){this.vertexBuffer=t,this.indexBuffer=a,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var wa=o.aU([{name:"a_pos",type:"Int16",components:2}]);const on="#define PROJECTION_MERCATOR",Pn="mercator";class ji{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Pn}get shaderDefine(){return on}get shaderPreludeCode(){return qt.projectionMercator}get vertexShaderPreludeCode(){return qt.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,a,l,d,p){if(this._cachedMesh)return this._cachedMesh;const g=new o.aW;g.emplaceBack(0,0),g.emplaceBack(o.a5,0),g.emplaceBack(0,o.a5),g.emplaceBack(o.a5,o.a5);const b=t.createVertexBuffer(g,wa.members),S=o.aX.simpleSegment(0,0,4,2),M=new o.aY;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3);const z=t.createIndexBuffer(M);return this._cachedMesh=new Jt(b,z,S),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class ar{constructor(t=0,a=0,l=0,d=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(l)||l<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=l,this.right=d}interpolate(t,a,l){return a.top!=null&&t.top!=null&&(this.top=o.G.number(t.top,a.top,l)),a.bottom!=null&&t.bottom!=null&&(this.bottom=o.G.number(t.bottom,a.bottom,l)),a.left!=null&&t.left!=null&&(this.left=o.G.number(t.left,a.left,l)),a.right!=null&&t.right!=null&&(this.right=o.G.number(t.right,a.right,l)),this}getCenter(t,a){const l=o.an((this.left+t-this.right)/2,0,t),d=o.an((this.top+a-this.bottom)/2,0,a);return new o.P(l,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new ar(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ea(f,t){if(!f.renderWorldCopies||f.lngRange)return;const a=t.lng-f.center.lng;t.lng+=a>180?-360:a<-180?360:0}function Rt(f){return Math.max(0,Math.floor(f))}class qn{constructor(t,a){var l;this.applyConstrain=(d,p)=>this._constrainOverride!==null?this._constrainOverride(d,p):this._callbacks.defaultConstrain(d,p),this._callbacks=t,this._tileSize=512,this._renderWorldCopies=a?.renderWorldCopies===void 0||!!a?.renderWorldCopies,this._minZoom=a?.minZoom||0,this._maxZoom=a?.maxZoom||22,this._minPitch=a?.minPitch==null?0:a?.minPitch,this._maxPitch=a?.maxPitch==null?60:a?.maxPitch,this._constrainOverride=(l=a?.constrainOverride)!==null&&l!==void 0?l:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Rt(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ar,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,a,l){this._constrainOverride=t.constrainOverride,this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Rt(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new ar(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!l&&t.autoCalculateNearFarZ,a&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get constrainOverride(){return this._constrainOverride}setConstrainOverride(t){t===void 0&&(t=null),this._constrainOverride!==t&&(this._constrainOverride=t,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const a=o.W(t,-180,180)*Math.PI/180;var l,d,p,g,b,S,M,z,F;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=R(),l=this._rotationMatrix,p=-this._bearingInRadians,g=(d=this._rotationMatrix)[0],b=d[1],S=d[2],M=d[3],z=Math.sin(p),F=Math.cos(p),l[0]=g*F+S*z,l[1]=b*F+M*z,l[2]=g*-z+S*F,l[3]=b*-z+M*F)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const a=o.an(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const a=t/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aZ(this._fovInRadians)}setFov(t){t=o.an(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=o.ap(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const a=this.applyConstrain(this._center,t).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=o.aq(a),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,a){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,l){this._unmodified=!1,this._edgeInsets.interpolate(t,a,l),this.constrainInternal(),this._calcMatrices()}resize(t,a,l=!0){this._width=t,this._height=a,l&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new hi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-o.ao,o.ao])}getCameraQueryGeometry(t,a){if(a.length===1)return[a[0],t];{const{minX:l,minY:d,maxX:p,maxY:g}=o.aa.fromPoints(a).extend(t);return[new o.P(l,d),new o.P(p,d),new o.P(p,g),new o.P(l,g),new o.P(l,d)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:l}=this.applyConstrain(this.center,this.zoom);this.setCenter(a),this.setZoom(l),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=o.ar(new Float64Array(16));o.Q(t,t,[this._width/2,-this._height/2,1]),o.O(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=o.ar(new Float64Array(16)),o.Q(t,t,[1,-1,1]),o.O(t,t,[-1,-1,0]),o.Q(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,a,l,d){const p=l!==void 0?l:this.bearing,g=d=d!==void 0?d:this.pitch,{distanceToCenter:b,clampedElevation:S}=this._distanceToCenterFromAltElevationPitch(a,this.elevation,g),{x:M,y:z}=ti(g,p),F=o.a9.fromLngLat(t,a);let j,V,Z=o.a_(1,F.y),Q=0;do{if(Q+=1,Q>10)break;V=b/Z,j=new o.a9(F.x+M*V,F.y+z*V),Z=1/j.meterInMercatorCoordinateUnits()}while(Math.abs(b-V*Z)>1e-12);return{center:j.toLngLat(),elevation:S,zoom:o.at(this.height/2/Math.tan(this.fovInRadians/2)/V/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const a=1/this.worldSize,l=o.as(1,this.center.lat)*this.worldSize,d=o.a9.fromLngLat(this.center,this.elevation),p=d.x/a,g=d.y/a,b=d.z/a,S=this.pitch,M=this.bearing,{x:z,y:F,z:j}=ti(S,M),V=this.cameraToCenterDistance,Z=p+V*-z,Q=g+V*-F,te=b+V*j,{distanceToCenter:ee,clampedElevation:ae}=this._distanceToCenterFromAltElevationPitch(te/l,t,S),he=ee*l,ie=new o.a9((Z+z*he)*a,(Q+F*he)*a,0).toLngLat(),ue=o.as(1,ie.lat),_e=o.at(this.height/2/Math.tan(this.fovInRadians/2)/ee/ue/this.tileSize);this._elevation=ae,this._center=ie,this.setZoom(_e)}_distanceToCenterFromAltElevationPitch(t,a,l){const d=-Math.cos(o.ap(l)),p=t-a;let g,b=a;return d*p>=0||Math.abs(d)<.1?(g=1e4,b=t+g*d):g=-p/d,{distanceToCenter:g,clampedElevation:b}}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=o.as(1,this.center.lat)*this.worldSize;return Se(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const a=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/a,t.canonical.y/a,1/a/o.a5,1/a/o.a5]}}class ua{constructor(t,a){this.min=t,this.max=a,this.center=o.a$([],o.b0([],this.min,this.max),.5)}quadrant(t){const a=[t%2==0,t<2],l=o.b1(this.min),d=o.b1(this.max);for(let p=0;p<a.length;p++)l[p]=a[p]?this.min[p]:this.center[p],d[p]=a[p]?this.center[p]:this.max[p];return d[2]=this.max[2],new ua(l,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let a=!0;for(let l=0;l<t.planes.length;l++){const d=this.intersectsPlane(t.planes[l]);if(d===0)return 0;d===1&&(a=!1)}return a?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let a=t[3],l=t[3];for(let d=0;d<3;d++)t[d]>0?(a+=t[d]*this.min[d],l+=t[d]*this.max[d]):(l+=t[d]*this.min[d],a+=t[d]*this.max[d]);return a>=0?2:l<0?0:1}}class Lo{distanceToTile2d(t,a,l,d){const p=d.distanceX([t,a]),g=d.distanceY([t,a]);return Math.hypot(p,g)}getWrap(t,a,l){return l}getTileBoundingVolume(t,a,l,d){var p,g;let b=0,S=0;if(d?.terrain){const z=new o.a2(t.z,a,t.z,t.x,t.y),F=d.terrain.getMinMaxElevation(z);b=(p=F.minElevation)!==null&&p!==void 0?p:Math.min(0,l),S=(g=F.maxElevation)!==null&&g!==void 0?g:Math.max(0,l)}const M=1<<t.z;return new ua([a+t.x/M,t.y/M,b],[a+(t.x+1)/M,(t.y+1)/M,S])}allowVariableZoom(t,a){const l=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,d=o.an(78.5-l/2,0,60);return!!a.terrain||t.pitch>d}allowWorldCopies(){return!0}prepareNextFrame(){}}class jn{constructor(t,a,l){this.points=t,this.planes=a,this.aabb=l}static fromInvProjectionMatrix(t,a=1,l=0,d,p){const g=p?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],b=Math.pow(2,l),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((j=>(function(V,Z,Q,te){const ee=o.aH([],V,Z),ae=1/ee[3]/Q*te;return o.b6(ee,ee,[ae,ae,1/ee[3],ae])})(j,t,a,b)));d&&(function(j,V,Z,Q){const te=Q?4:0,ee=Q?0:4;let ae=0;const he=[],ie=[];for(let se=0;se<4;se++){const ye=o.b2([],j[se+ee],j[se+te]),Ie=o.b7(ye);o.a$(ye,ye,1/Ie),he.push(Ie),ie.push(ye)}for(let se=0;se<4;se++){const ye=o.b8(j[se+te],ie[se],Z);ae=ye!==null&&ye>=0?Math.max(ae,ye):Math.max(ae,he[se])}const ue=(function(se,ye){const Ie=o.b2([],se[ye[0]],se[ye[1]]),Te=o.b2([],se[ye[2]],se[ye[1]]),Le=[0,0,0,0];return o.b3(Le,o.b4([],Ie,Te)),Le[3]=-o.b5(Le,se[ye[0]]),Le})(j,V),_e=(function(se,ye){const Ie=o.b9(se),Te=o.ba([],se,1/Ie),Le=o.b2([],ye,o.a$([],Te,o.b5(ye,Te))),Ce=o.b9(Le);if(Ce>0){const Ke=Math.sqrt(1-Te[3]*Te[3]),Xe=o.a$([],Te,-Te[3]),Ue=o.b0([],Xe,o.a$([],Le,Ke/Ce));return o.bb(ye,Ue)}return null})(Z,ue);if(_e!==null){const se=_e/o.b5(ie[0],ue);ae=Math.min(ae,se)}for(let se=0;se<4;se++){const ye=Math.min(ae,he[se]);j[se+ee]=[j[se+te][0]+ie[se][0]*ye,j[se+te][1]+ie[se][1]*ye,j[se+te][2]+ie[se][2]*ye,1]}})(S,g[0],d,p);const M=g.map((j=>{const V=o.b2([],S[j[0]],S[j[1]]),Z=o.b2([],S[j[2]],S[j[1]]),Q=o.b3([],o.b4([],V,Z)),te=-o.b5(Q,S[j[1]]);return Q.concat(te)})),z=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],F=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const j of S)for(let V=0;V<3;V++)z[V]=Math.min(z[V],j[V]),F[V]=Math.max(F[V],j[V]);return new jn(S,M,new ua(z,F))}}class rr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,l=!0){this._helper.resize(t,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,a){}constructor(t){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(a,l)=>{l=o.an(+l,this.minZoom,this.maxZoom);const d={center:new o.V(a.lng,a.lat),zoom:l};let p=this._helper._lngRange;if(!this._helper._renderWorldCopies&&p===null){const ie=179.9999999999;p=[-ie,ie]}const g=this.tileSize*o.aq(d.zoom);let b=0,S=g,M=0,z=g,F=0,j=0;const{x:V,y:Z}=this.size;if(this._helper._latRange){const ie=this._helper._latRange;b=o.X(ie[1])*g,S=o.X(ie[0])*g,S-b<Z&&(F=Z/(S-b))}p&&(M=o.W(o.Y(p[0])*g,0,g),z=o.W(o.Y(p[1])*g,0,g),z<M&&(z+=g),z-M<V&&(j=V/(z-M)));const{x:Q,y:te}=dt(g,a);let ee,ae;const he=Math.max(j||0,F||0);if(he){const ie=new o.P(j?(z+M)/2:Q,F?(S+b)/2:te);return d.center=gt(g,ie).wrap(),d.zoom+=o.at(he),d}if(this._helper._latRange){const ie=Z/2;te-ie<b&&(ae=b+ie),te+ie>S&&(ae=S-ie)}if(p){const ie=(M+z)/2;let ue=Q;this._helper._renderWorldCopies&&(ue=o.W(Q,ie-g/2,ie+g/2));const _e=V/2;ue-_e<M&&(ee=M+_e),ue+_e>z&&(ee=z-_e)}if(ee!==void 0||ae!==void 0){const ie=new o.P(ee??Q,ae??te);d.center=gt(g,ie).wrap()}return d},this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new qn({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._coveringTilesDetailsProvider=new Lo}clone(){const t=new rr;return t.apply(this),t}apply(t,a,l){this._helper.apply(t,a,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const a=[new o.bc(0,t)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new o.P(0,0)),d=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),p=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),g=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),b=Math.floor(Math.min(l.x,d.x,p.x,g.x)),S=Math.floor(Math.max(l.x,d.x,p.x,g.x)),M=1;for(let z=b-M;z<=S+M;z++)z!==0&&a.push(new o.bc(z,t))}return a}getCameraFrustum(){return jn.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const a=this.screenPointToLocation(this.centerPoint,t),l=t?t.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(t,a){const l=o.as(this.elevation,this.center.lat),d=this.screenPointToMercatorCoordinateAtZ(a,l),p=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),g=o.a9.fromLngLat(t),b=new o.a9(g.x-(d.x-p.x),g.y-(d.y-p.y));this.setCenter(b?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,a){return a?this.coordinatePoint(o.a9.fromLngLat(t),a.getElevationForLngLat(t,this),this._pixelMatrix3D):this.coordinatePoint(o.a9.fromLngLat(t))}screenPointToLocation(t,a){var l;return(l=this.screenPointToMercatorCoordinate(t,a))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(t,a){if(a){const l=a.pointCoordinate(t);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,a){const l=a||0,d=[t.x,t.y,0,1],p=[t.x,t.y,1,1];o.aH(d,d,this._pixelMatrixInverse),o.aH(p,p,this._pixelMatrixInverse);const g=d[3],b=p[3],S=d[1]/g,M=p[1]/b,z=d[2]/g,F=p[2]/b,j=z===F?0:(l-z)/(F-z);return new o.a9(o.G.number(d[0]/g,p[0]/b,j)/this.worldSize,o.G.number(S,M,j)/this.worldSize,l)}coordinatePoint(t,a=0,l=this._pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,a,1];return o.aH(d,d,l),new o.P(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Ht(this));return new hi().extend(this.screenPointToLocation(new o.P(0,t))).extend(this.screenPointToLocation(new o.P(this._helper._width,t))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(t,a){return a?a.pointCoordinate(t)!=null:t.y>this.height/2-Ht(this)}calculatePosMatrix(t,a=!1,l){var d;const p=(d=t.key)!==null&&d!==void 0?d:o.bd(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),g=a?this._alignedPosMatrixCache:this._posMatrixCache;if(g.has(p)){const M=g.get(p);return l?M.f32:M.f64}const b=Vt(t,this.worldSize);o.S(b,a?this._alignedProjMatrix:this._viewProjMatrix,b);const S={f64:b,f32:new Float32Array(b)};return g.set(p,S),l?S.f32:S.f64}calculateFogMatrix(t){const a=t.key,l=this._fogMatrixCacheF32;if(l.has(a))return l.get(a);const d=Vt(t,this.worldSize);return o.S(d,this._fogMatrix,d),l.set(a,new Float32Array(d)),l.get(a)}calculateCenterFromCameraLngLatAlt(t,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,d)}_calculateNearFarZIfNeeded(t,a,l){if(!this._helper.autoCalculateNearFarZ)return;const d=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),p=t-d*this._helper._pixelPerMeter/Math.cos(a),g=d<0?p:t,b=Math.PI/2+this.pitchInRadians,S=o.ap(this.fov)*(Math.abs(Math.cos(o.ap(this.roll)))*this.height+Math.abs(Math.sin(o.ap(this.roll)))*this.width)/this.height*(.5+l.y/this.height),M=Math.sin(S)*g/Math.sin(o.an(Math.PI-b-S,.01,Math.PI-.01)),z=Ht(this),F=Math.atan(z/this._helper.cameraToCenterDistance),j=o.ap(.75),V=F>j?2*F*(.5+l.y/(2*z)):j,Z=Math.sin(V)*g/Math.sin(o.an(Math.PI-b-V,.01,Math.PI-.01)),Q=Math.min(M,Z);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*Q+g),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,a=dt(this.worldSize,this.center),l=a.x,d=a.y;this._helper._pixelPerMeter=o.as(1,this.center.lat)*this.worldSize;const p=o.ap(Math.min(this.pitch,nt)),g=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(p));let b;this._calculateNearFarZIfNeeded(g,p,t),b=new Float64Array(16),o.be(b,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aB(this._invProjMatrix,b),b[8]=2*-t.x/this._helper._width,b[9]=2*t.y/this._helper._height,this._projectionMatrix=o.bf(b),o.Q(b,b,[1,-1,1]),o.O(b,b,[0,0,-this._helper.cameraToCenterDistance]),o.bg(b,b,-this.rollInRadians),o.bh(b,b,this.pitchInRadians),o.bg(b,b,-this.bearingInRadians),o.O(b,b,[-l,-d,0]),this._mercatorMatrix=o.Q([],b,[this.worldSize,this.worldSize,this.worldSize]),o.Q(b,b,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,b),o.O(b,b,[0,0,-this.elevation]),this._viewProjMatrix=b,this._invViewProjMatrix=o.aB([],b);const S=[0,0,-1,1];o.aH(S,S,this._invViewProjMatrix),this._cameraPosition=[S[0]/S[3],S[1]/S[3],S[2]/S[3]],this._fogMatrix=new Float64Array(16),o.be(this._fogMatrix,this.fovInRadians,this.width/this.height,g,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,o.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.O(this._fogMatrix,this._fogMatrix,[-l,-d,0]),o.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,b);const M=this._helper._width%2/2,z=this._helper._height%2/2,F=Math.cos(this.bearingInRadians),j=Math.sin(-this.bearingInRadians),V=l-Math.round(l)+F*M+j*z,Z=d-Math.round(d)+F*z+j*M,Q=new Float64Array(b);if(o.O(Q,Q,[V>.5?V-1:V,Z>.5?Z-1:Z,0]),this._alignedProjMatrix=Q,b=o.aB(new Float64Array(16),this._pixelMatrix),!b)throw new Error("failed to invert matrix");this._pixelMatrixInverse=b,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new o.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return o.aH(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=o.as(1,this.center.lat)*this.worldSize;return Se(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,a){const l=o.a9.fromLngLat(t),d=[l.x*this.worldSize,l.y*this.worldSize,a,1];return o.aH(d,d,this._viewProjMatrix),d[2]/d[3]}getProjectionData(t){const{overscaledTileID:a,aligned:l,applyTerrainMatrix:d}=t,p=this._helper.getMercatorTileCoordinates(a),g=a?this.calculatePosMatrix(a,l,!0):null;let b;return b=a&&a.terrainRttPosMatrix32f&&d?a.terrainRttPosMatrix32f:g||o.bi(),{mainMatrix:b,tileMercatorCoords:p,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:b}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,a,l){return 1}transformLightDirection(t){return o.b1(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,a,l,d){const p=this.calculatePosMatrix(l);let g;d?(g=[t,a,d(t,a),1],o.aH(g,g,p)):(g=[t,a,0,1],vr(g,g,p));const b=g[3];return{point:new o.P(g[0]/b,g[1]/b),signedDistanceFromCamera:b,isOccluded:!1}}populateCache(t){for(const a of t)this.calculatePosMatrix(a)}getMatrixForModel(t,a){const l=o.a9.fromLngLat(t,a),d=l.meterInMercatorCoordinateUnits(),p=o.bj();return o.O(p,p,[l.x,l.y,l.z]),o.bg(p,p,Math.PI),o.bh(p,p,Math.PI/2),o.Q(p,p,[-d,d,d]),p}getProjectionDataForCustomLayer(t=!0){const a=new o.a2(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:t}),d=Vt(a,this.worldSize);o.S(d,this._viewProjMatrix,d),l.tileMercatorCoords=[0,0,1,1];const p=[o.a5,o.a5,this.worldSize/this._helper.pixelsPerMeter],g=o.bk();return o.Q(g,d,p),l.fallbackMatrix=g,l.mainMatrix=g,l}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function da(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function nl(f){if(f.useSlerp)if(f.k<1){const t=o.bl(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),a=o.bl(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);o.bm(l,t,a,f.k);const d=o.bn(l);f.tr.setRoll(d.roll),f.tr.setPitch(d.pitch),f.tr.setBearing(d.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(o.G.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(o.G.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(o.G.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function Qo(f,t,a,l,d){const p=d.padding,g=dt(d.worldSize,a.getNorthWest()),b=dt(d.worldSize,a.getNorthEast()),S=dt(d.worldSize,a.getSouthEast()),M=dt(d.worldSize,a.getSouthWest()),z=o.ap(-l),F=g.rotate(z),j=b.rotate(z),V=S.rotate(z),Z=M.rotate(z),Q=new o.P(Math.max(F.x,j.x,Z.x,V.x),Math.max(F.y,j.y,Z.y,V.y)),te=new o.P(Math.min(F.x,j.x,Z.x,V.x),Math.min(F.y,j.y,Z.y,V.y)),ee=Q.sub(te),ae=(d.width-(p.left+p.right+t.left+t.right))/ee.x,he=(d.height-(p.top+p.bottom+t.top+t.bottom))/ee.y;if(he<0||ae<0)return void da();const ie=Math.min(o.at(d.scale*Math.min(ae,he)),f.maxZoom),ue=o.P.convert(f.offset),_e=new o.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(o.ap(l)),se=ue.add(_e).mult(d.scale/o.aq(ie));return{center:gt(d.worldSize,g.add(S).div(2).sub(se)),zoom:ie,bearing:l}}class It{get useGlobeControls(){return!1}handlePanInertia(t,a){const l=t.mag(),d=Math.abs(Ht(a));return{easingOffset:t.mult(Math.min(.75*d/l,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(t,a){t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta),t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta)}handleMapControlsPan(t,a,l){t.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(l,t.around)}cameraForBoxAndBearing(t,a,l,d,p){return Qo(t,a,l,d,p)}handleJumpToCenterZoom(t,a){t.zoom!==(a.zoom!==void 0?+a.zoom:t.zoom)&&t.setZoom(+a.zoom),a.center!==void 0&&t.setCenter(o.V.convert(a.center))}handleEaseTo(t,a){const l=t.zoom,d=t.padding,p={roll:t.roll,pitch:t.pitch,bearing:t.bearing},g={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},b=a.zoom!==void 0,S=!t.isPaddingEqual(a.padding);let M=!1;const z=b?+a.zoom:t.zoom;let F=t.centerPoint.add(a.offsetAsPoint);const j=t.screenPointToLocation(F),{center:V,zoom:Z}=t.applyConstrain(o.V.convert(a.center||j),z??l);ea(t,V);const Q=dt(t.worldSize,j),te=dt(t.worldSize,V).sub(Q),ee=o.aq(Z-l);return M=Z!==l,{easeFunc:ae=>{if(M&&t.setZoom(o.G.number(l,Z,ae)),o.bo(p,g)||nl({startEulerAngles:p,endEulerAngles:g,tr:t,k:ae,useSlerp:p.roll!=g.roll}),S&&(t.interpolatePadding(d,a.padding,ae),F=t.centerPoint.add(a.offsetAsPoint)),a.around)t.setLocationAtPoint(a.around,a.aroundPoint);else{const he=o.aq(t.zoom-l),ie=Z>l?Math.min(2,ee):Math.max(.5,ee),ue=Math.pow(ie,1-ae),_e=gt(t.worldSize,Q.add(te.mult(ae*ue)).mult(he));t.setLocationAtPoint(t.renderWorldCopies?_e.wrap():_e,F)}},isZooming:M,elevationCenter:V}}handleFlyTo(t,a){const l=a.zoom!==void 0,d=t.zoom,p=t.applyConstrain(o.V.convert(a.center||a.locationAtOffset),l?+a.zoom:d),g=p.center,b=p.zoom;ea(t,g);const S=dt(t.worldSize,a.locationAtOffset),M=dt(t.worldSize,g).sub(S),z=M.mag(),F=o.aq(b-d);let j;if(a.minZoom!==void 0){const V=Math.min(+a.minZoom,d,b),Z=t.applyConstrain(g,V).zoom;j=o.aq(Z-d)}return{easeFunc:(V,Z,Q,te)=>{t.setZoom(V===1?b:d+o.at(Z));const ee=V===1?g:gt(t.worldSize,S.add(M.mult(Q)).mult(Z));t.setLocationAtPoint(t.renderWorldCopies?ee.wrap():ee,te)},scaleOfZoom:F,targetCenter:g,scaleOfMinZoom:j,pixelPathLength:z}}}class ri{constructor(t,a,l){this.blendFunction=t,this.blendColor=a,this.mask=l}}ri.Replace=[1,0],ri.disabled=new ri(ri.Replace,o.bp.transparent,[!1,!1,!1,!1]),ri.unblended=new ri(ri.Replace,o.bp.transparent,[!0,!0,!0,!0]),ri.alphaBlended=new ri([1,771],o.bp.transparent,[!0,!0,!0,!0]);const fn=2305;class zt{constructor(t,a,l){this.enable=t,this.mode=a,this.frontFace=l}}zt.disabled=new zt(!1,1029,fn),zt.backCCW=new zt(!0,1029,fn),zt.frontCCW=new zt(!0,1028,fn);class St{constructor(t,a,l){this.func=t,this.mask=a,this.range=l}}St.ReadOnly=!1,St.ReadWrite=!0,St.disabled=new St(519,St.ReadOnly,[0,1]);const Hr=7680;class jt{constructor(t,a,l,d,p,g){this.test=t,this.ref=a,this.mask=l,this.fail=d,this.depthFail=p,this.pass=g}}jt.disabled=new jt({func:519,mask:0},0,0,Hr,Hr,Hr);const Mo=new WeakMap;function Zn(f){var t;if(Mo.has(f))return Mo.get(f);{const a=(t=f.getParameter(f.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Mo.set(f,a),a}}class Wr{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const a=t.context,l=a.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const d=new o.aW;d.emplaceBack(-1,-1),d.emplaceBack(2,-1),d.emplaceBack(-1,2);const p=new o.aY;p.emplaceBack(0,1,2),this._fullscreenTriangle=new Jt(a.createVertexBuffer(d,wa.members),a.createIndexBuffer(p),o.aX.simpleSegment(0,0,d.length,p.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(l.TEXTURE1);const g=l.createTexture();l.bindTexture(l.TEXTURE_2D,g),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(g),Zn(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,a){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,a=t.gl;t.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,a){const l=this._cachedRenderContext.context,d=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:o.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,d.TRIANGLES,St.disabled,jt.disabled,ri.unblended,zt.disabled,((p,g)=>({u_input:p,u_output_expected:g}))(t,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Zn(d)){d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.readBuffer(d.COLOR_ATTACHMENT0),d.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),d.bindBuffer(d.PIXEL_PACK_BUFFER,null);const p=d.fenceSync(d.SYNC_GPU_COMMANDS_COMPLETE,0);d.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:p}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Zn(t)){const a=t.clientWaitSync(this._readbackQueue.sync,0,0);if(a===t.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Wr._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let a=0;return a+=t[0]/256,a+=t[1]/65536,a+=t[2]/16777216,t[3]<127&&(a=-a),a/128}}const or=o.a5/128;function es(f,t){const a=f.granularity!==void 0?Math.max(f.granularity,1):1,l=a+(f.generateBorders?2:0),d=a+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),p=l+1,g=d+1,b=f.generateBorders?-1:0,S=f.generateBorders||f.extendToNorthPole?-1:0,M=a+(f.generateBorders?1:0),z=a+(f.generateBorders||f.extendToSouthPole?1:0),F=p*g,j=l*d*6,V=p*g>65536;if(V&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Z=V||t==="32bit",Q=new Int16Array(2*F);let te=0;for(let he=S;he<=z;he++)for(let ie=b;ie<=M;ie++){let ue=ie/a*o.a5;ie===-1&&(ue=-or),ie===a+1&&(ue=o.a5+or);let _e=he/a*o.a5;he===-1&&(_e=f.extendToNorthPole?o.br:-or),he===a+1&&(_e=f.extendToSouthPole?o.bs:o.a5+or),Q[te++]=ue,Q[te++]=_e}const ee=Z?new Uint32Array(j):new Uint16Array(j);let ae=0;for(let he=0;he<d;he++)for(let ie=0;ie<l;ie++){const ue=ie+1+he*p,_e=ie+(he+1)*p,se=ie+1+(he+1)*p;ee[ae++]=ie+he*p,ee[ae++]=_e,ee[ae++]=ue,ee[ae++]=ue,ee[ae++]=_e,ee[ae++]=se}return{vertices:Q.buffer.slice(0),indices:ee.buffer.slice(0),uses32bitIndices:Z}}const Co=new o.aV({fill:new o.bt(128,2),line:new o.bt(512,0),tile:new o.bt(128,32),stencil:new o.bt(128,1),circle:3});class ta{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return qt.projectionGlobe}get vertexShaderPreludeCode(){return qt.projectionMercator.vertexSource}get subdivisionGranularity(){return Co}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Wr(t));const a=o.X(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,d=this._errorMeasurement.updateErrorLoop(a,l),p=Pe();d!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=d,this._errorMeasurementLastChangeTime=p);const g=Math.min(Math.max((p-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bv(g))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,a,l,d,p){const g=(p==="stencil"?Co.stencil:Co.tile).getGranularityForZoomLevel(a.z);return this._getMesh(t,{granularity:g,generateBorders:l,extendToNorthPole:a.y===0&&d,extendToSouthPole:a.y===(1<<a.z)-1&&d})}_getMesh(t,a){const l=this._getMeshKey(a);if(l in this._tileMeshCache)return this._tileMeshCache[l];const d=(function(p,g){const b=es(g,"16bit"),S=o.aW.deserialize({arrayBuffer:b.vertices,length:b.vertices.byteLength/2/2}),M=o.aY.deserialize({arrayBuffer:b.indices,length:b.indices.byteLength/2/3});return new Jt(p.createVertexBuffer(S,wa.members),p.createIndexBuffer(M),o.aX.simpleSegment(0,0,S.length,M.length))})(t,a);return this._tileMeshCache[l]=d,d}recalculate(t){}hasTransition(){const t=Pe();let a=!1;return a=a||(t-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const iu=new o.t({type:new o.D(o.u.projection.type)});class Ss extends o.E{constructor(t){super(),this._transitionable=new o.x(iu,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0)),this._mercatorProjection=new ji,this._verticalPerspectiveProjection=new ta}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof o.bw){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,a,l,d,p){return this.currentProjection.getMeshFromTileID(t,a,l,d,p)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Ci(f){const t=Fa(f.worldSize,f.center.lat);return 2*Math.PI*t}function ha(f,t,a,l,d){const p=1/(1<<d),g=t/o.a5*p+l*p,b=o.by((f/o.a5*p+a*p)*Math.PI*2+Math.PI,2*Math.PI),S=2*Math.atan(Math.exp(Math.PI-g*Math.PI*2))-.5*Math.PI,M=Math.cos(S),z=new Float64Array(3);return z[0]=Math.sin(b)*M,z[1]=Math.sin(S),z[2]=Math.cos(b)*M,z}function si(f){return(function(t,a){const l=Math.cos(a),d=new Float64Array(3);return d[0]=Math.sin(t)*l,d[1]=Math.sin(a),d[2]=Math.cos(t)*l,d})(f.lng*Math.PI/180,f.lat*Math.PI/180)}function Fa(f,t){return f/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Ts(f){const t=Math.asin(f[1])/Math.PI*180,a=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(a>1e-6){const l=f[0]/a,d=Math.acos(f[2]/a),p=(l>0?d:-d)/Math.PI*180;return new o.V(o.W(p,-180,180),t)}return new o.V(0,t)}function Kr(f){return Math.cos(f*Math.PI/180)}function pi(f,t){const a=Kr(f),l=Kr(t);return o.at(l/a)}function al(f,t){const a=f.rotate(t.bearingInRadians),l=t.zoom+pi(t.center.lat,0),d=o.bu(1/Kr(t.center.lat),1/Kr(Math.min(Math.abs(t.center.lat),60)),o.bx(l,7,3,0,1)),p=360/Ci({worldSize:t.worldSize,center:{lat:t.center.lat}});return new o.V(t.center.lng-a.x*p*d,o.an(t.center.lat+a.y*p,-o.ao,o.ao))}function Ps(f){const t=.5*f,a=Math.sin(t),l=Math.cos(t);return Math.log(a+l)-Math.log(l-a)}function ts(f,t,a,l){const d=f.lat+a*l;if(Math.abs(a)>1){const p=(Math.sign(f.lat+a)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,g=Math.abs(f.lat+a)*Math.PI/180,b=Ps(p+l*(g-p)),S=Ps(p),M=Ps(g);return new o.V(f.lng+t*((b-S)/(M-S)),d)}return new o.V(f.lng+t*l,d)}class nu{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,a,l,d){const p=`${t.z}_${t.x}_${t.y}_${d?.terrain?"t":""}`,g=this._cache.get(p);if(g)return g;const b=this._cachePrevious.get(p);if(b)return this._cache.set(p,b),b;const S=this._boundingVolumeFactory(t,a,l,d);return this._cache.set(p,S),this._hadAnyChanges=!0,S}}class kr{constructor(t,a,l,d){this.min=l,this.max=d,this.points=t,this.planes=a}static fromAabb(t,a){const l=[];for(let d=0;d<8;d++)l.push([1&~d?t[0]:a[0],(d>>1&1)==1?a[1]:t[1],(d>>2&1)==1?a[2]:t[2]]);return new kr(l,[[-1,0,0,a[0]],[1,0,0,-t[0]],[0,-1,0,a[1]],[0,1,0,-t[1]],[0,0,-1,a[2]],[0,0,1,-t[2]]],t,a)}static fromCenterSizeAngles(t,a,l){const d=o.bB([],l[0],l[1],l[2]),p=o.bC([],[a[0],0,0],d),g=o.bC([],[0,a[1],0],d),b=o.bC([],[0,0,a[2]],d),S=[...t],M=[...t];for(let F=0;F<8;F++)for(let j=0;j<3;j++){const V=t[j]+p[j]*(1&~F?-1:1)+g[j]*((F>>1&1)==1?1:-1)+b[j]*((F>>2&1)==1?1:-1);S[j]=Math.min(S[j],V),M[j]=Math.max(M[j],V)}const z=[];for(let F=0;F<8;F++){const j=[...t];o.b0(j,j,o.a$([],p,1&~F?-1:1)),o.b0(j,j,o.a$([],g,(F>>1&1)==1?1:-1)),o.b0(j,j,o.a$([],b,(F>>2&1)==1?1:-1)),z.push(j)}return new kr(z,[[...p,-o.b5(p,z[0])],[...g,-o.b5(g,z[0])],[...b,-o.b5(b,z[0])],[-p[0],-p[1],-p[2],-o.b5(p,z[7])],[-g[0],-g[1],-g[2],-o.b5(g,z[7])],[-b[0],-b[1],-b[2],-o.b5(b,z[7])]],S,M)}intersectsFrustum(t){let a=!0;const l=this.points.length,d=this.planes.length,p=t.planes.length,g=t.points.length;for(let b=0;b<p;b++){const S=t.planes[b];let M=0;for(let z=0;z<l;z++){const F=this.points[z];S[0]*F[0]+S[1]*F[1]+S[2]*F[2]+S[3]>=0&&M++}if(M===0)return 0;M<l&&(a=!1)}if(a)return 2;for(let b=0;b<d;b++){const S=this.planes[b];let M=0;for(let z=0;z<g;z++){const F=t.points[z];S[0]*F[0]+S[1]*F[1]+S[2]*F[2]+S[3]>=0&&M++}if(M===0)return 0}return 1}intersectsPlane(t){const a=this.points.length;let l=0;for(let d=0;d<a;d++){const p=this.points[d];t[0]*p[0]+t[1]*p[1]+t[2]*p[2]+t[3]>=0&&l++}return l===a?2:l===0?0:1}}function Eo(f,t,a){const l=f-t;return l<0?-l:Math.max(0,l-a)}function Ba(f,t,a,l,d){const p=f-a;let g;return g=p<0?Math.min(-p,1+p-d):p>1?Math.min(Math.max(p-d,0),1-p):0,Math.max(g,Eo(t,l,d))}class Oa{constructor(){this._boundingVolumeCache=new nu(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,a,l,d){const p=1<<l.z,g=1/p,b=l.x/p,S=l.y/p;let M=2;return M=Math.min(M,Ba(t,a,b,S,g)),M=Math.min(M,Ba(t,a,b+.5,-S-g,g)),M=Math.min(M,Ba(t,a,b+.5,2-S-g,g)),M}getWrap(t,a,l){const d=1<<a.z,p=1/d,g=a.x/d,b=Eo(t.x,g,p),S=Eo(t.x,g-1,p),M=Eo(t.x,g+1,p),z=Math.min(b,S,M);return z===M?1:z===S?-1:0}allowVariableZoom(t,a){return ii(t,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,a,l,d){return this._boundingVolumeCache.getTileBoundingVolume(t,a,l,d)}_computeTileBoundingVolume(t,a,l,d){var p,g;let b=0,S=0;if(d?.terrain){const M=new o.a2(t.z,a,t.z,t.x,t.y),z=d.terrain.getMinMaxElevation(M);b=(p=z.minElevation)!==null&&p!==void 0?p:Math.min(0,l),S=(g=z.maxElevation)!==null&&g!==void 0?g:Math.max(0,l)}if(b/=o.bE,S/=o.bE,b+=1,S+=1,t.z<=0)return kr.fromAabb([-S,-S,-S],[S,S,S]);if(t.z===1)return kr.fromAabb([t.x===0?-S:0,t.y===0?0:-S,-S],[t.x===0?0:S,t.y===0?S:0,S]);{const M=[ha(0,0,t.x,t.y,t.z),ha(o.a5,0,t.x,t.y,t.z),ha(o.a5,o.a5,t.x,t.y,t.z),ha(0,o.a5,t.x,t.y,t.z)],z=[];for(const Le of M)z.push(o.a$([],Le,S));if(S!==b)for(const Le of M)z.push(o.a$([],Le,b));t.y===0&&z.push([0,1,0]),t.y===(1<<t.z)-1&&z.push([0,-1,0]);const F=[1,1,1],j=[-1,-1,-1];for(const Le of z)for(let Ce=0;Ce<3;Ce++)F[Ce]=Math.min(F[Ce],Le[Ce]),j[Ce]=Math.max(j[Ce],Le[Ce]);const V=ha(o.a5/2,o.a5/2,t.x,t.y,t.z),Z=o.b4([],[0,1,0],V);o.b3(Z,Z);const Q=o.b4([],V,Z);o.b3(Q,Q);const te=o.b4([],M[2],M[1]);o.b3(te,te);const ee=o.b4([],M[0],M[3]);o.b3(ee,ee),z.push(o.a$([],V,S)),t.y>=(1<<t.z)/2&&z.push(o.a$([],ha(o.a5/2,0,t.x,t.y,t.z),S)),t.y<(1<<t.z)/2&&z.push(o.a$([],ha(o.a5/2,o.a5,t.x,t.y,t.z),S));const ae=zo(V,z),he=zo(Q,z),ie=[-V[0],-V[1],-V[2],ae.max],ue=[V[0],V[1],V[2],-ae.min],_e=[-Q[0],-Q[1],-Q[2],he.max],se=[Q[0],Q[1],Q[2],-he.min],ye=[...te,0],Ie=[...ee,0],Te=[];return t.y===0?Te.push(o.bD(Ie,ye,ie),o.bD(Ie,ye,ue)):Te.push(o.bD(_e,ye,ie),o.bD(_e,ye,ue),o.bD(_e,Ie,ie),o.bD(_e,Ie,ue)),t.y===(1<<t.z)-1?Te.push(o.bD(Ie,ye,ie),o.bD(Ie,ye,ue)):Te.push(o.bD(se,ye,ie),o.bD(se,ye,ue),o.bD(se,Ie,ie),o.bD(se,Ie,ue)),new kr(Te,[ie,ue,_e,se,ye,Ie],F,j)}}}function zo(f,t){let a=1/0,l=-1/0;for(const d of t){const p=o.b5(f,d);a=Math.min(a,p),l=Math.max(l,p)}return{min:a,max:l}}class ba{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a){this._helper.resize(t,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(t){this._cachedClippingPlane=o.bF(),this._projectionMatrix=o.bj(),this._globeViewProjMatrix32f=o.bi(),this._globeViewProjMatrixNoCorrection=o.bj(),this._globeViewProjMatrixNoCorrectionInverted=o.bj(),this._globeProjMatrixInverted=o.bj(),this._cameraPosition=o.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(a,l)=>{const d=o.an(a.lat,-o.ao,o.ao),p=o.an(+l,this.minZoom+pi(0,d),this.maxZoom);return{center:new o.V(a.lng,d),zoom:p}},this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new qn({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._coveringTilesDetailsProvider=new Oa}clone(){const t=new ba;return t.apply(this),t}apply(t,a){this._globeLatitudeErrorCorrectionRadians=a||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=o.bz();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:a,applyGlobeMatrix:l}=t,d=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:d,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const a=this.pitchInRadians,l=this.cameraToCenterDistance/t,d=Math.sin(a)*l,p=Math.cos(a)*l+1,g=1/Math.sqrt(d*d+p*p)*1;let b=-d,S=p;const M=Math.sqrt(b*b+S*S);b/=M,S/=M;const z=[0,b,S];o.bG(z,z,[0,0,0],-this.bearingInRadians),o.bH(z,z,[0,0,0],-1*this.center.lat*Math.PI/180),o.bI(z,z,[0,0,0],this.center.lng*Math.PI/180);const F=1/o.b7(z);return o.a$(z,z,F),[...z,-g*F]}isLocationOccluded(t){return!this.isSurfacePointVisible(si(t))}transformLightDirection(t){const a=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,d=Math.cos(l),p=[Math.sin(a)*d,Math.sin(l),Math.cos(a)*d],g=[p[2],0,-p[0]],b=[0,0,0];o.b4(b,g,p),o.b3(g,g),o.b3(b,b);const S=[0,0,0];return o.b3(S,[g[0]*t[0]+b[0]*t[1]+p[0]*t[2],g[1]*t[0]+b[1]*t[1]+p[1]*t[2],g[2]*t[0]+b[2]*t[1]+p[2]*t[2]]),S}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,a,l){const d=(function(b,S,M){const z=1/(1<<M.z);return new o.a9(b/o.a5*z+M.x*z,S/o.a5*z+M.y*z)})(t,a,l.canonical),p=(g=d.y,[o.by(d.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-g*Math.PI*2))-.5*Math.PI]);var g;return this.getCircleRadiusCorrection()/Math.cos(p[1])}projectTileCoordinates(t,a,l,d){const p=l.canonical,g=ha(t,a,p.x,p.y,p.z),b=1+(d?d(t,a):0)/o.bE,S=[g[0]*b,g[1]*b,g[2]*b,1];o.aH(S,S,this._globeViewProjMatrixNoCorrection);const M=this._cachedClippingPlane,z=M[0]*g[0]+M[1]*g[1]+M[2]*g[2]+M[3]<0;return{point:new o.P(S[0]/S[3],S[1]/S[3]),signedDistanceFromCamera:S[3],isOccluded:z}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Fa(this.worldSize,this.center.lat),a=o.bk(),l=o.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),o.be(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const d=this.centerOffset;a[8]=2*-d.x/this._helper._width,a[9]=2*d.y/this._helper._height,this._projectionMatrix=o.bf(a),this._globeProjMatrixInverted=o.bk(),o.aB(this._globeProjMatrixInverted,a),o.O(a,a,[0,0,-this.cameraToCenterDistance]),o.bg(a,a,this.rollInRadians),o.bh(a,a,-this.pitchInRadians),o.bg(a,a,this.bearingInRadians),o.O(a,a,[0,0,-t]);const p=o.bz();p[0]=t,p[1]=t,p[2]=t,o.bh(l,a,this.center.lat*Math.PI/180),o.bJ(l,l,-this.center.lng*Math.PI/180),o.Q(l,l,p),this._globeViewProjMatrixNoCorrection=l,o.bh(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bJ(a,a,-this.center.lng*Math.PI/180),o.Q(a,a,p),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=o.bk(),o.aB(this._globeViewProjMatrixNoCorrectionInverted,l);const g=o.bz();this._cameraPosition=o.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/t,o.bG(this._cameraPosition,this._cameraPosition,g,-this.rollInRadians),o.bH(this._cameraPosition,this._cameraPosition,g,this.pitchInRadians),o.bG(this._cameraPosition,this._cameraPosition,g,-this.bearingInRadians),o.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bH(this._cameraPosition,this._cameraPosition,g,-this.center.lat*Math.PI/180),o.bI(this._cameraPosition,this._cameraPosition,g,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const b=o.bf(this._globeViewProjMatrixNoCorrectionInverted);o.Q(b,b,[1,1,-1]),this._cachedFrustum=jn.fromInvProjectionMatrix(b,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){o.w("calculateFogMatrix is not supported on globe projection.");const a=o.bk();return o.ar(a),a}getVisibleUnwrappedCoordinates(t){return[new o.bc(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=si(t);o.a$(l,l,1+a/o.bE);const d=o.bF();return o.aH(d,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),d[2]/d[3]}populateCache(t){}getBounds(){const t=.5*this.width,a=.5*this.height,l=[new o.P(0,0),new o.P(t,0),new o.P(this.width,0),new o.P(this.width,a),new o.P(this.width,this.height),new o.P(t,this.height),new o.P(0,this.height),new o.P(0,a)],d=[];for(const F of l)d.push(this.unprojectScreenPoint(F));let p=0,g=0,b=0,S=0;const M=this.center;for(const F of d){const j=o.bK(M.lng,F.lng),V=o.bK(M.lat,F.lat);j<g&&(g=j),j>p&&(p=j),V<S&&(S=V),V>b&&(b=V)}const z=[M.lng+g,M.lat+S,M.lng+p,M.lat+b];return this.isSurfacePointOnScreen([0,1,0])&&(z[3]=90,z[0]=-180,z[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(z[1]=-90,z[0]=-180,z[2]=180),new hi(z)}calculateCenterFromCameraLngLatAlt(t,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,d)}setLocationAtPoint(t,a){const l=si(this.unprojectScreenPoint(a)),d=si(t),p=o.bz();o.bL(p);const g=o.bz();o.bI(g,l,p,-this.center.lng*Math.PI/180),o.bH(g,g,p,this.center.lat*Math.PI/180);const b=d[0]*d[0]+d[2]*d[2],S=g[0]*g[0];if(b<S)return;const M=Math.sqrt(b-S),z=-M,F=o.bM(d[0],d[2],g[0],M),j=o.bM(d[0],d[2],g[0],z),V=o.bz();o.bI(V,d,p,-F);const Z=o.bM(V[1],V[2],g[1],g[2]),Q=o.bz();o.bI(Q,d,p,-j);const te=o.bM(Q[1],Q[2],g[1],g[2]),ee=.5*Math.PI,ae=Z>=-ee&&Z<=ee,he=te>=-ee&&te<=ee;let ie,ue;if(ae&&he){const Ie=this.center.lng*Math.PI/180,Te=this.center.lat*Math.PI/180;o.bN(F,Ie)+o.bN(Z,Te)<o.bN(j,Ie)+o.bN(te,Te)?(ie=F,ue=Z):(ie=j,ue=te)}else if(ae)ie=F,ue=Z;else{if(!he)return;ie=j,ue=te}const _e=ie/Math.PI*180,se=ue/Math.PI*180,ye=this.center.lat;this.setCenter(new o.V(_e,o.an(se,-90,90))),this.setZoom(this.zoom+pi(ye,this.center.lat))}locationToScreenPoint(t,a){const l=si(t);if(a){const d=a.getElevationForLngLatZoom(t,this._helper._tileZoom);o.a$(l,l,1+d/o.bE)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(t){const a=o.bF();return o.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new o.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,a){if(a){const l=a.pointCoordinate(t);if(l)return l}return o.a9.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,a){var l;return(l=this.screenPointToMercatorCoordinate(t,a))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(t,a){const l=this._cameraPosition,d=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(l,d)}getRayDirectionFromPixel(t){const a=o.bF();a[0]=t.x/this.width*2-1,a[1]=-1*(t.y/this.height*2-1),a[2]=1,a[3]=1,o.aH(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const l=o.bz();l[0]=a[0]-this._cameraPosition[0],l[1]=a[1]-this._cameraPosition[1],l[2]=a[2]-this._cameraPosition[2];const d=o.bz();return o.b3(d,l),d}isSurfacePointVisible(t){const a=this._cachedClippingPlane;return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const a=o.bF();return o.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(t,a){const l=o.b5(t,a),d=o.bz(),p=o.bz();o.a$(p,a,l),o.b2(d,t,p);const g=1-o.b5(d,d);if(g<0)return null;const b=o.b5(t,t)-1,S=-l+(l<0?1:-1)*Math.sqrt(g),M=b/S,z=S;return{tMin:Math.min(M,z),tMax:Math.max(M,z)}}unprojectScreenPoint(t){const a=this._cameraPosition,l=this.getRayDirectionFromPixel(t),d=this.rayPlanetIntersection(a,l);if(d){const z=o.bz();o.b0(z,a,[l[0]*d.tMin,l[1]*d.tMin,l[2]*d.tMin]);const F=o.bz();return o.b3(F,z),Ts(F)}const p=this._cachedClippingPlane,g=p[0]*l[0]+p[1]*l[1]+p[2]*l[2],b=-o.bb(p,a)/g,S=o.bz();if(b>0)o.b0(S,a,[l[0]*b,l[1]*b,l[2]*b]);else{const z=o.bz();o.b0(z,a,[2*l[0],2*l[1],2*l[2]]);const F=o.bb(this._cachedClippingPlane,z);o.b2(S,z,[this._cachedClippingPlane[0]*F,this._cachedClippingPlane[1]*F,this._cachedClippingPlane[2]*F])}const M=(function(z){const F=o.bz();return F[0]=z[0]*-z[3],F[1]=z[1]*-z[3],F[2]=z[2]*-z[3],{center:F,radius:Math.sqrt(1-z[3]*z[3])}})(p);return Ts((function(z,F,j){const V=o.bz();o.b2(V,j,z);const Z=o.bz();return o.bA(Z,z,V,F/o.b9(V)),Z})(M.center,M.radius,S))}getMatrixForModel(t,a){const l=o.V.convert(t),d=1/o.bE,p=o.bj();return o.bJ(p,p,l.lng/180*Math.PI),o.bh(p,p,-l.lat/180*Math.PI),o.O(p,p,[0,0,1+a/o.bE]),o.bh(p,p,.5*Math.PI),o.Q(p,p,[d,d,d]),p}getProjectionDataForCustomLayer(t=!0){const a=this.getProjectionData({overscaledTileID:new o.a2(0,0,0,0,0),applyGlobeMatrix:t});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(t){}}class sn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,l=!0){this._helper.resize(t,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,a){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(t){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(a,l)=>this.currentTransform.defaultConstrain(a,l),this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new qn({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._globeness=1,this._mercatorTransform=new rr,this._verticalPerspectiveTransform=new ba}clone(){const t=new sn;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const a=this._mercatorTransform.getProjectionData(t),l=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:a.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return o.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,a,l){const d=this._mercatorTransform.getPitchedTextCorrection(t,a,l),p=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,a,l);return o.bu(d,p,this._globeness)}projectTileCoordinates(t,a,l,d){return this.currentTransform.projectTileCoordinates(t,a,l,d)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){return this.currentTransform.lngLatToCameraDepth(t,a)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(t,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,d)}setLocationAtPoint(t,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,a),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,a),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,a){return this.currentTransform.locationToScreenPoint(t,a)}screenPointToMercatorCoordinate(t,a){return this.currentTransform.screenPointToMercatorCoordinate(t,a)}screenPointToLocation(t,a){return this.currentTransform.screenPointToLocation(t,a)}isPointOnMapSurface(t,a){return this.currentTransform.isPointOnMapSurface(t,a)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,a){return this.currentTransform.getMatrixForModel(t,a)}getProjectionDataForCustomLayer(t=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return a;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return l.fallbackMatrix=a.mainMatrix,l}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Fi{get useGlobeControls(){return!0}handlePanInertia(t,a){const l=al(t,a);return Math.abs(l.lng-a.center.lng)>180&&(l.lng=a.center.lng+179.5*Math.sign(l.lng-a.center.lng)),{easingCenter:l,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,a){const l=t.around,d=a.screenPointToLocation(l);t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta);const p=a.zoom;t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta);const g=a.zoom-p;if(g===0)return;const b=o.bK(a.center.lng,d.lng),S=b/(Math.abs(b/180)+1),M=o.bK(a.center.lat,d.lat),z=a.getRayDirectionFromPixel(l),F=a.cameraPosition,j=-1*o.b5(F,z),V=o.bz();o.b0(V,F,[z[0]*j,z[1]*j,z[2]*j]);const Z=o.b7(V)-1,Q=Math.exp(.5*-Math.max(Z-.3,0)),te=Fa(a.worldSize,a.center.lat)/Math.min(a.width,a.height),ee=o.bx(te,.9,.5,1,.25),ae=(1-o.aq(-g))*Math.min(Q,ee),he=a.center.lat,ie=a.zoom,ue=new o.V(a.center.lng+S*ae,o.an(a.center.lat+M*ae,-o.ao,o.ao));a.setLocationAtPoint(d,l);const _e=a.center,se=o.bx(Math.abs(b),45,85,0,1),ye=o.bx(te,.75,.35,0,1),Ie=Math.pow(Math.max(se,ye),.25),Te=o.bK(_e.lng,ue.lng),Le=o.bK(_e.lat,ue.lat);a.setCenter(new o.V(_e.lng+Te*Ie,_e.lat+Le*Ie).wrap()),a.setZoom(ie+pi(he,a.center.lat))}handleMapControlsPan(t,a,l){if(!t.panDelta)return;const d=a.center.lat,p=a.zoom;a.setCenter(al(t.panDelta,a).wrap()),a.setZoom(p+pi(d,a.center.lat))}cameraForBoxAndBearing(t,a,l,d,p){const g=Qo(t,a,l,d,p),b=a.left/p.width*2-1,S=(p.width-a.right)/p.width*2-1,M=a.top/p.height*-2+1,z=(p.height-a.bottom)/p.height*-2+1,F=o.bK(l.getWest(),l.getEast())<0,j=F?l.getEast():l.getWest(),V=F?l.getWest():l.getEast(),Z=Math.max(l.getNorth(),l.getSouth()),Q=Math.min(l.getNorth(),l.getSouth()),te=j+.5*o.bK(j,V),ee=Z+.5*o.bK(Z,Q),ae=p.clone();ae.setCenter(g.center),ae.setBearing(g.bearing),ae.setPitch(0),ae.setRoll(0),ae.setZoom(g.zoom);const he=ae.modelViewProjectionMatrix,ie=[si(l.getNorthWest()),si(l.getNorthEast()),si(l.getSouthWest()),si(l.getSouthEast()),si(new o.V(V,ee)),si(new o.V(j,ee)),si(new o.V(te,Z)),si(new o.V(te,Q))],ue=si(g.center);let _e=Number.POSITIVE_INFINITY;for(const se of ie)b<0&&(_e=Fi.getLesserNonNegativeNonNull(_e,Fi.solveVectorScale(se,ue,he,"x",b))),S>0&&(_e=Fi.getLesserNonNegativeNonNull(_e,Fi.solveVectorScale(se,ue,he,"x",S))),M>0&&(_e=Fi.getLesserNonNegativeNonNull(_e,Fi.solveVectorScale(se,ue,he,"y",M))),z<0&&(_e=Fi.getLesserNonNegativeNonNull(_e,Fi.solveVectorScale(se,ue,he,"y",z)));if(Number.isFinite(_e)&&_e!==0)return g.zoom=ae.zoom+o.at(_e),g;da()}handleJumpToCenterZoom(t,a){const l=t.center.lat,d=t.applyConstrain(a.center?o.V.convert(a.center):t.center,t.zoom).center;t.setCenter(d.wrap());const p=a.zoom!==void 0?+a.zoom:t.zoom+pi(l,d.lat);t.zoom!==p&&t.setZoom(p)}handleEaseTo(t,a){const l=t.zoom,d=t.center,p=t.padding,g={roll:t.roll,pitch:t.pitch,bearing:t.bearing},b={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},S=a.zoom!==void 0,M=!t.isPaddingEqual(a.padding);let z=!1;const F=a.center?o.V.convert(a.center):d,j=t.applyConstrain(F,l).center;ea(t,j);const V=t.clone();V.setCenter(j),V.setZoom(S?+a.zoom:l+pi(d.lat,F.lat)),V.setBearing(a.bearing);const Z=new o.P(o.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),o.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));V.setLocationAtPoint(j,Z);const Q=(a.offset&&a.offsetAsPoint.mag())>0?V.center:j,te=S?+a.zoom:l+pi(d.lat,Q.lat),ee=l+pi(d.lat,0),ae=te+pi(Q.lat,0),he=o.bK(d.lng,Q.lng),ie=o.bK(d.lat,Q.lat),ue=o.aq(ae-ee);return z=te!==l,{easeFunc:_e=>{if(o.bo(g,b)||nl({startEulerAngles:g,endEulerAngles:b,tr:t,k:_e,useSlerp:g.roll!=b.roll}),M&&t.interpolatePadding(p,a.padding,_e),a.around)o.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(a.around,a.aroundPoint);else{const se=ae>ee?Math.min(2,ue):Math.max(.5,ue),ye=Math.pow(se,1-_e),Ie=ts(d,he,ie,_e*ye);t.setCenter(Ie.wrap())}if(z){const se=o.G.number(ee,ae,_e)+pi(0,t.center.lat);t.setZoom(se)}},isZooming:z,elevationCenter:Q}}handleFlyTo(t,a){const l=a.zoom!==void 0,d=t.center,p=t.zoom,g=t.padding,b=!t.isPaddingEqual(a.padding),S=t.applyConstrain(o.V.convert(a.center||a.locationAtOffset),p).center,M=l?+a.zoom:t.zoom+pi(t.center.lat,S.lat),z=t.clone();z.setCenter(S),z.setZoom(M),z.setBearing(a.bearing);const F=new o.P(o.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),o.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));z.setLocationAtPoint(S,F);const j=z.center;ea(t,j);const V=(function(ie,ue,_e){const se=si(ue),ye=si(_e),Ie=o.b5(se,ye),Te=Math.acos(Ie),Le=Ci(ie);return Te/(2*Math.PI)*Le})(t,d,j),Z=p+pi(d.lat,0),Q=M+pi(j.lat,0),te=o.aq(Q-Z);let ee;if(typeof a.minZoom=="number"){const ie=+a.minZoom+pi(j.lat,0),ue=Math.min(ie,Z,Q)+pi(0,j.lat),_e=t.applyConstrain(j,ue).zoom+pi(j.lat,0);ee=o.aq(_e-Z)}const ae=o.bK(d.lng,j.lng),he=o.bK(d.lat,j.lat);return{easeFunc:(ie,ue,_e,se)=>{const ye=ts(d,ae,he,_e);b&&t.interpolatePadding(g,a.padding,ie);const Ie=ie===1?j:ye;t.setCenter(Ie.wrap());const Te=Z+o.at(ue);t.setZoom(ie===1?M:Te+pi(0,Ie.lat))},scaleOfZoom:te,targetCenter:j,scaleOfMinZoom:ee,pixelPathLength:V}}static solveVectorScale(t,a,l,d,p){const g=d==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],b=[l[3],l[7],l[11],l[15]],S=t[0]*g[0]+t[1]*g[1]+t[2]*g[2],M=t[0]*b[0]+t[1]*b[1]+t[2]*b[2],z=a[0]*g[0]+a[1]*g[1]+a[2]*g[2],F=a[0]*b[0]+a[1]*b[1]+a[2]*b[2];return z+p*M===S+p*F||b[3]*(S-z)+g[3]*(F-M)+S*F==z*M?null:(z+g[3]-p*F-p*b[3])/(z-S-p*F+p*M)}static getLesserNonNegativeNonNull(t,a){return a!==null&&a>=0&&a<t?a:t}}class Ls{constructor(t){this._globe=t,this._mercatorCameraHelper=new It,this._verticalPerspectiveCameraHelper=new Fi}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,a){return this.currentHelper.handlePanInertia(t,a)}handleMapControlsRollPitchBearingZoom(t,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,a)}handleMapControlsPan(t,a,l){this.currentHelper.handleMapControlsPan(t,a,l)}cameraForBoxAndBearing(t,a,l,d,p){return this.currentHelper.cameraForBoxAndBearing(t,a,l,d,p)}handleJumpToCenterZoom(t,a){this.currentHelper.handleJumpToCenterZoom(t,a)}handleEaseTo(t,a){return this.currentHelper.handleEaseTo(t,a)}handleFlyTo(t,a){return this.currentHelper.handleFlyTo(t,a)}}const Xr=(f,t)=>o.B(f,t&&t.filter((a=>a.identifier!=="source.canvas"))),Sr=o.bO();class $a extends o.E{constructor(t,a={}){var l,d;super(),this._rtlPluginLoaded=()=>{for(const g in this.tileManagers){const b=this.tileManagers[g].getSource().type;b!=="vector"&&b!=="geojson"||this.tileManagers[g].reload()}},this.map=t,this.dispatcher=new dn(ga(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((g,b)=>this.getGlyphs(g,b))),this.dispatcher.registerMessageHandler("GI",((g,b)=>this.getImages(g,b))),this.dispatcher.registerMessageHandler("GDA",((g,b)=>this.getDashes(g,b))),this.imageManager=new yi,this.imageManager.setEventedParent(this);const p=((l=t._container)===null||l===void 0?void 0:l.lang)||typeof document<"u"&&((d=document.documentElement)===null||d===void 0?void 0:d.lang)||void 0;this.glyphManager=new Hi(t._requestManager,a.localIdeographFontFamily,p),this.lineAtlas=new Ni(256,512),this.crossTileSymbolIndex=new Rn,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",o.bP()),ve().on(fe,this._rtlPluginLoaded),this.on("data",(g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const b=this.tileManagers[g.sourceId];if(!b)return;const S=b.getSource();if(S&&S.vectorLayerIds)for(const M in this._layers){const z=this._layers[M];z.source===S.id&&this._validateLayer(z)}}))}_setInitialValues(){var t;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new o.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((t=this.crossTileSymbolIndex)===null||t===void 0?void 0:t.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(t,a){var l,d,p;this._checkLoaded();const g=a===null?(p=(d=(l=this.stylesheet.state)===null||l===void 0?void 0:l[t])===null||d===void 0?void 0:d.default)!==null&&p!==void 0?p:null:a;if(o.bR(g,this._globalState[t]))return this;this._globalState[t]=g,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const a=[];for(const l in t)!o.bR(this._globalState[l],t[l].default)&&(a.push(l),this._globalState[l]=t[l].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(t){if(t.length===0)return;const a=new Set,l={};for(const d of t){l[d]=this._globalState[d];for(const p in this._layers){const g=this._layers[p],b=g.getLayoutAffectingGlobalStateRefs(),S=g.getPaintAffectingGlobalStateRefs(),M=g.getVisibilityAffectingGlobalStateRefs();if(b.has(d)&&a.add(g.source),S.has(d))for(const{name:z,value:F}of S.get(d))this._updatePaintProperty(g,z,F);M?.has(d)&&(g.recalculateVisibility(),this._updateLayer(g))}}this.dispatcher.broadcast("UGS",l);for(const d in this.tileManagers)a.has(d)&&(this._reloadSource(d),this._changed=!0)}loadURL(t,a={},l){this.fire(new o.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const p=this._loadStyleRequest;o.j(d,this._loadStyleRequest).then((g=>{this._loadStyleRequest=null,this._load(g.data,a,l)})).catch((g=>{this._loadStyleRequest=null,g&&!p.signal.aborted&&this.fire(new o.k(g))}))}loadJSON(t,a={},l){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ce.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,l)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(Sr,{validate:!1})}_load(t,a,l){var d,p;let g=a.transformStyle?a.transformStyle(l,t):t;if(!a.validate||!Xr(this,o.C(g))){g=Object.assign({},g),this._loaded=!0,this.stylesheet=g;for(const b in g.sources)this.addSource(b,g.sources[b],{validate:!1});g.sprite?this._loadSprite(g.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(g.glyphs),this._createLayers(),this.light=new pt(this.stylesheet.light),this._setProjectionInternal(((d=this.stylesheet.projection)===null||d===void 0?void 0:d.type)||"mercator"),this.sky=new Ri(this.stylesheet.sky),this.map.setTerrain((p=this.stylesheet.terrain)!==null&&p!==void 0?p:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var t,a,l;const d=o.bS(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",d),this._order=d.map((p=>p.id)),this._layers={},this._serializedLayers=null;for(const p of d){const g=o.bT(p,this._globalState);if(g.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=g,o.bU(g)&&this.tileManagers[g.source]){const b=(l=(a=p.paint)===null||a===void 0?void 0:a["raster-fade-duration"])!==null&&l!==void 0?l:g.paint.get("raster-fade-duration");this.tileManagers[g.source].setRasterFadeDuration(b)}}}_loadSprite(t,a=!1,l=void 0){this.imageManager.setLoaded(!1);const d=new AbortController;let p;this._spriteRequest=d,(function(g,b,S,M){return o._(this,void 0,void 0,(function*(){const z=En(g),F=S>1?"@2x":"",j={},V={};for(const{id:Z,url:Q}of z){const te=b.transformRequest(zn(Q,F,".json"),"SpriteJSON");j[Z]=o.j(te,M);const ee=b.transformRequest(zn(Q,F,".png"),"SpriteImage");V[Z]=Ot.getImage(ee,M)}return yield Promise.all([...Object.values(j),...Object.values(V)]),(function(Z,Q){return o._(this,void 0,void 0,(function*(){const te={};for(const ee in Z){te[ee]={};const ae=ce.getImageCanvasContext((yield Q[ee]).data),he=(yield Z[ee]).data;for(const ie in he){const{width:ue,height:_e,x:se,y:ye,sdf:Ie,pixelRatio:Te,stretchX:Le,stretchY:Ce,content:Ke,textFitWidth:Xe,textFitHeight:Ue}=he[ie];te[ee][ie]={data:null,pixelRatio:Te,sdf:Ie,stretchX:Le,stretchY:Ce,content:Ke,textFitWidth:Xe,textFitHeight:Ue,spriteData:{width:ue,height:_e,x:se,y:ye,context:ae}}}}return te}))})(j,V)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((g=>{if(this._spriteRequest=null,g)for(const b in g){this._spritesImagesIds[b]=[];const S=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter((M=>!(M in g))):[];for(const M of S)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in g[b]){const z=b==="default"?M:`${b}:${M}`;this._spritesImagesIds[b].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,g[b][M],!1):this.imageManager.addImage(z,g[b][M]),a&&(this._changedImages[z]=!0)}}})).catch((g=>{this._spriteRequest=null,p=g,d.signal.aborted||this.fire(new o.k(p))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),l&&l(p)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(t){const a=this.tileManagers[t.source];if(!a)return;const l=t.sourceLayer;if(!l)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(l)===-1)&&this.fire(new o.k(new Error(`Source layer "${l}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.tileManagers)if(!this.tileManagers[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const l=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?o.bV(l):l);const d=[];for(const p of t)if(l[p]){const g=a?o.bV(l[p]):l[p];d.push(g)}return d}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const l of a){const d=this._layers[l];d.type!=="custom"&&(t[l]=d.serialize())}return t}hasTransitions(){var t,a,l;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const d in this.tileManagers)if(this.tileManagers[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const d=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(d.length||p.length)&&this._updateWorkerLayers(d,p);for(const g in this._updatedSources){const b=this._updatedSources[g];if(b==="reload")this._reloadSource(g);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(g)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const g in this._updatedPaintProps)this._layers[g].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const l={};for(const d in this.tileManagers){const p=this.tileManagers[d];l[d]=p.used,p.used=!1}for(const d of this._order){const p=this._layers[d];p.recalculate(t,this._availableImages),!p.isHidden(t.zoom)&&p.source&&(this.tileManagers[p.source].used=!0)}for(const d in l){const p=this.tileManagers[d];!!l[d]!=!!p.used&&p.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,a&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.tileManagers)this.tileManagers[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var l;this._checkLoaded();const d=this.serialize();if(t=a.transformStyle?a.transformStyle(d,t):t,((l=a.validate)===null||l===void 0||l)&&Xr(this,o.C(t)))return!1;(t=o.bV(t)).layers=o.bS(t.layers);const p=o.bW(d,t),g=this._getOperationsToPerform(p);if(g.unimplemented.length>0)throw new Error(`Unimplemented: ${g.unimplemented.join(", ")}.`);if(g.operations.length===0)return!1;for(const b of g.operations)b();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const a=[],l=[];for(const d of t)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,d.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,d.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,d.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,d.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,d.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,d.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,d.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,d.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,d.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,d.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,d.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,d.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,d.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,d.args)));break;case"setProjection":this.setProjection.apply(this,d.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,d.args)));break;case"setTransition":a.push((()=>{}));break;default:l.push(d.command)}return{operations:a,unimplemented:l}}addImage(t,a){if(this.getImage(t))return this.fire(new o.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new o.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,l={}){if(this._checkLoaded(),this.tileManagers[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(o.C.source,`sources.${t}`,a,null,l))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.tileManagers[t]=new Gn(t,a,this.dispatcher);d.style=this,d.setEventedParent(this,(()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t}))),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===t)return this.fire(new o.k(new Error(`Source "${t}" cannot be removed while layer "${l}" is using it.`)));const a=this.tileManagers[t];delete this.tileManagers[t],delete this._updatedSources[t],a.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const l=this.tileManagers[t].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(a),this._changed=!0}getSource(t){return this.tileManagers[t]&&this.tileManagers[t].getSource()}addLayer(t,a,l={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new o.k(new Error(`Layer "${d}" already exists on this map.`)));let p;if(t.type==="custom"){if(Xr(this,o.bX(t)))return;p=o.bT(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=o.bV(t),t=o.e(t,{source:d})),this._validate(o.C.layer,`layers.${d}`,t,{arrayIndex:-1},l))return;p=o.bT(t,this._globalState),this._validateLayer(p),p.setEventedParent(this,{layer:{id:d}})}const g=a?this._order.indexOf(a):this._order.length;if(a&&g===-1)this.fire(new o.k(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(g,0,d),this._layerOrderChanged=!0,this._layers[d]=p,this._removedLayers[d]&&p.source&&p.type!=="custom"){const b=this._removedLayers[d];delete this._removedLayers[d],b.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",this.tileManagers[p.source].pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new o.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const l=this._order.indexOf(t);this._order.splice(l,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new o.k(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const l=this._order.indexOf(t);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,l){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===a&&d.maxzoom===l||(a!=null&&(d.minzoom=a),l!=null&&(d.maxzoom=l),this._updateLayer(d)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,l={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!o.bR(d.filter,a))return a==null?(d.setFilter(void 0),void this._updateLayer(d)):void(this._validate(o.C.filter,`layers.${d.id}.filter`,a,null,l)||(d.setFilter(o.bV(a)),this._updateLayer(d)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return o.bV(this.getLayer(t).filter)}setLayoutProperty(t,a,l,d={}){this._checkLoaded();const p=this.getLayer(t);p?o.bR(p.getLayoutProperty(a),l)||(p.setLayoutProperty(a,l,d),this._updateLayer(p)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const l=this.getLayer(t);if(l)return l.getLayoutProperty(a);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,l,d={}){this._checkLoaded();const p=this.getLayer(t);p?o.bR(p.getPaintProperty(a),l)||this._updatePaintProperty(p,a,l,d):this.fire(new o.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,a,l,d={}){t.setPaintProperty(a,l,d)&&this._updateLayer(t),o.bU(t)&&a==="raster-fade-duration"&&this.tileManagers[t.source].setRasterFadeDuration(l),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const l=t.source,d=t.sourceLayer,p=this.tileManagers[l];if(p===void 0)return void this.fire(new o.k(new Error(`The source '${l}' does not exist in the map's style.`)));const g=p.getSource().type;g==="geojson"&&d?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):g!=="vector"||d?(t.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),p.setFeatureState(d,t.id,a)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const l=t.source,d=this.tileManagers[l];if(d===void 0)return void this.fire(new o.k(new Error(`The source '${l}' does not exist in the map's style.`)));const p=d.getSource().type,g=p==="vector"?t.sourceLayer:void 0;p!=="vector"||g?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(g,t.id,a):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,l=t.sourceLayer,d=this.tileManagers[a];if(d!==void 0)return d.getSource().type!=="vector"||l?(t.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),d.getFeatureState(l,t.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=o.bY(this.tileManagers,(p=>p.serialize())),a=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,d=this.stylesheet;return o.bZ({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,projection:d.projection,sources:t,layers:a,terrain:l},(p=>p!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.tileManagers[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.tileManagers[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=g=>this._layers[g].type==="fill-extrusion",l={},d=[];for(let g=this._order.length-1;g>=0;g--){const b=this._order[g];if(a(b)){l[b]=g;for(const S of t){const M=S[b];if(M)for(const z of M)d.push(z)}}}d.sort(((g,b)=>b.intersectionZ-g.intersectionZ));const p=[];for(let g=this._order.length-1;g>=0;g--){const b=this._order[g];if(a(b))for(let S=d.length-1;S>=0;S--){const M=d[S].feature;if(l[M.layer.id]<g)break;p.push(M),d.pop()}else for(const S of t){const M=S[b];if(M)for(const z of M)p.push(z.feature)}}return p}queryRenderedFeatures(t,a,l){a&&a.filter&&this._validate(o.C.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const M of a.layers){const z=this._layers[M];if(!z)return this.fire(new o.k(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];d[z.source]=!0}}const p=[];a.availableImages=this._availableImages;const g=this._serializedAllLayers(),b=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,S=Object.assign(Object.assign({},a),{layers:b,globalState:this._globalState});for(const M in this.tileManagers)a.layers&&!d[M]||p.push(pr(this.tileManagers[M],this._layers,g,t,S,l,this.map.terrain?(z,F,j)=>this.map.terrain.getElevation(z,F,j):void 0));return this.placement&&p.push((function(M,z,F,j,V,Z,Q){const te={},ee=Z.queryRenderedSymbols(j),ae=[];for(const he of Object.keys(ee).map(Number))ae.push(Q[he]);ae.sort(Qi);for(const he of ae){const ie=he.featureIndex.lookupSymbolFeatures(ee[he.bucketInstanceId],z,he.bucketIndex,he.sourceLayerIndex,{filterSpec:V.filter,globalState:V.globalState},V.layers,V.availableImages,M);for(const ue in ie){const _e=te[ue]=te[ue]||[],se=ie[ue];se.sort(((ye,Ie)=>{const Te=he.featureSortOrder;if(Te){const Le=Te.indexOf(ye.featureIndex);return Te.indexOf(Ie.featureIndex)-Le}return Ie.featureIndex-ye.featureIndex}));for(const ye of se)_e.push(ye)}}return(function(he,ie,ue){for(const _e in he)for(const se of he[_e])Un(se,ue[ie[_e].source]);return he})(te,M,F)})(this._layers,g,this.tileManagers,t,S,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(t,a){a?.filter&&this._validate(o.C.filter,"querySourceFeatures.filter",a.filter,null,a);const l=this.tileManagers[t];return l?(function(d,p){const g=d.getRenderableIds().map((M=>d.getTileByID(M))),b=[],S={};for(let M=0;M<g.length;M++){const z=g[M],F=z.tileID.canonical.key;S[F]||(S[F]=!0,z.querySourceFeatures(b,p))}return b})(l,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const l=this.light.getLight();let d=!1;for(const g in t)if(!o.bR(t[g],l[g])){d=!0;break}if(!d)return;const p={now:Pe(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(p)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){this._checkLoaded();const l=this.getSky();let d=!1;if(!t&&!l)return;if(t&&!l)d=!0;else if(!t&&l)d=!0;else for(const g in t)if(!o.bR(t[g],l[g])){d=!0;break}if(!d)return;const p={now:Pe(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(p)}_setProjectionInternal(t){const a=(function(l,d){const p={constrainOverride:d};if(Array.isArray(l)){const g=new Ss({type:l});return{projection:g,transform:new sn(p),cameraHelper:new Ls(g)}}switch(l){case"mercator":return{projection:new ji,transform:new rr(p),cameraHelper:new It};case"globe":{const g=new Ss({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:g,transform:new sn(p),cameraHelper:new Ls(g)}}case"vertical-perspective":return{projection:new ta,transform:new ba(p),cameraHelper:new Fi};default:return o.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new ji,transform:new rr(p),cameraHelper:new It}}})(t,this.map.transformConstrain);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const l in this.tileManagers)this.tileManagers[l].reload()}_validate(t,a,l,d,p={}){return(!p||p.validate!==!1)&&Xr(this,t.call(o.C,o.e({key:a,style:this.serialize(),value:l,styleSpec:o.u},d)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ve().off(fe,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.tileManagers){const l=this.tileManagers[a];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.tileManagers[t].clearTiles()}_reloadSource(t){this.tileManagers[t].resume(),this.tileManagers[t].reload()}_updateSources(t){for(const a in this.tileManagers)this.tileManagers[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.tileManagers)this._reloadSource(t)}_updatePlacement(t,a,l,d,p=!1){let g=!1,b=!1;const S={};for(const M of this._order){const z=this._layers[M];if(z.type!=="symbol")continue;if(!S[z.source]){const j=this.tileManagers[z.source];S[z.source]=j.getRenderableIds(!0).map((V=>j.getTileByID(V))).sort(((V,Z)=>Z.tileID.overscaledZ-V.tileID.overscaledZ||(V.tileID.isLessThan(Z.tileID)?-1:1)))}const F=this.crossTileSymbolIndex.addLayer(z,S[z.source],t.center.lng);g=g||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((p=p||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Pe(),t.zoom))&&(this.pauseablePlacement=new nr(t,this.map.terrain,this._order,p,a,l,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Pe()),b=!0),g&&this.pauseablePlacement.placement.setStale()),b||g)for(const M of this._order){const z=this._layers[M];z.type==="symbol"&&this.placement.updateLayerOpacities(z,S[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Pe())}_releaseSymbolFadeTiles(){for(const t in this.tileManagers)this.tileManagers[t].releaseSymbolFadeTiles()}getImages(t,a){return o._(this,void 0,void 0,(function*(){const l=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const d=this.tileManagers[a.source];return d&&d.setDependencies(a.tileID.key,a.type,a.icons),l}))}getGlyphs(t,a){return o._(this,void 0,void 0,(function*(){const l=yield this.glyphManager.getGlyphs(a.stacks),d=this.tileManagers[a.source];return d&&d.setDependencies(a.tileID.key,a.type,[""]),l}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(o.C.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,a){return o._(this,void 0,void 0,(function*(){const l={};for(const[d,p]of Object.entries(a.dashes))l[d]=this.lineAtlas.getDash(p.dasharray,p.round);return l}))}addSprite(t,a,l={},d){this._checkLoaded();const p=[{id:t,url:a}],g=[...En(this.stylesheet.sprite),...p];this._validate(o.C.sprite,"sprite",g,null,l)||(this.stylesheet.sprite=g,this._loadSprite(p,!0,d))}removeSprite(t){this._checkLoaded();const a=En(this.stylesheet.sprite);if(a.find((l=>l.id===t))){if(this._spritesImagesIds[t])for(const l of this._spritesImagesIds[t])this.imageManager.removeImage(l),this._changedImages[l]=!0;a.splice(a.findIndex((l=>l.id===t)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return En(this.stylesheet.sprite)}setSprite(t,a={},l){this._checkLoaded(),t&&this._validate(o.C.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,l):(this._unloadSprite(),l&&l(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const t in this.tileManagers){const a=this.tileManagers[t];a.setEventedParent(null),a.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const t in this._layers){const a=this._layers[t];a.setEventedParent(null),a.onRemove&&a.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var au=o.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class is{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,l,d,p,g,b,S,M){this.context=t;let z=this.boundPaintVertexBuffers.length!==d.length;for(let F=0;!z&&F<d.length;F++)this.boundPaintVertexBuffers[F]!==d[F]&&(z=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==l||z||this.boundIndexBuffer!==p||this.boundVertexOffset!==g||this.boundDynamicVertexBuffer!==b||this.boundDynamicVertexBuffer2!==S||this.boundDynamicVertexBuffer3!==M?this.freshBind(a,l,d,p,g,b,S,M):(t.bindVertexArray.set(this.vao),b&&b.bind(),p&&p.dynamicDraw&&p.bind(),S&&S.bind(),M&&M.bind())}freshBind(t,a,l,d,p,g,b,S){const M=t.numAttributes,z=this.context,F=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=d,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=g,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=S,a.enableAttributes(F,t);for(const j of l)j.enableAttributes(F,t);g&&g.enableAttributes(F,t),b&&b.enableAttributes(F,t),S&&S.enableAttributes(F,t),a.bind(),a.setVertexAttribPointers(F,t,p);for(const j of l)j.bind(),j.setVertexAttribPointers(F,t,p);g&&(g.bind(),g.setVertexAttribPointers(F,t,p)),d&&d.bind(),b&&(b.bind(),b.setVertexAttribPointers(F,t,p)),S&&(S.bind(),S.setVertexAttribPointers(F,t,p)),z.currentNumAttributes=M}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const rl=(f,t,a,l,d)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:t,u_fog_color:a?a.properties.get("fog-color"):o.bp.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?0:a?a.calculateFogBlendOpacity(l):0,u_horizon_color:a?a.properties.get("horizon-color"):o.bp.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:d?1:0}),Yr={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Fn(f){const t=[];for(let a=0;a<f.length;a++){if(f[a]===null)continue;const l=f[a].split(" ");t.push(l.pop())}return t}class Tr{constructor(t,a,l,d,p,g,b,S,M=[]){const z=t.gl;this.program=z.createProgram();const F=Fn(a.staticAttributes),j=l?l.getBinderAttributes():[],V=F.concat(j),Z=qt.prelude.staticUniforms?Fn(qt.prelude.staticUniforms):[],Q=b.staticUniforms?Fn(b.staticUniforms):[],te=a.staticUniforms?Fn(a.staticUniforms):[],ee=l?l.getBinderUniforms():[],ae=Z.concat(Q).concat(te).concat(ee),he=[];for(const Te of ae)he.indexOf(Te)<0&&he.push(Te);const ie=l?l.defines():[];Zn(z)&&ie.unshift("#version 300 es"),p&&ie.push("#define OVERDRAW_INSPECTOR;"),g&&ie.push("#define TERRAIN3D;"),S&&ie.push(S),M&&ie.push(...M);let ue=ie.concat(qt.prelude.fragmentSource,b.fragmentSource,a.fragmentSource).join(`
`),_e=ie.concat(qt.prelude.vertexSource,b.vertexSource,a.vertexSource).join(`
`);Zn(z)||(ue=(function(Te){return Te.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ue),_e=(function(Te){return Te.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(_e));const se=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(se,ue),z.compileShader(se),!z.getShaderParameter(se,z.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${z.getShaderInfoLog(se)}`);z.attachShader(this.program,se);const ye=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(ye,_e),z.compileShader(ye),!z.getShaderParameter(ye,z.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${z.getShaderInfoLog(ye)}`);z.attachShader(this.program,ye),this.attributes={};const Ie={};this.numAttributes=V.length;for(let Te=0;Te<this.numAttributes;Te++)V[Te]&&(z.bindAttribLocation(this.program,Te,V[Te]),this.attributes[V[Te]]=Te);if(z.linkProgram(this.program),!z.getProgramParameter(this.program,z.LINK_STATUS))throw new Error(`Program failed to link: ${z.getProgramInfoLog(this.program)}`);z.deleteShader(ye),z.deleteShader(se);for(let Te=0;Te<he.length;Te++){const Le=he[Te];if(Le&&!Ie[Le]){const Ce=z.getUniformLocation(this.program,Le);Ce&&(Ie[Le]=Ce)}}this.fixedUniforms=d(t,Ie),this.terrainUniforms=((Te,Le)=>({u_depth:new o.b_(Te,Le.u_depth),u_terrain:new o.b_(Te,Le.u_terrain),u_terrain_dim:new o.bq(Te,Le.u_terrain_dim),u_terrain_matrix:new o.c0(Te,Le.u_terrain_matrix),u_terrain_unpack:new o.c1(Te,Le.u_terrain_unpack),u_terrain_exaggeration:new o.bq(Te,Le.u_terrain_exaggeration)}))(t,Ie),this.projectionUniforms=((Te,Le)=>({u_projection_matrix:new o.c0(Te,Le.u_projection_matrix),u_projection_tile_mercator_coords:new o.c1(Te,Le.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.c1(Te,Le.u_projection_clipping_plane),u_projection_transition:new o.bq(Te,Le.u_projection_transition),u_projection_fallback_matrix:new o.c0(Te,Le.u_projection_fallback_matrix)}))(t,Ie),this.binderUniforms=l?l.getUniforms(t,Ie):[]}draw(t,a,l,d,p,g,b,S,M,z,F,j,V,Z,Q,te,ee,ae,he){const ie=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(l),t.setStencilMode(d),t.setColorMode(p),t.setCullFace(g),S){t.activeTexture.set(ie.TEXTURE2),ie.bindTexture(ie.TEXTURE_2D,S.depthTexture),t.activeTexture.set(ie.TEXTURE3),ie.bindTexture(ie.TEXTURE_2D,S.texture);for(const _e in this.terrainUniforms)this.terrainUniforms[_e].set(S[_e])}if(M)for(const _e in M)this.projectionUniforms[Yr[_e]].set(M[_e]);if(b)for(const _e in this.fixedUniforms)this.fixedUniforms[_e].set(b[_e]);te&&te.setUniforms(t,this.binderUniforms,Z,{zoom:Q});let ue=0;switch(a){case ie.LINES:ue=2;break;case ie.TRIANGLES:ue=3;break;case ie.LINE_STRIP:ue=1}for(const _e of V.get()){const se=_e.vaos||(_e.vaos={});(se[z]||(se[z]=new is)).bind(t,this,F,te?te.getPaintVertexBuffers():[],j,_e.vertexOffset,ee,ae,he),ie.drawElements(a,_e.primitiveLength*ue,ie.UNSIGNED_SHORT,_e.primitiveOffset*ue*2)}}}function ol(f,t,a){const l=1/o.aN(a,1,t.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),p=a.tileSize*Math.pow(2,t.transform.tileZoom)/d,g=p*(a.tileID.canonical.x+a.tileID.wrap*d),b=p*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[g>>16,b>>16],u_pixel_coord_lower:[65535&g,65535&b]}}const ca=(f,t,a,l)=>{const d=f.style.light,p=d.properties.get("position"),g=[p.x,p.y,p.z],b=o.c4();d.properties.get("anchor")==="viewport"&&o.c5(b,f.transform.bearingInRadians),o.c6(g,g,b);const S=f.transform.transformLightDirection(g),M=d.properties.get("color");return{u_lightpos:g,u_lightpos_globe:S,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+t,u_opacity:a,u_fill_translate:l}},Ms=(f,t,a,l,d,p,g)=>o.e(ca(f,t,a,l),ol(p,f,g),{u_height_factor:-Math.pow(2,d.overscaledZ)/g.tileSize/8}),sr=(f,t,a,l)=>o.e(ol(t,f,a),{u_fill_translate:l}),sl=(f,t)=>({u_world:f,u_fill_translate:t}),Jr=(f,t,a,l,d)=>o.e(sr(f,t,a,d),{u_world:l}),Cs=(f,t,a,l,d)=>{const p=f.transform;let g,b,S=0;if(a.paint.get("circle-pitch-alignment")==="map"){const M=o.aN(t,1,p.zoom);g=!0,b=[M,M],S=M/(o.a5*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*d}else g=!1,b=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+g,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:b,u_globe_extrude_scale:S,u_translate:l}},ka=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),ll=f=>({u_viewport_size:[f.width,f.height]}),Sa=(f,t=1)=>({u_color:f,u_overlay:0,u_overlay_scale:t}),Va=(f,t,a,l)=>{const d=o.aN(f,1,t)/(o.a5*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:o.aN(f,1,t),u_intensity:a,u_globe_extrude_scale:d}},ul=(f,t,a,l)=>{const d=o.N();o.c7(d,0,f.width,f.height,0,0,1);const p=f.context.gl;return{u_matrix:d,u_world:[p.drawingBufferWidth,p.drawingBufferHeight],u_image:a,u_color_ramp:l,u_opacity:t.paint.get("heatmap-opacity")}},Qr=(f,t,a)=>{const l=a.paint.get("hillshade-accent-color");let d;switch(a.paint.get("hillshade-method")){case"basic":d=4;break;case"combined":d=1;break;case"igor":d=2;break;case"multidirectional":d=3;break;default:d=0}const p=a.getIlluminationProperties();for(let g=0;g<p.directionRadians.length;g++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(p.directionRadians[g]+=f.transform.bearingInRadians);return{u_image:0,u_latrange:Na(0,t.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:p.altitudeRadians,u_azimuths:p.directionRadians,u_accent:l,u_method:d,u_highlights:p.highlightColor,u_shadows:p.shadowColor}},ru=(f,t)=>{const a=t.stride,l=o.N();return o.c7(l,0,o.a5,-o.a5,0,0,1),o.O(l,l,[0,-o.a5,0]),{u_matrix:l,u_image:1,u_dimension:[a,a],u_zoom:f.overscaledZ,u_unpack:t.getUnpackVector()}};function Na(f,t){const a=Math.pow(2,t.canonical.z),l=t.canonical.y;return[new o.a9(0,l/a).toLngLat().lat,new o.a9(0,(l+1)/a).toLngLat().lat]}const dl=(f,t,a=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:f.paint.get("color-relief-opacity")}),Ta=(f,t,a,l)=>{const d=f.transform;return{u_translation:Pr(f,t,a),u_ratio:l/o.aN(t,1,d.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},hl=(f,t,a,l,d)=>o.e(Ta(f,t,a,l),{u_image:0,u_image_height:d}),fa=(f,t,a,l,d)=>{const p=f.transform,g=Hn(t,p);return{u_translation:Pr(f,t,a),u_texsize:t.imageAtlasTexture.size,u_ratio:l/o.aN(t,1,p.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[g,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Io=(f,t,a,l,d)=>{const p=Hn(t,f.transform);return o.e(Ta(f,t,a,l),{u_tileratio:p,u_crossfade_from:d.fromScale,u_crossfade_to:d.toScale,u_image:0,u_mix:d.t,u_lineatlas_width:f.lineAtlas.width,u_lineatlas_height:f.lineAtlas.height})},Do=(f,t,a,l,d,p)=>{const g=Hn(t,f.transform);return o.e(Ta(f,t,a,l),{u_image:0,u_image_height:p,u_tileratio:g,u_crossfade_from:d.fromScale,u_crossfade_to:d.toScale,u_image_dash:1,u_mix:d.t,u_lineatlas_width:f.lineAtlas.width,u_lineatlas_height:f.lineAtlas.height})};function Hn(f,t){return 1/o.aN(f,1,t.tileZoom)}function Pr(f,t,a){return o.aO(f.transform,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Ao=(f,t,a,l,d)=>{return{u_tl_parent:f,u_scale_parent:t,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(g=l.paint.get("raster-saturation"),g>0?1-1/(1.001-g):-g),u_contrast_factor:(p=l.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:eo(l.paint.get("raster-hue-rotate")),u_coords_top:[d[0].x,d[0].y,d[1].x,d[1].y],u_coords_bottom:[d[3].x,d[3].y,d[2].x,d[2].y]};var p,g};function eo(f){f*=Math.PI/180;const t=Math.sin(f),a=Math.cos(f);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const lr=(f,t,a,l,d,p,g,b,S,M,z,F,j)=>{const V=g.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:V.cameraToCenterDistance,u_pitch:V.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:V.width/V.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_label_plane_matrix:b,u_coord_matrix:S,u_is_text:+z,u_pitch_with_map:+l,u_is_along_line:d,u_is_variable_anchor:p,u_texsize:F,u_texture:0,u_translation:M,u_pitched_scale:j}},Lr=(f,t,a,l,d,p,g,b,S,M,z,F,j,V)=>{const Z=g.transform;return o.e(lr(f,t,a,l,d,p,g,b,S,M,z,F,V),{u_gamma_scale:l?Math.cos(Z.pitch*Math.PI/180)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:g.pixelRatio,u_is_halo:1})},Ua=(f,t,a,l,d,p,g,b,S,M,z,F,j)=>o.e(Lr(f,t,a,l,d,p,g,b,S,M,!0,z,0,j),{u_texsize_icon:F,u_texture_icon:1}),ns=(f,t)=>({u_opacity:f,u_color:t}),ou=(f,t,a,l,d)=>o.e((function(p,g,b,S){const M=b.imageManager.getPattern(p.from.toString()),z=b.imageManager.getPattern(p.to.toString()),{width:F,height:j}=b.imageManager.getPixelSize(),V=Math.pow(2,S.tileID.overscaledZ),Z=S.tileSize*Math.pow(2,b.transform.tileZoom)/V,Q=Z*(S.tileID.canonical.x+S.tileID.wrap*V),te=Z*S.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[F,j],u_mix:g.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:g.fromScale,u_scale_b:g.toScale,u_tile_units_to_pixels:1/o.aN(S,1,b.transform.tileZoom),u_pixel_coord_upper:[Q>>16,te>>16],u_pixel_coord_lower:[65535&Q,65535&te]}})(a,d,t,l),{u_opacity:f}),Ro=(f,t)=>{},su={fillExtrusion:(f,t)=>({u_lightpos:new o.c2(f,t.u_lightpos),u_lightpos_globe:new o.c2(f,t.u_lightpos_globe),u_lightintensity:new o.bq(f,t.u_lightintensity),u_lightcolor:new o.c2(f,t.u_lightcolor),u_vertical_gradient:new o.bq(f,t.u_vertical_gradient),u_opacity:new o.bq(f,t.u_opacity),u_fill_translate:new o.c3(f,t.u_fill_translate)}),fillExtrusionPattern:(f,t)=>({u_lightpos:new o.c2(f,t.u_lightpos),u_lightpos_globe:new o.c2(f,t.u_lightpos_globe),u_lightintensity:new o.bq(f,t.u_lightintensity),u_lightcolor:new o.c2(f,t.u_lightcolor),u_vertical_gradient:new o.bq(f,t.u_vertical_gradient),u_height_factor:new o.bq(f,t.u_height_factor),u_opacity:new o.bq(f,t.u_opacity),u_fill_translate:new o.c3(f,t.u_fill_translate),u_image:new o.b_(f,t.u_image),u_texsize:new o.c3(f,t.u_texsize),u_pixel_coord_upper:new o.c3(f,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(f,t.u_pixel_coord_lower),u_scale:new o.c2(f,t.u_scale),u_fade:new o.bq(f,t.u_fade)}),fill:(f,t)=>({u_fill_translate:new o.c3(f,t.u_fill_translate)}),fillPattern:(f,t)=>({u_image:new o.b_(f,t.u_image),u_texsize:new o.c3(f,t.u_texsize),u_pixel_coord_upper:new o.c3(f,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(f,t.u_pixel_coord_lower),u_scale:new o.c2(f,t.u_scale),u_fade:new o.bq(f,t.u_fade),u_fill_translate:new o.c3(f,t.u_fill_translate)}),fillOutline:(f,t)=>({u_world:new o.c3(f,t.u_world),u_fill_translate:new o.c3(f,t.u_fill_translate)}),fillOutlinePattern:(f,t)=>({u_world:new o.c3(f,t.u_world),u_image:new o.b_(f,t.u_image),u_texsize:new o.c3(f,t.u_texsize),u_pixel_coord_upper:new o.c3(f,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(f,t.u_pixel_coord_lower),u_scale:new o.c2(f,t.u_scale),u_fade:new o.bq(f,t.u_fade),u_fill_translate:new o.c3(f,t.u_fill_translate)}),circle:(f,t)=>({u_camera_to_center_distance:new o.bq(f,t.u_camera_to_center_distance),u_scale_with_map:new o.b_(f,t.u_scale_with_map),u_pitch_with_map:new o.b_(f,t.u_pitch_with_map),u_extrude_scale:new o.c3(f,t.u_extrude_scale),u_device_pixel_ratio:new o.bq(f,t.u_device_pixel_ratio),u_globe_extrude_scale:new o.bq(f,t.u_globe_extrude_scale),u_translate:new o.c3(f,t.u_translate)}),collisionBox:(f,t)=>({u_pixel_extrude_scale:new o.c3(f,t.u_pixel_extrude_scale)}),collisionCircle:(f,t)=>({u_viewport_size:new o.c3(f,t.u_viewport_size)}),debug:(f,t)=>({u_color:new o.b$(f,t.u_color),u_overlay:new o.b_(f,t.u_overlay),u_overlay_scale:new o.bq(f,t.u_overlay_scale)}),depth:Ro,clippingMask:Ro,heatmap:(f,t)=>({u_extrude_scale:new o.bq(f,t.u_extrude_scale),u_intensity:new o.bq(f,t.u_intensity),u_globe_extrude_scale:new o.bq(f,t.u_globe_extrude_scale)}),heatmapTexture:(f,t)=>({u_matrix:new o.c0(f,t.u_matrix),u_world:new o.c3(f,t.u_world),u_image:new o.b_(f,t.u_image),u_color_ramp:new o.b_(f,t.u_color_ramp),u_opacity:new o.bq(f,t.u_opacity)}),hillshade:(f,t)=>({u_image:new o.b_(f,t.u_image),u_latrange:new o.c3(f,t.u_latrange),u_exaggeration:new o.bq(f,t.u_exaggeration),u_altitudes:new o.c9(f,t.u_altitudes),u_azimuths:new o.c9(f,t.u_azimuths),u_accent:new o.b$(f,t.u_accent),u_method:new o.b_(f,t.u_method),u_shadows:new o.c8(f,t.u_shadows),u_highlights:new o.c8(f,t.u_highlights)}),hillshadePrepare:(f,t)=>({u_matrix:new o.c0(f,t.u_matrix),u_image:new o.b_(f,t.u_image),u_dimension:new o.c3(f,t.u_dimension),u_zoom:new o.bq(f,t.u_zoom),u_unpack:new o.c1(f,t.u_unpack)}),colorRelief:(f,t)=>({u_image:new o.b_(f,t.u_image),u_unpack:new o.c1(f,t.u_unpack),u_dimension:new o.c3(f,t.u_dimension),u_elevation_stops:new o.b_(f,t.u_elevation_stops),u_color_stops:new o.b_(f,t.u_color_stops),u_color_ramp_size:new o.b_(f,t.u_color_ramp_size),u_opacity:new o.bq(f,t.u_opacity)}),line:(f,t)=>({u_translation:new o.c3(f,t.u_translation),u_ratio:new o.bq(f,t.u_ratio),u_device_pixel_ratio:new o.bq(f,t.u_device_pixel_ratio),u_units_to_pixels:new o.c3(f,t.u_units_to_pixels)}),lineGradient:(f,t)=>({u_translation:new o.c3(f,t.u_translation),u_ratio:new o.bq(f,t.u_ratio),u_device_pixel_ratio:new o.bq(f,t.u_device_pixel_ratio),u_units_to_pixels:new o.c3(f,t.u_units_to_pixels),u_image:new o.b_(f,t.u_image),u_image_height:new o.bq(f,t.u_image_height)}),linePattern:(f,t)=>({u_translation:new o.c3(f,t.u_translation),u_texsize:new o.c3(f,t.u_texsize),u_ratio:new o.bq(f,t.u_ratio),u_device_pixel_ratio:new o.bq(f,t.u_device_pixel_ratio),u_image:new o.b_(f,t.u_image),u_units_to_pixels:new o.c3(f,t.u_units_to_pixels),u_scale:new o.c2(f,t.u_scale),u_fade:new o.bq(f,t.u_fade)}),lineSDF:(f,t)=>({u_translation:new o.c3(f,t.u_translation),u_ratio:new o.bq(f,t.u_ratio),u_device_pixel_ratio:new o.bq(f,t.u_device_pixel_ratio),u_units_to_pixels:new o.c3(f,t.u_units_to_pixels),u_image:new o.b_(f,t.u_image),u_mix:new o.bq(f,t.u_mix),u_tileratio:new o.bq(f,t.u_tileratio),u_crossfade_from:new o.bq(f,t.u_crossfade_from),u_crossfade_to:new o.bq(f,t.u_crossfade_to),u_lineatlas_width:new o.bq(f,t.u_lineatlas_width),u_lineatlas_height:new o.bq(f,t.u_lineatlas_height)}),lineGradientSDF:(f,t)=>({u_translation:new o.c3(f,t.u_translation),u_ratio:new o.bq(f,t.u_ratio),u_device_pixel_ratio:new o.bq(f,t.u_device_pixel_ratio),u_units_to_pixels:new o.c3(f,t.u_units_to_pixels),u_image:new o.b_(f,t.u_image),u_image_height:new o.bq(f,t.u_image_height),u_tileratio:new o.bq(f,t.u_tileratio),u_crossfade_from:new o.bq(f,t.u_crossfade_from),u_crossfade_to:new o.bq(f,t.u_crossfade_to),u_image_dash:new o.b_(f,t.u_image_dash),u_mix:new o.bq(f,t.u_mix),u_lineatlas_width:new o.bq(f,t.u_lineatlas_width),u_lineatlas_height:new o.bq(f,t.u_lineatlas_height)}),raster:(f,t)=>({u_tl_parent:new o.c3(f,t.u_tl_parent),u_scale_parent:new o.bq(f,t.u_scale_parent),u_buffer_scale:new o.bq(f,t.u_buffer_scale),u_fade_t:new o.bq(f,t.u_fade_t),u_opacity:new o.bq(f,t.u_opacity),u_image0:new o.b_(f,t.u_image0),u_image1:new o.b_(f,t.u_image1),u_brightness_low:new o.bq(f,t.u_brightness_low),u_brightness_high:new o.bq(f,t.u_brightness_high),u_saturation_factor:new o.bq(f,t.u_saturation_factor),u_contrast_factor:new o.bq(f,t.u_contrast_factor),u_spin_weights:new o.c2(f,t.u_spin_weights),u_coords_top:new o.c1(f,t.u_coords_top),u_coords_bottom:new o.c1(f,t.u_coords_bottom)}),symbolIcon:(f,t)=>({u_is_size_zoom_constant:new o.b_(f,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(f,t.u_is_size_feature_constant),u_size_t:new o.bq(f,t.u_size_t),u_size:new o.bq(f,t.u_size),u_camera_to_center_distance:new o.bq(f,t.u_camera_to_center_distance),u_pitch:new o.bq(f,t.u_pitch),u_rotate_symbol:new o.b_(f,t.u_rotate_symbol),u_aspect_ratio:new o.bq(f,t.u_aspect_ratio),u_fade_change:new o.bq(f,t.u_fade_change),u_label_plane_matrix:new o.c0(f,t.u_label_plane_matrix),u_coord_matrix:new o.c0(f,t.u_coord_matrix),u_is_text:new o.b_(f,t.u_is_text),u_pitch_with_map:new o.b_(f,t.u_pitch_with_map),u_is_along_line:new o.b_(f,t.u_is_along_line),u_is_variable_anchor:new o.b_(f,t.u_is_variable_anchor),u_texsize:new o.c3(f,t.u_texsize),u_texture:new o.b_(f,t.u_texture),u_translation:new o.c3(f,t.u_translation),u_pitched_scale:new o.bq(f,t.u_pitched_scale)}),symbolSDF:(f,t)=>({u_is_size_zoom_constant:new o.b_(f,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(f,t.u_is_size_feature_constant),u_size_t:new o.bq(f,t.u_size_t),u_size:new o.bq(f,t.u_size),u_camera_to_center_distance:new o.bq(f,t.u_camera_to_center_distance),u_pitch:new o.bq(f,t.u_pitch),u_rotate_symbol:new o.b_(f,t.u_rotate_symbol),u_aspect_ratio:new o.bq(f,t.u_aspect_ratio),u_fade_change:new o.bq(f,t.u_fade_change),u_label_plane_matrix:new o.c0(f,t.u_label_plane_matrix),u_coord_matrix:new o.c0(f,t.u_coord_matrix),u_is_text:new o.b_(f,t.u_is_text),u_pitch_with_map:new o.b_(f,t.u_pitch_with_map),u_is_along_line:new o.b_(f,t.u_is_along_line),u_is_variable_anchor:new o.b_(f,t.u_is_variable_anchor),u_texsize:new o.c3(f,t.u_texsize),u_texture:new o.b_(f,t.u_texture),u_gamma_scale:new o.bq(f,t.u_gamma_scale),u_device_pixel_ratio:new o.bq(f,t.u_device_pixel_ratio),u_is_halo:new o.b_(f,t.u_is_halo),u_translation:new o.c3(f,t.u_translation),u_pitched_scale:new o.bq(f,t.u_pitched_scale)}),symbolTextAndIcon:(f,t)=>({u_is_size_zoom_constant:new o.b_(f,t.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(f,t.u_is_size_feature_constant),u_size_t:new o.bq(f,t.u_size_t),u_size:new o.bq(f,t.u_size),u_camera_to_center_distance:new o.bq(f,t.u_camera_to_center_distance),u_pitch:new o.bq(f,t.u_pitch),u_rotate_symbol:new o.b_(f,t.u_rotate_symbol),u_aspect_ratio:new o.bq(f,t.u_aspect_ratio),u_fade_change:new o.bq(f,t.u_fade_change),u_label_plane_matrix:new o.c0(f,t.u_label_plane_matrix),u_coord_matrix:new o.c0(f,t.u_coord_matrix),u_is_text:new o.b_(f,t.u_is_text),u_pitch_with_map:new o.b_(f,t.u_pitch_with_map),u_is_along_line:new o.b_(f,t.u_is_along_line),u_is_variable_anchor:new o.b_(f,t.u_is_variable_anchor),u_texsize:new o.c3(f,t.u_texsize),u_texsize_icon:new o.c3(f,t.u_texsize_icon),u_texture:new o.b_(f,t.u_texture),u_texture_icon:new o.b_(f,t.u_texture_icon),u_gamma_scale:new o.bq(f,t.u_gamma_scale),u_device_pixel_ratio:new o.bq(f,t.u_device_pixel_ratio),u_is_halo:new o.b_(f,t.u_is_halo),u_translation:new o.c3(f,t.u_translation),u_pitched_scale:new o.bq(f,t.u_pitched_scale)}),background:(f,t)=>({u_opacity:new o.bq(f,t.u_opacity),u_color:new o.b$(f,t.u_color)}),backgroundPattern:(f,t)=>({u_opacity:new o.bq(f,t.u_opacity),u_image:new o.b_(f,t.u_image),u_pattern_tl_a:new o.c3(f,t.u_pattern_tl_a),u_pattern_br_a:new o.c3(f,t.u_pattern_br_a),u_pattern_tl_b:new o.c3(f,t.u_pattern_tl_b),u_pattern_br_b:new o.c3(f,t.u_pattern_br_b),u_texsize:new o.c3(f,t.u_texsize),u_mix:new o.bq(f,t.u_mix),u_pattern_size_a:new o.c3(f,t.u_pattern_size_a),u_pattern_size_b:new o.c3(f,t.u_pattern_size_b),u_scale_a:new o.bq(f,t.u_scale_a),u_scale_b:new o.bq(f,t.u_scale_b),u_pixel_coord_upper:new o.c3(f,t.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(f,t.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bq(f,t.u_tile_units_to_pixels)}),terrain:(f,t)=>({u_texture:new o.b_(f,t.u_texture),u_ele_delta:new o.bq(f,t.u_ele_delta),u_fog_matrix:new o.c0(f,t.u_fog_matrix),u_fog_color:new o.b$(f,t.u_fog_color),u_fog_ground_blend:new o.bq(f,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bq(f,t.u_fog_ground_blend_opacity),u_horizon_color:new o.b$(f,t.u_horizon_color),u_horizon_fog_blend:new o.bq(f,t.u_horizon_fog_blend),u_is_globe_mode:new o.bq(f,t.u_is_globe_mode)}),terrainDepth:(f,t)=>({u_ele_delta:new o.bq(f,t.u_ele_delta)}),terrainCoords:(f,t)=>({u_texture:new o.b_(f,t.u_texture),u_terrain_coords_id:new o.bq(f,t.u_terrain_coords_id),u_ele_delta:new o.bq(f,t.u_ele_delta)}),projectionErrorMeasurement:(f,t)=>({u_input:new o.bq(f,t.u_input),u_output_expected:new o.bq(f,t.u_output_expected)}),atmosphere:(f,t)=>({u_sun_pos:new o.c2(f,t.u_sun_pos),u_atmosphere_blend:new o.bq(f,t.u_atmosphere_blend),u_globe_position:new o.c2(f,t.u_globe_position),u_globe_radius:new o.bq(f,t.u_globe_radius),u_inv_proj_matrix:new o.c0(f,t.u_inv_proj_matrix)}),sky:(f,t)=>({u_sky_color:new o.b$(f,t.u_sky_color),u_horizon_color:new o.b$(f,t.u_horizon_color),u_horizon:new o.c3(f,t.u_horizon),u_horizon_normal:new o.c3(f,t.u_horizon_normal),u_sky_horizon_blend:new o.bq(f,t.u_sky_horizon_blend),u_sky_blend:new o.bq(f,t.u_sky_blend)})};class cl{constructor(t,a,l){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const fl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ml{constructor(t,a,l,d){this.length=a.length,this.attributes=l,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=t;const p=t.gl;this.buffer=p.createBuffer(),t.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let l=0;l<this.attributes.length;l++){const d=a.attributes[this.attributes[l].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,a,l){for(let d=0;d<this.attributes.length;d++){const p=this.attributes[d],g=a.attributes[p.name];g!==void 0&&t.vertexAttribPointer(g,p.components,t[fl[p.type]],!1,this.itemSize,p.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Zt{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wn extends Zt{getDefault(){return o.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Mr extends Zt{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class as extends Zt{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class to extends Zt{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Cr extends Zt{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class io extends Zt{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class no extends Zt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class mn extends Zt{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class pl extends Zt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class Er extends Zt{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class rs extends Zt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class ur extends Zt{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class os extends Zt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class ia extends Zt{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ao extends Zt{getDefault(){return o.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class jo extends Zt{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class ro extends Zt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class oo extends Zt{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Ga extends Zt{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class so extends Zt{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class ss extends Zt{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Et extends Zt{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ls extends Zt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class _l extends Zt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Es extends Zt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class lo extends Zt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class gl extends Zt{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class yl extends Zt{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const l=this.gl;Zn(l)?l.bindVertexArray(t):(a=l.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class vl extends Zt{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class xl extends Zt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class us extends Zt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class uo extends Zt{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class s extends uo{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class m extends uo{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class x extends uo{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const C="Framebuffer is not complete";class B{constructor(t,a,l,d,p){this.context=t,this.width=a,this.height=l;const g=t.gl,b=this.framebuffer=g.createFramebuffer();if(this.colorAttachment=new s(t,b),d)this.depthAttachment=p?new x(t,b):new m(t,b);else if(p)throw new Error("Stencil cannot be set without depth");if(g.checkFramebufferStatus(g.FRAMEBUFFER)!==g.FRAMEBUFFER_COMPLETE)throw new Error(C)}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const l=this.depthAttachment.get();l&&t.deleteRenderbuffer(l)}t.deleteFramebuffer(this.framebuffer)}}class W{constructor(t){var a,l;if(this.gl=t,this.clearColor=new Wn(this),this.clearDepth=new Mr(this),this.clearStencil=new as(this),this.colorMask=new to(this),this.depthMask=new Cr(this),this.stencilMask=new io(this),this.stencilFunc=new no(this),this.stencilOp=new mn(this),this.stencilTest=new pl(this),this.depthRange=new Er(this),this.depthTest=new rs(this),this.depthFunc=new ur(this),this.blend=new os(this),this.blendFunc=new ia(this),this.blendColor=new ao(this),this.blendEquation=new jo(this),this.cullFace=new ro(this),this.cullFaceSide=new oo(this),this.frontFace=new Ga(this),this.program=new so(this),this.activeTexture=new ss(this),this.viewport=new Et(this),this.bindFramebuffer=new ls(this),this.bindRenderbuffer=new _l(this),this.bindTexture=new Es(this),this.bindVertexBuffer=new lo(this),this.bindElementBuffer=new gl(this),this.bindVertexArray=new yl(this),this.pixelStoreUnpack=new vl(this),this.pixelStoreUnpackPremultiplyAlpha=new xl(this),this.pixelStoreUnpackFlipY=new us(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Zn(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:d?.RGBA16F_EXT,this.RGB16F=(l=t.RGB16F)!==null&&l!==void 0?l:d?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new cl(this,t,a)}createVertexBuffer(t,a,l){return new ml(this,t,a,l)}createRenderbuffer(t,a,l){const d=this.gl,p=d.createRenderbuffer();return this.bindRenderbuffer.set(p),d.renderbufferStorage(d.RENDERBUFFER,t,a,l),this.bindRenderbuffer.set(null),p}createFramebuffer(t,a,l,d){return new B(this,t,a,l,d)}clear({color:t,depth:a,stencil:l}){const d=this.gl;let p=0;t&&(p|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(p|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),l!==void 0&&(p|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),d.clear(p)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){o.bR(t.blendFunction,ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Zn(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return Zn(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let me;function be(f,t,a,l,d){const p=f.context,g=f.transform,b=p.gl,S=f.useProgram("collisionBox"),M=[];let z=0,F=0;for(let ee=0;ee<l.length;ee++){const ae=l[ee],he=t.getTile(ae).getBucket(a);if(!he)continue;const ie=d?he.textCollisionBox:he.iconCollisionBox,ue=he.collisionCircleArray;ue.length>0&&(M.push({circleArray:ue,circleOffset:F,coord:ae}),z+=ue.length/4,F=z),ie&&S.draw(p,b.LINES,St.disabled,jt.disabled,f.colorModeForRenderPass(),zt.disabled,ka(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(ae),g.getProjectionData({overscaledTileID:ae,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,null,f.transform.zoom,null,null,ie.collisionVertexBuffer)}if(!d||!M.length)return;const j=f.useProgram("collisionCircle"),V=new o.ca;V.resize(4*z),V._trim();let Z=0;for(const ee of M)for(let ae=0;ae<ee.circleArray.length/4;ae++){const he=4*ae,ie=ee.circleArray[he+0],ue=ee.circleArray[he+1],_e=ee.circleArray[he+2],se=ee.circleArray[he+3];V.emplace(Z++,ie,ue,_e,se,0),V.emplace(Z++,ie,ue,_e,se,1),V.emplace(Z++,ie,ue,_e,se,2),V.emplace(Z++,ie,ue,_e,se,3)}(!me||me.length<2*z)&&(me=(function(ee){const ae=2*ee,he=new o.cc;he.resize(ae),he._trim();for(let ie=0;ie<ae;ie++){const ue=6*ie;he.uint16[ue+0]=4*ie+0,he.uint16[ue+1]=4*ie+1,he.uint16[ue+2]=4*ie+2,he.uint16[ue+3]=4*ie+2,he.uint16[ue+4]=4*ie+3,he.uint16[ue+5]=4*ie+0}return he})(z));const Q=p.createIndexBuffer(me,!0),te=p.createVertexBuffer(V,o.cb.members,!0);for(const ee of M){const ae=ll(f.transform);j.draw(p,b.TRIANGLES,St.disabled,jt.disabled,f.colorModeForRenderPass(),zt.disabled,ae,f.style.map.terrain&&f.style.map.terrain.getTerrainData(ee.coord),null,a.id,te,Q,o.aX.simpleSegment(0,2*ee.circleOffset,ee.circleArray.length,ee.circleArray.length/2),null,f.transform.zoom,null,null,null)}te.destroy(),Q.destroy()}const Re=o.ar(new Float32Array(16));function Ze(f,t,a,l,d,p){const{horizontalAlign:g,verticalAlign:b}=o.aS(f);return new o.P((-(g-.5)*t/d+l[0])*p,(-(b-.5)*a/d+l[1])*p)}function ut(f,t,a,l,d,p){const g=t.tileAnchorPoint.add(new o.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let b=l.mult(p);a||(b=b.rotate(-d));const S=g.add(b);return Pt(S.x,S.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(a){const b=Kt(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(f),S=Math.atan(b.y/b.x)+(b.x<0?Math.PI:0);return f.add(l.rotate(S))}return f.add(l)}function vt(f,t,a,l,d,p,g,b,S,M,z,F){const j=f.text.placedSymbolArray,V=f.text.dynamicLayoutVertexArray,Z=f.icon.dynamicLayoutVertexArray,Q={};V.clear();for(let te=0;te<j.length;te++){const ee=j.get(te),ae=ee.hidden||!ee.crossTileID||f.allowVerticalPlacement&&!ee.placedOrientation?null:l[ee.crossTileID];if(ae){const he=new o.P(ee.anchorX,ee.anchorY),ie={getElevation:F,width:d.width,height:d.height,pitchedLabelPlaneMatrix:p,pitchWithMap:a,transform:d,tileAnchorPoint:he,translation:M,unwrappedTileID:z},ue=a?va(he.x,he.y,ie):Kt(he.x,he.y,ie),_e=wo(d.cameraToCenterDistance,ue.signedDistanceFromCamera);let se=o.aA(f.textSizeData,b,ee)*_e/o.aM;a&&(se*=f.tilePixelRatio/g);const{width:ye,height:Ie,anchor:Te,textOffset:Le,textBoxScale:Ce}=ae,Ke=Ze(Te,ye,Ie,Le,Ce,se),Xe=d.getPitchedTextCorrection(he.x+M[0],he.y+M[1],z),Ue=ut(ue.point,ie,t,Ke,-d.bearingInRadians,Xe),Je=f.allowVerticalPlacement&&ee.placedOrientation===o.az.vertical?Math.PI/2:0;for(let wt=0;wt<ee.numGlyphs;wt++)o.aG(V,Ue,Je);S&&ee.associatedIconIndex>=0&&(Q[ee.associatedIconIndex]={shiftedAnchor:Ue,angle:Je})}else Yt(ee.numGlyphs,V)}if(S){Z.clear();const te=f.icon.placedSymbolArray;for(let ee=0;ee<te.length;ee++){const ae=te.get(ee);if(ae.hidden)Yt(ae.numGlyphs,Z);else{const he=Q[ee];if(he)for(let ie=0;ie<ae.numGlyphs;ie++)o.aG(Z,he.shiftedAnchor,he.angle);else Yt(ae.numGlyphs,Z)}}f.icon.dynamicLayoutVertexBuffer.updateData(Z)}f.text.dynamicLayoutVertexBuffer.updateData(V)}function Dt(f,t,a){return a.iconsInText&&t?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Ki(f,t,a,l,d,p,g,b,S,M,z,F,j){const V=f.context,Z=V.gl,Q=f.transform,te=b==="map",ee=S==="map",ae=b!=="viewport"&&a.layout.get("symbol-placement")!=="point",he=te&&!ee&&!ae,ie=!a.layout.get("symbol-sort-key").isConstant();let ue=!1;const _e=f.getDepthModeForSublayer(0,St.ReadOnly),se=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ye=[],Ie=Q.getCircleRadiusCorrection();for(const Te of l){const Le=t.getTile(Te),Ce=Le.getBucket(a);if(!Ce)continue;const Ke=d?Ce.text:Ce.icon;if(!Ke||!Ke.segments.get().length||!Ke.hasVisibleVertices)continue;const Xe=Ke.programConfigurations.get(a.id),Ue=d||Ce.sdfIcons,Je=d?Ce.textSizeData:Ce.iconSizeData,wt=ee||Q.pitch!==0,Qt=f.useProgram(Dt(Ue,d,Ce),Xe),_i=o.ay(Je,Q.zoom),li=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Te);let bi,ui,Oi,ki,_n=[0,0],Xi=null;if(d)ui=Le.glyphAtlasTexture,Oi=Z.LINEAR,bi=Le.glyphAtlasTexture.size,Ce.iconsInText&&(_n=Le.imageAtlasTexture.size,Xi=Le.imageAtlasTexture,ki=wt||f.options.rotating||f.options.zooming||Je.kind==="composite"||Je.kind==="camera"?Z.LINEAR:Z.NEAREST);else{const ci=a.layout.get("icon-size").constantOr(0)!==1||Ce.iconsNeedLinear;ui=Le.imageAtlasTexture,Oi=Ue||f.options.rotating||f.options.zooming||ci||wt?Z.LINEAR:Z.NEAREST,bi=Le.imageAtlasTexture.size}const qi=o.aN(Le,1,f.transform.zoom),Mn=An(te,f.transform,qi),mo=o.N();o.aB(mo,Mn);const Ar=Wo(ee,te,f.transform,qi),cr=o.aO(Q,Le,p,g),na=Q.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Vo=se&&Ce.hasTextData(),Hs=a.layout.get("icon-text-fit")!=="none"&&Vo&&Ce.hasIconData();if(ae){const ci=f.style.map.terrain?(ln,un)=>f.style.map.terrain.getElevation(Te,ln,un):null,di=a.layout.get("text-rotation-alignment")==="map";Ko(Ce,f,d,Mn,mo,ee,M,di,Te.toUnwrapped(),Q.width,Q.height,cr,ci)}const No=d&&se||Hs,Ca=ae||No?Re:ee?Mn:f.transform.clipSpaceToPixelsMatrix,fr=Ue&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Xa;Xa=Ue?Ce.iconsInText?Ua(Je.kind,_i,he,ee,ae,No,f,Ca,Ar,cr,bi,_n,Ie):Lr(Je.kind,_i,he,ee,ae,No,f,Ca,Ar,cr,d,bi,0,Ie):lr(Je.kind,_i,he,ee,ae,No,f,Ca,Ar,cr,d,bi,Ie);const Ya={program:Qt,buffers:Ke,uniformValues:Xa,projectionData:na,atlasTexture:ui,atlasTextureIcon:Xi,atlasInterpolation:Oi,atlasInterpolationIcon:ki,isSDF:Ue,hasHalo:fr};if(ie&&Ce.canOverlap){ue=!0;const ci=Ke.segments.get();for(const di of ci)ye.push({segments:new o.aX([di]),sortKey:di.sortKey,state:Ya,terrainData:li})}else ye.push({segments:Ke.segments,sortKey:0,state:Ya,terrainData:li})}ue&&ye.sort(((Te,Le)=>Te.sortKey-Le.sortKey));for(const Te of ye){const Le=Te.state;if(V.activeTexture.set(Z.TEXTURE0),Le.atlasTexture.bind(Le.atlasInterpolation,Z.CLAMP_TO_EDGE),Le.atlasTextureIcon&&(V.activeTexture.set(Z.TEXTURE1),Le.atlasTextureIcon&&Le.atlasTextureIcon.bind(Le.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),Le.isSDF){const Ce=Le.uniformValues;Le.hasHalo&&(Ce.u_is_halo=1,Bi(Le.buffers,Te.segments,a,f,Le.program,_e,z,F,Ce,Le.projectionData,Te.terrainData)),Ce.u_is_halo=0}Bi(Le.buffers,Te.segments,a,f,Le.program,_e,z,F,Le.uniformValues,Le.projectionData,Te.terrainData)}}function Bi(f,t,a,l,d,p,g,b,S,M,z){const F=l.context;d.draw(F,F.gl.TRIANGLES,p,g,b,zt.backCCW,S,z,M,a.id,f.layoutVertexBuffer,f.indexBuffer,t,a.paint,l.transform.zoom,f.programConfigurations.get(a.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function Kn(f,t,a,l,d){const p=f.context,g=p.gl,b=jt.disabled,S=new ri([g.ONE,g.ONE],o.bp.transparent,[!0,!0,!0,!0]),M=t.getBucket(a);if(!M)return;const z=l.key;let F=a.heatmapFbos.get(z);F||(F=Pa(p,t.tileSize,t.tileSize),a.heatmapFbos.set(z,F)),p.bindFramebuffer.set(F.framebuffer),p.viewport.set([0,0,t.tileSize,t.tileSize]),p.clear({color:o.bp.transparent});const j=M.programConfigurations.get(a.id),V=f.useProgram("heatmap",j,!d),Z=f.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Q=f.style.map.terrain.getTerrainData(l);V.draw(p,g.TRIANGLES,St.disabled,b,S,zt.disabled,Va(t,f.transform.zoom,a.paint.get("heatmap-intensity"),1),Q,Z,a.id,M.layoutVertexBuffer,M.indexBuffer,M.segments,a.paint,f.transform.zoom,j)}function Ln(f,t,a,l,d){const p=f.context,g=p.gl,b=f.transform;p.setColorMode(f.colorModeForRenderPass());const S=ds(p,t),M=a.key,z=t.heatmapFbos.get(M);if(!z)return;p.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,z.colorAttachment.get()),p.activeTexture.set(g.TEXTURE1),S.bind(g.LINEAR,g.CLAMP_TO_EDGE);const F=b.getProjectionData({overscaledTileID:a,applyTerrainMatrix:d,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(p,g.TRIANGLES,St.disabled,jt.disabled,f.colorModeForRenderPass(),zt.disabled,ul(f,t,0,1),null,F,t.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,t.paint,b.zoom),z.destroy(),t.heatmapFbos.delete(M)}function Pa(f,t,a){var l,d;const p=f.gl,g=p.createTexture();p.bindTexture(p.TEXTURE_2D,g),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);const b=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:p.UNSIGNED_BYTE,S=(d=f.RGBA16F)!==null&&d!==void 0?d:p.RGBA;p.texImage2D(p.TEXTURE_2D,0,S,t,a,0,p.RGBA,b,null);const M=f.createFramebuffer(t,a,!1,!1);return M.colorAttachment.set(g),M}function ds(f,t){return t.colorRampTexture||(t.colorRampTexture=new o.T(f,t.colorRamp,f.gl.RGBA)),t.colorRampTexture}function wl(f,t,a,l,d,p,g,b){let S=256;if(d.stepInterpolant){const M=t.getSource().maxzoom,z=g.canonical.z===M?Math.ceil(1<<f.transform.maxZoom-g.canonical.z):1;S=o.an(o.ce(p.maxLineLength/o.a5*1024*z),256,a.maxTextureSize)}return b.gradient=o.cf({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:S,image:b.gradient||void 0,clips:p.lineClipsArray}),b.texture?b.texture.update(b.gradient):b.texture=new o.T(a,b.gradient,l.RGBA),b.version=d.gradientVersion,b.texture}function bl(f,t,a,l,d){f.activeTexture.set(t.TEXTURE0),a.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),l.updatePaintBuffers(d)}function xi(f,t,a,l,d,p){(d||f.lineAtlas.dirty)&&(t.activeTexture.set(a.TEXTURE0),f.lineAtlas.bind(t)),l.updatePaintBuffers(p)}function zr(f,t,a,l,d,p,g){const b=p.gradients[d.id];let S=b.texture;d.gradientVersion!==b.version&&(S=wl(f,t,a,l,d,p,g,b)),a.activeTexture.set(l.TEXTURE0),S.bind(d.stepInterpolant?l.NEAREST:l.LINEAR,l.CLAMP_TO_EDGE)}function Bn(f,t,a,l,d,p,g,b,S){const M=p.gradients[d.id];let z=M.texture;d.gradientVersion!==M.version&&(z=wl(f,t,a,l,d,p,g,M)),a.activeTexture.set(l.TEXTURE0),z.bind(d.stepInterpolant?l.NEAREST:l.LINEAR,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),f.lineAtlas.bind(a),b.updatePaintBuffers(S)}function wi(f,t,a,l,d){if(!a||!l||!l.imageAtlas)return;const p=l.imageAtlas.patternPositions;let g=p[a.to.toString()],b=p[a.from.toString()];if(!g&&b&&(g=b),!b&&g&&(b=g),!g||!b){const S=d.getPaintProperty(t);g=p[S],b=p[S]}g&&b&&f.setConstantPatternPositions(g,b)}function dr(f,t,a,l,d,p,g,b){const S=f.context.gl,M="fill-pattern",z=a.paint.get(M),F=z&&z.constantOr(1),j=a.getCrossfadeParameters();let V,Z,Q,te,ee;const ae=f.transform,he=a.paint.get("fill-translate"),ie=a.paint.get("fill-translate-anchor");g?(Z=F&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=S.LINES):(Z=F?"fillPattern":"fill",V=S.TRIANGLES);const ue=z.constantOr(null);for(const _e of l){const se=t.getTile(_e);if(F&&!se.patternsLoaded())continue;const ye=se.getBucket(a);if(!ye)continue;const Ie=ye.programConfigurations.get(a.id),Te=f.useProgram(Z,Ie),Le=f.style.map.terrain&&f.style.map.terrain.getTerrainData(_e);F&&(f.context.activeTexture.set(S.TEXTURE0),se.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Ie.updatePaintBuffers(j)),wi(Ie,M,ue,se,a);const Ce=ae.getProjectionData({overscaledTileID:_e,applyGlobeMatrix:!b,applyTerrainMatrix:!0}),Ke=o.aO(ae,se,he,ie);if(g){te=ye.indexBuffer2,ee=ye.segments2;const Ue=[S.drawingBufferWidth,S.drawingBufferHeight];Q=Z==="fillOutlinePattern"&&F?Jr(f,j,se,Ue,Ke):sl(Ue,Ke)}else te=ye.indexBuffer,ee=ye.segments,Q=F?sr(f,j,se,Ke):{u_fill_translate:Ke};const Xe=f.stencilModeForClipping(_e);Te.draw(f.context,V,d,Xe,p,zt.backCCW,Q,Le,Ce,a.id,ye.layoutVertexBuffer,te,ee,a.paint,f.transform.zoom,Ie)}}function hs(f,t,a,l,d,p,g,b){const S=f.context,M=S.gl,z="fill-extrusion-pattern",F=a.paint.get(z),j=F.constantOr(1),V=a.getCrossfadeParameters(),Z=a.paint.get("fill-extrusion-opacity"),Q=F.constantOr(null),te=f.transform;for(const ee of l){const ae=t.getTile(ee),he=ae.getBucket(a);if(!he)continue;const ie=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ee),ue=he.programConfigurations.get(a.id),_e=f.useProgram(j?"fillExtrusionPattern":"fillExtrusion",ue);j&&(f.context.activeTexture.set(M.TEXTURE0),ae.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),ue.updatePaintBuffers(V));const se=te.getProjectionData({overscaledTileID:ee,applyGlobeMatrix:!b,applyTerrainMatrix:!0});wi(ue,z,Q,ae,a);const ye=o.aO(te,ae,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ie=a.paint.get("fill-extrusion-vertical-gradient"),Te=j?Ms(f,Ie,Z,ye,ee,V,ae):ca(f,Ie,Z,ye);_e.draw(S,S.gl.TRIANGLES,d,p,g,zt.backCCW,Te,ie,se,a.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,a.paint,f.transform.zoom,ue,f.style.map.terrain&&he.centroidVertexBuffer)}}function hr(f,t,a,l,d,p,g,b,S){var M;const z=f.style.projection,F=f.context,j=f.transform,V=F.gl,Z=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],Q=f.useProgram("hillshade",null,!1,Z),te=!f.options.moving;for(const ee of l){const ae=t.getTile(ee),he=ae.fbo;if(!he)continue;const ie=z.getMeshFromTileID(F,ee.canonical,b,!0,"raster"),ue=(M=f.style.map.terrain)===null||M===void 0?void 0:M.getTerrainData(ee);F.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,he.colorAttachment.get());const _e=j.getProjectionData({overscaledTileID:ee,aligned:te,applyGlobeMatrix:!S,applyTerrainMatrix:!0});Q.draw(F,V.TRIANGLES,p,d[ee.overscaledZ],g,zt.backCCW,Qr(f,ae,a),ue,_e,a.id,ie.vertexBuffer,ie.indexBuffer,ie.segments)}}function Fo(f,t,a,l,d,p,g,b,S){var M;const z=f.style.projection,F=f.context,j=f.transform,V=F.gl,Z=f.useProgram("colorRelief"),Q=!f.options.moving;let te=!0,ee=0;for(const ae of l){const he=t.getTile(ae),ie=he.dem;if(te){const Te=V.getParameter(V.MAX_TEXTURE_SIZE),{elevationTexture:Le,colorTexture:Ce}=a.getColorRampTextures(F,Te,ie.getUnpackVector());F.activeTexture.set(V.TEXTURE1),Le.bind(V.NEAREST,V.CLAMP_TO_EDGE),F.activeTexture.set(V.TEXTURE4),Ce.bind(V.LINEAR,V.CLAMP_TO_EDGE),te=!1,ee=Le.size[0]}if(!ie||!ie.data)continue;const ue=ie.stride,_e=ie.getPixels();if(F.activeTexture.set(V.TEXTURE0),F.pixelStoreUnpackPremultiplyAlpha.set(!1),he.demTexture=he.demTexture||f.getTileTexture(ue),he.demTexture){const Te=he.demTexture;Te.update(_e,{premultiply:!1}),Te.bind(V.LINEAR,V.CLAMP_TO_EDGE)}else he.demTexture=new o.T(F,_e,V.RGBA,{premultiply:!1}),he.demTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const se=z.getMeshFromTileID(F,ae.canonical,b,!0,"raster"),ye=(M=f.style.map.terrain)===null||M===void 0?void 0:M.getTerrainData(ae),Ie=j.getProjectionData({overscaledTileID:ae,aligned:Q,applyGlobeMatrix:!S,applyTerrainMatrix:!0});Z.draw(F,V.TRIANGLES,p,d[ae.overscaledZ],g,zt.backCCW,dl(a,he.dem,ee),ye,Ie,a.id,se.vertexBuffer,se.indexBuffer,se.segments)}}const qa=[new o.P(0,0),new o.P(o.a5,0),new o.P(o.a5,o.a5),new o.P(0,o.a5)];function Ir(f,t,a,l,d,p,g,b,S=!1,M=!1){const z=l[l.length-1].overscaledZ,F=f.context,j=F.gl,V=f.useProgram("raster"),Z=f.transform,Q=f.style.projection,te=f.colorModeForRenderPass(),ee=!f.options.moving,ae=a.paint.get("raster-opacity"),he=a.paint.get("raster-resampling"),ie=a.paint.get("raster-fade-duration"),ue=!!f.style.map.terrain;for(const _e of l){const se=f.getDepthModeForSublayer(_e.overscaledZ-z,ae===1?St.ReadWrite:St.ReadOnly,j.LESS),ye=t.getTile(_e),Ie=he==="nearest"?j.NEAREST:j.LINEAR;F.activeTexture.set(j.TEXTURE0),ye.texture.bind(Ie,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),F.activeTexture.set(j.TEXTURE1);const{parentTile:Te,parentScaleBy:Le,parentTopLeft:Ce,fadeValues:Ke}=kl(ye,t,ie,ue);ye.fadeOpacity=Ke.tileOpacity,Te?(Te.fadeOpacity=Ke.parentTileOpacity,Te.texture.bind(Ie,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST)):ye.texture.bind(Ie,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),ye.texture.useMipmap&&F.extTextureFilterAnisotropic&&f.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax);const Xe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(_e),Ue=Z.getProjectionData({overscaledTileID:_e,aligned:ee,applyGlobeMatrix:!M,applyTerrainMatrix:!0}),Je=Ao(Ce,Le,Ke.fadeMix,a,b),wt=Q.getMeshFromTileID(F,_e.canonical,p,g,"raster");V.draw(F,j.TRIANGLES,se,d?d[_e.overscaledZ]:jt.disabled,te,S?zt.frontCCW:zt.backCCW,Je,Xe,Ue,a.id,wt.vertexBuffer,wt.indexBuffer,wt.segments)}}function kl(f,t,a,l){const d={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(a===0||l)return d;if(f.fadingParentID){const p=t.getLoadedTile(f.fadingParentID);if(!p)return d;const g=Math.pow(2,p.tileID.overscaledZ-f.tileID.overscaledZ),b=[f.tileID.canonical.x*g%1,f.tileID.canonical.y*g%1],S=(function(M,z,F){const j=Pe(),V=(j-z.timeAdded)/F,Z=M.fadingDirection===Me.Incoming,Q=o.an((j-M.timeAdded)/F,0,1),te=o.an(1-V,0,1),ee=Z?Q:te;return{tileOpacity:ee,parentTileOpacity:Z?te:Q,fadeMix:{opacity:1,mix:1-ee}}})(f,p,a);return{parentTile:p,parentScaleBy:g,parentTopLeft:b,fadeValues:S}}if(f.selfFading){const p=(function(g,b){const S=(Pe()-g.timeAdded)/b,M=o.an(S,0,1);return{tileOpacity:M,fadeMix:{opacity:M,mix:0}}})(f,a);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:p}}return d}const Yu=new o.bp(1,0,0,1),Ju=new o.bp(0,1,0,1),Qu=new o.bp(0,0,1,1),ed=new o.bp(1,0,1,1),ho=new o.bp(0,1,1,1);function lu(f,t,a,l){zs(f,0,t+a/2,f.transform.width,a,l)}function uu(f,t,a,l){zs(f,t-a/2,0,a,f.transform.height,l)}function zs(f,t,a,l,d,p){const g=f.context,b=g.gl;b.enable(b.SCISSOR_TEST),b.scissor(t*f.pixelRatio,a*f.pixelRatio,l*f.pixelRatio,d*f.pixelRatio),g.clear({color:p}),b.disable(b.SCISSOR_TEST)}function td(f,t,a){const l=f.context,d=l.gl,p=f.useProgram("debug"),g=St.disabled,b=jt.disabled,S=f.colorModeForRenderPass(),M="$debug",z=f.style.map.terrain&&f.style.map.terrain.getTerrainData(a);l.activeTexture.set(d.TEXTURE0);const F=t.getTileByID(a.key).latestRawTileData,j=Math.floor((F&&F.byteLength||0)/1024),V=t.getTile(a).tileSize,Z=512/Math.min(V,512)*(a.overscaledZ/f.transform.zoom)*.5;let Q=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(Q+=` => ${a.overscaledZ}`),(function(ee,ae){ee.initDebugOverlayCanvas();const he=ee.debugOverlayCanvas,ie=ee.context.gl,ue=ee.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,he.width,he.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(ae,5,5),ue.strokeText(ae,5,5),ee.debugOverlayTexture.update(he),ee.debugOverlayTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE)})(f,`${Q} ${j}kB`);const te=f.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(l,d.TRIANGLES,g,b,ri.alphaBlended,zt.disabled,Sa(o.bp.transparent,Z),null,te,M,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),p.draw(l,d.LINE_STRIP,g,b,S,zt.disabled,Sa(o.bp.red),z,te,M,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function du(f,t,a,l){const{isRenderingGlobe:d}=l,p=f.context,g=p.gl,b=f.transform,S=f.colorModeForRenderPass(),M=f.getDepthModeFor3D(),z=f.useProgram("terrain");p.bindFramebuffer.set(null),p.viewport.set([0,0,f.width,f.height]);for(const F of a){const j=t.getTerrainMesh(F.tileID),V=f.renderToTexture.getTexture(F),Z=t.getTerrainData(F.tileID);p.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,V.texture);const Q=t.getMeshFrameDelta(b.zoom),te=b.calculateFogMatrix(F.tileID.toUnwrapped()),ee=rl(Q,te,f.style.sky,b.pitch,d),ae=b.getProjectionData({overscaledTileID:F.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});z.draw(p,g.TRIANGLES,M,jt.disabled,S,zt.backCCW,ee,Z,ae,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}function hu(f,t){if(!t.mesh){const a=new o.aW;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const l=new o.aY;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),t.mesh=new Jt(f.createVertexBuffer(a,wa.members),f.createIndexBuffer(l),o.aX.simpleSegment(0,0,a.length,l.length))}return t.mesh}class id{constructor(t,a){this.context=new W(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Gn.maxOverzooming+Gn.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Rn}resize(t,a,l){if(this.width=Math.floor(t*l),this.height=Math.floor(a*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,a=new o.aW;a.emplaceBack(0,0),a.emplaceBack(o.a5,0),a.emplaceBack(0,o.a5),a.emplaceBack(o.a5,o.a5),this.tileExtentBuffer=t.createVertexBuffer(a,wa.members),this.tileExtentSegments=o.aX.simpleSegment(0,0,4,2);const l=new o.aW;l.emplaceBack(0,0),l.emplaceBack(o.a5,0),l.emplaceBack(0,o.a5),l.emplaceBack(o.a5,o.a5),this.debugBuffer=t.createVertexBuffer(l,wa.members),this.debugSegments=o.aX.simpleSegment(0,0,4,5);const d=new o.ch;d.emplaceBack(0,0,0,0),d.emplaceBack(o.a5,0,o.a5,0),d.emplaceBack(0,o.a5,0,o.a5),d.emplaceBack(o.a5,o.a5,o.a5,o.a5),this.rasterBoundsBuffer=t.createVertexBuffer(d,au.members),this.rasterBoundsSegments=o.aX.simpleSegment(0,0,4,2);const p=new o.aW;p.emplaceBack(0,0),p.emplaceBack(o.a5,0),p.emplaceBack(0,o.a5),p.emplaceBack(o.a5,o.a5),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(p,wa.members),this.rasterBoundsSegmentsPosOnly=o.aX.simpleSegment(0,0,4,5);const g=new o.aW;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(g,wa.members),this.viewportSegments=o.aX.simpleSegment(0,0,4,2);const b=new o.ci;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(b);const S=new o.aY;S.emplaceBack(1,0,2),S.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(S);const M=this.context.gl;this.stencilClearMode=new jt({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO),this.tileExtentMesh=new Jt(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=o.N();o.c7(l,0,this.width,this.height,0,0,1),o.Q(l,l,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const d={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(t,a.TRIANGLES,St.disabled,this.stencilClearMode,ri.disabled,zt.disabled,null,null,d,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a,l){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source,this.nextStencilID+a.length>256&&this.clearStencil();const d=this.context;d.setColorMode(ri.disabled),d.setDepthMode(St.disabled);const p={};for(const g of a)p[g.key]=this.nextStencilID++;this._renderTileMasks(p,a,l,!0),this._renderTileMasks(p,a,l,!1),this._tileClippingMaskIDs=p}_renderTileMasks(t,a,l,d){const p=this.context,g=p.gl,b=this.style.projection,S=this.transform,M=this.useProgram("clippingMask");for(const z of a){const F=t[z.key],j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(z),V=b.getMeshFromTileID(this.context,z.canonical,d,!0,"stencil"),Z=S.getProjectionData({overscaledTileID:z,applyGlobeMatrix:!l,applyTerrainMatrix:!0});M.draw(p,g.TRIANGLES,St.disabled,new jt({func:g.ALWAYS,mask:0},F,255,g.KEEP,g.KEEP,g.REPLACE),ri.disabled,l?zt.disabled:zt.backCCW,null,j,Z,"$clipping",V.vertexBuffer,V.indexBuffer,V.segments)}}_renderTilesDepthBuffer(){const t=this.context,a=t.gl,l=this.style.projection,d=this.transform,p=this.useProgram("depth"),g=this.getDepthModeFor3D(),b=vi(d,{tileSize:d.tileSize});for(const S of b){const M=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S),z=l.getMeshFromTileID(this.context,S.canonical,!0,!0,"raster"),F=d.getProjectionData({overscaledTileID:S,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(t,a.TRIANGLES,g,jt.disabled,ri.disabled,zt.backCCW,null,M,F,"$clipping",z.vertexBuffer,z.indexBuffer,z.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new jt({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new jt({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const a=this.context.gl,l=t.sort(((g,b)=>b.overscaledZ-g.overscaledZ)),d=l[l.length-1].overscaledZ,p=l[0].overscaledZ-d+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const g={};for(let b=0;b<p;b++)g[b+d]=new jt({func:a.GEQUAL,mask:255},b+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=p,[g,l]}return[{[d]:jt.disabled},l]}stencilConfigForOverlapTwoPass(t){const a=this.context.gl,l=t.sort(((g,b)=>b.overscaledZ-g.overscaledZ)),d=l[l.length-1].overscaledZ,p=l[0].overscaledZ-d+1;if(this.clearStencil(),p>1){const g={},b={};for(let S=0;S<p;S++)g[S+d]=new jt({func:a.GREATER,mask:255},p+1+S,255,a.KEEP,a.KEEP,a.REPLACE),b[S+d]=new jt({func:a.GREATER,mask:255},1+S,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*p+1,[g,b,l]}return this.nextStencilID=3,[{[d]:new jt({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[d]:new jt({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},l]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new ri([t.CONSTANT_COLOR,t.ONE],new o.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ri.unblended:ri.alphaBlended}getDepthModeForSublayer(t,a,l){if(!this.opaquePassEnabledForLayer())return St.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new St(l||this.context.gl.LEQUAL,a,[d,d])}getDepthModeFor3D(){return new St(this.context.gl.LEQUAL,St.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){var l,d;this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(Pe()),this.imageManager.beginFrame();const p=this.style._order,g=this.style.tileManagers,b={},S={},M={},z={isRenderingToTexture:!1,isRenderingGlobe:((l=t.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const j in g){const V=g[j];V.used&&V.prepare(this.context),b[j]=V.getVisibleCoordinates(!1),S[j]=b[j].slice().reverse(),M[j]=V.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<p.length;j++)if(this.style._layers[p[j]].is3D()){this.opaquePassCutoff=j;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const j of p){const V=this.style._layers[j];if(!V.hasOffscreenPass()||V.isHidden(this.transform.zoom))continue;const Z=S[V.source];(V.type==="custom"||Z.length)&&this.renderLayer(this,g[V.source],V,Z,z)}if((d=this.style.projection)===null||d===void 0||d.updateGPUdependent({context:this.context,useProgram:j=>this.useProgram(j)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?o.bp.black:o.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(j,V){const Z=j.context,Q=Z.gl,te=((_e,se,ye)=>{const Ie=Math.cos(se.rollInRadians),Te=Math.sin(se.rollInRadians),Le=Ht(se),Ce=se.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:_e.properties.get("sky-color"),u_horizon_color:_e.properties.get("horizon-color"),u_horizon:[(se.width/2-Le*Te)*ye,(se.height/2+Le*Ie)*ye],u_horizon_normal:[-Te,Ie],u_sky_horizon_blend:_e.properties.get("sky-horizon-blend")*se.height/2*ye,u_sky_blend:Ce}})(V,j.style.map.transform,j.pixelRatio),ee=new St(Q.LEQUAL,St.ReadWrite,[0,1]),ae=jt.disabled,he=j.colorModeForRenderPass(),ie=j.useProgram("sky"),ue=hu(Z,V);ie.draw(Z,Q.TRIANGLES,ee,ae,he,zt.disabled,te,null,void 0,"sky",ue.vertexBuffer,ue.indexBuffer,ue.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[p[this.currentLayer]],V=g[j.source],Z=b[j.source];this._renderTileClippingMasks(j,Z,!1),this.renderLayer(this,V,j,Z,z)}this.renderPass="translucent";let F=!1;for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const j=this.style._layers[p[this.currentLayer]],V=g[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j,z))continue;this.opaquePassEnabledForLayer()||F||(F=!0,z.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Z=(j.type==="symbol"?M:S)[j.source];this._renderTileClippingMasks(j,b[j.source],!!this.renderToTexture),this.renderLayer(this,V,j,Z,z)}if(z.isRenderingGlobe&&(function(j,V,Z){const Q=j.context,te=Q.gl,ee=j.useProgram("atmosphere"),ae=new St(te.LEQUAL,St.ReadOnly,[0,1]),he=j.transform,ie=(function(Ce,Ke){const Xe=Ce.properties.get("position"),Ue=[-Xe.x,-Xe.y,-Xe.z],Je=o.ar(new Float64Array(16));return Ce.properties.get("anchor")==="map"&&(o.bg(Je,Je,Ke.rollInRadians),o.bh(Je,Je,-Ke.pitchInRadians),o.bg(Je,Je,Ke.bearingInRadians),o.bh(Je,Je,Ke.center.lat*Math.PI/180),o.bJ(Je,Je,-Ke.center.lng*Math.PI/180)),o.cg(Ue,Ue,Je),Ue})(Z,j.transform),ue=he.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),_e=V.properties.get("atmosphere-blend")*ue.projectionTransition;if(_e===0)return;const se=Fa(he.worldSize,he.center.lat),ye=he.inverseProjectionMatrix,Ie=new Float64Array(4);Ie[3]=1,o.aH(Ie,Ie,he.modelViewProjectionMatrix),Ie[0]/=Ie[3],Ie[1]/=Ie[3],Ie[2]/=Ie[3],Ie[3]=1,o.aH(Ie,Ie,ye),Ie[0]/=Ie[3],Ie[1]/=Ie[3],Ie[2]/=Ie[3],Ie[3]=1;const Te=((Ce,Ke,Xe,Ue,Je)=>({u_sun_pos:Ce,u_atmosphere_blend:Ke,u_globe_position:Xe,u_globe_radius:Ue,u_inv_proj_matrix:Je}))(ie,_e,[Ie[0],Ie[1],Ie[2]],se,ye),Le=hu(Q,V);ee.draw(Q,te.TRIANGLES,ae,jt.disabled,ri.alphaBlended,zt.disabled,Te,null,null,"atmosphere",Le.vertexBuffer,Le.indexBuffer,Le.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const j=(function(V,Z){let Q=null;const te=Object.values(V._layers).flatMap((ie=>ie.source&&!ie.isHidden(Z)?[V.tileManagers[ie.source]]:[])),ee=te.filter((ie=>ie.getSource().type==="vector")),ae=te.filter((ie=>ie.getSource().type!=="vector")),he=ie=>{(!Q||Q.getSource().maxzoom<ie.getSource().maxzoom)&&(Q=ie)};return ee.forEach((ie=>he(ie))),Q||ae.forEach((ie=>he(ie))),Q})(this.style,this.transform.zoom);j&&(function(V,Z,Q){for(let te=0;te<Q.length;te++)td(V,Z,Q[te])})(this,j,j.getVisibleCoordinates())}this.options.showPadding&&(function(j){const V=j.transform.padding;lu(j,j.transform.height-(V.top||0),3,Yu),lu(j,V.bottom||0,3,Ju),uu(j,V.left||0,3,Qu),uu(j,j.transform.width-(V.right||0),3,ed);const Z=j.transform.centerPoint;(function(Q,te,ee,ae){zs(Q,te-1,ee-10,2,20,ae),zs(Q,te-10,ee-1,20,2,ae)})(j,Z.x,j.transform.height-Z.y,ho)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=t?!o.cj(a,l):!o.ck(a,l)),d||(d=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),d&&(o.cl(a,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(p,g){const b=p.context,S=b.gl,M=p.transform,z=ri.unblended,F=new St(S.LEQUAL,St.ReadWrite,[0,1]),j=g.tileManager.getRenderableTiles(),V=p.useProgram("terrainDepth");b.bindFramebuffer.set(g.getFramebuffer("depth").framebuffer),b.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),b.clear({color:o.bp.transparent,depth:1});for(const Z of j){const Q=g.getTerrainMesh(Z.tileID),te=g.getTerrainData(Z.tileID),ee=M.getProjectionData({overscaledTileID:Z.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ae={u_ele_delta:g.getMeshFrameDelta(M.zoom)};V.draw(b,S.TRIANGLES,F,jt.disabled,z,zt.backCCW,ae,te,ee,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments)}b.bindFramebuffer.set(null),b.viewport.set([0,0,p.width,p.height])})(this,this.style.map.terrain),(function(p,g){const b=p.context,S=b.gl,M=p.transform,z=ri.unblended,F=new St(S.LEQUAL,St.ReadWrite,[0,1]),j=g.getCoordsTexture(),V=g.tileManager.getRenderableTiles(),Z=p.useProgram("terrainCoords");b.bindFramebuffer.set(g.getFramebuffer("coords").framebuffer),b.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),b.clear({color:o.bp.transparent,depth:1}),g.coordsIndex=[];for(const Q of V){const te=g.getTerrainMesh(Q.tileID),ee=g.getTerrainData(Q.tileID);b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,j.texture);const ae={u_terrain_coords_id:(255-g.coordsIndex.length)/255,u_texture:0,u_ele_delta:g.getMeshFrameDelta(M.zoom)},he=M.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Z.draw(b,S.TRIANGLES,F,jt.disabled,z,zt.backCCW,ae,ee,he,"terrain",te.vertexBuffer,te.indexBuffer,te.segments),g.coordsIndex.push(Q.tileID.key)}b.bindFramebuffer.set(null),b.viewport.set([0,0,p.width,p.height])})(this,this.style.map.terrain))}renderLayer(t,a,l,d,p){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(d||[]).length)&&(this.id=l.id,o.cm(l)?(function(g,b,S,M,z,F){if(g.renderPass!=="translucent")return;const{isRenderingToTexture:j}=F,V=jt.disabled,Z=g.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(Q,te,ee,ae,he,ie,ue,_e,se){const ye=te.transform,Ie=te.style.map.terrain,Te=he==="map",Le=ie==="map";for(const Ce of Q){const Ke=ae.getTile(Ce),Xe=Ke.getBucket(ee);if(!Xe||!Xe.text||!Xe.text.segments.get().length)continue;const Ue=o.ay(Xe.textSizeData,ye.zoom),Je=o.aN(Ke,1,te.transform.zoom),wt=An(Te,te.transform,Je),Qt=ee.layout.get("icon-text-fit")!=="none"&&Xe.hasIconData();if(Ue){const _i=Math.pow(2,ye.zoom-Ke.tileID.overscaledZ),li=Ie?(bi,ui)=>Ie.getElevation(Ce,bi,ui):null;vt(Xe,Te,Le,se,ye,wt,_i,Ue,Qt,o.aO(ye,Ke,ue,_e),Ce.toUnwrapped(),li)}}})(M,g,S,b,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),z),S.paint.get("icon-opacity").constantOr(1)!==0&&Ki(g,b,S,M,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),V,Z,j),S.paint.get("text-opacity").constantOr(1)!==0&&Ki(g,b,S,M,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),V,Z,j),b.map.showCollisionBoxes&&(be(g,b,S,M,!0),be(g,b,S,M,!1))})(t,a,l,d,this.style.placement.variableOffsets,p):o.cn(l)?(function(g,b,S,M,z){if(g.renderPass!=="translucent")return;const{isRenderingToTexture:F}=z,j=S.paint.get("circle-opacity"),V=S.paint.get("circle-stroke-width"),Z=S.paint.get("circle-stroke-opacity"),Q=!S.layout.get("circle-sort-key").isConstant();if(j.constantOr(1)===0&&(V.constantOr(1)===0||Z.constantOr(1)===0))return;const te=g.context,ee=te.gl,ae=g.transform,he=g.getDepthModeForSublayer(0,St.ReadOnly),ie=jt.disabled,ue=g.colorModeForRenderPass(),_e=[],se=ae.getCircleRadiusCorrection();for(let ye=0;ye<M.length;ye++){const Ie=M[ye],Te=b.getTile(Ie),Le=Te.getBucket(S);if(!Le)continue;const Ce=S.paint.get("circle-translate"),Ke=S.paint.get("circle-translate-anchor"),Xe=o.aO(ae,Te,Ce,Ke),Ue=Le.programConfigurations.get(S.id),Je=g.useProgram("circle",Ue),wt=Le.layoutVertexBuffer,Qt=Le.indexBuffer,_i=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ie),li={programConfiguration:Ue,program:Je,layoutVertexBuffer:wt,indexBuffer:Qt,uniformValues:Cs(g,Te,S,Xe,se),terrainData:_i,projectionData:ae.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!F,applyTerrainMatrix:!0})};if(Q){const bi=Le.segments.get();for(const ui of bi)_e.push({segments:new o.aX([ui]),sortKey:ui.sortKey,state:li})}else _e.push({segments:Le.segments,sortKey:0,state:li})}Q&&_e.sort(((ye,Ie)=>ye.sortKey-Ie.sortKey));for(const ye of _e){const{programConfiguration:Ie,program:Te,layoutVertexBuffer:Le,indexBuffer:Ce,uniformValues:Ke,terrainData:Xe,projectionData:Ue}=ye.state;Te.draw(te,ee.TRIANGLES,he,ie,ue,zt.backCCW,Ke,Xe,Ue,S.id,Le,Ce,ye.segments,S.paint,g.transform.zoom,Ie)}})(t,a,l,d,p):o.co(l)?(function(g,b,S,M,z){if(S.paint.get("heatmap-opacity")===0)return;const F=g.context,{isRenderingToTexture:j,isRenderingGlobe:V}=z;if(g.style.map.terrain){for(const Z of M){const Q=b.getTile(Z);b.hasRenderableParent(Z)||(g.renderPass==="offscreen"?Kn(g,Q,S,Z,V):g.renderPass==="translucent"&&Ln(g,S,Z,j,V))}F.viewport.set([0,0,g.width,g.height])}else g.renderPass==="offscreen"?(function(Z,Q,te,ee){const ae=Z.context,he=ae.gl,ie=Z.transform,ue=jt.disabled,_e=new ri([he.ONE,he.ONE],o.bp.transparent,[!0,!0,!0,!0]);(function(se,ye,Ie){const Te=se.gl;se.activeTexture.set(Te.TEXTURE1),se.viewport.set([0,0,ye.width/4,ye.height/4]);let Le=Ie.heatmapFbos.get(o.cd);Le?(Te.bindTexture(Te.TEXTURE_2D,Le.colorAttachment.get()),se.bindFramebuffer.set(Le.framebuffer)):(Le=Pa(se,ye.width/4,ye.height/4),Ie.heatmapFbos.set(o.cd,Le))})(ae,Z,te),ae.clear({color:o.bp.transparent});for(let se=0;se<ee.length;se++){const ye=ee[se];if(Q.hasRenderableParent(ye))continue;const Ie=Q.getTile(ye),Te=Ie.getBucket(te);if(!Te)continue;const Le=Te.programConfigurations.get(te.id),Ce=Z.useProgram("heatmap",Le),Ke=ie.getProjectionData({overscaledTileID:ye,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Xe=ie.getCircleRadiusCorrection();Ce.draw(ae,he.TRIANGLES,St.disabled,ue,_e,zt.backCCW,Va(Ie,ie.zoom,te.paint.get("heatmap-intensity"),Xe),null,Ke,te.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,te.paint,ie.zoom,Le)}ae.viewport.set([0,0,Z.width,Z.height])})(g,b,S,M):g.renderPass==="translucent"&&(function(Z,Q){const te=Z.context,ee=te.gl;te.setColorMode(Z.colorModeForRenderPass());const ae=Q.heatmapFbos.get(o.cd);ae&&(te.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_2D,ae.colorAttachment.get()),te.activeTexture.set(ee.TEXTURE1),ds(te,Q).bind(ee.LINEAR,ee.CLAMP_TO_EDGE),Z.useProgram("heatmapTexture").draw(te,ee.TRIANGLES,St.disabled,jt.disabled,Z.colorModeForRenderPass(),zt.disabled,ul(Z,Q,0,1),null,null,Q.id,Z.viewportBuffer,Z.quadTriangleIndexBuffer,Z.viewportSegments,Q.paint,Z.transform.zoom))})(g,S)})(t,a,l,d,p):o.cp(l)?(function(g,b,S,M,z){if(g.renderPass!=="translucent")return;const{isRenderingToTexture:F}=z,j=S.paint.get("line-opacity"),V=S.paint.get("line-width");if(j.constantOr(1)===0||V.constantOr(1)===0)return;const Z=g.getDepthModeForSublayer(0,St.ReadOnly),Q=g.colorModeForRenderPass(),te=S.paint.get("line-dasharray"),ee=te.constantOr(1),ae=S.paint.get("line-pattern"),he=ae.constantOr(1),ie=S.paint.get("line-gradient"),ue=S.getCrossfadeParameters();let _e;_e=he?"linePattern":ee&&ie?"lineGradientSDF":ee?"lineSDF":ie?"lineGradient":"line";const se=g.context,ye=se.gl,Ie=g.transform;let Te=!0;for(const Le of M){const Ce=b.getTile(Le);if(he&&!Ce.patternsLoaded())continue;const Ke=Ce.getBucket(S);if(!Ke)continue;const Xe=Ke.programConfigurations.get(S.id),Ue=g.context.program.get(),Je=g.useProgram(_e,Xe),wt=Te||Je.program!==Ue,Qt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Le),_i=ae.constantOr(null),li=te&&te.constantOr(null);if(_i&&Ce.imageAtlas){const _n=Ce.imageAtlas,Xi=_n.patternPositions[_i.to.toString()],qi=_n.patternPositions[_i.from.toString()];Xi&&qi&&Xe.setConstantPatternPositions(Xi,qi)}else if(li){const _n=S.layout.get("line-cap")==="round",Xi=g.lineAtlas.getDash(li.to,_n),qi=g.lineAtlas.getDash(li.from,_n);Xe.setConstantDashPositions(Xi,qi)}const bi=Ie.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),ui=Ie.getPixelScale();let Oi;he?(Oi=fa(g,Ce,S,ui,ue),bl(se,ye,Ce,Xe,ue)):ee&&ie?(Oi=Do(g,Ce,S,ui,ue,Ke.lineClipsArray.length),Bn(g,b,se,ye,S,Ke,Le,Xe,ue)):ee?(Oi=Io(g,Ce,S,ui,ue),xi(g,se,ye,Xe,wt,ue)):ie?(Oi=hl(g,Ce,S,ui,Ke.lineClipsArray.length),zr(g,b,se,ye,S,Ke,Le)):Oi=Ta(g,Ce,S,ui);const ki=g.stencilModeForClipping(Le);Je.draw(se,ye.TRIANGLES,Z,ki,Q,zt.disabled,Oi,Qt,bi,S.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,S.paint,g.transform.zoom,Xe,Ke.layoutVertexBuffer2),Te=!1}})(t,a,l,d,p):o.cq(l)?(function(g,b,S,M,z){const F=S.paint.get("fill-color"),j=S.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const{isRenderingToTexture:V}=z,Z=g.colorModeForRenderPass(),Q=S.paint.get("fill-pattern"),te=g.opaquePassEnabledForLayer()&&!Q.constantOr(1)&&F.constantOr(o.bp.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===te){const ee=g.getDepthModeForSublayer(1,g.renderPass==="opaque"?St.ReadWrite:St.ReadOnly);dr(g,b,S,M,ee,Z,!1,V)}if(g.renderPass==="translucent"&&S.paint.get("fill-antialias")){const ee=g.getDepthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,St.ReadOnly);dr(g,b,S,M,ee,Z,!0,V)}})(t,a,l,d,p):o.cr(l)?(function(g,b,S,M,z){const F=S.paint.get("fill-extrusion-opacity");if(F===0)return;const{isRenderingToTexture:j}=z;if(g.renderPass==="translucent"){const V=new St(g.context.gl.LEQUAL,St.ReadWrite,g.depthRangeFor3D);if(F!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))hs(g,b,S,M,V,jt.disabled,ri.disabled,j),hs(g,b,S,M,V,g.stencilModeFor3D(),g.colorModeForRenderPass(),j);else{const Z=g.colorModeForRenderPass();hs(g,b,S,M,V,jt.disabled,Z,j)}}})(t,a,l,d,p):o.cs(l)?(function(g,b,S,M,z){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const{isRenderingToTexture:F}=z,j=g.context,V=g.style.projection.useSubdivision,Z=g.getDepthModeForSublayer(0,St.ReadOnly),Q=g.colorModeForRenderPass();if(g.renderPass==="offscreen")(function(te,ee,ae,he,ie,ue,_e){const se=te.context,ye=se.gl;for(const Ie of ae){const Te=ee.getTile(Ie),Le=Te.dem;if(!Le||!Le.data||!Te.needsHillshadePrepare)continue;const Ce=Le.dim,Ke=Le.stride,Xe=Le.getPixels();if(se.activeTexture.set(ye.TEXTURE1),se.pixelStoreUnpackPremultiplyAlpha.set(!1),Te.demTexture=Te.demTexture||te.getTileTexture(Ke),Te.demTexture){const Je=Te.demTexture;Je.update(Xe,{premultiply:!1}),Je.bind(ye.NEAREST,ye.CLAMP_TO_EDGE)}else Te.demTexture=new o.T(se,Xe,ye.RGBA,{premultiply:!1}),Te.demTexture.bind(ye.NEAREST,ye.CLAMP_TO_EDGE);se.activeTexture.set(ye.TEXTURE0);let Ue=Te.fbo;if(!Ue){const Je=new o.T(se,{width:Ce,height:Ce,data:null},ye.RGBA);Je.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),Ue=Te.fbo=se.createFramebuffer(Ce,Ce,!0,!1),Ue.colorAttachment.set(Je.texture)}se.bindFramebuffer.set(Ue.framebuffer),se.viewport.set([0,0,Ce,Ce]),te.useProgram("hillshadePrepare").draw(se,ye.TRIANGLES,ie,ue,_e,zt.disabled,ru(Te.tileID,Le),null,null,he.id,te.rasterBoundsBuffer,te.quadTriangleIndexBuffer,te.rasterBoundsSegments),Te.needsHillshadePrepare=!1}})(g,b,M,S,Z,jt.disabled,Q),j.viewport.set([0,0,g.width,g.height]);else if(g.renderPass==="translucent")if(V){const[te,ee,ae]=g.stencilConfigForOverlapTwoPass(M);hr(g,b,S,ae,te,Z,Q,!1,F),hr(g,b,S,ae,ee,Z,Q,!0,F)}else{const[te,ee]=g.getStencilConfigForOverlapAndUpdateStencilID(M);hr(g,b,S,ee,te,Z,Q,!1,F)}})(t,a,l,d,p):o.ct(l)?(function(g,b,S,M,z){if(g.renderPass!=="translucent"||!M.length)return;const{isRenderingToTexture:F}=z,j=g.style.projection.useSubdivision,V=g.getDepthModeForSublayer(0,St.ReadOnly),Z=g.colorModeForRenderPass();if(j){const[Q,te,ee]=g.stencilConfigForOverlapTwoPass(M);Fo(g,b,S,ee,Q,V,Z,!1,F),Fo(g,b,S,ee,te,V,Z,!0,F)}else{const[Q,te]=g.getStencilConfigForOverlapAndUpdateStencilID(M);Fo(g,b,S,te,Q,V,Z,!1,F)}})(t,a,l,d,p):o.bU(l)?(function(g,b,S,M,z){if(g.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!M.length)return;const{isRenderingToTexture:F}=z,j=b.getSource(),V=g.style.projection.useSubdivision;if(j instanceof In)Ir(g,b,S,M,null,!1,!1,j.tileCoords,j.flippedWindingOrder,F);else if(V){const[Z,Q,te]=g.stencilConfigForOverlapTwoPass(M);Ir(g,b,S,te,Z,!1,!0,qa,!1,F),Ir(g,b,S,te,Q,!0,!0,qa,!1,F)}else{const[Z,Q]=g.getStencilConfigForOverlapAndUpdateStencilID(M);Ir(g,b,S,Q,Z,!1,!0,qa,!1,F)}})(t,a,l,d,p):o.cu(l)?(function(g,b,S,M,z){const F=S.paint.get("background-color"),j=S.paint.get("background-opacity");if(j===0)return;const{isRenderingToTexture:V}=z,Z=g.context,Q=Z.gl,te=g.style.projection,ee=g.transform,ae=ee.tileSize,he=S.paint.get("background-pattern");if(g.isPatternMissing(he))return;const ie=!he&&F.a===1&&j===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==ie)return;const ue=jt.disabled,_e=g.getDepthModeForSublayer(0,ie==="opaque"?St.ReadWrite:St.ReadOnly),se=g.colorModeForRenderPass(),ye=g.useProgram(he?"backgroundPattern":"background"),Ie=M||vi(ee,{tileSize:ae,terrain:g.style.map.terrain});he&&(Z.activeTexture.set(Q.TEXTURE0),g.imageManager.bind(g.context));const Te=S.getCrossfadeParameters();for(const Le of Ie){const Ce=ee.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),Ke=he?ou(j,g,he,{tileID:Le,tileSize:ae},Te):ns(j,F),Xe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Le),Ue=te.getMeshFromTileID(Z,Le.canonical,!1,!0,"raster");ye.draw(Z,Q.TRIANGLES,_e,ue,se,zt.backCCW,Ke,Xe,Ce,S.id,Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}})(t,0,l,d,p):o.cv(l)&&(function(g,b,S,M){const{isRenderingGlobe:z}=M,F=g.context,j=S.implementation,V=g.style.projection,Z=g.transform,Q=Z.getProjectionDataForCustomLayer(z),te={farZ:Z.farZ,nearZ:Z.nearZ,fov:Z.fov*Math.PI/180,modelViewProjectionMatrix:Z.modelViewProjectionMatrix,projectionMatrix:Z.projectionMatrix,shaderData:{variantName:V.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${V.shaderPreludeCode.vertexSource}`,define:V.shaderDefine},defaultProjectionData:Q},ee=j.renderingMode?j.renderingMode:"2d";if(g.renderPass==="offscreen"){const ae=j.prerender;ae&&(g.setCustomLayerDefaults(),F.setColorMode(g.colorModeForRenderPass()),ae.call(j,F.gl,te),F.setDirty(),g.setBaseState())}else if(g.renderPass==="translucent"){g.setCustomLayerDefaults(),F.setColorMode(g.colorModeForRenderPass()),F.setStencilMode(jt.disabled);const ae=ee==="3d"?g.getDepthModeFor3D():g.getDepthModeForSublayer(0,St.ReadOnly);F.setDepthMode(ae),j.render(F.gl,te),F.setDirty(),g.setBaseState(),F.bindFramebuffer.set(null)}})(t,0,l,p))}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),l=this.imageManager.getPattern(t.to.toString());return!a||!l}useProgram(t,a,l=!1,d=[]){this.cache=this.cache||{};const p=!!this.style.map.terrain,g=this.style.projection,b=l?qt.projectionMercator:g.shaderPreludeCode,S=l?on:g.shaderDefine,M=t+(a?a.cacheKey:"")+`/${l?Pn:g.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(p?"/terrain":"")+(d?`/${d.join("/")}`:"");return this.cache[M]||(this.cache[M]=new Tr(this.context,qt[t],a,su[t],this._showOverdrawInspector,p,b,S,d)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var t,a;if(this._tileTextures){for(const l in this._tileTextures){const d=this._tileTextures[l];if(d)for(const p of d)p.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((t=this.tileExtentMesh.vertexBuffer)===null||t===void 0||t.destroy()),this.tileExtentMesh&&((a=this.tileExtentMesh.indexBuffer)===null||a===void 0||a.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const l in this.cache){const d=this.cache[l];d&&d.program&&this.context.gl.deleteProgram(d.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}function cu(f,t){let a,l=!1,d=null,p=null;const g=()=>{d=null,l&&(f.apply(p,a),d=setTimeout(g,t),l=!1)};return(...b)=>(l=!0,p=this,a=b,d||g(),d)}class fu{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let l;return a.split("&").map((d=>d.split("="))).forEach((d=>{d[0]===this._hashName&&(l=d)})),(l&&l[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:l,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const l=a.join("/");let d=l;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${l}`);let p=window.location.hash.replace(d,"");p.startsWith("#&")?p=p.slice(0,1)+p.slice(2):p==="#"&&(p="");let g=window.location.href.replace(/(#.+)?$/,p);g=g.replace("&&","&"),window.history.replaceState(window.history.state,null,g)},this._updateHash=cu(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,d=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,d),g=Math.round(a.lng*p)/p,b=Math.round(a.lat*p)/p,S=this._map.getBearing(),M=this._map.getPitch();let z="";if(z+=t?`/${g}/${b}/${l}`:`${l}/${b}/${g}`,(S||M)&&(z+="/"+Math.round(10*S)/10),M&&(z+=`/${Math.round(M)}`),this._hashName){const F=this._hashName;let j=!1;const V=window.location.hash.slice(1).split("&").map((Z=>{const Q=Z.split("=")[0];return Q===F?(j=!0,`${Q}=${z}`):Z})).filter((Z=>Z));return j||V.push(`${F}=${z}`),`#${V.join("&")}`}return`#${z}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new o.V(+t[2],+t[1])}catch{return!1}const a=+t[0],l=+(t[3]||0),d=+(t[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&l>=-180&&l<=180&&d>=this._map.getMinPitch()&&d<=this._map.getMaxPitch()}}const co={linearity:.3,easing:o.cw(0,0,.3,1)},nd=o.e({deceleration:2500,maxSpeed:1400},co),La=o.e({deceleration:20,maxSpeed:1400},co),Za=o.e({deceleration:1e3,maxSpeed:360},co),ad=o.e({deceleration:1e3,maxSpeed:90},co),Ha=o.e({deceleration:1e3,maxSpeed:360},co);class qd{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Pe(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=Pe();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)a.zoom+=p.zoomDelta||0,a.bearing+=p.bearingDelta||0,a.pitch+=p.pitchDelta||0,a.roll+=p.rollDelta||0,p.panDelta&&a.pan._add(p.panDelta),p.around&&(a.around=p.around),p.pinchAround&&(a.pinchAround=p.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const p=Ds(a.pan.mag(),l,o.e({},nd,t||{})),g=a.pan.mult(p.amount/a.pan.mag()),b=this._map.cameraHelper.handlePanInertia(g,this._map.transform);d.center=b.easingCenter,d.offset=b.easingOffset,Is(d,p)}if(a.zoom){const p=Ds(a.zoom,l,La);d.zoom=this._map.transform.zoom+p.amount,Is(d,p)}if(a.bearing){const p=Ds(a.bearing,l,Za);d.bearing=this._map.transform.bearing+o.an(p.amount,-179,179),Is(d,p)}if(a.pitch){const p=Ds(a.pitch,l,ad);d.pitch=this._map.transform.pitch+p.amount,Is(d,p)}if(a.roll){const p=Ds(a.roll,l,Ha);d.roll=this._map.transform.roll+o.an(p.amount,-179,179),Is(d,p)}if(d.zoom||d.bearing){const p=a.pinchAround===void 0?a.around:a.pinchAround;d.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),o.e(d,{noMoveStart:!0})}}function Is(f,t){(!f.duration||f.duration<t.duration)&&(f.duration=t.duration,f.easing=t.easing)}function Ds(f,t,a){const{maxSpeed:l,linearity:d,deceleration:p}=a,g=o.an(f*d/(t/1e3),-l,l),b=Math.abs(g)/(p*d);return{easing:a.easing,duration:1e3*b,amount:g*(b/2)}}class pn extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l,d={}){l=l instanceof MouseEvent?l:new MouseEvent(t,l);const p=le.mousePos(a.getCanvas(),l),g=a.unproject(p);super(t,o.e({point:p,lngLat:g,originalEvent:l},d)),this._defaultPrevented=!1,this.target=a}}class As extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l){const d=t==="touchend"?l.changedTouches:l.touches,p=le.touchPos(a.getCanvasContainer(),d),g=p.map((S=>a.unproject(S))),b=p.reduce(((S,M,z,F)=>S.add(M.div(F.length))),new o.P(0,0));super(t,{points:p,point:b,lngLats:g,lngLat:a.unproject(b),originalEvent:l}),this._defaultPrevented=!1}}class rd extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l){super(t,{originalEvent:l}),this._defaultPrevented=!1}}class Zd{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new rd(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new pn(t.type,this._map,t))}mouseup(t){this._map.fire(new pn(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new pn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new pn(t.type,this._map,t))}mouseover(t){this._map.fire(new pn(t.type,this._map,t))}mouseout(t){this._map.fire(new pn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new As(t.type,this._map,t))}touchmove(t){this._map.fire(new As(t.type,this._map,t))}touchend(t){this._map.fire(new As(t.type,this._map,t))}touchcancel(t){this._map.fire(new As(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hd{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new pn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new pn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new pn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cs{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(o.P.convert(t),this._map.terrain)}}class fs{constructor(t,a){this._map=t,this._tr=new cs(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(le.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const l=a;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=l,this._box||(this._box=le.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const p=Math.min(d.x,l.x),g=Math.max(d.x,l.x),b=Math.min(d.y,l.y),S=Math.max(d.y,l.y);le.setTransform(this._box,`translate(${p}px,${b}px)`),this._box.style.width=g-p+"px",this._box.style.height=S-b+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const l=this._startPos,d=a;if(this.reset(),le.suppressClick(),l.x!==d.x||l.y!==d.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:t})),{cameraAnimation:p=>p.fitScreenCoordinates(l,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(le.remove(this._box),this._box=null),le.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new o.l(t,{originalEvent:a}))}}function Wa(f,t){if(f.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${t.length}`);const a={};for(let l=0;l<f.length;l++)a[f[l].identifier]=t[l];return a}class ot{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),l.length===this.numTouches&&(this.centroid=(function(d){const p=new o.P(0,0);for(const g of d)p._add(g);return p.div(d.length)})(a),this.touches=Wa(l,a)))}touchmove(t,a,l){if(this.aborted||!this.centroid)return;const d=Wa(l,a);for(const p in this.touches){const g=d[p];(!g||g.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(t,a,l){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Sl{constructor(t){this.singleTap=new ot(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,l){this.singleTap.touchstart(t,a,l)}touchmove(t,a,l){this.singleTap.touchmove(t,a,l)}touchend(t,a,l){const d=this.singleTap.touchend(t,a,l);if(d){const p=t.timeStamp-this.lastTime<500,g=!this.lastTap||this.lastTap.dist(d)<30;if(p&&g||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class mu{constructor(t){this._tr=new cs(t),this._zoomIn=new Sl({numTouches:1,numTaps:2}),this._zoomOut=new Sl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,l){this._zoomIn.touchstart(t,a,l),this._zoomOut.touchstart(t,a,l)}touchmove(t,a,l){this._zoomIn.touchmove(t,a,l),this._zoomOut.touchmove(t,a,l)}touchend(t,a,l){const d=this._zoomIn.touchend(t,a,l),p=this._zoomOut.touchend(t,a,l),g=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:g.zoom+1,around:g.unproject(d)},{originalEvent:t})}):p?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:g.zoom-1,around:g.unproject(p)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ms{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=Array.isArray(a)?a[0]:a;return!this._moved&&d.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(l,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&le.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Rs=0,js=2,pu={[Rs]:1,[js]:2};class Fs{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=le.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(a,l){const d=pu[l];return a.buttons===void 0||(a.buttons&d)!==d})(t,this._eventButton)}isValidEndEvent(t){return le.mouseButton(t)===this._eventButton}}class _u{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class od{constructor(t=new Fs({checkCorrectEvent:()=>!0}),a=new _u){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(t,a,l){return t instanceof MouseEvent?a(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?l(t):void 0}startMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const ps=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=t=>{t.preventDefault()}};class Wd{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,l){return this._calculateTransform(t,a,l)}touchmove(t,a,l){if(this._active){if(!this._shouldBePrevented(l.length))return t.preventDefault(),this._calculateTransform(t,a,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,l){this._calculateTransform(t,a,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,l){l.length>0&&(this._active=!0);const d=Wa(l,a),p=new o.P(0,0),g=new o.P(0,0);let b=0;for(const M in d){const z=d[M],F=this._touches[M];F&&(p._add(z),g._add(z.sub(F)),b++,d[M]=z)}if(this._touches=d,this._shouldBePrevented(b)||!g.mag())return;const S=g.div(b);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(b),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Tl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,l){if(!this._firstTwoTouches)return;t.preventDefault();const[d,p]=this._firstTwoTouches,g=Pl(l,a,d),b=Pl(l,a,p);if(!g||!b)return;const S=this._aroundCenter?null:g.add(b).div(2);return this._move([g,b],S,t)}touchend(t,a,l){if(!this._firstTwoTouches)return;const[d,p]=this._firstTwoTouches,g=Pl(l,a,d),b=Pl(l,a,p);g&&b||(this._active&&le.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Pl(f,t,a){for(let l=0;l<f.length;l++)if(f[l].identifier===a)return t[l]}function sd(f,t){return Math.log(f/t)/Math.LN2}class gu extends Tl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const l=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(sd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:sd(this._distance,l),pinchAround:a}}}function ld(f,t){return 180*f.angleWith(t)/Math.PI}class yu extends Tl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,l){const d=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ld(this._vector,d),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,l=ld(t,this._startVector);return Math.abs(l)<a}}function vu(f){return Math.abs(f.y)>Math.abs(f.x)}class ud extends Tl{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,l){super.touchstart(t,a,l),this._currentTouchCount=l.length}_start(t){this._lastPoints=t,vu(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),p=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,p,l.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+p.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,l){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,p=a.mag()>=2;if(!d&&!p)return;if(!d||!p)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const g=t.y>0==a.y>0;return vu(t)&&vu(a)&&g}}const fo={panStep:100,bearingStep:15,pitchStep:10};class oi{constructor(t){this._tr=new cs(t);const a=fo;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,l=0,d=0,p=0,g=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?l=-1:(t.preventDefault(),p=-1);break;case 39:t.shiftKey?l=1:(t.preventDefault(),p=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),g=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),g=1);break;default:return}return this._rotationDisabled&&(l=0,d=0),{cameraAnimation:b=>{const S=this._tr;b.easeTo({duration:300,easeId:"keyboardHandler",easing:Kd,zoom:a?Math.round(S.zoom)+a*(t.shiftKey?2:1):S.zoom,bearing:S.bearing+l*this._bearingStep,pitch:S.pitch+d*this._pitchStep,offset:[-p*this._panStep,-g*this._panStep],center:S.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Kd(f){return f*(2-f)}const Bs=4.000244140625,Ll=1/450;class Ml{constructor(t,a){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=t,this._tr=new cs(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ll}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const l=Pe(),d=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,a!==0&&a%Bs==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=le.mousePos(this._map.getCanvas(),t),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(o.V.convert(l.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const b=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=b),typeof this._targetZoom=="number"&&(this._targetZoom+=b)}if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>Bs?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&S!==0&&(S=1/S);const M=typeof this._targetZoom!="number"?t.scale:o.aq(this._targetZoom);this._targetZoom=t.applyConstrain(t.getCameraLngLat(),o.at(M*S)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,l=this._startZoom,d=this._easing;let p,g=!1;if(this._type==="wheel"&&l&&d){const b=Pe()-this._lastWheelEventTime,S=Math.min((b+5)/200,1),M=d(S);p=o.G.number(l,a,M),S<1?this._frameId||(this._frameId=!0):g=!0}else p=a,g=!0;return this._active=!0,g&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=p,{noInertia:!0,needsRenderFrame:!g,zoomDelta:p-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=o.cy;if(this._prevEase){const l=this._prevEase,d=(Pe()-l.start)/l.duration,p=l.easing(d+.01)-l.easing(d),g=.27/Math.sqrt(p*p+1e-4)*.01,b=Math.sqrt(.0729-g*g);a=o.cw(g,b,.25,1)}return this._prevEase={start:Pe(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class xu{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class dd{constructor(t){this._tr=new cs(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hd{constructor(){this._tap=new Sl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,l){if(!this._swipePoint)if(this._tapTime){const d=a[0],p=t.timeStamp-this._tapTime<500,g=this._tapPoint.dist(d)<30;p&&g?l.length>0&&(this._swipePoint=d,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(t,a,l)}touchmove(t,a,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const d=a[0],p=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(t,a,l)}touchend(t,a,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const d=this._tap.touchend(t,a,l);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cd{constructor(t,a,l){this._el=t,this._mousePan=a,this._touchPan=l}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ka{constructor(t,a,l,d){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=a,this._mousePitch=l,this._mouseRoll=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Os{constructor(t,a,l,d){this._el=t,this._touchZoom=a,this._touchRotate=l,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ht{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=le.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=a,this._container.appendChild(d);const p=document.createElement("div");p.className="maplibregl-mobile-message",p.textContent=l,this._container.appendChild(p),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(le.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const ft=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class $s extends o.l{}function Cl(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class El{constructor(t,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,p)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const g=d.type==="renderFrame"?void 0:d,b={needsRenderFrame:!1},S={},M={};for(const{handlerName:j,handler:V,allowed:Z}of this._handlers){if(!V.isEnabled())continue;let Q;if(this._blockedByActive(M,Z,j))V.reset();else if(V[p||d.type]){if(o.cz(d,p||d.type)){const te=le.mousePos(this._map.getCanvas(),d);Q=V[p||d.type](d,te)}else if(o.cA(d,p||d.type)){const te=this._getMapTouches(d.touches),ee=le.touchPos(this._map.getCanvas(),te);Q=V[p||d.type](d,ee,te)}else o.cB(p||d.type)||(Q=V[p||d.type](d));this.mergeHandlerResult(b,S,Q,j,g),Q&&Q.needsRenderFrame&&this._triggerRenderFrame()}(Q||V.isActive())&&(M[j]=V)}const z={};for(const j in this._previousActiveHandlers)M[j]||(z[j]=g);this._previousActiveHandlers=M,(Object.keys(z).length||Cl(b))&&(this._changes.push([b,S,z]),this._triggerRenderFrame()),(Object.keys(M).length||Cl(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:F}=b;F&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],F(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qd(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,p,g]of this._listeners)le.addEventListener(d,p,d===document?this.handleWindowEvent:this.handleEvent,g)}destroy(){for(const[t,a,l]of this._listeners)le.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(t){const a=this._map,l=a.getCanvasContainer();this._add("mapEvent",new Zd(a,t));const d=a.boxZoom=new fs(a,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const p=a.cooperativeGestures=new ht(a,t.cooperativeGestures);this._add("cooperativeGestures",p),t.cooperativeGestures&&p.enable();const g=new mu(a),b=new dd(a);a.doubleClickZoom=new xu(b,g),this._add("tapZoom",g),this._add("clickZoom",b),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const S=new hd;this._add("tapDragZoom",S);const M=a.touchPitch=new ud(a);this._add("touchPitch",M),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const z=()=>a.project(a.getCenter()),F=(function({enable:ie,clickTolerance:ue,aroundCenter:_e=!0,minPixelCenterThreshold:se=100,rotateDegreesPerPixelMoved:ye=.8},Ie){const Te=new Fs({checkCorrectEvent:Le=>le.mouseButton(Le)===0&&Le.ctrlKey||le.mouseButton(Le)===2&&!Le.ctrlKey});return new ms({clickTolerance:ue,move:(Le,Ce)=>{const Ke=Ie();if(_e&&Math.abs(Ke.y-Le.y)>se)return{bearingDelta:o.cx(new o.P(Le.x,Ce.y),Ce,Ke)};let Xe=(Ce.x-Le.x)*ye;return _e&&Ce.y<Ke.y&&(Xe=-Xe),{bearingDelta:Xe}},moveStateManager:Te,enable:ie,assignEvents:ps})})(t,z),j=(function({enable:ie,clickTolerance:ue,pitchDegreesPerPixelMoved:_e=-.5}){const se=new Fs({checkCorrectEvent:ye=>le.mouseButton(ye)===0&&ye.ctrlKey||le.mouseButton(ye)===2});return new ms({clickTolerance:ue,move:(ye,Ie)=>({pitchDelta:(Ie.y-ye.y)*_e}),moveStateManager:se,enable:ie,assignEvents:ps})})(t),V=(function({enable:ie,clickTolerance:ue,rollDegreesPerPixelMoved:_e=.3},se){const ye=new Fs({checkCorrectEvent:Ie=>le.mouseButton(Ie)===2&&Ie.ctrlKey});return new ms({clickTolerance:ue,move:(Ie,Te)=>{const Le=se();let Ce=(Te.x-Ie.x)*_e;return Te.y<Le.y&&(Ce=-Ce),{rollDelta:Ce}},moveStateManager:ye,enable:ie,assignEvents:ps})})(t,z);a.dragRotate=new Ka(t,F,j,V),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",j,["mouseRotate","mouseRoll"]),this._add("mouseRoll",V,["mousePitch"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const Z=(function({enable:ie,clickTolerance:ue}){const _e=new Fs({checkCorrectEvent:se=>le.mouseButton(se)===0&&!se.ctrlKey});return new ms({clickTolerance:ue,move:(se,ye)=>({around:ye,panDelta:ye.sub(se)}),activateOnStart:!0,moveStateManager:_e,enable:ie,assignEvents:ps})})(t),Q=new Wd(t,a);a.dragPan=new cd(l,Z,Q),this._add("mousePan",Z),this._add("touchPan",Q,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const te=new yu,ee=new gu;a.touchZoomRotate=new Os(l,ee,te,S),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate),this._add("blockableMapEvent",new Hd(a));const ae=a.scrollZoom=new Ml(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",ae,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const he=a.keyboard=new oi(a);this._add("keyboard",he),t.interactive&&t.keyboard&&a.keyboard.enable()}_add(t,a,l){this._handlers.push({handlerName:t,handler:a,allowed:l}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ft(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,l){for(const d in t)if(d!==l&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const l of t)this._el.contains(l.target)&&a.push(l);return a}mergeHandlerResult(t,a,l,d,p){if(!l)return;o.e(t,l);const g={handlerName:d,originalEvent:l.originalEvent||p};l.zoomDelta!==void 0&&(a.zoom=g),l.panDelta!==void 0&&(a.drag=g),l.rollDelta!==void 0&&(a.roll=g),l.pitchDelta!==void 0&&(a.pitch=g),l.bearingDelta!==void 0&&(a.rotate=g)}_applyChanges(){const t={},a={},l={};for(const[d,p,g]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new o.P(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.rollDelta&&(t.rollDelta=(t.rollDelta||0)+d.rollDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),o.e(a,p),o.e(l,g);this._updateMapTransform(t,a,l),this._changes=[]}_updateMapTransform(t,a,l){const d=this._map,p=d._getTransformForUpdate(),g=d.terrain;if(!(Cl(t)||g&&this._terrainMovement))return this._fireEvents(a,l,!0);d._stop(!0);let{panDelta:b,zoomDelta:S,bearingDelta:M,pitchDelta:z,rollDelta:F,around:j,pinchAround:V}=t;V!==void 0&&(j=V),j=j||d.transform.centerPoint,g&&!p.isPointOnMapSurface(j)&&(j=p.centerPoint);const Z={panDelta:b,zoomDelta:S,rollDelta:F,pitchDelta:z,bearingDelta:M,around:j};this._map.cameraHelper.useGlobeControls&&!p.isPointOnMapSurface(j)&&(j=p.centerPoint);const Q=j.distSqr(p.centerPoint)<.01?p.center:p.screenPointToLocation(b?j.sub(b):j);this._handleMapControls({terrain:g,tr:p,deltasForHelper:Z,preZoomAroundLoc:Q,combinedEventsInProgress:a,panDelta:b}),d._applyUpdatedTransform(p),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,l,!0)}_handleMapControls({terrain:t,tr:a,deltasForHelper:l,preZoomAroundLoc:d,combinedEventsInProgress:p,panDelta:g}){const b=this._map.cameraHelper;if(b.handleMapControlsRollPitchBearingZoom(l,a),t)return b.useGlobeControls?(this._terrainMovement||!p.drag&&!p.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void b.handleMapControlsPan(l,a,d)):this._terrainMovement||!p.drag&&!p.zoom?void(p.drag&&this._terrainMovement&&g?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(g))):b.handleMapControlsPan(l,a,d)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void b.handleMapControlsPan(l,a,d));b.handleMapControlsPan(l,a,d)}_fireEvents(t,a,l){const d=ft(this._eventsInProgress),p=ft(t),g={};for(const F in t){const{originalEvent:j}=t[F];this._eventsInProgress[F]||(g[`${F}start`]=j),this._eventsInProgress[F]=t[F]}!d&&p&&this._fireEvent("movestart",p.originalEvent);for(const F in g)this._fireEvent(F,g[F]);p&&this._fireEvent("move",p.originalEvent);for(const F in t){const{originalEvent:j}=t[F];this._fireEvent(F,j)}const b={};let S;for(const F in this._eventsInProgress){const{handlerName:j,originalEvent:V}=this._eventsInProgress[F];this._handlersById[j].isActive()||(delete this._eventsInProgress[F],S=a[j]||V,b[`${F}end`]=S)}for(const F in b)this._fireEvent(F,b[F]);const M=ft(this._eventsInProgress),z=(d||p)&&!M;if(z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const F=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&F.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(F)}if(l&&z){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=V=>V!==0&&-this._bearingSnap<V&&V<this._bearingSnap;!F||!F.essential&&ce.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:S})),j(this._map.getBearing())&&this._map.resetNorth()):(j(F.bearing||this._map.getBearing())&&(F.bearing=0),F.freezeElevation=!0,this._map.easeTo(F,{originalEvent:S})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new o.l(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new $s("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Xn extends o.E{constructor(t,a,l){super(),this._renderFrameCallback=()=>{const d=Math.min((Pe()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=l.bearingSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,a){t.apply(this.transform),this.transform=t,this.cameraHelper=a}getCenter(){return new o.V(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,a){return this.jumpTo({elevation:t},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,a,l){return t=o.P.convert(t).mult(-1),this.panTo(this.transform.center,o.e({offset:t},a),l)}panTo(t,a,l){return this.easeTo(o.e({center:t},a),l)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,l){return this.easeTo(o.e({zoom:t},a),l)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,a){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new o.l("movestart",a)).fire(new o.l("move",a)).fire(new o.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,l){return this.easeTo(o.e({bearing:t},a),l)}resetNorth(t,a){return this.rotateTo(0,o.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}getRoll(){return this.transform.roll}setRoll(t,a){return this.jumpTo({roll:t},a),this}cameraForBounds(t,a){t=hi.convert(t).adjustAntiMeridian();const l=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),l,a)}_cameraForBoxAndBearing(t,a,l,d){const p={top:0,bottom:0,right:0,left:0};if(typeof(d=o.e({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const M=d.padding;d.padding={top:M,bottom:M,right:M,left:M}}const g=o.e(p,d.padding);d.padding=g;const b=this.transform,S=new hi(t,a);return this.cameraHelper.cameraForBoxAndBearing(d,g,S,l,b)}fitBounds(t,a,l){return this._fitInternal(this.cameraForBounds(t,a),a,l)}fitScreenCoordinates(t,a,l,d,p){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(t)),this.transform.screenPointToLocation(o.P.convert(a)),l,d),d,p)}_fitInternal(t,a,l){return t?(delete(a=o.e(t,a)).padding,a.linear?this.easeTo(a,l):this.flyTo(a,l)):this}jumpTo(t,a){this.stop();const l=this._getTransformForUpdate();let d=!1,p=!1,g=!1;const b=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,t);const S=l.zoom!==b;return"elevation"in t&&l.elevation!==+t.elevation&&l.setElevation(+t.elevation),"bearing"in t&&l.bearing!==+t.bearing&&(d=!0,l.setBearing(+t.bearing)),"pitch"in t&&l.pitch!==+t.pitch&&(p=!0,l.setPitch(+t.pitch)),"roll"in t&&l.roll!==+t.roll&&(g=!0,l.setRoll(+t.roll)),t.padding==null||l.isPaddingEqual(t.padding)||l.setPadding(t.padding),this._applyUpdatedTransform(l),this.fire(new o.l("movestart",a)).fire(new o.l("move",a)),S&&this.fire(new o.l("zoomstart",a)).fire(new o.l("zoom",a)).fire(new o.l("zoomend",a)),d&&this.fire(new o.l("rotatestart",a)).fire(new o.l("rotate",a)).fire(new o.l("rotateend",a)),p&&this.fire(new o.l("pitchstart",a)).fire(new o.l("pitch",a)).fire(new o.l("pitchend",a)),g&&this.fire(new o.l("rollstart",a)).fire(new o.l("roll",a)).fire(new o.l("rollend",a)),this.fire(new o.l("moveend",a))}calculateCameraOptionsFromTo(t,a,l,d=0){const p=o.a9.fromLngLat(t,a),g=o.a9.fromLngLat(l,d),b=g.x-p.x,S=g.y-p.y,M=g.z-p.z,z=Math.hypot(b,S,M);if(z===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(b,S),j=o.at(this.transform.cameraToCenterDistance/z/this.transform.tileSize),V=180*Math.atan2(b,-S)/Math.PI;let Z=180*Math.acos(F/z)/Math.PI;return Z=M<0?90-Z:90+Z,{center:g.toLngLat(),elevation:d,zoom:j,pitch:Z,bearing:V}}calculateCameraOptionsFromCameraLngLatAltRotation(t,a,l,d,p){const g=this.transform.calculateCenterFromCameraLngLatAlt(t,a,l,d);return{center:g.center,elevation:g.elevation,zoom:g.zoom,bearing:l,pitch:d,roll:p}}easeTo(t,a){this._stop(!1,t.easeId),((t=o.e({offset:[0,0],duration:500,easing:o.cy},t)).animate===!1||!t.essential&&ce.prefersReducedMotion)&&(t.duration=0);const l=this._getTransformForUpdate(),d=this.getBearing(),p=l.pitch,g=l.roll,b="bearing"in t?this._normalizeBearing(t.bearing,d):d,S="pitch"in t?+t.pitch:p,M="roll"in t?this._normalizeBearing(t.roll,g):g,z="padding"in t?t.padding:l.padding,F=o.P.convert(t.offset);let j,V;t.around&&(j=o.V.convert(t.around),V=l.locationToScreenPoint(j));const Z={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Q=this.cameraHelper.handleEaseTo(l,{bearing:b,pitch:S,roll:M,padding:z,around:j,aroundPoint:V,offsetAsPoint:F,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||d!==b,this._pitching=this._pitching||S!==p,this._rolling=this._rolling||M!==g,this._padding=!l.isPaddingEqual(z),this._zooming=this._zooming||Q.isZooming,this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,Z),this.terrain&&this._prepareElevation(Q.elevationCenter),this._ease((te=>{Q.easeFunc(te),this.terrain&&!t.freezeElevation&&this._updateElevation(te),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(te=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,te)}),t),this}_prepareEase(t,a,l={}){this._moving=!0,a||l.moving||this.fire(new o.l("movestart",t)),this._zooming&&!l.zooming&&this.fire(new o.l("zoomstart",t)),this._rotating&&!l.rotating&&this.fire(new o.l("rotatestart",t)),this._pitching&&!l.pitching&&this.fire(new o.l("pitchstart",t)),this._rolling&&!l.rolling&&this.fire(new o.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(l-(a-(l*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.setElevation(o.G.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const a=t.getCameraLngLat(),l=t.getCameraAltitude(),d=this.terrain?this.terrain.getElevationForLngLatZoom(a,t.zoom):0;if(l<d){const p=this.calculateCameraOptionsFromTo(a,d,t.center,t.elevation);return{pitch:p.pitch,zoom:p.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(a.push((d=>this._elevateCameraIfInsideTerrain(d))),this.transformCameraUpdate&&a.push((d=>this.transformCameraUpdate(d))),!a.length)return;const l=t.clone();for(const d of a){const p=l.clone(),{center:g,zoom:b,roll:S,pitch:M,bearing:z,elevation:F}=d(p);g&&p.setCenter(g),F!==void 0&&p.setElevation(F),b!==void 0&&p.setZoom(b),S!==void 0&&p.setRoll(S),M!==void 0&&p.setPitch(M),z!==void 0&&p.setBearing(z),l.apply(p)}this.transform.apply(l)}_fireMoveEvents(t){this.fire(new o.l("move",t)),this._zooming&&this.fire(new o.l("zoom",t)),this._rotating&&this.fire(new o.l("rotate",t)),this._pitching&&this.fire(new o.l("pitch",t)),this._rolling&&this.fire(new o.l("roll",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const l=this._zooming,d=this._rotating,p=this._pitching,g=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new o.l("zoomend",t)),d&&this.fire(new o.l("rotateend",t)),p&&this.fire(new o.l("pitchend",t)),g&&this.fire(new o.l("rollend",t)),this.fire(new o.l("moveend",t))}flyTo(t,a){if(!t.essential&&ce.prefersReducedMotion){const Ce=o.U(t,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Ce,a)}this.stop(),t=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cy},t);const l=this._getTransformForUpdate(),d=l.bearing,p=l.pitch,g=l.roll,b=l.padding,S="bearing"in t?this._normalizeBearing(t.bearing,d):d,M="pitch"in t?+t.pitch:p,z="roll"in t?this._normalizeBearing(t.roll,g):g,F="padding"in t?t.padding:l.padding,j=o.P.convert(t.offset);let V=l.centerPoint.add(j);const Z=l.screenPointToLocation(V),Q=this.cameraHelper.handleFlyTo(l,{bearing:S,pitch:M,roll:z,padding:F,locationAtOffset:Z,offsetAsPoint:j,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let te=t.curve;const ee=Math.max(l.width,l.height),ae=ee/Q.scaleOfZoom,he=Q.pixelPathLength;typeof Q.scaleOfMinZoom=="number"&&(te=Math.sqrt(ee/Q.scaleOfMinZoom/he*2));const ie=te*te;function ue(Ce){const Ke=(ae*ae-ee*ee+(Ce?-1:1)*ie*ie*he*he)/(2*(Ce?ae:ee)*ie*he);return Math.log(Math.sqrt(Ke*Ke+1)-Ke)}function _e(Ce){return(Math.exp(Ce)-Math.exp(-Ce))/2}function se(Ce){return(Math.exp(Ce)+Math.exp(-Ce))/2}const ye=ue(!1);let Ie=function(Ce){return se(ye)/se(ye+te*Ce)},Te=function(Ce){return ee*((se(ye)*(_e(Ke=ye+te*Ce)/se(Ke))-_e(ye))/ie)/he;var Ke},Le=(ue(!0)-ye)/te;if(Math.abs(he)<2e-6||!isFinite(Le)){if(Math.abs(ee-ae)<1e-6)return this.easeTo(t,a);const Ce=ae<ee?-1:1;Le=Math.abs(Math.log(ae/ee))/te,Te=()=>0,Ie=Ke=>Math.exp(Ce*te*Ke)}return t.duration="duration"in t?+t.duration:1e3*Le/("screenSpeed"in t?+t.screenSpeed/te:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=d!==S,this._pitching=M!==p,this._rolling=z!==g,this._padding=!l.isPaddingEqual(F),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(Q.targetCenter),this._ease((Ce=>{const Ke=Ce*Le,Xe=1/Ie(Ke),Ue=Te(Ke);this._rotating&&l.setBearing(o.G.number(d,S,Ce)),this._pitching&&l.setPitch(o.G.number(p,M,Ce)),this._rolling&&l.setRoll(o.G.number(g,z,Ce)),this._padding&&(l.interpolatePadding(b,F,Ce),V=l.centerPoint.add(j)),Q.easeFunc(Ce,Xe,Ue,V),this.terrain&&!t.freezeElevation&&this._updateElevation(Ce),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,a)}return t||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(t,a,l){l.animate===!1||l.duration===0?(t(1),a()):(this._easeStart=Pe(),this._easeOptions=l,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=o.W(t,-180,180);const l=Math.abs(t-a);return Math.abs(t-360-a)<l&&(t-=360),Math.abs(t+360-a)<l&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLat(o.V.convert(t),this.transform):null}}const Ma={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class wu{constructor(t=Ma){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=le.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=le.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=le.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){le.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const l=this._map._getUIString(`AttributionControl.${a}`);t.title=l,t.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((d=>typeof d!="string"?"":d))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.tileManagers;for(const d in a){const p=a[d];if(p.used||p.usedForTerrain){const g=p.getSource();g.attribution&&t.indexOf(g.attribution)<0&&t.push(g.attribution)}}t=t.filter((d=>String(d).trim())),t.sort(((d,p)=>d.length-p.length)),t=t.filter(((d,p)=>{for(let g=p+1;g<t.length;g++)if(t[g].indexOf(d)>=0)return!1;return!0}));const l=t.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,t.length?(this._innerContainer.innerHTML=le.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class fd{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const l=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=le.create("div","maplibregl-ctrl");const a=le.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){le.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Xd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,l=a?this._queue.concat(a):this._queue;for(const d of l)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const l of a)if(!l.cancelled&&(l.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Yd=o.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Vs extends o.E{constructor(t){super(),this._lastTilesetChange=Pe(),this.tileManager=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(t,a){this.tileManager.update(t,a),this._renderableTilesKeys=[];const l={};for(const d of vi(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.tileManager._source.calculateTileZoom}))l[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.terrainRttPosMatrix32f=new Float64Array(16),o.c7(d.terrainRttPosMatrix32f,0,o.a5,o.a5,0,0,1),this._tiles[d.key]=new Ge(d,this.tileSize),this._lastTilesetChange=Pe());for(const d in this._tiles)l[d]||delete this._tiles[d]}freeRtt(t){for(const a in this._tiles){const l=this._tiles[a];(!t||l.tileID.equals(t)||l.tileID.isChildOf(t)||t.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,a){return a?this._getTerrainCoordsForTileRanges(t,a):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const a={};for(const l of this._renderableTilesKeys){const d=this._tiles[l].tileID,p=t.clone(),g=o.bk();if(d.canonical.equals(t.canonical))o.c7(g,0,o.a5,o.a5,0,0,1);else if(d.canonical.isChildOf(t.canonical)){const b=d.canonical.z-t.canonical.z,S=d.canonical.x-(d.canonical.x>>b<<b),M=d.canonical.y-(d.canonical.y>>b<<b),z=o.a5>>b;o.c7(g,0,z,z,0,0,1),o.O(g,g,[-S*z,-M*z,0])}else{if(!t.canonical.isChildOf(d.canonical))continue;{const b=t.canonical.z-d.canonical.z,S=t.canonical.x-(t.canonical.x>>b<<b),M=t.canonical.y-(t.canonical.y>>b<<b),z=o.a5>>b;o.c7(g,0,o.a5,o.a5,0,0,1),o.O(g,g,[S*z,M*z,0]),o.Q(g,g,[1/2**b,1/2**b,0])}}p.terrainRttPosMatrix32f=new Float32Array(g),a[l]=p}return a}_getTerrainCoordsForTileRanges(t,a){const l={};for(const d of this._renderableTilesKeys){const p=this._tiles[d].tileID;if(!this._isWithinTileRanges(p,a))continue;const g=t.clone(),b=o.bk();if(p.canonical.z===t.canonical.z){const S=t.canonical.x-p.canonical.x,M=t.canonical.y-p.canonical.y;o.c7(b,0,o.a5,o.a5,0,0,1),o.O(b,b,[S*o.a5,M*o.a5,0])}else if(p.canonical.z>t.canonical.z){const S=p.canonical.z-t.canonical.z,M=p.canonical.x-(p.canonical.x>>S<<S),z=p.canonical.y-(p.canonical.y>>S<<S),F=t.canonical.x-(p.canonical.x>>S),j=t.canonical.y-(p.canonical.y>>S),V=o.a5>>S;o.c7(b,0,V,V,0,0,1),o.O(b,b,[-M*V+F*o.a5,-z*V+j*o.a5,0])}else{const S=t.canonical.z-p.canonical.z,M=t.canonical.x-(t.canonical.x>>S<<S),z=t.canonical.y-(t.canonical.y>>S<<S),F=(t.canonical.x>>S)-p.canonical.x,j=(t.canonical.y>>S)-p.canonical.y,V=o.a5<<S;o.c7(b,0,V,V,0,0,1),o.O(b,b,[M*o.a5+F*V,z*o.a5+j*V,0])}g.terrainRttPosMatrix32f=new Float32Array(b),l[d]=g}return l}getSourceTile(t,a){const l=this.tileManager._source;let d=t.overscaledZ-this.deltaZoom;if(d>l.maxzoom&&(d=l.maxzoom),d<l.minzoom)return;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let p=this.findTileInCaches(this._sourceTileCache[t.key]);if(!p?.dem&&a)for(;d>=l.minzoom&&!p?.dem;)p=this.findTileInCaches(t.scaledTo(d--).key);return p}findTileInCaches(t){let a=this.tileManager.getTileByID(t);return a||(a=this.tileManager._outOfViewCache.getByKey(t),a)}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,a){return a[t.canonical.z]&&t.canonical.x>=a[t.canonical.z].minTileX&&t.canonical.x<=a[t.canonical.z].maxTileX&&t.canonical.y>=a[t.canonical.z].minTileY&&t.canonical.y<=a[t.canonical.z].maxTileY}}class Ei{constructor(t,a,l){this._meshCache={},this.painter=t,this.tileManager=new Vs(a),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,l,d=o.a5){var p;if(!(a>=0&&a<d&&l>=0&&l<d))return 0;const g=this.getTerrainData(t),b=(p=g.tile)===null||p===void 0?void 0:p.dem;if(!b)return 0;const S=o.cC([],[a/d*o.a5,l/d*o.a5],g.u_terrain_matrix),M=[S[0]*b.dim,S[1]*b.dim],z=Math.floor(M[0]),F=Math.floor(M[1]),j=M[0]-z,V=M[1]-F;return b.get(z,F)*(1-j)*(1-V)+b.get(z+1,F)*j*(1-V)+b.get(z,F+1)*(1-j)*V+b.get(z+1,F+1)*j*V}getElevationForLngLatZoom(t,a){if(!o.cD(a,t.wrap()))return 0;const{tileID:l,mercatorX:d,mercatorY:p}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(l,d%o.a5,p%o.a5,o.a5)}getElevationForLngLat(t,a){const l=vi(a,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let d=0;for(const p of l)p.canonical.z>d&&(d=Math.min(p.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(t,d)}getElevation(t,a,l,d=o.a5){return this.getDEMElevation(t,a,l,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,p=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(d,p,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(d,new o.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ar([])}const a=this.tileManager.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new o.T(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const l=a&&a.toString()+a.tileID.key+t.key;if(l&&!this._demMatrixCache[l]){const d=this.tileManager.getSource().maxzoom;let p=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?p=t.canonical.z-d:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const g=t.canonical.x-(t.canonical.x>>p<<p),b=t.canonical.y-(t.canonical.y>>p<<p),S=o.cE(new Float64Array(16),[1/(o.a5<<p),1/(o.a5<<p),0]);o.O(S,S,[g*o.a5,b*o.a5,0]),this._demMatrixCache[t.key]={matrix:S,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,l=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(a.context,{width:l,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(a.context,{width:l,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(l,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,l,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let p=0,g=0;p<this._coordsTextureSize;p++)for(let b=0;b<this._coordsTextureSize;b++,g+=4)a[g+0]=255&b,a[g+1]=255&p,a[g+2]=b>>8<<4|p>>8,a[g+3]=0;const l=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new o.T(t,l,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),l=this.painter.context,d=l.gl,p=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),g=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),b=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(p,b-g-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null);const S=a[0]+(a[2]>>4<<8),M=a[1]+((15&a[2])<<8),z=this.coordsIndex[255-a[3]],F=z&&this.tileManager.getTileByID(z);if(!F)return null;const j=this._coordsTextureSize,V=(1<<F.tileID.canonical.z)*j;return new o.a9((F.tileID.canonical.x*j+S)/V+F.tileID.wrap,(F.tileID.canonical.y*j+M)/V,this.getElevation(F.tileID,S,M,j))}depthAtPoint(t){const a=new Uint8Array(4),l=this.painter.context,d=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(t){var a;const l=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,d=l&&t.canonical.y===0,p=l&&t.canonical.y===(1<<t.canonical.z)-1,g=`m_${d?"n":""}_${p?"s":""}`;if(this._meshCache[g])return this._meshCache[g];const b=this.painter.context,S=new o.cF,M=new o.aY,z=this.meshSize,F=o.a5/z,j=z*z;for(let se=0;se<=z;se++)for(let ye=0;ye<=z;ye++)S.emplaceBack(ye*F,se*F,0);for(let se=0;se<j;se+=z+1)for(let ye=0;ye<z;ye++)M.emplaceBack(ye+se,z+ye+se+1,z+ye+se+2),M.emplaceBack(ye+se,z+ye+se+2,ye+se+1);const V=S.length,Z=V+(z+1),Q=(z+1)*z,te=d?o.br:0,ee=d?0:1,ae=p?o.bs:o.a5,he=p?0:1;for(let se=0;se<=z;se++)S.emplaceBack(se*F,te,ee);for(let se=0;se<=z;se++)S.emplaceBack(se*F,ae,he);for(let se=0;se<z;se++)M.emplaceBack(Q+se,Z+se,Z+se+1),M.emplaceBack(Q+se,Z+se+1,Q+se+1),M.emplaceBack(0+se,V+se+1,V+se),M.emplaceBack(0+se,0+se+1,V+se+1);const ie=S.length,ue=ie+2*(z+1);for(const se of[0,1])for(let ye=0;ye<=z;ye++)for(const Ie of[0,1])S.emplaceBack(se*o.a5,ye*F,Ie);for(let se=0;se<2*z;se+=2)M.emplaceBack(ie+se,ie+se+1,ie+se+3),M.emplaceBack(ie+se,ie+se+3,ie+se+2),M.emplaceBack(ue+se,ue+se+3,ue+se+1),M.emplaceBack(ue+se,ue+se+2,ue+se+3);const _e=new Jt(b.createVertexBuffer(S,Yd.members),b.createIndexBuffer(M),o.aX.simpleSegment(0,0,S.length,M.length));return this._meshCache[g]=_e,_e}getMeshFrameDelta(t){return 2*Math.PI*o.bE/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,a){var l;if(!o.cD(a,t.wrap()))return 0;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(l=this.getMinMaxElevation(d).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,l={minElevation:null,maxElevation:null};return a&&a.dem&&(l.minElevation=a.dem.min*this.exaggeration,l.maxElevation=a.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(t,a){const l=o.a9.fromLngLat(t.wrap()),d=(1<<a)*o.a5,p=l.x*d,g=l.y*d,b=Math.floor(p/o.a5),S=Math.floor(g/o.a5);return{tileID:new o.a2(a,0,a,b,S),mercatorX:p,mercatorY:g}}}class Gi{constructor(t,a,l){this._context=t,this._size=a,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(l.texture),{id:t,fbo:a,texture:l,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>t.id!==a)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const Bo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Ns{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new Gi(t.context,30,a.tileManager.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=t._order.filter((l=>!t._layers[l].isHidden(a))),this._coordsAscending={};for(const l in t.tileManagers){this._coordsAscending[l]={};const d=t.tileManagers[l].getVisibleCoordinates(),p=t.tileManagers[l].getSource(),g=p instanceof In?p.terrainTileRanges:null;for(const b of d){const S=this.terrain.tileManager.getTerrainCoords(b,g);for(const M in S)this._coordsAscending[l][M]||(this._coordsAscending[l][M]=[]),this._coordsAscending[l][M].push(S[M])}}this._coordsAscendingStr={};for(const l of t._order){const d=t._layers[l],p=d.source;if(Bo[d.type]&&!this._coordsAscendingStr[p]){this._coordsAscendingStr[p]={};for(const g in this._coordsAscending[p])this._coordsAscendingStr[p][g]=this._coordsAscending[p][g].map((b=>b.key)).sort().join()}}for(const l of this._renderableTiles)for(const d in this._coordsAscendingStr){const p=this._coordsAscendingStr[d][l.tileID.key];p&&p!==l.rttCoords[d]&&(l.rtt=[])}}renderLayer(t,a){if(t.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),d=t.type,p=this.painter,g=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Bo[d]&&(this._prevType&&Bo[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(t.id),!g))return!0;if(Bo[this._prevType]||Bo[d]&&g){this._prevType=d;const b=this._stacks.length-1,S=this._stacks[b]||[];for(const M of this._renderableTiles){if(this.pool.isFull()&&(du(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(M),M.rtt[b]){const F=this.pool.getObjectForId(M.rtt[b].id);if(F.stamp===M.rtt[b].stamp){this.pool.useObject(F);continue}}const z=this.pool.getOrCreateFreeObject();this.pool.useObject(z),this.pool.stampObject(z),M.rtt[b]={id:z.id,stamp:z.stamp},p.context.bindFramebuffer.set(z.fbo.framebuffer),p.context.clear({color:o.bp.transparent,stencil:0}),p.currentStencilSource=void 0;for(let F=0;F<S.length;F++){const j=p.style._layers[S[F]],V=j.source?this._coordsAscending[j.source][M.tileID.key]:[M.tileID];p.context.viewport.set([0,0,z.fbo.width,z.fbo.height]),p._renderTileClippingMasks(j,V,!0),p.renderLayer(p,p.style.tileManagers[j.source],j,V,l),j.source&&(M.rttCoords[j.source]=this._coordsAscendingStr[j.source][M.tileID.key])}}return du(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),Bo[d]}return!1}}const zl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},bu=I,Il={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ma,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},ku={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Us{constructor(t,a,l=!1){this.mousedown=p=>{this.startMove(p,le.mousePos(this.element,p)),le.addEventListener(window,"mousemove",this.mousemove),le.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=p=>{this.move(p,le.mousePos(this.element,p))},this.mouseup=p=>{this._rotatePitchHandler.dragEnd(p),this.offTemp()},this.touchstart=p=>{p.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=le.touchPos(this.element,p.targetTouches)[0],this.startMove(p,this._startPos),le.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),le.addEventListener(window,"touchend",this.touchend))},this.touchmove=p=>{p.targetTouches.length!==1?this.reset():(this._lastPos=le.touchPos(this.element,p.targetTouches)[0],this.move(p,this._lastPos))},this.touchend=p=>{p.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const d=new od;this._rotatePitchHandler=new ms({clickTolerance:3,move:(p,g)=>{const b=a.getBoundingClientRect(),S=new o.P((b.bottom-b.top)/2,(b.right-b.left)/2);return{bearingDelta:o.cx(new o.P(p.x,g.y),g,S),pitchDelta:l?-.5*(g.y-p.y):void 0}},moveStateManager:d,enable:!0,assignEvents:()=>{}}),this.map=t,le.addEventListener(a,"mousedown",this.mousedown),le.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),le.addEventListener(a,"touchcancel",this.reset)}startMove(t,a){this._rotatePitchHandler.dragStart(t,a),le.disableDrag()}move(t,a){const l=this.map,{bearingDelta:d,pitchDelta:p}=this._rotatePitchHandler.dragMove(t,a)||{};d&&l.setBearing(l.getBearing()+d),p&&l.setPitch(l.getPitch()+p)}off(){const t=this.element;le.removeEventListener(t,"mousedown",this.mousedown),le.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),le.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),le.removeEventListener(window,"touchend",this.touchend),le.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){le.enableDrag(),le.removeEventListener(window,"mousemove",this.mousemove),le.removeEventListener(window,"mouseup",this.mouseup),le.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),le.removeEventListener(window,"touchend",this.touchend)}}let Dr;function Dl(f,t,a,l=!1){if(l||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return f?.wrap();const d=new o.V(f.lng,f.lat);if(f=new o.V(f.lng,f.lat),t){const p=new o.V(f.lng-360,f.lat),g=new o.V(f.lng+360,f.lat),b=a.locationToScreenPoint(f).distSqr(t);a.locationToScreenPoint(p).distSqr(t)<b?f=p:a.locationToScreenPoint(g).distSqr(t)<b&&(f=g)}for(;Math.abs(f.lng-a.center.lng)>180;){const p=a.locationToScreenPoint(f);if(p.x>=0&&p.y>=0&&p.x<=a.width&&p.y<=a.height)break;f.lng>a.center.lng?f.lng-=360:f.lng+=360}return f.lng!==d.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(f))?f:d}const Gs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Al(f,t,a){const l=f.classList;for(const d in Gs)l.remove(`maplibregl-${a}-anchor-${d}`);l.add(`maplibregl-${a}-anchor-${t}`)}class qs extends o.E{constructor(t){if(super(),this._onKeyPress=a=>{const l=a.code,d=a.charCode||a.keyCode;l!=="Space"&&l!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const l=a.originalEvent.target,d=this._element;this._popup&&(l===d||d.contains(l))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=Dl(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let p="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?p="rotateX(0deg)":this._pitchAlignment==="map"&&(p=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),le.setTransform(this._element,`${Gs[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${p} ${d}`),ce.frameAsync(new AbortController).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=o.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=le.create("div");const a=le.createNS("http://www.w3.org/2000/svg","svg"),l=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${l}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${l}`);const p=le.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"stroke","none"),p.setAttributeNS(null,"stroke-width","1"),p.setAttributeNS(null,"fill","none"),p.setAttributeNS(null,"fill-rule","evenodd");const g=le.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill-rule","nonzero");const b=le.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(3.0, 29.0)"),b.setAttributeNS(null,"fill","#000000");const S=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ee of S){const ae=le.createNS("http://www.w3.org/2000/svg","ellipse");ae.setAttributeNS(null,"opacity","0.04"),ae.setAttributeNS(null,"cx","10.5"),ae.setAttributeNS(null,"cy","5.80029008"),ae.setAttributeNS(null,"rx",ee.rx),ae.setAttributeNS(null,"ry",ee.ry),b.appendChild(ae)}const M=le.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill",this._color);const z=le.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),M.appendChild(z);const F=le.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const j=le.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(j);const V=le.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(6.0, 7.0)"),V.setAttributeNS(null,"fill","#FFFFFF");const Z=le.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Q=le.createNS("http://www.w3.org/2000/svg","circle");Q.setAttributeNS(null,"fill","#000000"),Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"cx","5.5"),Q.setAttributeNS(null,"cy","5.5"),Q.setAttributeNS(null,"r","5.4999962");const te=le.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#FFFFFF"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962"),Z.appendChild(Q),Z.appendChild(te),g.appendChild(b),g.appendChild(M),g.appendChild(F),g.appendChild(V),g.appendChild(Z),a.appendChild(g),a.setAttributeNS(null,"height",l*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=o.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),Al(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),le.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=o.V.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,l;const d=(a=this._map)===null||a===void 0?void 0:a.terrain,p=this._map.transform.isLocationOccluded(this._lngLat);if(!d||p){const V=p?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==V&&(this._element.style.opacity=V))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const g=this._map,b=g.terrain.depthAtPoint(this._pos),S=g.terrain.getElevationForLngLat(this._lngLat,g.transform);if(g.transform.lngLatToCameraDepth(this._lngLat,S)-b<.006)return void(this._element.style.opacity=this._opacity);const M=-this._offset.y/g.transform.pixelsPerMeter,z=Math.sin(g.getPitch()*Math.PI/180)*M,F=g.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),j=g.transform.lngLatToCameraDepth(this._lngLat,S+z)-F>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&j&&this._popup.remove(),this._element.style.opacity=j?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=o.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return(this._opacity===void 0||t===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Su={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let _s=0,Oo=!1;const Tu={maxWidth:100,unit:"metric"};function Zs(f,t,a){const l=a&&a.maxWidth||100,d=f._container.clientHeight/2,p=f._container.clientWidth/2,g=f.unproject([p-l/2,d]),b=f.unproject([p+l/2,d]),S=Math.round(f.project(b).x-f.project(g).x),M=Math.min(l,S,f._container.clientWidth),z=g.distanceTo(b);if(a&&a.unit==="imperial"){const F=3.2808*z;F>5280?$o(t,M,F/5280,f._getUIString("ScaleControl.Miles")):$o(t,M,F,f._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?$o(t,M,z/1852,f._getUIString("ScaleControl.NauticalMiles")):z>=1e3?$o(t,M,z/1e3,f._getUIString("ScaleControl.Kilometers")):$o(t,M,z,f._getUIString("ScaleControl.Meters"))}function $o(f,t,a,l){const d=(function(p){const g=Math.pow(10,`${Math.floor(p)}`.length-1);let b=p/g;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:(function(S){const M=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*M)/M})(b),g*b})(a);f.style.width=t*(d/a)+"px",f.innerHTML=`${d}&nbsp;${l}`}const Pu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Rl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function jl(f){if(f){if(typeof f=="number"){const t=Math.round(Math.abs(f)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,f),"top-left":new o.P(t,t),"top-right":new o.P(-t,t),bottom:new o.P(0,-f),"bottom-left":new o.P(t,-t),"bottom-right":new o.P(-t,-t),left:new o.P(f,0),right:new o.P(-f,0)}}if(f instanceof o.P||Array.isArray(f)){const t=o.P.convert(f);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:o.P.convert(f.center||[0,0]),top:o.P.convert(f.top||[0,0]),"top-left":o.P.convert(f["top-left"]||[0,0]),"top-right":o.P.convert(f["top-right"]||[0,0]),bottom:o.P.convert(f.bottom||[0,0]),"bottom-left":o.P.convert(f["bottom-left"]||[0,0]),"bottom-right":o.P.convert(f["bottom-right"]||[0,0]),left:o.P.convert(f.left||[0,0]),right:o.P.convert(f.right||[0,0])}}return jl(new o.P(0,0))}const Lu=I;v.AJAXError=o.cI,v.Event=o.l,v.Evented=o.E,v.LngLat=o.V,v.MercatorCoordinate=o.a9,v.Point=o.P,v.addProtocol=o.cJ,v.config=o.c,v.removeProtocol=o.cK,v.AttributionControl=wu,v.BoxZoomHandler=fs,v.CanvasSource=G,v.CooperativeGesturesHandler=ht,v.DoubleClickZoomHandler=xu,v.DragPanHandler=cd,v.DragRotateHandler=Ka,v.EdgeInsets=ar,v.FullscreenControl=class extends o.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){le.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=le.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);le.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=$r,v.GeolocateControl=class extends o.E{constructor(f){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new o.V(t.coords.longitude,t.coords.latitude),l=t.coords.accuracy,d=this._map.getBearing(),p=o.e({bearing:d},this.options.fitBoundsOptions),g=hi.fromLngLat(a,l);this._map.fitBounds(g,p,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new o.V(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Oo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=le.create("button","maplibregl-ctrl-geolocate",this._container),le.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=le.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new qs({element:this._dotElement}),this._circleElement=le.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const l=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))}))}},this.options=o.e({},Su,f)}onAdd(f){return this._map=f,this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(t=!1){if(Dr!==void 0&&!t)return Dr;if(window.navigator.permissions===void 0)return Dr=!!window.navigator.geolocation,Dr;try{Dr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Dr=!!window.navigator.geolocation}return Dr}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),le.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,_s=0,Oo=!1}_isOutOfMapMaxBounds(f){const t=this._map.getMaxBounds(),a=f.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const f=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&f))return;const t=this._map.project(f),a=this._map.unproject([t.x+100,t.y]),l=f.distanceTo(a)/100,d=2*this._accuracy/l;this._circleElement.style.width=`${d.toFixed(2)}px`,this._circleElement.style.height=`${d.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":_s--,Oo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),_s++,_s>1?(f={maximumAge:6e5,timeout:0},Oo=!0):(f=this.options.positionOptions,Oo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const t=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=le.create("button","maplibregl-ctrl-globe",this._container),le.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){le.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},v.Hash=fu,v.ImageSource=In,v.KeyboardHandler=oi,v.LngLatBounds=hi,v.LogoControl=fd,v.Map=class extends Xn{constructor(f){var t,a;o.cG.mark(o.cH.create);const l=Object.assign(Object.assign(Object.assign({},Il),f),{canvasContextAttributes:Object.assign(Object.assign({},Il.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const d=new rr,p=new It;if(l.minZoom!==void 0&&d.setMinZoom(l.minZoom),l.maxZoom!==void 0&&d.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&d.setMinPitch(l.minPitch),l.maxPitch!==void 0&&d.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&d.setRenderWorldCopies(l.renderWorldCopies),l.transformConstrain!==null&&d.setConstrainOverride(l.transformConstrain),super(d,p,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Xd,this._controls=[],this._mapId=o.af(),this._lostContextStyle={style:null,images:null},this._contextLost=b=>{b.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const S of Object.values(this.style._layers))if(S.type==="custom"&&console.warn(`Custom layer with id '${S.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),S._listeners)for(const[M]of Object.entries(S._listeners))console.warn(`Custom layer with id '${S.id}' had event listeners for event '${M}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new o.l("webglcontextlost",{originalEvent:b}))},this._contextRestored=b=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:b}))},this._onMapScroll=b=>{if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},zl),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this._zoomLevelsToOverscale=l.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=l.transformCameraUpdate,this.transformConstrain=l.transformConstrain,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,l.reduceMotion!==void 0&&(ce.prefersReducedMotion=l.reduceMotion),this._imageQueueHandle=Ot.addThrottleControl((()=>this.isMoving())),this._requestManager=new Ai(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let b=!1;const S=cu((M=>{this._trackResize&&!this._removed&&(this.resize(M),this.redraw())}),50);this._resizeObserver=new ResizeObserver((M=>{b?S(M):b=!0})),this._resizeObserver.observe(this._container)}this.handlers=new El(this,l),this._hash=l.hash&&new fu(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.e({},l.fitBoundsOptions,{duration:0}))));const g=typeof l.style=="string"||((a=(t=l.style)===null||t===void 0?void 0:t.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,g),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new wu(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new fd,l.logoPosition),this.on("style.load",(()=>{if(g||this._resizeTransform(),this.transform.unmodified){const b=o.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(b)}})),this.on("data",(b=>{this._update(b.dataType==="style"),this.fire(new o.l(`${b.dataType}data`,b))})),this.on("dataloading",(b=>{this.fire(new o.l(`${b.dataType}dataloading`,b))})),this.on("dataabort",(b=>{this.fire(new o.l("sourcedataabort",b))}))}_getMapId(){return this._mapId}setGlobalStateProperty(f,t){return this.style.setGlobalStateProperty(f,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(f,t){if(t===void 0&&(t=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[t];return t.indexOf("bottom")!==-1?l.insertBefore(a,l.firstChild):l.appendChild(a),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(f);return t>-1&&this._controls.splice(t,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}coveringTiles(f){return vi(this.transform,f)}calculateCameraOptionsFromTo(f,t,a,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLat(a,this.transform)),super.calculateCameraOptionsFromTo(f,t,a,l)}resize(f,t=!0){const[a,l]=this._containerDimensions(),d=this._getClampedPixelRatio(a,l);if(this._resizeCanvas(a,l,d),this.painter.resize(a,l,d),this.painter.overLimit()){const g=this.painter.context.gl;this._maxCanvasSize=[g.drawingBufferWidth,g.drawingBufferHeight];const b=this._getClampedPixelRatio(a,l);this._resizeCanvas(a,l,b),this.painter.resize(a,l,b)}this._resizeTransform(t);const p=!this._moving;return p&&(this.stop(),this.fire(new o.l("movestart",f)).fire(new o.l("move",f))),this.fire(new o.l("resize",f)),p&&this.fire(new o.l("moveend",f)),this}_resizeTransform(f=!0){var t;const[a,l]=this._containerDimensions();this.transform.resize(a,l,f),(t=this._requestedCameraState)===null||t===void 0||t.resize(a,l,f)}_getClampedPixelRatio(f,t){const{0:a,1:l}=this._maxCanvasSize,d=this.getPixelRatio(),p=f*d,g=t*d;return Math.min(p>a?a/p:1,g>l?l/g:1)*d}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(hi.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom){const t=this._getTransformForUpdate();return t.setMinZoom(f),this._applyUpdatedTransform(t),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom){const t=this._getTransformForUpdate();return t.setMaxZoom(f),this._applyUpdatedTransform(t),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}setTransformConstrain(f){return this.transform.setConstrainOverride(f),this._update()}project(f){return this.transform.locationToScreenPoint(o.V.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(o.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,t,a){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:t,listener:a,delegates:{mousemove:p=>{const g=t.filter((S=>this.getLayer(S))),b=g.length!==0?this.queryRenderedFeatures(p.point,{layers:g}):[];b.length?l||(l=!0,a.call(this,new pn(f,this,p.originalEvent,{features:b}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:t,listener:a,delegates:{mousemove:g=>{const b=t.filter((S=>this.getLayer(S)));(b.length!==0?this.queryRenderedFeatures(g.point,{layers:b}):[]).length?l=!0:l&&(l=!1,a.call(this,new pn(f,this,g.originalEvent)))},mouseout:g=>{l&&(l=!1,a.call(this,new pn(f,this,g.originalEvent)))}}}}{const l=d=>{const p=t.filter((b=>this.getLayer(b))),g=p.length!==0?this.queryRenderedFeatures(d.point,{layers:p}):[];g.length&&(d.features=g,a.call(this,d),delete d.features)};return{layers:t,listener:a,delegates:{[f]:l}}}}_saveDelegatedListener(f,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(t)}_removeDelegatedListener(f,t,a){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let d=0;d<l.length;d++){const p=l[d];if(p.listener===a&&p.layers.length===t.length&&p.layers.every((g=>t.includes(g)))){for(const g in p.delegates)this.off(g,p.delegates[g]);return void l.splice(d,1)}}}on(f,t,a){if(a===void 0)return super.on(f,t);const l=typeof t=="string"?[t]:t,d=this._createDelegatedListener(f,l,a);this._saveDelegatedListener(f,d);for(const p in d.delegates)this.on(p,d.delegates[p]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,a)}}}once(f,t,a){if(a===void 0)return super.once(f,t);const l=typeof t=="string"?[t]:t,d=this._createDelegatedListener(f,l,a);for(const p in d.delegates){const g=d.delegates[p];d.delegates[p]=(...b)=>{this._removeDelegatedListener(f,l,a),g(...b)}}this._saveDelegatedListener(f,d);for(const p in d.delegates)this.once(p,d.delegates[p]);return this}off(f,t,a){return a===void 0?super.off(f,t):(this._removeDelegatedListener(f,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(f,t){if(!this.style)return[];let a;const l=f instanceof o.P||Array.isArray(f),d=l?f:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(l?{}:f)||{},d instanceof o.P||typeof d[0]=="number")a=[o.P.convert(d)];else{const p=o.P.convert(d[0]),g=o.P.convert(d[1]);a=[p,new o.P(g.x,p.y),g,new o.P(p.x,g.y),p]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(f,t){return this.style.querySourceFeatures(f,t)}setStyle(f,t){return(t=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(f,t))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const t=this._locale[f];if(t==null)throw new Error(`Missing UI string '${f}'`);return t}_updateStyle(f,t){var a,l;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(f,t)));const d=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new $a(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,t,d):this.style.loadJSON(f,t,d),this):((l=(a=this.style)===null||a===void 0?void 0:a.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new $a(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,t){if(typeof f=="string"){const a=this._requestManager.transformRequest(f,"Style");o.j(a,new AbortController).then((l=>{this._updateDiff(l.data,t)})).catch((l=>{l&&this.fire(new o.k(l))}))}else typeof f=="object"&&this._updateDiff(f,t)}_updateDiff(f,t){try{this.style.setState(f,t)&&this._update(!0)}catch(a){o.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(f,t)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(f,t){return this._lazyInitEmptyStyle(),this.style.addSource(f,t),this._update(!0)}isSourceLoaded(f){const t=this.style&&this.style.tileManagers[f];if(t!==void 0)return t.loaded();this.fire(new o.k(new Error(`There is no tile manager with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const t=this.style.tileManagers[f.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const l=this.style._layers[a];l.type==="hillshade"&&l.source===f.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),l.type==="color-relief"&&l.source===f.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ei(this.painter,t,f),this.painter.renderToTexture=new Ns(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var l;a.dataType==="style"?this.terrain.tileManager.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=a.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:f})),this}getTerrain(){var f,t;return(t=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const f=this.style&&this.style.tileManagers;for(const t of Object.values(f))if(!t.areTilesLoaded())return!1;return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}setSourceTileLodParams(f,t,a){if(a){const l=this.getSource(a);if(!l)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);l.calculateTileZoom=Wt(Math.max(1,f),Math.max(1,t))}else for(const l in this.style.tileManagers)this.style.tileManagers[l].getSource().calculateTileZoom=Wt(Math.max(1,f),Math.max(1,t));return this._update(!0),this}refreshTiles(f,t){const a=this.style.tileManagers[f];if(!a)throw new Error(`There is no tile manager with ID "${f}", cannot refresh tile`);t===void 0?a.reload(!0):a.refreshTiles(t.map((l=>new o.ac(l.z,l.x,l.y))))}addImage(f,t,a={}){const{pixelRatio:l=1,sdf:d=!1,stretchX:p,stretchY:g,content:b,textFitWidth:S,textFitHeight:M}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||o.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:z,height:F,data:j}=t,V=t;return this.style.addImage(f,{data:new o.R({width:z,height:F},new Uint8Array(j)),pixelRatio:l,stretchX:p,stretchY:g,content:b,textFitWidth:S,textFitHeight:M,sdf:d,version:0,userImage:V}),V.onAdd&&V.onAdd(this,f),this}}{const{width:z,height:F,data:j}=ce.getImageData(t);this.style.addImage(f,{data:new o.R({width:z,height:F},j),pixelRatio:l,stretchX:p,stretchY:g,content:b,textFitWidth:S,textFitHeight:M,sdf:d,version:0})}}updateImage(f,t){const a=this.style.getImage(f);if(!a)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=t instanceof HTMLImageElement||o.b(t)?ce.getImageData(t):t,{width:d,height:p,data:g}=l;if(d===void 0||p===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||p!==a.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(t instanceof HTMLImageElement||o.b(t));return a.data.replace(g,b),this.style.updateImage(f,a),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return Ot.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,t){return this._lazyInitEmptyStyle(),this.style.addLayer(f,t),this._update(!0)}moveLayer(f,t){return this.style.moveLayer(f,t),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,t,a){return this.style.setLayerZoomRange(f,t,a),this._update(!0)}setFilter(f,t,a={}){return this.style.setFilter(f,t,a),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,t,a,l={}){return this.style.setPaintProperty(f,t,a,l),this._update(!0)}getPaintProperty(f,t){return this.style.getPaintProperty(f,t)}setLayoutProperty(f,t,a,l={}){return this.style.setLayoutProperty(f,t,a,l),this._update(!0)}getLayoutProperty(f,t){return this.style.getLayoutProperty(f,t)}setGlyphs(f,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,t,a,(l=>{l||this._update(!0)})),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,t,(a=>{a||this._update(!0)})),this}setLight(f,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,t){return this.style.setFeatureState(f,t),this._update()}removeFeatureState(f,t){return this.style.removeFeatureState(f,t),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,t=0;return this._container&&(f=this._container.clientWidth||400,t=this._container.clientHeight||300),[f,t]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const t=this._canvasContainer=le.create("div","maplibregl-canvas-container",f);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=le.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),l=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],l);const d=this._controlContainer=le.create("div","maplibregl-control-container",f),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((g=>{p[g]=le.create("div",`maplibregl-ctrl-${g} `,d)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,t,a){this._canvas.width=Math.floor(a*f),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(l=>{t={requestedAttributes:f},l&&(t.statusMessage=l.statusMessage,t.type=l.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!a){const l="Failed to initialize WebGL";throw t?(t.message=l,new Error(JSON.stringify(t))):new Error(l)}this.painter=new id(a,this.transform),it.testSupport(a)}migrateProjection(f,t){super.migrateProjection(f,t),this.painter.transform=f,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var t,a,l,d,p;const g=this._idleTriggered?this._fadeDuration:0,b=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let S=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,j=Pe();this.style.zoomHistory.update(F,j);const V=new o.H(F,{now:j,fadeDuration:g,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Z=V.crossFadingFactor();Z===1&&Z===this._crossFadingFactor||(S=!0,this._crossFadingFactor=Z),this.style.update(V)}const M=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==b;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((d=this.style.projection)===null||d===void 0?void 0:d.transitionState,(p=this.style.projection)===null||p===void 0?void 0:p.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||M)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,g,this._crossSourceCollisions,M),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:g,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cG.mark(o.cH.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||S)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const z=this._sourcesDirty||this._styleDirty||this._placementDirty;return z||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,o.cG.mark(o.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ot.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),le.remove(this._canvasContainer),le.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cG.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ce.frame(this._frameRequest,(f=>{o.cG.frame(f),this._frameRequest=null;try{this._render(f)}catch(t){if(!o.Z(t)&&!(function(a){return a.message===C})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return bu}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},v.MapMouseEvent=pn,v.MapTouchEvent=As,v.MapWheelEvent=rd,v.Marker=qs,v.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),l=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,a)=>{const l=this._map._getUIString(`NavigationControl.${a}`);t.title=l,t.setAttribute("aria-label",l)},this.options=o.e({},ku,f),this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),le.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),le.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=le.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Us(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){le.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,t){const a=le.create("button",f,this._container);return a.type="button",a.addEventListener("click",t),a}},v.Popup=class extends o.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&le.remove(this._content),this._container&&(le.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=le.create("div","maplibregl-popup",this._map.getContainer()),this._tip=le.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const g of this.options.className.split(" "))this._container.classList.add(g);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Dl(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const a=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const d=jl(this.options.offset);if(!l){const g=this._container.offsetWidth,b=this._container.offsetHeight;let S;S=a.y+d.bottom.y<b?["top"]:a.y>this._map.transform.height-b?["bottom"]:[],a.x<g/2?S.push("left"):a.x>this._map.transform.width-g/2&&S.push("right"),l=S.length===0?"bottom":S.join("-")}let p=a.add(d[l]);this.options.subpixelPositioning||(p=p.round()),le.setTransform(this._container,`${Gs[l]} translate(${p.x}px,${p.y}px)`),Al(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Pu),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=o.V.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const t=document.createDocumentFragment(),a=document.createElement("body");let l;for(a.innerHTML=f;l=a.firstChild,l;)t.appendChild(l);return this.setDOMContent(t)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=le.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=le.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Rl);f&&f.focus()}},v.RasterDEMTileSource=ya,v.RasterTileSource=gr,v.ScaleControl=class{constructor(f){this._onMove=()=>{Zs(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Zs(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Tu),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){le.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=Ml,v.Style=$a,v.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=le.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=le.create("button","maplibregl-ctrl-terrain",this._container),le.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){le.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=ud,v.TwoFingersTouchRotateHandler=yu,v.TwoFingersTouchZoomHandler=gu,v.TwoFingersTouchZoomRotateHandler=Os,v.VectorTileSource=_r,v.VideoSource=xe,v.addSourceType=(f,t)=>o._(void 0,void 0,void 0,(function*(){if(Y(f))throw new Error(`A source type called "${f}" already exists.`);((a,l)=>{U[a]=l})(f,t)})),v.clearPrewarmedResources=function(){const f=Wi;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(ei),Wi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.createTileMesh=es,v.getMaxParallelImageRequests=function(){return o.c.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return ve().getRTLTextPluginStatus()},v.getVersion=function(){return Lu},v.getWorkerCount=function(){return Tt.workerCount},v.getWorkerUrl=function(){return o.c.WORKER_URL},v.importScriptInWorkers=function(f){return Ia().broadcast("IS",f)},v.isTimeFrozen=function(){return Ae.isFrozen()},v.now=Pe,v.prewarm=function(){ga().acquire(ei)},v.restoreNow=function(){Ae.restoreNow()},v.setMaxParallelImageRequests=function(f){o.c.MAX_PARALLEL_IMAGE_REQUESTS=f},v.setNow=function(f){Ae.setNow(f)},v.setRTLTextPlugin=function(f,t){return ve().setRTLTextPlugin(f,t)},v.setWorkerCount=function(f){Tt.workerCount=f},v.setWorkerUrl=function(f){o.c.WORKER_URL=f}}));var w=De;return w}))})(Gd)),Gd.exports}var q_=G_();const Y_=mm(q_);(function(Fe,Oe,De){function st(T,w){for(;(T=T.parentElement)&&!T.classList.contains(w););return T}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(T,w){this._map=T,this._container=T._container,this._overlayPane=T._panes.overlayPane,this._popupPane=T._panes.popupPane,w&&w.shapeOptions&&(w.shapeOptions=L.Util.extend({},this.options.shapeOptions,w.shapeOptions)),L.setOptions(this,w);var v=L.version.split(".");parseInt(v[0],10)===1&&parseInt(v[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var T=this._map;T&&(L.DomUtil.disableTextSelection(),T.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(T){L.setOptions(this,T)},_fireCreatedEvent:function(T){this._map.fire(L.Draw.Event.CREATED,{layer:T,layerType:this.type})},_cancelDrawing:function(T){T.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(T,w){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,w&&w.drawError&&(w.drawError=L.Util.extend({},this.options.drawError,w.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,T,w)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var T=this._markers.pop(),w=this._poly,v=w.getLatLngs(),o=v.splice(-1,1)[0];this._poly.setLatLngs(v),this._markerGroup.removeLayer(T),w.getLatLngs().length<2&&this._map.removeLayer(w),this._vertexChanged(o,!1)}},addVertex:function(T){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(T))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(T)),this._poly.addLatLng(T),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(T,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var T=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),w=this._poly.newLatLngIntersects(T[T.length-1]);if(!this.options.allowIntersection&&w||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(T){var w=this._map.mouseEventToLayerPoint(T.originalEvent),v=this._map.layerPointToLatLng(w);this._currentLatLng=v,this._updateTooltip(v),this._updateGuide(w),this._mouseMarker.setLatLng(v),L.DomEvent.preventDefault(T.originalEvent)},_vertexChanged:function(T,w){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(T,w),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(T){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(T),this._clickHandled=!0,this._disableNewMarkers();var w=T.originalEvent,v=w.clientX,o=w.clientY;this._startPoint.call(this,v,o)}},_startPoint:function(T,w){this._mouseDownOrigin=L.point(T,w)},_onMouseUp:function(T){var w=T.originalEvent,v=w.clientX,o=w.clientY;this._endPoint.call(this,v,o,T),this._clickHandled=null},_endPoint:function(T,w,v){if(this._mouseDownOrigin){var o=L.point(T,w).distanceTo(this._mouseDownOrigin),I=this._calculateFinishDistance(v.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(v.latlng),this._finishShape()):I<10&&L.Browser.touch?this._finishShape():Math.abs(o)<9*(Fe.devicePixelRatio||1)&&this.addVertex(v.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(T){var w,v,o=T.originalEvent;!o.touches||!o.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(w=o.touches[0].clientX,v=o.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,w,v),this._endPoint.call(this,w,v,T),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(T){var w;if(this._markers.length>0){var v;if(this.type===L.Draw.Polyline.TYPE)v=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;v=this._markers[0]}var o=this._map.latLngToContainerPoint(v.getLatLng()),I=new L.Marker(T,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),R=this._map.latLngToContainerPoint(I.getLatLng());w=o.distanceTo(R)}else w=1/0;return w},_updateFinishHandler:function(){var T=this._markers.length;T>1&&this._markers[T-1].on("click",this._finishShape,this),T>2&&this._markers[T-2].off("click",this._finishShape,this)},_createMarker:function(T){var w=new L.Marker(T,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(w),w},_updateGuide:function(T){var w=this._markers?this._markers.length:0;w>0&&(T=T||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[w-1].getLatLng()),T))},_updateTooltip:function(T){var w=this._getTooltipText();T&&this._tooltip.updatePosition(T),this._errorShown||this._tooltip.updateContent(w)},_drawGuide:function(T,w){var v,o,I,R=Math.floor(Math.sqrt(Math.pow(w.x-T.x,2)+Math.pow(w.y-T.y,2))),q=this.options.guidelineDistance,X=this.options.maxGuideLineLength,re=R>X?R-X:q;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));re<R;re+=this.options.guidelineDistance)v=re/R,o={x:Math.floor(T.x*(1-v)+v*w.x),y:Math.floor(T.y*(1-v)+v*w.y)},I=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),I.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(I,o)},_updateGuideColor:function(T){if(this._guidesContainer)for(var w=0,v=this._guidesContainer.childNodes.length;w<v;w++)this._guidesContainer.childNodes[w].style.backgroundColor=T},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var T,w,v=this.options.showLength;return this._markers.length===0?T={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(w=v?this._getMeasurementString():"",T=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:w}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:w}),T},_updateRunningMeasure:function(T,w){var v,o,I=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(v=I-(w?2:1),o=L.GeometryUtil.isVersion07x()?T.distanceTo(this._markers[v].getLatLng())*(this.options.factor||1):this._map.distance(T,this._markers[v].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=o*(w?1:-1))},_getMeasurementString:function(){var T,w=this._currentLatLng,v=this._markers[this._markers.length-1].getLatLng();return T=L.GeometryUtil.isVersion07x()?v&&w&&w.distanceTo?this._measurementRunningTotal+w.distanceTo(v)*(this.options.factor||1):this._measurementRunningTotal||0:v&&w?this._measurementRunningTotal+this._map.distance(w,v)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(T,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var T=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,T)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(T,w){L.Draw.Polyline.prototype.initialize.call(this,T,w),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var T=this._markers.length;T===1&&this._markers[0].on("click",this._finishShape,this),T>2&&(this._markers[T-1].on("dblclick",this._finishShape,this),T>3&&this._markers[T-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var T,w;return this._markers.length===0?T=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(T=L.drawLocal.draw.handlers.polygon.tooltip.cont,w=this._getMeasurementString()):(T=L.drawLocal.draw.handlers.polygon.tooltip.end,w=this._getMeasurementString()),{text:T,subtext:w}},_getMeasurementString:function(){var T=this._area,w="";return T||this.options.showLength?(this.options.showLength&&(w=L.Draw.Polyline.prototype._getMeasurementString.call(this)),T&&(w+="<br>"+L.GeometryUtil.readableArea(T,this.options.metric,this.options.precision)),w):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(T,w){var v;!this.options.allowIntersection&&this.options.showArea&&(v=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(v)),L.Draw.Polyline.prototype._vertexChanged.call(this,T,w)},_cleanUpShape:function(){var T=this._markers.length;T>0&&(this._markers[0].off("click",this._finishShape,this),T>2&&this._markers[T-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(T,w){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,T,w)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),Oe.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(Oe,"mouseup",this._onMouseUp,this),L.DomEvent.off(Oe,"touchend",this._onMouseUp,this),Oe.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(T){this._isDrawing=!0,this._startLatLng=T.latlng,L.DomEvent.on(Oe,"mouseup",this._onMouseUp,this).on(Oe,"touchend",this._onMouseUp,this).preventDefault(T.originalEvent)},_onMouseMove:function(T){var w=T.latlng;this._tooltip.updatePosition(w),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(w))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(T,w){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,T,w)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(T){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!st(T.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(T){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,T)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,T),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var T=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,T)},_getTooltipText:function(){var T,w,v,o=L.Draw.SimpleShape.prototype._getTooltipText.call(this),I=this._shape,R=this.options.showArea;return I&&(T=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),w=L.GeometryUtil.geodesicArea(T),v=R?L.GeometryUtil.readableArea(w,this.options.metric):""),{text:o.text,subtext:v}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(T,w){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,T,w)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(T){var w=T.latlng;this._tooltip.updatePosition(w),this._mouseMarker.setLatLng(w),this._marker?(w=this._mouseMarker.getLatLng(),this._marker.setLatLng(w)):(this._marker=this._createMarker(w),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(T){return new L.Marker(T,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(T){this._onMouseMove(T),this._onClick()},_fireCreatedEvent:function(){var T=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,T)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(T,w){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,T,w)},_fireCreatedEvent:function(){var T=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,T)},_createMarker:function(T){return new L.CircleMarker(T,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(T,w){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,T,w)},_drawShape:function(T){if(L.GeometryUtil.isVersion07x())var w=this._startLatLng.distanceTo(T);else var w=this._map.distance(this._startLatLng,T);this._shape?this._shape.setRadius(w):(this._shape=new L.Circle(this._startLatLng,w,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var T=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,T)},_onMouseMove:function(T){var w,v=T.latlng,o=this.options.showRadius,I=this.options.metric;if(this._tooltip.updatePosition(v),this._isDrawing){this._drawShape(v),w=this._shape.getRadius().toFixed(1);var R="";o&&(R=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(w,I,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:R})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(T,w){this._marker=T,L.setOptions(this,w)},addHooks:function(){var T=this._marker;T.dragging.enable(),T.on("dragend",this._onDragEnd,T),this._toggleMarkerHighlight()},removeHooks:function(){var T=this._marker;T.dragging.disable(),T.off("dragend",this._onDragEnd,T),this._toggleMarkerHighlight()},_onDragEnd:function(T){var w=T.target;w.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:w})},_toggleMarkerHighlight:function(){var T=this._marker._icon;T&&(T.style.display="none",L.DomUtil.hasClass(T,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(T,"leaflet-edit-marker-selected"),this._offsetMarker(T,-4)):(L.DomUtil.addClass(T,"leaflet-edit-marker-selected"),this._offsetMarker(T,4)),T.style.display="")},_offsetMarker:function(T,w){var v=parseInt(T.style.marginTop,10)-w,o=parseInt(T.style.marginLeft,10)-w;T.style.marginTop=v+"px",T.style.marginLeft=o+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(T){this.latlngs=[T._latlngs],T._holes&&(this.latlngs=this.latlngs.concat(T._holes)),this._poly=T,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(T){for(var w=0;w<this._verticesHandlers.length;w++)T(this._verticesHandlers[w])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(T){T.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(T){T.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(T){T.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var T=0;T<this.latlngs.length;T++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[T],this._poly.options.poly))},_updateLatLngs:function(T){this.latlngs=[T.layer._latlngs],T.layer._holes&&(this.latlngs=this.latlngs.concat(T.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(T,w,v){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=T,v&&v.drawError&&(v.drawError=L.Util.extend({},this.options.drawError,v.drawError)),this._latlngs=w,L.setOptions(this,v)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var T=this._poly,w=T._path;T instanceof L.Polygon||(T.options.fill=!1,T.options.editing&&(T.options.editing.fill=!1)),w&&T.options.editing&&T.options.editing.className&&(T.options.original.className&&T.options.original.className.split(" ").forEach(function(v){L.DomUtil.removeClass(w,v)}),T.options.editing.className.split(" ").forEach(function(v){L.DomUtil.addClass(w,v)})),T.setStyle(T.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var T=this._poly,w=T._path;w&&T.options.editing&&T.options.editing.className&&(T.options.editing.className.split(" ").forEach(function(v){L.DomUtil.removeClass(w,v)}),T.options.original.className&&T.options.original.className.split(" ").forEach(function(v){L.DomUtil.addClass(w,v)})),T.setStyle(T.options.original),T._map&&(T._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var T,w,v,o,I=this._defaultShape();for(T=0,v=I.length;T<v;T++)o=this._createMarker(I[T],T),o.on("click",this._onMarkerClick,this),o.on("contextmenu",this._onContextMenu,this),this._markers.push(o);var R,q;for(T=0,w=v-1;T<v;w=T++)(T!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(R=this._markers[w],q=this._markers[T],this._createMiddleMarker(R,q),this._updatePrevNext(R,q))},_createMarker:function(T,w){var v=new L.Marker.Touch(T,{draggable:!0,icon:this.options.icon});return v._origLatLng=T,v._index=w,v.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(v),v},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var T=this._defaultShape(),w=[].splice.apply(T,arguments);return this._poly._convertLatLngs(T,!0),this._poly.redraw(),w},_removeMarker:function(T){var w=T._index;this._markerGroup.removeLayer(T),this._markers.splice(w,1),this._spliceLatLngs(w,1),this._updateIndexes(w,-1),T.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(T){var w=T.target,v=this._poly,o=L.LatLngUtil.cloneLatLng(w._origLatLng);if(L.extend(w._origLatLng,w._latlng),v.options.poly){var I=v._map._editTooltip;if(!v.options.poly.allowIntersection&&v.intersects()){L.extend(w._origLatLng,o),w.setLatLng(o);var R=v.options.color;v.setStyle({color:this.options.drawError.color}),I&&I.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){v.setStyle({color:R}),I&&I.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}w._middleLeft&&w._middleLeft.setLatLng(this._getMiddleLatLng(w._prev,w)),w._middleRight&&w._middleRight.setLatLng(this._getMiddleLatLng(w,w._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var q=this._poly.getLatLngs();this._poly._convertLatLngs(q,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(T){var w=L.Polygon&&this._poly instanceof L.Polygon?4:3,v=T.target;this._defaultShape().length<w||(this._removeMarker(v),this._updatePrevNext(v._prev,v._next),v._middleLeft&&this._markerGroup.removeLayer(v._middleLeft),v._middleRight&&this._markerGroup.removeLayer(v._middleRight),v._prev&&v._next?this._createMiddleMarker(v._prev,v._next):v._prev?v._next||(v._prev._middleRight=null):v._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(T){var w=T.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:w,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(T){var w=this._map.mouseEventToLayerPoint(T.originalEvent.touches[0]),v=this._map.layerPointToLatLng(w),o=T.target;L.extend(o._origLatLng,v),o._middleLeft&&o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&&o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(T,w){this._markerGroup.eachLayer(function(v){v._index>T&&(v._index+=w)})},_createMiddleMarker:function(T,w){var v,o,I,R=this._getMiddleLatLng(T,w),q=this._createMarker(R);q.setOpacity(.6),T._middleRight=w._middleLeft=q,o=function(){q.off("touchmove",o,this);var X=w._index;q._index=X,q.off("click",v,this).on("click",this._onMarkerClick,this),R.lat=q.getLatLng().lat,R.lng=q.getLatLng().lng,this._spliceLatLngs(X,0,R),this._markers.splice(X,0,q),q.setOpacity(1),this._updateIndexes(X,1),w._index++,this._updatePrevNext(T,q),this._updatePrevNext(q,w),this._poly.fire("editstart")},I=function(){q.off("dragstart",o,this),q.off("dragend",I,this),q.off("touchmove",o,this),this._createMiddleMarker(T,q),this._createMiddleMarker(q,w)},v=function(){o.call(this),I.call(this),this._fireEdit()},q.on("click",v,this).on("dragstart",o,this).on("dragend",I,this).on("touchmove",o,this),this._markerGroup.addLayer(q)},_updatePrevNext:function(T,w){T&&(T._next=w),w&&(w._prev=T)},_getMiddleLatLng:function(T,w){var v=this._poly._map,o=v.project(T.getLatLng()),I=v.project(w.getLatLng());return v.unproject(o._add(I)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(T,w){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=T,L.Util.setOptions(this,w)},addHooks:function(){var T=this._shape;this._shape._map&&(this._map=this._shape._map,T.setStyle(T.options.editing),T._map&&(this._map=T._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var T=this._shape;if(T.setStyle(T.options.original),T._map){this._unbindMarker(this._moveMarker);for(var w=0,v=this._resizeMarkers.length;w<v;w++)this._unbindMarker(this._resizeMarkers[w]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(T,w){var v=new L.Marker.Touch(T,{draggable:!0,icon:w,zIndexOffset:10});return this._bindMarker(v),this._markerGroup.addLayer(v),v},_bindMarker:function(T){T.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(T){T.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(T){T.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(T){var w=T.target,v=w.getLatLng();w===this._moveMarker?this._move(v):this._resize(v),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(T){T.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(T){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,T),typeof this._getCorners=="function"){var w=this._getCorners(),v=T.target,o=v._cornerIndex;v.setOpacity(0),this._oppositeCorner=w[(o+2)%4],this._toggleCornerMarkers(0,o)}this._shape.fire("editstart")},_onTouchMove:function(T){var w=this._map.mouseEventToLayerPoint(T.originalEvent.touches[0]),v=this._map.layerPointToLatLng(w);return T.target===this._moveMarker?this._move(v):this._resize(v),this._shape.redraw(),!1},_onTouchEnd:function(T){T.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var T=this._shape.getBounds(),w=T.getCenter();this._moveMarker=this._createMarker(w,this.options.moveIcon)},_createResizeMarker:function(){var T=this._getCorners();this._resizeMarkers=[];for(var w=0,v=T.length;w<v;w++)this._resizeMarkers.push(this._createMarker(T[w],this.options.resizeIcon)),this._resizeMarkers[w]._cornerIndex=w},_onMarkerDragStart:function(T){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,T);var w=this._getCorners(),v=T.target,o=v._cornerIndex;this._oppositeCorner=w[(o+2)%4],this._toggleCornerMarkers(0,o)},_onMarkerDragEnd:function(T){var w,v,o=T.target;o===this._moveMarker&&(w=this._shape.getBounds(),v=w.getCenter(),o.setLatLng(v)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,T)},_move:function(T){for(var w,v=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),o=this._shape.getBounds(),I=o.getCenter(),R=[],q=0,X=v.length;q<X;q++)w=[v[q].lat-I.lat,v[q].lng-I.lng],R.push([T.lat+w[0],T.lng+w[1]]);this._shape.setLatLngs(R),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(T){var w;this._shape.setBounds(L.latLngBounds(T,this._oppositeCorner)),w=this._shape.getBounds(),this._moveMarker.setLatLng(w.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var T=this._shape.getBounds();return[T.getNorthWest(),T.getNorthEast(),T.getSouthEast(),T.getSouthWest()]},_toggleCornerMarkers:function(T){for(var w=0,v=this._resizeMarkers.length;w<v;w++)this._resizeMarkers[w].setOpacity(T)},_repositionCornerMarkers:function(){for(var T=this._getCorners(),w=0,v=this._resizeMarkers.length;w<v;w++)this._resizeMarkers[w].setLatLng(T[w])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var T=this._shape.getLatLng();this._moveMarker=this._createMarker(T,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(T){if(this._resizeMarkers.length){var w=this._getResizeMarkerPoint(T);this._resizeMarkers[0].setLatLng(w)}this._shape.setLatLng(T),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var T=this._shape.getLatLng(),w=this._getResizeMarkerPoint(T);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(w,this.options.resizeIcon))},_getResizeMarkerPoint:function(T){var w=this._shape._radius*Math.cos(Math.PI/4),v=this._map.project(T);return this._map.unproject([v.x+w,v.y-w])},_resize:function(T){var w=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=w.distanceTo(T):radius=this._map.distance(w,T),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(T){this._map=T,this._container=T._container,this._pane=T._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(T,w){var v={};if(T.touches!==void 0){if(!T.touches.length)return;v=T.touches[0]}else if(T.pointerType!=="touch"||(v=T,!this._filterClick(T)))return;var o=this._map.mouseEventToContainerPoint(v),I=this._map.mouseEventToLayerPoint(v),R=this._map.layerPointToLatLng(I);this._map.fire(w,{latlng:R,layerPoint:I,containerPoint:o,pageX:v.pageX,pageY:v.pageY,originalEvent:T})},_filterClick:function(T){var w=T.timeStamp||T.originalEvent.timeStamp,v=L.DomEvent._lastClick&&w-L.DomEvent._lastClick;return v&&v>100&&v<500||T.target._simulatedClick&&!T._simulated?(L.DomEvent.stop(T),!1):(L.DomEvent._lastClick=w,!0)},_onTouchStart:function(T){this._map._loaded&&this._touchEvent(T,"touchstart")},_onTouchEnd:function(T){this._map._loaded&&this._touchEvent(T,"touchend")},_onTouchCancel:function(T){if(this._map._loaded){var w="touchcancel";this._detectIE()&&(w="pointercancel"),this._touchEvent(T,w)}},_onTouchLeave:function(T){this._map._loaded&&this._touchEvent(T,"touchleave")},_onTouchMove:function(T){this._map._loaded&&this._touchEvent(T,"touchmove")},_detectIE:function(){var T=Fe.navigator.userAgent,w=T.indexOf("MSIE ");if(w>0)return parseInt(T.substring(w+5,T.indexOf(".",w)),10);if(T.indexOf("Trident/")>0){var v=T.indexOf("rv:");return parseInt(T.substring(v+3,T.indexOf(".",v)),10)}var o=T.indexOf("Edge/");return o>0&&parseInt(T.substring(o+5,T.indexOf(".",o)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var T=this._icon,w=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?w.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):w.concat(["touchcancel"]),L.DomUtil.addClass(T,"leaflet-clickable"),L.DomEvent.on(T,"click",this._onMouseClick,this),L.DomEvent.on(T,"keypress",this._onKeyPress,this);for(var v=0;v<w.length;v++)L.DomEvent.on(T,w[v],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var T=Fe.navigator.userAgent,w=T.indexOf("MSIE ");if(w>0)return parseInt(T.substring(w+5,T.indexOf(".",w)),10);if(T.indexOf("Trident/")>0){var v=T.indexOf("rv:");return parseInt(T.substring(v+3,T.indexOf(".",v)),10)}var o=T.indexOf("Edge/");return o>0&&parseInt(T.substring(o+5,T.indexOf(".",o)),10)}}),L.LatLngUtil={cloneLatLngs:function(T){for(var w=[],v=0,o=T.length;v<o;v++)Array.isArray(T[v])?w.push(L.LatLngUtil.cloneLatLngs(T[v])):w.push(this.cloneLatLng(T[v]));return w},cloneLatLng:function(T){return L.latLng(T.lat,T.lng)}},(function(){var T={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(w){var v,o,I=w.length,R=0,q=Math.PI/180;if(I>2){for(var X=0;X<I;X++)v=w[X],o=w[(X+1)%I],R+=(o.lng-v.lng)*q*(2+Math.sin(v.lat*q)+Math.sin(o.lat*q));R=6378137*R*6378137/2}return Math.abs(R)},formattedNumber:function(w,v){var o=parseFloat(w).toFixed(v),I=L.drawLocal.format&&L.drawLocal.format.numeric,R=I&&I.delimiters,q=R&&R.thousands,X=R&&R.decimal;if(q||X){var re=o.split(".");o=q?re[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+q):re[0],X=X||".",re.length>1&&(o=o+X+re[1])}return o},readableArea:function(w,v,q){var I,R,q=L.Util.extend({},T,q);return v?(R=["ha","m"],type=typeof v,type==="string"?R=[v]:type!=="boolean"&&(R=v),I=w>=1e6&&R.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*w,q.km)+" km":w>=1e4&&R.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*w,q.ha)+" ha":L.GeometryUtil.formattedNumber(w,q.m)+" m"):(w/=.836127,I=w>=3097600?L.GeometryUtil.formattedNumber(w/3097600,q.mi)+" mi":w>=4840?L.GeometryUtil.formattedNumber(w/4840,q.ac)+" acres":L.GeometryUtil.formattedNumber(w,q.yd)+" yd"),I},readableDistance:function(w,v,o,I,X){var q,X=L.Util.extend({},T,X);switch(v?typeof v=="string"?v:"metric":o?"feet":I?"nauticalMile":"yards"){case"metric":q=w>1e3?L.GeometryUtil.formattedNumber(w/1e3,X.km)+" km":L.GeometryUtil.formattedNumber(w,X.m)+" m";break;case"feet":w*=3.28083,q=L.GeometryUtil.formattedNumber(w,X.ft)+" ft";break;case"nauticalMile":w*=.53996,q=L.GeometryUtil.formattedNumber(w/1e3,X.nm)+" nm";break;case"yards":default:w*=1.09361,q=w>1760?L.GeometryUtil.formattedNumber(w/1760,X.mi)+" miles":L.GeometryUtil.formattedNumber(w,X.yd)+" yd"}return q},isVersion07x:function(){var w=L.version.split(".");return parseInt(w[0],10)===0&&parseInt(w[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(T,w,v,o){return this._checkCounterclockwise(T,v,o)!==this._checkCounterclockwise(w,v,o)&&this._checkCounterclockwise(T,w,v)!==this._checkCounterclockwise(T,w,o)},_checkCounterclockwise:function(T,w,v){return(v.y-T.y)*(w.x-T.x)>(w.y-T.y)*(v.x-T.x)}}),L.Polyline.include({intersects:function(){var T,w,v,o=this._getProjectedPoints(),I=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(T=I-1;T>=3;T--)if(w=o[T-1],v=o[T],this._lineSegmentsIntersectsRange(w,v,T-2))return!0;return!1},newLatLngIntersects:function(T,w){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(T),w)},newPointIntersects:function(T,w){var v=this._getProjectedPoints(),o=v?v.length:0,I=v?v[o-1]:null,R=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(I,T,R,w?1:0)},_tooFewPointsForIntersection:function(T){var w=this._getProjectedPoints(),v=w?w.length:0;return v+=T||0,!w||v<=3},_lineSegmentsIntersectsRange:function(T,w,v,o){var I,R,q=this._getProjectedPoints();o=o||0;for(var X=v;X>o;X--)if(I=q[X-1],R=q[X],L.LineUtil.segmentsIntersect(T,w,I,R))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var T=[],w=this._defaultShape(),v=0;v<w.length;v++)T.push(this._map.latLngToLayerPoint(w[v]));return T}}),L.Polygon.include({intersects:function(){var T,w,v,o,I=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(T=I.length,w=I[0],v=I[T-1],o=T-2,this._lineSegmentsIntersectsRange(v,w,o,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(T){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,T);var w;this._toolbars={},L.DrawToolbar&&this.options.draw&&(w=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=w,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(w=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=w,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(T){var w,v=L.DomUtil.create("div","leaflet-draw"),o=!1;for(var I in this._toolbars)this._toolbars.hasOwnProperty(I)&&(w=this._toolbars[I].addToolbar(T))&&(o||(L.DomUtil.hasClass(w,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(w.childNodes[0],"leaflet-draw-toolbar-top"),o=!0),v.appendChild(w));return v},onRemove:function(){for(var T in this._toolbars)this._toolbars.hasOwnProperty(T)&&this._toolbars[T].removeToolbar()},setDrawingOptions:function(T){for(var w in this._toolbars)this._toolbars[w]instanceof L.DrawToolbar&&this._toolbars[w].setOptions(T)},_toolbarEnabled:function(T){var w=T.target;for(var v in this._toolbars)this._toolbars[v]!==w&&this._toolbars[v].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(T){L.setOptions(this,T),this._modes={},this._actionButtons=[],this._activeMode=null;var w=L.version.split(".");parseInt(w[0],10)===1&&parseInt(w[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(T){var w,v=L.DomUtil.create("div","leaflet-draw-section"),o=0,I=this._toolbarClass||"",R=this.getModeHandlers(T);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=T,w=0;w<R.length;w++)R[w].enabled&&this._initModeHandler(R[w].handler,this._toolbarContainer,o++,I,R[w].title);if(o)return this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),v.appendChild(this._toolbarContainer),v.appendChild(this._actionsContainer),v},removeToolbar:function(){for(var T in this._modes)this._modes.hasOwnProperty(T)&&(this._disposeButton(this._modes[T].button,this._modes[T].handler.enable,this._modes[T].handler),this._modes[T].handler.disable(),this._modes[T].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var w=0,v=this._actionButtons.length;w<v;w++)this._disposeButton(this._actionButtons[w].button,this._actionButtons[w].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(T,w,v,o,I){var R=T.type;this._modes[R]={},this._modes[R].handler=T,this._modes[R].button=this._createButton({type:R,title:I,className:o+"-"+R,container:w,callback:this._modes[R].handler.enable,context:this._modes[R].handler}),this._modes[R].buttonIndex=v,this._modes[R].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!Fe.MSStream},_createButton:function(T){var w=L.DomUtil.create("a",T.className||"",T.container),v=L.DomUtil.create("span","sr-only",T.container);w.href="#",w.appendChild(v),T.title&&(w.title=T.title,v.innerHTML=T.title),T.text&&(w.innerHTML=T.text,v.innerHTML=T.text);var o=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(w,"click",L.DomEvent.stopPropagation).on(w,"mousedown",L.DomEvent.stopPropagation).on(w,"dblclick",L.DomEvent.stopPropagation).on(w,"touchstart",L.DomEvent.stopPropagation).on(w,"click",L.DomEvent.preventDefault).on(w,o,T.callback,T.context),w},_disposeButton:function(T,w){var v=this._detectIOS()?"touchstart":"click";L.DomEvent.off(T,"click",L.DomEvent.stopPropagation).off(T,"mousedown",L.DomEvent.stopPropagation).off(T,"dblclick",L.DomEvent.stopPropagation).off(T,"touchstart",L.DomEvent.stopPropagation).off(T,"click",L.DomEvent.preventDefault).off(T,v,w)},_handlerActivated:function(T){this.disable(),this._activeMode=this._modes[T.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(T){var w,v,o,I,R=this._actionsContainer,q=this.getActions(T),X=q.length;for(v=0,o=this._actionButtons.length;v<o;v++)this._disposeButton(this._actionButtons[v].button,this._actionButtons[v].callback);for(this._actionButtons=[];R.firstChild;)R.removeChild(R.firstChild);for(var re=0;re<X;re++)"enabled"in q[re]&&!q[re].enabled||(w=L.DomUtil.create("li","",R),I=this._createButton({title:q[re].title,text:q[re].text,container:w,callback:q[re].callback,context:q[re].context}),this._actionButtons.push({button:I,callback:q[re].callback}))},_showActionsToolbar:function(){var T=this._activeMode.buttonIndex,w=this._lastButtonIndex,v=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=v+"px",T===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),T===w&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(T){this._map=T,this._popupPane=T._panes.popupPane,this._visible=!1,this._container=T.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(T){return this._container?(T.subtext=T.subtext||"",T.subtext.length!==0||this._singleLineLabel?T.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(T.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+T.subtext+"</span><br />":"")+"<span>"+T.text+"</span>",T.text||T.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(T){var w=this._map.latLngToLayerPoint(T),v=this._container;return this._container&&(this._visible&&(v.style.visibility="inherit"),L.DomUtil.setPosition(v,w)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(T){for(var w in this.options)this.options.hasOwnProperty(w)&&T[w]&&(T[w]=L.extend({},this.options[w],T[w]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,T)},getModeHandlers:function(T){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(T,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(T,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(T,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(T,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(T,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(T,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(T){return[{enabled:T.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:T.completeShape,context:T},{enabled:T.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:T.deleteLastVertex,context:T},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(T){L.setOptions(this,T);for(var w in this._modes)this._modes.hasOwnProperty(w)&&T.hasOwnProperty(w)&&this._modes[w].handler.setOptions(T[w])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(T){T.edit&&(T.edit.selectedPathOptions===void 0&&(T.edit.selectedPathOptions=this.options.edit.selectedPathOptions),T.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,T.edit.selectedPathOptions)),T.remove&&(T.remove=L.extend({},this.options.remove,T.remove)),T.poly&&(T.poly=L.extend({},this.options.poly,T.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,T),this._selectedFeatureCount=0},getModeHandlers:function(T){var w=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(T,{featureGroup:w,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(T,{featureGroup:w}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(T){var w=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return T.removeAllLayers&&w.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),w},addToolbar:function(T){var w=L.Toolbar.prototype.addToolbar.call(this,T);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),w},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var T,w=this.options.featureGroup,v=w.getLayers().length!==0;this.options.edit&&(T=this._modes[L.EditToolbar.Edit.TYPE].button,v?L.DomUtil.removeClass(T,"leaflet-disabled"):L.DomUtil.addClass(T,"leaflet-disabled"),T.setAttribute("title",v?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(T=this._modes[L.EditToolbar.Delete.TYPE].button,v?L.DomUtil.removeClass(T,"leaflet-disabled"):L.DomUtil.addClass(T,"leaflet-disabled"),T.setAttribute("title",v?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(T,w){if(L.Handler.prototype.initialize.call(this,T),L.setOptions(this,w),this._featureGroup=w.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var v=L.version.split(".");parseInt(v[0],10)===1&&parseInt(v[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var T=this._map;T&&(T.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),T._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(T){this._revertLayer(T)},this)},save:function(){var T=new L.LayerGroup;this._featureGroup.eachLayer(function(w){w.edited&&(T.addLayer(w),w.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:T})},_backupLayer:function(T){var w=L.Util.stamp(T);this._uneditedLayerProps[w]||(T instanceof L.Polyline||T instanceof L.Polygon||T instanceof L.Rectangle?this._uneditedLayerProps[w]={latlngs:L.LatLngUtil.cloneLatLngs(T.getLatLngs())}:T instanceof L.Circle?this._uneditedLayerProps[w]={latlng:L.LatLngUtil.cloneLatLng(T.getLatLng()),radius:T.getRadius()}:(T instanceof L.Marker||T instanceof L.CircleMarker)&&(this._uneditedLayerProps[w]={latlng:L.LatLngUtil.cloneLatLng(T.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(T){var w=L.Util.stamp(T);T.edited=!1,this._uneditedLayerProps.hasOwnProperty(w)&&(T instanceof L.Polyline||T instanceof L.Polygon||T instanceof L.Rectangle?T.setLatLngs(this._uneditedLayerProps[w].latlngs):T instanceof L.Circle?(T.setLatLng(this._uneditedLayerProps[w].latlng),T.setRadius(this._uneditedLayerProps[w].radius)):(T instanceof L.Marker||T instanceof L.CircleMarker)&&T.setLatLng(this._uneditedLayerProps[w].latlng),T.fire("revert-edited",{layer:T}))},_enableLayerEdit:function(T){var w,v,o=T.layer||T.target||T;this._backupLayer(o),this.options.poly&&(v=L.Util.extend({},this.options.poly),o.options.poly=v),this.options.selectedPathOptions&&(w=L.Util.extend({},this.options.selectedPathOptions),w.maintainColor&&(w.color=o.options.color,w.fillColor=o.options.fillColor),o.options.original=L.extend({},o.options),o.options.editing=w),o instanceof L.Marker?(o.editing&&o.editing.enable(),o.dragging.enable(),o.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):o.editing.enable()},_disableLayerEdit:function(T){var w=T.layer||T.target||T;w.edited=!1,w.editing&&w.editing.disable(),delete w.options.editing,delete w.options.original,this._selectedPathOptions&&(w instanceof L.Marker?this._toggleMarkerHighlight(w):(w.setStyle(w.options.previousOptions),delete w.options.previousOptions)),w instanceof L.Marker?(w.dragging.disable(),w.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):w.editing.disable()},_onMouseMove:function(T){this._tooltip.updatePosition(T.latlng)},_onMarkerDragEnd:function(T){var w=T.target;w.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:w})},_onTouchMove:function(T){var w=T.originalEvent.changedTouches[0],v=this._map.mouseEventToLayerPoint(w),o=this._map.layerPointToLatLng(v);T.target.setLatLng(o)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(T,w){if(L.Handler.prototype.initialize.call(this,T),L.Util.setOptions(this,w),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var v=L.version.split(".");parseInt(v[0],10)===1&&parseInt(v[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var T=this._map;T&&(T.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(T){this._deletableLayers.addLayer(T),T.fire("revert-deleted",{layer:T})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(T){this._removeLayer({layer:T})},this),this.save()},_enableLayerDelete:function(T){(T.layer||T.target||T).on("click",this._removeLayer,this)},_disableLayerDelete:function(T){var w=T.layer||T.target||T;w.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(w)},_removeLayer:function(T){var w=T.layer||T.target||T;this._deletableLayers.removeLayer(w),this._deletedLayers.addLayer(w),w.fire("deleted")},_onMouseMove:function(T){this._tooltip.updatePosition(T.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);function Ud(Fe){throw new Error('Could not dynamically require "'+Fe+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var hm={},cm;function Z_(){return cm||(cm=1,(function(){function Fe(Oe,De,st){function T(o,I){if(!De[o]){if(!Oe[o]){var R=typeof Ud=="function"&&Ud;if(!I&&R)return R(o,!0);if(w)return w(o,!0);var q=new Error("Cannot find module '"+o+"'");throw q.code="MODULE_NOT_FOUND",q}var X=De[o]={exports:{}};Oe[o][0].call(X.exports,function(re){var ce=Oe[o][1][re];return T(ce||re)},X,X.exports,Fe,Oe,De,st)}return De[o].exports}for(var w=typeof Ud=="function"&&Ud,v=0;v<st.length;v++)T(st[v]);return T}return Fe})()({1:[function(Fe,Oe,De){function st(T,w,v){var o=!1;if(typeof window.XMLHttpRequest>"u")return w(Error("Browser not supported"));if(typeof v>"u"){var I=T.match(/^\s*https?:\/\/[^\/]*/);v=I&&I[0]!==location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}var R=new window.XMLHttpRequest;function q(ce){return ce>=200&&ce<300||ce===304}if(v&&!("withCredentials"in R)){R=new window.XDomainRequest;var X=w;w=function(){if(o)X.apply(this,arguments);else{var ce=this,Ae=arguments;setTimeout(function(){X.apply(ce,Ae)},0)}}}function re(){R.status===void 0||q(R.status)?w.call(R,null,R):w.call(R,R,null)}return"onload"in R?R.onload=re:R.onreadystatechange=function(){R.readyState===4&&re()},R.onerror=function(Ae){w.call(this,Ae||!0,null),w=function(){}},R.onprogress=function(){},R.ontimeout=function(ce){w.call(this,ce,null),w=function(){}},R.onabort=function(ce){w.call(this,ce,null),w=function(){}},R.open("GET",T,!0),R.send(null),o=!0,R}typeof Oe<"u"&&(Oe.exports=st)},{}],2:[function(Fe,Oe,De){var st={};function T(o){return Math.floor(Math.abs(o)+.5)*Math.sign(o)}function w(o,I,R){o=T(o*R),I=T(I*R);var q=o-I;q<<=1,o-I<0&&(q=~q);for(var X="";q>=32;)X+=String.fromCharCode((32|q&31)+63),q>>=5;return X+=String.fromCharCode(q+63),X}st.decode=function(o,I){for(var R=0,q=0,X=0,re=[],ce=0,Ae=0,Pe=null,le,it,We=Math.pow(10,I||5);R<o.length;){Pe=null,ce=0,Ae=0;do Pe=o.charCodeAt(R++)-63,Ae|=(Pe&31)<<ce,ce+=5;while(Pe>=32);le=Ae&1?~(Ae>>1):Ae>>1,ce=Ae=0;do Pe=o.charCodeAt(R++)-63,Ae|=(Pe&31)<<ce,ce+=5;while(Pe>=32);it=Ae&1?~(Ae>>1):Ae>>1,q+=le,X+=it,re.push([q/We,X/We])}return re},st.encode=function(o,I){if(!o.length)return"";for(var R=Math.pow(10,I||5),q=w(o[0][0],0,R)+w(o[0][1],0,R),X=1;X<o.length;X++){var re=o[X],ce=o[X-1];q+=w(re[0],ce[0],R),q+=w(re[1],ce[1],R)}return q};function v(o){for(var I=[],R=0;R<o.length;R++)I.push(o[R].slice().reverse());return I}st.fromGeoJSON=function(o,I){if(o&&o.type==="Feature"&&(o=o.geometry),!o||o.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return st.encode(v(o.coordinates),I)},st.toGeoJSON=function(o,I){var R=st.decode(o,I);return{type:"LineString",coordinates:v(R)}},typeof Oe=="object"&&Oe.exports&&(Oe.exports=st)},{}],3:[function(Fe,Oe,De){var st=Fe("./languages"),T=st.instructions,w=st.grammars,v=st.abbreviations;Oe.exports=function(o){return Object.keys(T).forEach(function(I){if(!T[I][o])throw"invalid version "+o+": "+I+" not supported"}),{capitalizeFirstLetter:function(I,R){return R.charAt(0).toLocaleUpperCase(I)+R.slice(1)},ordinalize:function(I,R){if(!I)throw new Error("No language code provided");return T[I][o].constants.ordinalize[R.toString()]||""},directionFromDegree:function(I,R){if(!I)throw new Error("No language code provided");if(!R&&R!==0)return"";if(R>=0&&R<=20)return T[I][o].constants.direction.north;if(R>20&&R<70)return T[I][o].constants.direction.northeast;if(R>=70&&R<=110)return T[I][o].constants.direction.east;if(R>110&&R<160)return T[I][o].constants.direction.southeast;if(R>=160&&R<=200)return T[I][o].constants.direction.south;if(R>200&&R<250)return T[I][o].constants.direction.southwest;if(R>=250&&R<=290)return T[I][o].constants.direction.west;if(R>290&&R<340)return T[I][o].constants.direction.northwest;if(R>=340&&R<=360)return T[I][o].constants.direction.north;throw new Error("Degree "+R+" invalid")},laneConfig:function(I){if(!I.intersections||!I.intersections[0].lanes)throw new Error("No lanes object");var R=[],q=null;return I.intersections[0].lanes.forEach(function(X){(q===null||q!==X.valid)&&(X.valid?R.push("o"):R.push("x"),q=X.valid)}),R.join("")},getWayName:function(I,R,q){var X=q?q.classes||[]:[];if(typeof R!="object")throw new Error("step must be an Object");if(!I)throw new Error("No language code provided");if(!Array.isArray(X))throw new Error("classes must be an Array or undefined");var re,ce=R.name||"",Ae=(R.ref||"").split(";")[0];ce===R.ref&&(ce=""),ce=ce.replace(" ("+R.ref+")","");var Pe=X.indexOf("motorway")!==-1;if(ce&&Ae&&ce!==Ae&&!Pe){var le=T[I][o].phrase["name and ref"]||T.en[o].phrase["name and ref"];re=this.tokenize(I,le,{name:ce,ref:Ae},q)}else ce&&Ae&&Pe&&/\d/.test(Ae)||!ce&&Ae?re=q&&q.formatToken?q.formatToken("ref",Ae):Ae:re=q&&q.formatToken?q.formatToken("name",ce):ce;return re},compile:function(I,R,q){if(!I)throw new Error("No language code provided");if(st.supportedCodes.indexOf(I)===-1)throw new Error("language code "+I+" not loaded");if(!R.maneuver)throw new Error("No step maneuver provided");var X=q||{},re=R.maneuver.type,ce=R.maneuver.modifier,Ae=R.mode,Pe=R.driving_side;if(!re)throw new Error("Missing step maneuver type");if(re!=="depart"&&re!=="arrive"&&!ce)throw new Error("Missing step maneuver modifier");T[I][o][re]||(console.log("Encountered unknown instruction type: "+re),re="turn");var le;if(T[I][o].modes[Ae])le=T[I][o].modes[Ae];else{var it=re==="off ramp"&&ce.indexOf(Pe)>=0;T[I][o][re][ce]&&!it?le=T[I][o][re][ce]:le=T[I][o][re].default}var We;switch(re){case"use lane":We=T[I][o].constants.lanes[this.laneConfig(R)],We||(le=T[I][o]["use lane"].no_lanes);break;case"rotary":case"roundabout":R.rotary_name&&R.maneuver.exit&&le.name_exit?le=le.name_exit:R.rotary_name&&le.name?le=le.name:R.maneuver.exit&&le.exit?le=le.exit:le=le.default;break}var He=this.getWayName(I,R,X),bt;R.destinations&&R.exits&&le.exit_destination?bt=le.exit_destination:R.destinations&&le.destination?bt=le.destination:R.exits&&le.exit?bt=le.exit:He&&le.name?bt=le.name:X.waypointName&&le.named?bt=le.named:bt=le.default;var Bt=R.destinations&&R.destinations.split(": "),Di=Bt&&Bt[0].split(",")[0],Ot=Bt&&Bt[1]&&Bt[1].split(",")[0],Ai;Ot&&Di?Ai=Di+": "+Ot:Ai=Di||Ot||"";var En=X.legIndex>=0&&X.legIndex!==X.legCount-1?this.ordinalize(I,X.legIndex+1):"",zn={way_name:He,destination:Ai,exit:(R.exits||"").split(";")[0],exit_number:this.ordinalize(I,R.maneuver.exit||1),rotary_name:R.rotary_name,lane_instruction:We,modifier:T[I][o].constants.modifier[ce],direction:this.directionFromDegree(I,R.maneuver.bearing_after),nth:En,waypoint_name:X.waypointName};return this.tokenize(I,bt,zn,X)},grammarize:function(I,R,q){if(!I)throw new Error("No language code provided");if(R&&q&&w&&w[I]&&w[I][o]){var X=w[I][o][q];if(X){var re=" "+R+" ",ce=w[I].meta.regExpFlags||"";return X.forEach(function(Ae){var Pe=new RegExp(Ae[0],ce);re=re.replace(Pe,Ae[1])}),re.trim()}}return R},abbreviations:v,tokenize:function(I,R,q,X){if(!I)throw new Error("No language code provided");var re=this,ce=!1,Ae=R.replace(/\{(\w+)(?::(\w+))?\}/g,function(Pe,le,it,We){var He=q[le];return typeof He>"u"?Pe:(He=re.grammarize(I,He,it),We===0&&T[I].meta.capitalizeFirstLetter&&(ce=!0,He=re.capitalizeFirstLetter(I,He)),X&&X.formatToken&&(He=X.formatToken(le,He)),He)}).replace(/ {2}/g," ");return!ce&&T[I].meta.capitalizeFirstLetter?this.capitalizeFirstLetter(I,Ae):Ae}}}},{"./languages":4}],4:[function(Fe,Oe,De){var st=Fe("./languages/translations/da.json"),T=Fe("./languages/translations/de.json"),w=Fe("./languages/translations/en.json"),v=Fe("./languages/translations/eo.json"),o=Fe("./languages/translations/es.json"),I=Fe("./languages/translations/es-ES.json"),R=Fe("./languages/translations/fi.json"),q=Fe("./languages/translations/fr.json"),X=Fe("./languages/translations/he.json"),re=Fe("./languages/translations/id.json"),ce=Fe("./languages/translations/it.json"),Ae=Fe("./languages/translations/ko.json"),Pe=Fe("./languages/translations/my.json"),le=Fe("./languages/translations/nl.json"),it=Fe("./languages/translations/no.json"),We=Fe("./languages/translations/pl.json"),He=Fe("./languages/translations/pt-BR.json"),bt=Fe("./languages/translations/pt-PT.json"),Bt=Fe("./languages/translations/ro.json"),Di=Fe("./languages/translations/ru.json"),Ot=Fe("./languages/translations/sv.json"),Ai=Fe("./languages/translations/tr.json"),En=Fe("./languages/translations/uk.json"),zn=Fe("./languages/translations/vi.json"),Pi=Fe("./languages/translations/zh-Hans.json"),yi=Fe("./languages/grammar/fr.json"),Jn=Fe("./languages/grammar/ru.json"),bn=Fe("./languages/abbreviations/bg.json"),za=Fe("./languages/abbreviations/ca.json"),Ji=Fe("./languages/abbreviations/da.json"),Hi=Fe("./languages/abbreviations/de.json"),_t=Fe("./languages/abbreviations/en.json"),$t=Fe("./languages/abbreviations/es.json"),pt=Fe("./languages/abbreviations/fr.json"),Ut=Fe("./languages/abbreviations/he.json"),Ri=Fe("./languages/abbreviations/hu.json"),Ni=Fe("./languages/abbreviations/lt.json"),ei=Fe("./languages/abbreviations/nl.json"),Tt=Fe("./languages/abbreviations/ru.json"),kt=Fe("./languages/abbreviations/sl.json"),Wi=Fe("./languages/abbreviations/sv.json"),mi=Fe("./languages/abbreviations/uk.json"),ga=Fe("./languages/abbreviations/vi.json"),dn={da:st,de:T,en:w,eo:v,es:o,"es-ES":I,fi:R,fr:q,he:X,id:re,it:ce,ko:Ae,my:Pe,nl:le,no:it,pl:We,"pt-BR":He,"pt-PT":bt,ro:Bt,ru:Di,sv:Ot,tr:Ai,uk:En,vi:zn,"zh-Hans":Pi},Ia={fr:yi,ru:Jn},nn={bg:bn,ca:za,da:Ji,de:Hi,en:_t,es:$t,fr:pt,he:Ut,hu:Ri,lt:Ni,nl:ei,ru:Tt,sl:kt,sv:Wi,uk:mi,vi:ga};Oe.exports={supportedCodes:Object.keys(dn),instructions:dn,grammars:Ia,abbreviations:nn}},{"./languages/abbreviations/bg.json":5,"./languages/abbreviations/ca.json":6,"./languages/abbreviations/da.json":7,"./languages/abbreviations/de.json":8,"./languages/abbreviations/en.json":9,"./languages/abbreviations/es.json":10,"./languages/abbreviations/fr.json":11,"./languages/abbreviations/he.json":12,"./languages/abbreviations/hu.json":13,"./languages/abbreviations/lt.json":14,"./languages/abbreviations/nl.json":15,"./languages/abbreviations/ru.json":16,"./languages/abbreviations/sl.json":17,"./languages/abbreviations/sv.json":18,"./languages/abbreviations/uk.json":19,"./languages/abbreviations/vi.json":20,"./languages/grammar/fr.json":21,"./languages/grammar/ru.json":22,"./languages/translations/da.json":23,"./languages/translations/de.json":24,"./languages/translations/en.json":25,"./languages/translations/eo.json":26,"./languages/translations/es-ES.json":27,"./languages/translations/es.json":28,"./languages/translations/fi.json":29,"./languages/translations/fr.json":30,"./languages/translations/he.json":31,"./languages/translations/id.json":32,"./languages/translations/it.json":33,"./languages/translations/ko.json":34,"./languages/translations/my.json":35,"./languages/translations/nl.json":36,"./languages/translations/no.json":37,"./languages/translations/pl.json":38,"./languages/translations/pt-BR.json":39,"./languages/translations/pt-PT.json":40,"./languages/translations/ro.json":41,"./languages/translations/ru.json":42,"./languages/translations/sv.json":43,"./languages/translations/tr.json":44,"./languages/translations/uk.json":45,"./languages/translations/vi.json":46,"./languages/translations/zh-Hans.json":47}],5:[function(Fe,Oe,De){Oe.exports={abbreviations:{:"",:"",:"",:"Mkt",:"",:"",:"",:"",:"",:"",:"-",:"",:"-",:"",:"",:"",:"",:"-",:"-",:"-",:"",:"",:"",:"",:"",:".",:"",:"",:"-",:"",:""},classifications:{:"",:"",:"",:"",:"-",:"",:"",:"-",:"-",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""},directions:{:"",:"",:"",:"",:"",:"",:""}}},{}],6:[function(Fe,Oe,De){Oe.exports={abbreviations:{comunicacions:"Com.","entitat de poblaci":"Nucli",disseminat:"Diss.","cap de municipi":"Cap",indret:"Indr.",comarca:"Cca.","relleu del litoral":"Lit.",municipi:"Mun.","xarxa hidrogrfica":"Curs Fluv.",equipament:"Equip.",orografia:"Orogr.",barri:"Barri",edificaci:"Edif.","edificaci histrica":"Edif. Hist.","entitat descentralitzada":"E.M.D.","element hidrogrfic":"Hidr."},classifications:{rotonda:"Rot.",carrerada:"Ca.",jard:"J.",paratge:"Pge.",pont:"Pont",lloc:"Lloc",rambla:"Rbla.",cases:"Cses.",barranc:"Bnc.",plana:"Plana",polgon:"Pol.",muralla:"Mur.",enlla:"Ella","antiga carretera":"Actra",glorieta:"Glor.",autovia:"Autv.",prolongaci:"Prol.",calada:"Cda.",carretera:"Ctra.",pujada:"Pda.",torrent:"T.",disseminat:"Disse",barri:"B.",cintur:"Cinto",passera:"Psera",sender:"Send.",carrer:"C.",squia:"Sq.",blocs:"Bloc",rambleta:"Rblt.",partida:"Par.",costa:"Cos.",sector:"Sec.",corral:"Crral",urbanitzaci:"Urb.",autopista:"Autp.",grup:"Gr.",platja:"Pja.",jardins:"J.",complex:"Comp.",portals:"Ptals",finca:"Fin.",travessera:"Trav.",plaa:"Pl.",travessia:"Trv.","polgon industrial":"PI.",passatge:"Ptge.",apartaments:"Apmt.",mirador:"Mira.",antic:"Antic",accs:"Acc.",colnia:"Col.",corriol:"Crol.",portal:"Ptal.",porta:"Pta.",port:"Port",carrer:"Cr.",riera:"Ra.","circumvallaci":"Cval.",baixada:"Bda.",placeta:"Plta.",escala:"Esc.","gran via":"GV",rial:"Rial",conjunt:"Conj.",avinguda:"Av.",esplanada:"Esp.",cantonada:"Cant.",ronda:"Rda.",corredor:"Cdor.",drecera:"Drec.",passads:"Pds.",viaducte:"Vdct.",passeig:"Pg.",venat:"Ve."},directions:{sudest:"SE",sudoest:"SO",nordest:"NE",nordoest:"NO",est:"E",nord:"N",oest:"O",sud:"S"}}},{}],7:[function(Fe,Oe,De){Oe.exports={abbreviations:{skole:"Sk.",ved:"v.",centrum:"C.",sankt:"Skt.",vestre:"v.",hospital:"Hosp.",strde:"Str.",nordre:"Nr.",plads:"Pl.",universitet:"Uni.",vnge:"vg.",station:"St."},classifications:{avenue:"Ave",gammel:"Gl.",dronning:"Dronn.",snder:"Sdr.",nrre:"Nr.",vester:"V.",vestre:"V.",ster:".",stre:".",boulevard:"Boul."},directions:{sydst:"S",nordvest:"NV",syd:"S",nordst:"N",sydvest:"SV",vest:"V",nord:"N",st:""}}},{}],8:[function(Fe,Oe,De){Oe.exports={abbreviations:{},classifications:{},directions:{osten:"O",nordosten:"NO",sden:"S",nordwest:"NW",norden:"N",sdost:"SO",sdwest:"SW",westen:"W"}}},{}],9:[function(Fe,Oe,De){Oe.exports={abbreviations:{square:"Sq",centre:"Ctr",sister:"Sr",lake:"Lk",fort:"Ft",route:"Rte",william:"Wm",national:"Natl",junction:"Jct",center:"Ctr",saint:"St",saints:"SS",station:"Sta",mount:"Mt",junior:"Jr",mountain:"Mtn",heights:"Hts",university:"Univ",school:"Sch",international:"Intl",apartments:"Apts",crossing:"Xing",creek:"Crk",township:"Twp",downtown:"Dtwn",father:"Fr",senior:"Sr",point:"Pt",river:"Riv",market:"Mkt",village:"Vil",park:"Pk",memorial:"Mem"},classifications:{place:"Pl",circle:"Cir",bypass:"Byp",motorway:"Mwy",crescent:"Cres",road:"Rd",cove:"Cv",lane:"Ln",square:"Sq",street:"St",freeway:"Fwy",walk:"Wk",plaza:"Plz",parkway:"Pky",avenue:"Ave",pike:"Pk",drive:"Dr",highway:"Hwy",footway:"Ftwy",point:"Pt",court:"Ct",terrace:"Ter",walkway:"Wky",alley:"Aly",expressway:"Expy",bridge:"Br",boulevard:"Blvd",turnpike:"Tpk"},directions:{southeast:"SE",northwest:"NW",south:"S",west:"W",southwest:"SW",north:"N",east:"E",northeast:"NE"}}},{}],10:[function(Fe,Oe,De){Oe.exports={abbreviations:{segunda:"2",octubre:"8bre",doctores:"Drs",doctora:"Dra",internacional:"Intl",doctor:"Dr",segundo:"2",seorita:"Srta",doctoras:"Drs",primera:"1",primero:"1",san:"S",colonia:"Col",doa:"Da",septiembre:"7bre",diciembre:"10bre",seor:"Sr",ayuntamiento:"Ayto",seora:"Sra",tercera:"3",tercero:"3",don:"D",santa:"Sta",ciudad:"Cdad",noviembre:"9bre",departamento:"Dep"},classifications:{camino:"Cmno",avenida:"Av",paseo:"P",autopista:"Auto",calle:"C",plaza:"Pza",carretera:"Crta"},directions:{este:"E",noreste:"NE",sur:"S",suroeste:"SO",noroeste:"NO",oeste:"O",sureste:"SE",norte:"N"}}},{}],11:[function(Fe,Oe,De){Oe.exports={abbreviations:{alle:"All",arodrome:"Arod",aroport:"Arop"},classifications:{centrale:"Ctrale",campings:"Camp.",urbains:"Urb.",mineure:"Min.",publique:"Publ.",suprieur:"Sup.",fdration:"Fd.","notre-dame":"ND",saint:"St","centre hospitalier rgional":"CHR",exploitation:"Exploit.",gnral:"Gal",civiles:"Civ.",maritimes:"Marit.",aviation:"Aviat.",iii:"3",archologique:"Archo.",musical:"Music.",musicale:"Music.",immeuble:"Imm.",xv:"15",htel:"Ht.",alpine:"Alp.",communale:"Commun.",v:"5",global:"Glob.",universit:"Univ.",confdral:"Confd.",xx:"20",x:"10",piscine:"Pisc.",dimanche:"di.",fleuve:"Flv",postaux:"Post.",musicienne:"Music.",dpartement:"Dpt",fvrier:"Fvr.",municipales:"Munic.",province:"Prov.",communauts:"Commts",barrage:"Barr.",mercredi:"me.",prsidentes:"Pdtes",caftrias:"Caft.",thtral:"Th.",viticulteur:"Vitic.",poste:"Post.",spcialise:"Spc.",agriculture:"Agric.",infirmier:"Infirm.",animation:"Anim.",mondiale:"Mond.",arrt:"Arr.",zone:"zon.",municipaux:"Munic.",grand:"Gd",janvier:"Janv.",fondateur:"Fond.",premire:"1re",municipale:"Munic.",direction:"Dir.",anonyme:"Anon.",dpartementale:"Dpt",moyens:"Moy.",novembre:"Nov.",jardin:"Jard.",petites:"Pet.",priv:"Priv.",centres:"Ctres",forestier:"Forest.",xiv:"14",africaines:"Afric.",sergent:"Sgt",europenne:"Eur.",prive:"Priv.",caf:"Cf",xix:"19",hautes:"Htes",major:"Mjr",vendredi:"ve.",municipalit:"Munic.","sous-prfecture":"Ss-prf.",spciales:"Spc.",secondaires:"Second.",viie:"7e",moyenne:"Moy.",commerciale:"Commerc.",rgion:"Rg.",amricaines:"Amr.",amricains:"Amr.",service:"Sce",professeur:"Prof.",dpartemental:"Dpt",htels:"Ht.",mondiales:"Mond.",ire:"1re",caporal:"Capo.",militaire:"Milit.","lyce d'enseignement professionnel":"LEP",adjudant:"Adj.",mdicale:"Md.",confrences:"Confr.",universelle:"Univ.",xiie:"12e",suprieures:"Sup.",naturel:"Natur.","socit nationale":"SN",hospitalier:"Hosp.",culturelle:"Cult.",amricain:"Amr.","son altesse royale":"S.A.R.",infirmire:"Infirm.",viii:"8",fondatrice:"Fond.",madame:"Mme",mtropolitain:"Mtrop.",ophtalmologues:"Ophtalmos",xviie:"18e",viiie:"8e",commerante:"Commer.","centre d'enseignement du second degr":"CES",septembre:"Sept.",agriculteur:"Agric.",xiii:"13",pontifical:"Pontif.",caftria:"Caft.",prince:"Pce",vie:"6e",archiduchesse:"Archid.",occidental:"Occ.",spectacles:"Spect.",camping:"Camp.",mtro:"M",arrondissement:"Arrond.",viticole:"Vitic.",ii:"2",sicle:"Si.",chapelles:"Chap.",centre:"Ctre","sapeur-pompiers":"Sap.-pomp.",tablissements:"tabts","socit anonyme":"SA",directeurs:"Dir.",vii:"7",culturel:"Cult.",central:"Ctral",mtropolitaine:"Mtrop.",administrations:"Admin.",amiraux:"Amir.",sur:"s/",premiers:"1ers","provence-alpes-cte d'azur":"PACA",cathdrale:"Cathd.",iv:"4",postale:"Post.",social:"Soc.",spcialis:"Spc.",district:"Distr.",technologique:"Techno.",viticoles:"Vitic.",ix:"9",protgs:"Prot.",historiques:"Hist.",sous:"s/s",national:"Nal",ambassade:"Amb.",cafs:"Cfs",agronomie:"Agro.",sapeurs:"Sap.",petits:"Pet.",monsieur:"M.",boucher:"Bouch.",restaurant:"Restau.",lyce:"Lyc.",urbaine:"Urb.",prfecture:"Prf.",districts:"Distr.",civil:"Civ.",protges:"Prot.",sapeur:"Sap.",thtre:"Th.",collge:"Coll.",mardi:"ma.",mmorial:"Mmor.",africain:"Afric.",rpublicaine:"Rpubl.",sociale:"Soc.",spcial:"Spc.",technologie:"Techno.",charcuterie:"Charc.",commerces:"Commerc.",fluviale:"Flv",parachutistes:"Para.",primaires:"Prim.",directions:"Dir.",prsidentiel:"Pdtl",nationales:"Nales",aprs:"apr.",samedi:"sa.",unit:"U.",xxiii:"23",associ:"Assoc.",lectrique:"lectr.",populaire:"Pop.",asiatique:"Asiat.",navigable:"Navig.",prsidente:"Pdte",xive:"14e",associs:"Assoc.",pompiers:"Pomp.",agricoles:"Agric.",lm:"lm.",dcembre:"Dc.","son altesse":"S.Alt.","aprs-midi":"a.-m.",mineures:"Min.",juillet:"Juil.",aviatrices:"Aviat.",fondation:"Fond.",pontificaux:"Pontif.",temple:"Tple",europennes:"Eur.",rgionale:"Rg.",informations:"Infos",mondiaux:"Mond.",infanterie:"Infant.",archologie:"Archo.",dans:"d/",hospice:"Hosp.",spectacle:"Spect.","htels-restaurants":"Ht.-Rest.","htel-restaurant":"Ht.-Rest.",hlicoptre:"hlico",xixe:"19e",cliniques:"Clin.",docteur:"Dr",secondaire:"Second.",municipal:"Munic.",gnrale:"Gale",chteau:"Cht.",commerant:"Commer.",avril:"Avr.",clinique:"Clin.",urbaines:"Urb.",navale:"Nav.",navigation:"Navig.",asiatiques:"Asiat.",pontificales:"Pontif.",administrative:"Admin.",syndicat:"Synd.",lundi:"lu.",petite:"Pet.",maritime:"Marit.",mtros:"M",enseignement:"Enseign.",fluviales:"Flv",historique:"Hist.",comts:"Cts",rsidentiel:"Rsid.",international:"Int.",suprieure:"Sup.","centre hospitalier universitaire":"CHU",confdration:"Confd.",boucherie:"Bouch.",fondatrices:"Fond.",mdicaux:"Md.",europens:"Eur.",orientaux:"Ori.",naval:"Nav.",tang:"tg",provincial:"Prov.",junior:"Jr",dpartementales:"Dpt",musique:"Musiq.",directrices:"Dir.",marchal:"Mal",civils:"Civ.",protg:"Prot.",tablissement:"tabt",trafic:"Traf.",aviateur:"Aviat.",archives:"Arch.",africains:"Afric.",maternelle:"Matern.",industrielle:"Ind.",administratif:"Admin.",oriental:"Ori.",universitaire:"Univ.",majeur:"Maj.",haute:"Hte",communal:"Commun.",petit:"Pet.",commune:"Commun.",exploitant:"Exploit.",confrence:"Confr.",monseigneur:"Mgr",pharmacien:"Pharm.",jeudi:"je.",primaire:"Prim.",hlicoptres:"hlicos",agronomique:"Agro.",mdecin:"Md.",ve:"5e",pontificale:"Pontif.",ier:"1er",cinma:"Cin",fluvial:"Flv",occidentaux:"Occ.",commerants:"Commer.",banque:"Bq",moyennes:"Moy.",pharmacienne:"Pharm.",dmocratique:"Dm.",cinmas:"Cins",spciale:"Spc.",prsidents:"Pdts",directrice:"Dir.",vi:"6",basse:"Bas.",xve:"15e",tat:".",aviateurs:"Aviat.",majeurs:"Maj.",infirmiers:"Infirm.",glise:"gl.",confdrale:"Confd.",xxie:"21e",comte:"Cte",europen:"Eur.",union:"U.",pharmacie:"Pharm.",infirmires:"Infirm.",comt:"Ct",sportive:"Sport.",deuxime:"2e",xvi:"17",haut:"Ht",mdicales:"Md.",dvelopp:"Dvelop.",btiment:"Bt.",commerce:"Commerc.",ive:"4e",associatif:"Assoc.",rural:"Rur.",cimetire:"Cim.",rgional:"Rg.",ferroviaire:"Ferr.",vers:"v/",mosque:"Mosq.",mineurs:"Min.",nautique:"Naut.",chteaux:"Cht.",sportif:"Sport.",mademoiselle:"Mle",cole:"c.",doyen:"Doy.",industriel:"Ind.",chapelle:"Chap.",socits:"Sts",internationale:"Int.",coopratif:"Coop.",hospices:"Hosp.",xxii:"22",parachutiste:"Para.",alpines:"Alp.",civile:"Civ.",xvie:"17e",tats:".",muse:"Mse",centrales:"Ctrales",globaux:"Glob.",suprieurs:"Sup.",syndicats:"Synd.",archevque:"Archev.",docteurs:"Drs",bibliothque:"Biblio.",lieutenant:"Lieut.",rpublique:"Rp.",vtrinaire:"Vt.",dpartementaux:"Dpt",premier:"1er",fluviaux:"Flv",anim:"Anim.",orientales:"Ori.",technologiques:"Techno.",princesse:"Pse",routire:"Rout.",cooprative:"Coop.",scolaire:"Scol.",coles:"c.",football:"Foot",territoriale:"Territ.",commercial:"Commerc.",mineur:"Min.",millnaires:"Mill.",association:"Assoc.",catholique:"Cathol.",administration:"Admin.",mairie:"Mair.",portuaire:"Port.",tertiaires:"Terti.",thtrale:"Th.",palais:"Pal.",troisime:"3e",directeur:"Dir.",vtrinaires:"Vt.",facult:"Fac.",occidentales:"Occ.",viticulteurs:"Vitic.",xvii:"18",occidentale:"Occ.",amiral:"Amir.",professionnel:"Profess.",administratives:"Admin.",commerciales:"Commerc.",saints:"Sts",agronomes:"Agro.",stade:"Std","sous-prfet":"Ss-prf.",senior:"Sr",agronome:"Agro.",terrain:"Terr.",catholiques:"Cathol.",rsidentielle:"Rsid.",grands:"Gds",exploitants:"Exploit.",xiiie:"13e",croix:"Cx",gnraux:"Gaux",crdit:"Crd.",cimetires:"Cim.",antenne:"Ant.",mdical:"Md.",collges:"Coll.",musicien:"Music.",apostolique:"Apost.",postal:"Post.",territorial:"Territ.",urbanisme:"Urb.",prfectorale:"Prf.",fondateurs:"Fond.",information:"Info.",glises:"gl.",ophtalmologue:"Ophtalmo",congrgation:"Congrg.",charcutier:"Charc.",tage:"t.",consulat:"Consul.",public:"Publ.",ferre:"Ferr.",matin:"mat.","socit anonyme  responsabilit limite":"SARL",monuments:"Mmts",protection:"Prot.",universel:"Univ.",nationale:"Nale",prsident:"Pdt",provinciale:"Prov.",agriculteurs:"Agric.",prfectoral:"Prf.",xxe:"20e",alpins:"Alp.",avant:"av.",infirmerie:"Infirm.","deux mil":"2000",rurale:"Rur.",administratifs:"Admin.",octobre:"Oct.",archipel:"Archip.",communaut:"Commt",globales:"Glob.",alpin:"Alp.",numros:"N","lieutenant-colonel":"Lieut.-Col.","jsus-christ":"J.-C.",agricole:"Agric.","sa majest":"S.Maj.",associative:"Assoc.",xxi:"21",prsidentielle:"Pdtle",moyen:"Moy.",fdral:"Fd.",professionnelle:"Profess.",tertiaire:"Terti.",ixe:"9e",hpital:"Hp.",technologies:"Techno.",iiie:"3e",dveloppement:"Dvelop.",monument:"Mmt",forestire:"Forest.",numro:"N",viticulture:"Vitic.",traversire:"Traver.",technique:"Tech.",lectriques:"lectr.",militaires:"Milit.",pompier:"Pomp.",amricaine:"Amr.",prfet:"Prf.",congrgations:"Congrg.",ptissier:"Ptiss.",mondial:"Mond.",ophtalmologie:"Ophtalm.",sainte:"Ste",africaine:"Afric.",aviatrice:"Aviat.",doyens:"Doy.",socit:"St",majeures:"Maj.",orientale:"Ori.",ministre:"Min.",archiduc:"Archid.",territoire:"Territ.",techniques:"Tech.","le-de-france":"IDF",globale:"Glob.",xe:"10e",xie:"11e",majeure:"Maj.",commerciaux:"Commerc.",maire:"Mair.",spciaux:"Spc.",grande:"Gde",messieurs:"MM",colonel:"Col.",millnaire:"Mill.",xi:"11",urbain:"Urb.",fdrale:"Fd.",ferr:"Ferr.",rivire:"Riv.",rpublicain:"Rpubl.",grandes:"Gdes",rgiment:"Rgim.",hauts:"Hts",catgorie:"Catg.",basses:"Bas.",xii:"12",agronomiques:"Agro.",iie:"2e",protge:"Prot.","sapeur-pompier":"Sap.-pomp."},directions:{"est-nord-est":"ENE","nord-est":"NE",ouest:"O","sud-est":"SE","est-sud-est":"ESE","nord-nord-est":"NNE",sud:"S","nord-nord-ouest":"NNO","nord-ouest":"NO",nord:"N","ouest-sud-ouest":"OSO","ouest-nord-ouest":"ONO","sud-ouest":"SO","sud-sud-est":"SSE","sud-sud-ouest":"SSO",est:"E"}}},{}],12:[function(Fe,Oe,De){Oe.exports={abbreviations:{:"'"},classifications:{},directions:{}}},{}],13:[function(Fe,Oe,De){Oe.exports={abbreviations:{},classifications:{},directions:{kelet:"K",szakkelet:"K",dl:"D",szaknyugat:"NY",szak:"",dlkelet:"DK",dlnyugat:"DNY",nyugat:"NY"}}},{}],14:[function(Fe,Oe,De){Oe.exports={abbreviations:{apartamentai:"Apt",auktumos:"Auk",centras:"Ctr",eeras:"E",fortas:"Ft",greitkelis:"Grtkl",juosta:"Jst",kaimas:"Km",kalnas:"Kln",kelias:"Kl",kiemelis:"Kml",miestelis:"Mstl","miesto centras":"M.Ctr",mokykla:"Mok",nacionalinis:"Nac",paminklas:"Pmkl",parkas:"Pk",pusratis:"Psrt",sankrya:"Skr",ses:"Ses",skveras:"Skv",stotis:"St",v:"v",tarptautinis:"Trptaut",takas:"Tk",tvas:"Tv",turgus:"Tgs",universitetas:"Univ",up:"Up",upelis:"Up",vieta:"Vt"},classifications:{aikt:"a.",alja:"al.",aplinkkelis:"aplinkl.",autostrada:"auto.",bulvaras:"b.",gatv:"g.",kelias:"kel.",krantin:"krant.",prospektas:"pr.",plentas:"pl.",skersgatvis:"skg.",takas:"tak.",tiltas:"tlt."},directions:{piets:"P",vakarai:"V",iaur:"","iaurs vakarai":"V",pietryiai:"PR","iaurs rytai":"R",rytai:"R",pietvakariai:"PV"}}},{}],15:[function(Fe,Oe,De){Oe.exports={abbreviations:{centrum:"Cntrm",nationaal:"Natl",berg:"Brg",meer:"Mr",kruising:"Krsng",toetreden:"Ttrdn"},classifications:{bypass:"Pass",brug:"Br",straat:"Str",rechtbank:"Rbank",snoek:"Snk",autobaan:"Baan",terras:"Trrs",punt:"Pt",plaza:"Plz",rijden:"Rijd",parkway:"Pky",inham:"Nham",snelweg:"Weg","halve maan":"Maan",cirkel:"Crkl",laan:"Ln",rijbaan:"Strook",weg:"Weg",lopen:"Lpn",autoweg:"Weg",boulevard:"Blvd",plaats:"Plts",steeg:"Stg",voetpad:"Stoep"},directions:{noordoost:"NO",westen:"W",zuiden:"Z",zuidwest:"ZW",oost:"O",zuidoost:"ZO",noordwest:"NW",noorden:"N"}}},{}],16:[function(Fe,Oe,De){Oe.exports={abbreviations:{:".",:".",:"",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:".",:"."},classifications:{:"-",:".",:".",:".",:".",:".",:".",:".",:"."},directions:{:"","-":"","-":"","-":"","-":"",:"",:"",:""}}},{}],17:[function(Fe,Oe,De){Oe.exports={abbreviations:{},classifications:{},directions:{vzhod:"V",severovzhod:"SV",jug:"J",severozahod:"SZ",sever:"S",jugovzhod:"JV",jugozahod:"JZ",zahod:"Z"}}},{}],18:[function(Fe,Oe,De){Oe.exports={abbreviations:{sankta:"s:ta",gamla:"G:la",sankt:"s:t"},classifications:{Bro:"Br"},directions:{norr:"N",sydst:"SO",vster:"V",ster:"O",nordvst:"NV",sydvst:"SV",sder:"S",nordst:"NO"}}},{}],19:[function(Fe,Oe,De){Oe.exports={abbreviations:{},classifications:{},directions:{:""," ":"",:""," ":"",:""," ":""," ":"",:""}}},{}],20:[function(Fe,Oe,De){Oe.exports={abbreviations:{"vin bo tng":"VBT","th trn":"Tt","i hc":"H","cn c khng quan":"CCKQ","cu lc b":"CLB","bu in":"B","khch sn":"KS","khu du lch":"KDL","khu cng nghip":"KCN","khu ngh mt":"KNM","th x":"Tx","khu chung c":"KCC","phi trng":"PT","trung tm":"TT","tng cng ty":"TCty","trung hc c s":"THCS","sn bay quc t":"SBQT","trung hc ph thng":"THPT","cao ng":"C","cng ty":"Cty","sn bay":"SB","thnh ph":"Tp","cng vin":"CV","sn vn ng":"SV","linh mc":"LM","vn quc gia":"VQG"},classifications:{"huyn l":"HL","ng tnh":"T","quc l":"QL","xa l":"XL","hng l":"HL","tnh l":"TL","ng huyn":"H","ng cao tc":"CT","i l":"L","vit nam":"VN","qung trng":"QT","ng b":"B"},directions:{ty:"T",nam:"N","ng nam":"N","ng bc":"B","ty nam":"TN",ng:"",bc:"B"}}},{}],21:[function(Fe,Oe,De){Oe.exports={meta:{regExpFlags:"gi"},v5:{article:[["^ Acc[e]s "," laccs "],["^ Aire "," laire "],["^ All[e]e "," lalle "],["^ Anse "," lanse "],["^ (L['])?Autoroute "," lautoroute "],["^ Avenue "," lavenue "],["^ Barreau "," le barreau "],["^ Boulevard "," le boulevard "],["^ Chemin "," le chemin "],["^ Petit[\\- ]Chemin "," le petit chemin "],["^ Cit[e] "," la cit "],["^ Clos "," le clos "],["^ Corniche "," la corniche "],["^ Cour "," la cour "],["^ Cours "," le cours "],["^ D[e]viation "," la dviation "],["^ Entr[e]e "," lentre "],["^ Esplanade "," lesplanade "],["^ Galerie "," la galerie "],["^ Impasse "," limpasse "],["^ Lotissement "," le lotissement "],["^ Mont[e]e "," la monte "],["^ Parc "," le parc "],["^ Parvis "," le parvis "],["^ Passage "," le passage "],["^ Place "," la place "],["^ Petit[\\- ]Pont "," le petit-pont "],["^ Pont "," le pont "],["^ Promenade "," la promenade "],["^ Quai "," le quai "],["^ Rocade "," la rocade "],["^ Rond[\\- ]?Point "," le rond-point "],["^ Route "," la route "],["^ Rue "," la rue "],["^ Grande Rue "," la grande rue "],["^ Sente "," la sente "],["^ Sentier "," le sentier "],["^ Sortie "," la sortie "],["^ Souterrain "," le souterrain "],["^ Square "," le square "],["^ Terrasse "," la terrasse "],["^ Traverse "," la traverse "],["^ Tunnel "," le tunnel "],["^ Viaduc "," le viaduc "],["^ Villa "," la villa "],["^ Village "," le village "],["^ Voie "," la voie "],[" ([dl])'"," $1"]],preposition:[["^ Le ","  du "],["^ Les ","  des "],["^ La ","  de La "],["^ Acc[e]s ","  de laccs "],["^ Aire ","  de laire "],["^ All[e]e ","  de lalle "],["^ Anse ","  de lanse "],["^ (L['])?Autoroute ","  de lautoroute "],["^ Avenue ","  de lavenue "],["^ Barreau ","  du barreau "],["^ Boulevard ","  du boulevard "],["^ Chemin ","  du chemin "],["^ Petit[\\- ]Chemin ","  du petit chemin "],["^ Cit[e] ","  de la cit "],["^ Clos ","  du clos "],["^ Corniche ","  de la corniche "],["^ Cour ","  de la cour "],["^ Cours ","  du cours "],["^ D[e]viation ","  de la dviation "],["^ Entr[e]e ","  de lentre "],["^ Esplanade ","  de lesplanade "],["^ Galerie ","  de la galerie "],["^ Impasse ","  de limpasse "],["^ Lotissement ","  du lotissement "],["^ Mont[e]e ","  de la monte "],["^ Parc ","  du parc "],["^ Parvis ","  du parvis "],["^ Passage ","  du passage "],["^ Place ","  de la place "],["^ Petit[\\- ]Pont ","  du petit-pont "],["^ Pont ","  du pont "],["^ Promenade ","  de la promenade "],["^ Quai ","  du quai "],["^ Rocade ","  de la rocade "],["^ Rond[\\- ]?Point ","  du rond-point "],["^ Route ","  de la route "],["^ Rue ","  de la rue "],["^ Grande Rue ","  de la grande rue "],["^ Sente ","  de la sente "],["^ Sentier ","  du sentier "],["^ Sortie ","  de la sortie "],["^ Souterrain ","  du souterrain "],["^ Square ","  du square "],["^ Terrasse ","  de la terrasse "],["^ Traverse ","  de la traverse "],["^ Tunnel ","  du tunnel "],["^ Viaduc ","  du viaduc "],["^ Villa ","  de la villa "],["^ Village ","  du village "],["^ Voie ","  de la voie "],["^ ([AEIOUY])","  d$1"],["^ (\\S)","  de $1"],[" ([dl])'"," $1"]],rotary:[["^ Le ","  le rond-point du "],["^ Les ","  le rond-point des "],["^ La ","  le rond-point de La "],["^ Acc[e]s "," le rond-point de laccs "],["^ Aire ","  le rond-point de laire "],["^ All[e]e ","  le rond-point de lalle "],["^ Anse ","  le rond-point de lanse "],["^ (L['])?Autoroute ","  le rond-point de lautoroute "],["^ Avenue ","  le rond-point de lavenue "],["^ Barreau ","  le rond-point du barreau "],["^ Boulevard ","  le rond-point du boulevard "],["^ Chemin ","  le rond-point du chemin "],["^ Petit[\\- ]Chemin ","  le rond-point du petit chemin "],["^ Cit[e] ","  le rond-point de la cit "],["^ Clos ","  le rond-point du clos "],["^ Corniche ","  le rond-point de la corniche "],["^ Cour ","  le rond-point de la cour "],["^ Cours ","  le rond-point du cours "],["^ D[e]viation ","  le rond-point de la dviation "],["^ Entr[e]e ","  le rond-point de lentre "],["^ Esplanade ","  le rond-point de lesplanade "],["^ Galerie ","  le rond-point de la galerie "],["^ Impasse ","  le rond-point de limpasse "],["^ Lotissement ","  le rond-point du lotissement "],["^ Mont[e]e ","  le rond-point de la monte "],["^ Parc ","  le rond-point du parc "],["^ Parvis ","  le rond-point du parvis "],["^ Passage ","  le rond-point du passage "],["^ Place ","  le rond-point de la place "],["^ Petit[\\- ]Pont ","  le rond-point du petit-pont "],["^ Pont ","  le rond-point du pont "],["^ Promenade ","  le rond-point de la promenade "],["^ Quai ","  le rond-point du quai "],["^ Rocade ","  le rond-point de la rocade "],["^ Rond[\\- ]?Point ","  le rond-point "],["^ Route ","  le rond-point de la route "],["^ Rue ","  le rond-point de la rue "],["^ Grande Rue ","  le rond-point de la grande rue "],["^ Sente ","  le rond-point de la sente "],["^ Sentier ","  le rond-point du sentier "],["^ Sortie ","  le rond-point de la sortie "],["^ Souterrain ","  le rond-point du souterrain "],["^ Square ","  le rond-point du square "],["^ Terrasse ","  le rond-point de la terrasse "],["^ Traverse ","  le rond-point de la traverse "],["^ Tunnel ","  le rond-point du tunnel "],["^ Viaduc ","  le rond-point du viaduc "],["^ Villa ","  le rond-point de la villa "],["^ Village ","  le rond-point du village "],["^ Voie ","  le rond-point de la voie "],["^ ([AEIOUY])","  le rond-point d$1"],["^ (\\S)","  le rond-point de $1"],[" ([dl])'"," $1"]],arrival:[["^ Le ","  au "],["^ Les ","  aux "],["^ La ","   La "],["^ (\\S)","   $1"],[" ([dl])'"," $1"]]}}},{}],22:[function(Fe,Oe,De){Oe.exports={meta:{regExpFlags:""},v5:{accusative:[['^ (["])',"  $1"],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+)-(\\S+) [] "," $1-$2  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\S+) (\\S+) [] "," $1 $2  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+) (\\S+[]) [] "," $1 $2  "],["^  [] ","   "],["^  [] ","   "],["^  [] ","   "],["^ [] ","  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)-(\\d+)- [] "," $1-$2-  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\d+)-(\\d+)- [] "," $1-$2-  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- [] "," $1-  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) (\\S+) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) (\\S+) ([])?[] "," $1 $2 $3 "],["^ (\\d+)- (\\S+) ([])?[] "," $1- $2 $3 "],["^ ([])?[] "," $1 "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ [][] ","  "]],dative:[['^ (["])',"  $1"],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+)-(\\S+) [] "," $1-$2  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\S+) (\\S+) [] "," $1 $2  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+) (\\S+[]) [] "," $1 $2  "],["^  [] ","   "],["^  [] ","   "],["^  [] ","   "],["^ [] ","  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)-(\\d+)- [] "," $1-$2-  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\d+)-(\\d+)- [] "," $1-$2-  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- [] "," $1-  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) (\\S+) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) (\\S+) ([])?[] "," $1 $2 $3 "],["^ (\\d+)- (\\S+) ([])?[] "," $1- $2 $3 "],["^ ([])?[] "," $1 "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ [][] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+)[]-(\\S+)[] [] "," $1-$2  "],["^ (\\d+)- (\\S+)[]-(\\S+)[] [] "," $1- $2-$3  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ [] ","  "],["^ (\\S+[])-(\\S+)[] [] "," $1-$2  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+) (\\S+)[] [] "," $1- $2 $3  "],["^ (\\d+)- (\\S+)[] (\\S+)[] [] "," $1- $2 $3  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [][] "," $1  "],["^ (\\S+)[] [][] "," $1  "],["^ (\\S+[]) [][] "," $1  "],["^ (\\S+)[] (\\S+) [][] "," $1 $2  "],["^ (\\S+) (\\S+)[] [][] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [][] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [][] "," $1 $2  "],["^ (\\d+)- (\\S+) [][] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [][] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [][] "," $1- $2  "],["^ [][] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+[]) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+[]) (\\S+[]) ([])?[] "," $1 $2 $3 "],["^ (\\S+) (\\S+[]) ([])?[] "," $1 $2 $3 "],["^ (\\d+)- (\\S+[]) ([])?[] "," $1- $2 $3 "],["^ (\\d+)- (\\S+) ([])?[] "," $1- $2 $3 "],["^ ([])?[] "," $1 "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+[]) (\\S+[]) [] "," $1 $2  "],["^ (\\S+) (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],[" ([]) "," $1 "],["([]) ","$1 "],["([]) ","$1 "]],genitive:[['^ (["])',"  $1"],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+)-(\\S+) [] "," $1-$2  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\S+) (\\S+) [] "," $1 $2  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+) (\\S+[]) [] "," $1 $2  "],["^  [] ","   "],["^  [] ","   "],["^  [] ","   "],["^ [] ","  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)-(\\d+)- [] "," $1-$2-  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\d+)-(\\d+)- [] "," $1-$2-  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- [] "," $1-  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) (\\S+) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) (\\S+) ([])?[] "," $1 $2 $3 "],["^ (\\d+)- (\\S+) ([])?[] "," $1- $2 $3 "],["^ ([])?[] "," $1 "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ [][] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+)[]-(\\S+)[] [] "," $1-$2  "],["^ (\\d+)- (\\S+)[]-(\\S+)[] [] "," $1- $2-$3  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ [] ","  "],["^ (\\S+[])-(\\S+)[] [] "," $1-$2  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+) (\\S+)[] [] "," $1- $2 $3  "],["^ (\\d+)- (\\S+)[] (\\S+)[] [] "," $1- $2 $3  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [][] "," $1  "],["^ (\\S+)[] [][] "," $1  "],["^ (\\S+[]) [][] "," $1  "],["^ (\\S+)[] (\\S+) [][] "," $1 $2  "],["^ (\\S+) (\\S+)[] [][] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [][] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [][] "," $1 $2  "],["^ (\\d+)- (\\S+) [][] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [][] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [][] "," $1- $2  "],["^ [][] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+[]) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+[]) (\\S+[]) ([])?[] "," $1 $2 $3 "],["^ (\\S+) (\\S+[]) ([])?[] "," $1 $2 $3 "],["^ (\\d+)- (\\S+[]) ([])?[] "," $1- $2 $3 "],["^ (\\d+)- (\\S+) ([])?[] "," $1- $2 $3 "],["^ ([])?[] "," $1 "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+[]) (\\S+[]) [] "," $1 $2  "],["^ (\\S+) (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],[" ([]) "," $1 "],["([]) ","$1 "]],prepositional:[['^ (["])',"  $1"],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+)-(\\S+) [] "," $1-$2  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\S+) (\\S+) [] "," $1 $2  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+) (\\S+[]) [] "," $1 $2  "],["^  [] ","   "],["^  [] ","   "],["^  [] ","   "],["^ [] ","  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)-(\\d+)- [] "," $1-$2-  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\d+)-(\\d+)- [] "," $1-$2-  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- [] "," $1-  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) (\\S+) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+) (\\S+) ([])?[] "," $1 $2 $3 "],["^ (\\d+)- (\\S+) ([])?[] "," $1- $2 $3 "],["^ ([])?[] "," $1 "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ [][] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+)[]-(\\S+)[] [] "," $1-$2  "],["^ (\\d+)- (\\S+)[]-(\\S+)[] [] "," $1- $2-$3  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ [] ","  "],["^ (\\S+[])-(\\S+)[] [] "," $1-$2  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+) (\\S+)[] [] "," $1- $2 $3  "],["^ (\\d+)- (\\S+)[] (\\S+)[] [] "," $1- $2 $3  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [][] "," $1  "],["^ (\\S+)[] [][] "," $1  "],["^ (\\S+[]) [][] "," $1  "],["^ (\\S+)[] (\\S+) [][] "," $1 $2  "],["^ (\\S+) (\\S+)[] [][] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [][] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [][] "," $1 $2  "],["^ (\\d+)- (\\S+) [][] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [][] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [][] "," $1- $2  "],["^ [][] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+) [] "," $1  "],["^ (\\S+)[] [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+)[] (\\S+) [] "," $1 $2  "],["^ (\\S+) (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+)[] [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\S+)[] (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- [] "," $1-  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],["^ (\\d+)- (\\S+)[] [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ [] ","  "],["^ (\\S+[]) ([])?[] "," $1 $2 "],["^ (\\S+) ([])?[] "," $1 $2 "],["^ (\\S+[]) (\\S+[]) ([])?[] "," $1 $2 $3 "],["^ (\\S+) (\\S+[]) ([])?[] "," $1 $2 $3 "],["^ (\\d+)- (\\S+[]) ([])?[] "," $1- $2 $3 "],["^ (\\d+)- (\\S+) ([])?[] "," $1- $2 $3 "],["^ ([])?[] "," $1 "],["^ (\\S+[]) [] "," $1  "],["^ (\\S+) [] "," $1  "],["^ (\\S+[]) (\\S+[]) [] "," $1 $2  "],["^ (\\S+) (\\S+[]) [] "," $1 $2  "],["^ (\\d+)- (\\S+[]) [] "," $1- $2  "],["^ (\\d+)- (\\S+) [] "," $1- $2  "],[" ([]) "," $1 "],["([]) ","$1 "]]}}},{}],23:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"frste",2:"anden",3:"tredje",4:"fjerde",5:"femte",6:"sjette",7:"syvende",8:"ottende",9:"niende",10:"tiende"},direction:{north:"Nord",northeast:"Nordst",east:"st",southeast:"Sydst",south:"Syd",southwest:"Sydvest",west:"Vest",northwest:"Nordvest"},modifier:{left:"venstresving",right:"hjresving","sharp left":"skarpt venstresving","sharp right":"skarpt hjresving","slight left":"svagt venstresving","slight right":"svagt hjresving",straight:"ligeud",uturn:"U-vending"},lanes:{xo:"Hold til hjre",ox:"Hold til venstre",xox:"Benyt midterste spor",oxo:"Hold til hjre eller venstre"}},modes:{ferry:{default:"Tag frgen",name:"Tag frgen {way_name}",destination:"Tag frgen i retning {destination}"}},phrase:{"two linked by distance":"{instruction_one} derefter, efter {distance}, {instruction_two}","two linked":"{instruction_one}, derefter {instruction_two}","one in distance":"Efter {distance} {instruction_one}","name and ref":"{name} ({ref})","exit with number":"afkrsel {exit}"},arrive:{default:{default:"Du er ankommet til din {nth} destination",upcoming:"Du vil ankomme til din {nth} destination",short:"Du er ankommet","short-upcoming":"Du vil ankomme",named:"Du er ankommet til {waypoint_name}"},left:{default:"Du er ankommet til din {nth} destination, som befinder sig til venstre",upcoming:"Du vil ankomme til din {nth} destination p venstre hnd",short:"Du er ankommet","short-upcoming":"Du vil ankomme",named:"Du er ankommet til {waypoint_name}, som befinder sig til venstre"},right:{default:"Du er ankommet til din {nth} destination, som befinder sig til hjre",upcoming:"Du vil ankomme til din {nth} destination p hjre hnd",short:"Du er ankommet","short-upcoming":"Du vil ankomme",named:"Du er ankommet til {waypoint_name}, som befinder sig til hjre"},"sharp left":{default:"Du er ankommet til din {nth} destination, som befinder sig til venstre",upcoming:"Du vil ankomme til din {nth} destination p venstre hnd",short:"Du er ankommet","short-upcoming":"Du vil ankomme",named:"Du er ankommet til {waypoint_name}, som befinder sig til venstre"},"sharp right":{default:"Du er ankommet til din {nth} destination, som befinder sig til hjre",upcoming:"Du vil ankomme til din {nth} destination p hjre hnd",short:"Du er ankommet","short-upcoming":"Du vil ankomme",named:"Du er ankommet til {waypoint_name}, som befinder sig til hjre"},"slight right":{default:"Du er ankommet til din {nth} destination, som befinder sig til hjre",upcoming:"Du vil ankomme til din {nth} destination p hjre hnd",short:"Du er ankommet","short-upcoming":"Du vil ankomme",named:"Du er ankommet til {waypoint_name}, som befinder sig til hjre"},"slight left":{default:"Du er ankommet til din {nth} destination, som befinder sig til venstre",upcoming:"Du vil ankomme til din {nth} destination p venstre hnd",short:"Du er ankommet","short-upcoming":"Du vil ankomme",named:"Du er ankommet til {waypoint_name}, som befinder sig til venstre"},straight:{default:"Du er ankommet til din {nth} destination, der befinder sig lige frem",upcoming:"Du vil ankomme til din {nth} destination foran dig",short:"Du er ankommet","short-upcoming":"Du vil ankomme",named:"Du er ankommet til {waypoint_name}, der befinder sig lige frem"}},continue:{default:{default:"Drej til {modifier}",name:"Drej til {modifier} videre ad {way_name}",destination:"Drej til {modifier} mod {destination}",exit:"Drej til {modifier} ad {way_name}"},straight:{default:"Fortst ligeud",name:"Fortst ligeud ad {way_name}",destination:"Fortst mod {destination}",distance:"Fortst {distance} ligeud",namedistance:"Fortst {distance} ad {way_name}"},"sharp left":{default:"Drej skarpt til venstre",name:"Drej skarpt til venstre videre ad {way_name}",destination:"Drej skarpt til venstre mod {destination}"},"sharp right":{default:"Drej skarpt til hjre",name:"Drej skarpt til hjre videre ad {way_name}",destination:"Drej skarpt til hjre mod {destination}"},"slight left":{default:"Drej left til venstre",name:"Drej let til venstre videre ad {way_name}",destination:"Drej let til venstre mod {destination}"},"slight right":{default:"Drej let til hjre",name:"Drej let til hjre videre ad {way_name}",destination:"Drej let til hjre mod {destination}"},uturn:{default:"Foretag en U-vending",name:"Foretag en U-vending tilbage ad {way_name}",destination:"Foretag en U-vending mod {destination}"}},depart:{default:{default:"Kr mod {direction}",name:"Kr mod {direction} ad {way_name}",namedistance:"Fortst {distance} ad {way_name}mod {direction}"}},"end of road":{default:{default:"Drej til {modifier}",name:"Drej til {modifier} ad {way_name}",destination:"Drej til {modifier} mof {destination}"},straight:{default:"Fortst ligeud",name:"Fortst ligeud ad {way_name}",destination:"Fortst ligeud mod {destination}"},uturn:{default:"Foretag en U-vending for enden af vejen",name:"Foretag en U-vending ad {way_name} for enden af vejen",destination:"Foretag en U-vending mod {destination} for enden af vejen"}},fork:{default:{default:"Hold til {modifier} ved udfletningen",name:"Hold mod {modifier} p {way_name}",destination:"Hold mod {modifier} mod {destination}"},"slight left":{default:"Hold til venstre ved udfletningen",name:"Hold til venstre p {way_name}",destination:"Hold til venstre mod {destination}"},"slight right":{default:"Hold til hjre ved udfletningen",name:"Hold til hjre p {way_name}",destination:"Hold til hjre mod {destination}"},"sharp left":{default:"Drej skarpt til venstre ved udfletningen",name:"Drej skarpt til venstre ad {way_name}",destination:"Drej skarpt til venstre mod {destination}"},"sharp right":{default:"Drej skarpt til hjre ved udfletningen",name:"Drej skarpt til hjre ad {way_name}",destination:"Drej skarpt til hjre mod {destination}"},uturn:{default:"Foretag en U-vending",name:"Foretag en U-vending ad {way_name}",destination:"Foretag en U-vending mod {destination}"}},merge:{default:{default:"Flet til {modifier}",name:"Flet til {modifier} ad {way_name}",destination:"Flet til {modifier} mod {destination}"},straight:{default:"Flet",name:"Flet ind p {way_name}",destination:"Flet ind mod {destination}"},"slight left":{default:"Flet til venstre",name:"Flet til venstre ad {way_name}",destination:"Flet til venstre mod {destination}"},"slight right":{default:"Flet til hjre",name:"Flet til hjre ad {way_name}",destination:"Flet til hjre mod {destination}"},"sharp left":{default:"Flet til venstre",name:"Flet til venstre ad {way_name}",destination:"Flet til venstre mod {destination}"},"sharp right":{default:"Flet til hjre",name:"Flet til hjre ad {way_name}",destination:"Flet til hjre mod {destination}"},uturn:{default:"Foretag en U-vending",name:"Foretag en U-vending ad {way_name}",destination:"Foretag en U-vending mod {destination}"}},"new name":{default:{default:"Fortst {modifier}",name:"Fortst {modifier} ad {way_name}",destination:"Fortst {modifier} mod {destination}"},straight:{default:"Fortst ligeud",name:"Fortst ad {way_name}",destination:"Fortst mod {destination}"},"sharp left":{default:"Drej skarpt til venstre",name:"Drej skarpt til venstre ad {way_name}",destination:"Drej skarpt til venstre mod {destination}"},"sharp right":{default:"Drej skarpt til hjre",name:"Drej skarpt til hjre ad {way_name}",destination:"Drej skarpt til hjre mod {destination}"},"slight left":{default:"Fortst til venstre",name:"Fortst til venstre ad {way_name}",destination:"Fortst til venstre mod {destination}"},"slight right":{default:"Fortst til hjre",name:"Fortst til hjre ad {way_name}",destination:"Fortst til hjre mod {destination}"},uturn:{default:"Foretag en U-vending",name:"Foretag en U-vending ad {way_name}",destination:"Foretag en U-vending mod {destination}"}},notification:{default:{default:"Fortst {modifier}",name:"Fortst {modifier} ad {way_name}",destination:"Fortst {modifier} mod {destination}"},uturn:{default:"Foretag en U-vending",name:"Foretag en U-vending ad {way_name}",destination:"Foretag en U-vending mod {destination}"}},"off ramp":{default:{default:"Tag afkrslen",name:"Tag afkrslen ad {way_name}",destination:"Tag afkrslen mod {destination}",exit:"Vlg afkrsel {exit}",exit_destination:"Vlg afkrsel {exit} mod {destination}"},left:{default:"Tag afkrslen til venstre",name:"Tag afkrslen til venstre ad {way_name}",destination:"Tag afkrslen til venstre mod {destination}",exit:"Vlg afkrsel {exit} til venstre",exit_destination:`Vlg afkrsel {exit} til venstre mod {destination}
`},right:{default:"Tag afkrslen til hjre",name:"Tag afkrslen til hjre ad {way_name}",destination:"Tag afkrslen til hjre mod {destination}",exit:"Vlg afkrsel {exit} til hjre",exit_destination:"Vlg afkrsel {exit} til hjre mod {destination}"},"sharp left":{default:"Tag afkrslen til venstre",name:"Tag afkrslen til venstre ad {way_name}",destination:"Tag afkrslen til venstre mod {destination}",exit:"Vlg afkrsel {exit} til venstre",exit_destination:`Vlg afkrsel {exit} til venstre mod {destination}
`},"sharp right":{default:"Tag afkrslen til hjre",name:"Tag afkrslen til hjre ad {way_name}",destination:"Tag afkrslen til hjre mod {destination}",exit:"Vlg afkrsel {exit} til hjre",exit_destination:"Vlg afkrsel {exit} til hjre mod {destination}"},"slight left":{default:"Tag afkrslen til venstre",name:"Tag afkrslen til venstre ad {way_name}",destination:"Tag afkrslen til venstre mod {destination}",exit:"Vlg afkrsel {exit} til venstre",exit_destination:`Vlg afkrsel {exit} til venstre mod {destination}
`},"slight right":{default:"Tag afkrslen til hjre",name:"Tag afkrslen til hjre ad {way_name}",destination:"Tag afkrslen til hjre mod {destination}",exit:"Vlg afkrsel {exit} til hjre",exit_destination:"Vlg afkrsel {exit} til hjre mod {destination}"}},"on ramp":{default:{default:"Tag afkrslen",name:"Tag afkrslen ad {way_name}",destination:"Tag afkrslen mod {destination}"},left:{default:"Tag afkrslen til venstre",name:"Tag afkrslen til venstre ad {way_name}",destination:"Tag afkrslen til venstre mod {destination}"},right:{default:"Tag afkrslen til hjre",name:"Tag afkrslen til hjre ad {way_name}",destination:"Tag afkrslen til hjre mod {destination}"},"sharp left":{default:"Tag afkrslen til venstre",name:"Tag afkrslen til venstre ad {way_name}",destination:"Tag afkrslen til venstre mod {destination}"},"sharp right":{default:"Tag afkrslen til hjre",name:"Tag afkrslen til hjre ad {way_name}",destination:"Tag afkrslen til hjre mod {destination}"},"slight left":{default:"Tag afkrslen til venstre",name:"Tag afkrslen til venstre ad {way_name}",destination:"Tag afkrslen til venstre mod {destination}"},"slight right":{default:"Tag afkrslen til hjre",name:"Tag afkrslen til hjre ad {way_name}",destination:"Tag afkrslen til hjre mod {destination}"}},rotary:{default:{default:{default:"Kr ind i rundkrslen",name:"Tag rundkrslen og kr fra ad {way_name}",destination:"Tag rundkrslen og kr mod {destination}"},name:{default:"Kr ind i {rotary_name}",name:"Kr ind i {rotary_name} og kr ad {way_name} ",destination:"Kr ind i {rotary_name} og kr mod {destination}"},exit:{default:"Tag rundkrslen og forlad ved {exit_number} afkrsel",name:"Tag rundkrslen og forlad ved {exit_number} afkrsel ad {way_name}",destination:"Tag rundkrslen og forlad ved {exit_number} afkrsel mod {destination}"},name_exit:{default:"Kr ind i {rotary_name} og forlad ved {exit_number} afkrsel",name:"Kr ind i {rotary_name} og forlad ved {exit_number} afkrsel ad {way_name}",destination:"Kr ind i {rotary_name} og forlad ved {exit_number} afkrsel mod {destination}"}}},roundabout:{default:{exit:{default:"Tag rundkrslen og forlad ved {exit_number} afkrsel",name:"Tag rundkrslen og forlad ved {exit_number} afkrsel ad {way_name}",destination:"Tag rundkrslen og forlad ved {exit_number} afkrsel mod {destination}"},default:{default:"Kr ind i rundkrslen",name:"Tag rundkrslen og kr fra ad {way_name}",destination:"Tag rundkrslen og kr mod {destination}"}}},"roundabout turn":{default:{default:"Foretag et {modifier}",name:"Foretag et {modifier} ad {way_name}",destination:"Foretag et {modifier} mod {destination}"},left:{default:"Drej til venstre",name:"Drej til venstre ad {way_name}",destination:"Drej til venstre mod {destination}"},right:{default:"Drej til hjre",name:"Drej til hjre ad {way_name}",destination:"Drej til hjre mod {destination}"},straight:{default:"Fortst ligeud",name:"Fortst ligeud ad {way_name}",destination:"Fortst ligeud mod {destination}"}},"exit roundabout":{default:{default:"Forlad rundkrslen",name:"Forlad rundkrslen ad {way_name}",destination:"Forlad rundkrslen mod  {destination}"}},"exit rotary":{default:{default:"Forlad rundkrslen",name:"Forlad rundkrslen ad {way_name}",destination:"Forlad rundkrslen mod {destination}"}},turn:{default:{default:"Foretag et {modifier}",name:"Foretag et {modifier} ad {way_name}",destination:"Foretag et {modifier} mod {destination}"},left:{default:"Drej til venstre",name:"Drej til venstre ad {way_name}",destination:"Drej til venstre mod {destination}"},right:{default:"Drej til hjre",name:"Drej til hjre ad {way_name}",destination:"Drej til hjre mod {destination}"},straight:{default:"Fortst ligeud",name:"Kr ligeud ad {way_name}",destination:"Kr ligeud mod {destination}"}},"use lane":{no_lanes:{default:"Fortst ligeud"},default:{default:"{lane_instruction}"}}}}},{}],24:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"erste",2:"zweite",3:"dritte",4:"vierte",5:"fnfte",6:"sechste",7:"siebente",8:"achte",9:"neunte",10:"zehnte"},direction:{north:"Norden",northeast:"Nordosten",east:"Osten",southeast:"Sdosten",south:"Sden",southwest:"Sdwesten",west:"Westen",northwest:"Nordwesten"},modifier:{left:"links",right:"rechts","sharp left":"scharf links","sharp right":"scharf rechts","slight left":"leicht links","slight right":"leicht rechts",straight:"geradeaus",uturn:"180-Wendung"},lanes:{xo:"Rechts halten",ox:"Links halten",xox:"Mittlere Spur nutzen",oxo:"Rechts oder links halten"}},modes:{ferry:{default:"Fhre nehmen",name:"Fhre nehmen {way_name}",destination:"Fhre nehmen Richtung {destination}"}},phrase:{"two linked by distance":"{instruction_one} danach in {distance} {instruction_two}","two linked":"{instruction_one} danach {instruction_two}","one in distance":"In {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"exit {exit}"},arrive:{default:{default:"Sie haben Ihr {nth} Ziel erreicht",upcoming:"Sie haben Ihr {nth} Ziel erreicht",short:"Sie haben Ihr {nth} Ziel erreicht","short-upcoming":"Sie haben Ihr {nth} Ziel erreicht",named:"Sie haben Ihr {waypoint_name}"},left:{default:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich links",upcoming:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich links",short:"Sie haben Ihr {nth} Ziel erreicht","short-upcoming":"Sie haben Ihr {nth} Ziel erreicht",named:"Sie haben Ihr {waypoint_name}, es befindet sich links"},right:{default:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich rechts",upcoming:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich rechts",short:"Sie haben Ihr {nth} Ziel erreicht","short-upcoming":"Sie haben Ihr {nth} Ziel erreicht",named:"Sie haben Ihr {waypoint_name}, es befindet sich rechts"},"sharp left":{default:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich links",upcoming:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich links",short:"Sie haben Ihr {nth} Ziel erreicht","short-upcoming":"Sie haben Ihr {nth} Ziel erreicht",named:"Sie haben Ihr {waypoint_name}, es befindet sich links"},"sharp right":{default:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich rechts",upcoming:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich rechts",short:"Sie haben Ihr {nth} Ziel erreicht","short-upcoming":"Sie haben Ihr {nth} Ziel erreicht",named:"Sie haben Ihr {waypoint_name}, es befindet sich rechts"},"slight right":{default:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich rechts",upcoming:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich rechts",short:"Sie haben Ihr {nth} Ziel erreicht","short-upcoming":"Sie haben Ihr {nth} Ziel erreicht",named:"Sie haben Ihr {waypoint_name}, es befindet sich rechts"},"slight left":{default:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich links",upcoming:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich links",short:"Sie haben Ihr {nth} Ziel erreicht","short-upcoming":"Sie haben Ihr {nth} Ziel erreicht",named:"Sie haben Ihr {waypoint_name}, es befindet sich links"},straight:{default:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich geradeaus",upcoming:"Sie haben Ihr {nth} Ziel erreicht, es befindet sich geradeaus",short:"Sie haben Ihr {nth} Ziel erreicht","short-upcoming":"Sie haben Ihr {nth} Ziel erreicht",named:"Sie haben Ihr {waypoint_name}, es befindet sich geradeaus"}},continue:{default:{default:"{modifier} abbiegen",name:"{modifier} weiterfahren auf {way_name}",destination:"{modifier} abbiegen Richtung {destination}",exit:"{modifier} abbiegen auf {way_name}"},straight:{default:"Geradeaus weiterfahren",name:"Geradeaus weiterfahren auf {way_name}",destination:"Weiterfahren in Richtung {destination}",distance:"Geradeaus weiterfahren fr {distance}",namedistance:"Geradeaus weiterfahren auf {way_name} fr {distance}"},"sharp left":{default:"Scharf links",name:"Scharf links weiterfahren auf {way_name}",destination:"Scharf links Richtung {destination}"},"sharp right":{default:"Scharf rechts",name:"Scharf rechts weiterfahren auf {way_name}",destination:"Scharf rechts Richtung {destination}"},"slight left":{default:"Leicht links",name:"Leicht links weiter auf {way_name}",destination:"Leicht links weiter Richtung {destination}"},"slight right":{default:"Leicht rechts weiter",name:"Leicht rechts weiter auf {way_name}",destination:"Leicht rechts weiter Richtung {destination}"},uturn:{default:"180-Wendung",name:"180-Wendung auf {way_name}",destination:"180-Wendung Richtung {destination}"}},depart:{default:{default:"Fahren Sie Richtung {direction}",name:"Fahren Sie Richtung {direction} auf {way_name}",namedistance:"Fahren Sie Richtung {direction} auf {way_name} fr {distance}"}},"end of road":{default:{default:"{modifier} abbiegen",name:"{modifier} abbiegen auf {way_name}",destination:"{modifier} abbiegen Richtung {destination}"},straight:{default:"Geradeaus weiterfahren",name:"Geradeaus weiterfahren auf {way_name}",destination:"Geradeaus weiterfahren Richtung {destination}"},uturn:{default:"180-Wendung am Ende der Strae",name:"180-Wendung auf {way_name} am Ende der Strae",destination:"180-Wendung Richtung {destination} am Ende der Strae"}},fork:{default:{default:"{modifier} halten an der Gabelung",name:"{modifier} halten an der Gabelung auf {way_name}",destination:"{modifier}  halten an der Gabelung Richtung {destination}"},"slight left":{default:"Links halten an der Gabelung",name:"Links halten an der Gabelung auf {way_name}",destination:"Links halten an der Gabelung Richtung {destination}"},"slight right":{default:"Rechts halten an der Gabelung",name:"Rechts halten an der Gabelung auf {way_name}",destination:"Rechts halten an der Gabelung Richtung {destination}"},"sharp left":{default:"Scharf links abbiegen an der Gabelung",name:"Scharf links auf {way_name}",destination:"Scharf links Richtung {destination}"},"sharp right":{default:"Scharf rechts abbiegen an der Gabelung",name:"Scharf rechts auf {way_name}",destination:"Scharf rechts Richtung {destination}"},uturn:{default:"180-Wendung",name:"180-Wendung auf {way_name}",destination:"180-Wendung Richtung {destination}"}},merge:{default:{default:"{modifier} auffahren",name:"{modifier} auffahren auf {way_name}",destination:"{modifier} auffahren Richtung {destination}"},straight:{default:"geradeaus auffahren",name:"geradeaus auffahren auf {way_name}",destination:"geradeaus auffahren Richtung {destination}"},"slight left":{default:"Leicht links auffahren",name:"Leicht links auffahren auf {way_name}",destination:"Leicht links auffahren Richtung {destination}"},"slight right":{default:"Leicht rechts auffahren",name:"Leicht rechts auffahren auf {way_name}",destination:"Leicht rechts auffahren Richtung {destination}"},"sharp left":{default:"Scharf links auffahren",name:"Scharf links auffahren auf {way_name}",destination:"Scharf links auffahren Richtung {destination}"},"sharp right":{default:"Scharf rechts auffahren",name:"Scharf rechts auffahren auf {way_name}",destination:"Scharf rechts auffahren Richtung {destination}"},uturn:{default:"180-Wendung",name:"180-Wendung auf {way_name}",destination:"180-Wendung Richtung {destination}"}},"new name":{default:{default:"{modifier} weiterfahren",name:"{modifier} weiterfahren auf {way_name}",destination:"{modifier} weiterfahren Richtung {destination}"},straight:{default:"Geradeaus weiterfahren",name:"Weiterfahren auf {way_name}",destination:"Weiterfahren in Richtung {destination}"},"sharp left":{default:"Scharf links",name:"Scharf links auf {way_name}",destination:"Scharf links Richtung {destination}"},"sharp right":{default:"Scharf rechts",name:"Scharf rechts auf {way_name}",destination:"Scharf rechts Richtung {destination}"},"slight left":{default:"Leicht links weiter",name:"Leicht links weiter auf {way_name}",destination:"Leicht links weiter Richtung {destination}"},"slight right":{default:"Leicht rechts weiter",name:"Leicht rechts weiter auf {way_name}",destination:"Leicht rechts weiter Richtung {destination}"},uturn:{default:"180-Wendung",name:"180-Wendung auf {way_name}",destination:"180-Wendung Richtung {destination}"}},notification:{default:{default:"{modifier} weiterfahren",name:"{modifier} weiterfahren auf {way_name}",destination:"{modifier} weiterfahren Richtung {destination}"},uturn:{default:"180-Wendung",name:"180-Wendung auf {way_name}",destination:"180-Wendung Richtung {destination}"}},"off ramp":{default:{default:"Ausfahrt nehmen",name:"Ausfahrt nehmen auf {way_name}",destination:"Ausfahrt nehmen Richtung {destination}",exit:"Ausfahrt {exit} nehmen",exit_destination:"Ausfahrt {exit} nehmen Richtung {destination}"},left:{default:"Ausfahrt links nehmen",name:"Ausfahrt links nehmen auf {way_name}",destination:"Ausfahrt links nehmen Richtung {destination}",exit:"Ausfahrt {exit} links nehmen",exit_destination:"Ausfahrt {exit} links nehmen Richtung {destination}"},right:{default:"Ausfahrt rechts nehmen",name:"Ausfahrt rechts nehmen Richtung {way_name}",destination:"Ausfahrt rechts nehmen Richtung {destination}",exit:"Ausfahrt {exit} rechts nehmen",exit_destination:"Ausfahrt {exit} nehmen Richtung {destination}"},"sharp left":{default:"Ausfahrt links nehmen",name:"Ausfahrt links Seite nehmen auf {way_name}",destination:"Ausfahrt links nehmen Richtung {destination}",exit:"Ausfahrt {exit} links nehmen",exit_destination:"Ausfahrt{exit} links nehmen Richtung {destination}"},"sharp right":{default:"Ausfahrt rechts nehmen",name:"Ausfahrt rechts nehmen auf {way_name}",destination:"Ausfahrt rechts nehmen Richtung {destination}",exit:"Ausfahrt {exit} rechts nehmen",exit_destination:"Ausfahrt {exit} nehmen Richtung {destination}"},"slight left":{default:"Ausfahrt links nehmen",name:"Ausfahrt links nehmen auf {way_name}",destination:"Ausfahrt links nehmen Richtung {destination}",exit:"Ausfahrt {exit} nehmen",exit_destination:"Ausfahrt {exit} links nehmen Richtung {destination}"},"slight right":{default:"Ausfahrt rechts nehmen",name:"Ausfahrt rechts nehmen auf {way_name}",destination:"Ausfahrt rechts nehmen Richtung {destination}",exit:"Ausfahrt {exit} rechts nehmen",exit_destination:"Ausfahrt {exit} nehmen Richtung {destination}"}},"on ramp":{default:{default:"Auffahrt nehmen",name:"Auffahrt nehmen auf {way_name}",destination:"Auffahrt nehmen Richtung {destination}"},left:{default:"Auffahrt links nehmen",name:"Auffahrt links nehmen auf {way_name}",destination:"Auffahrt links nehmen Richtung {destination}"},right:{default:"Auffahrt rechts nehmen",name:"Auffahrt rechts nehmen auf {way_name}",destination:"Auffahrt rechts nehmen Richtung {destination}"},"sharp left":{default:"Auffahrt links nehmen",name:"Auffahrt links nehmen auf {way_name}",destination:"Auffahrt links nehmen Richtung {destination}"},"sharp right":{default:"Auffahrt rechts nehmen",name:"Auffahrt rechts nehmen auf {way_name}",destination:"Auffahrt rechts nehmen Richtung {destination}"},"slight left":{default:"Auffahrt links Seite nehmen",name:"Auffahrt links nehmen auf {way_name}",destination:"Auffahrt links nehmen Richtung {destination}"},"slight right":{default:"Auffahrt rechts nehmen",name:"Auffahrt rechts nehmen auf {way_name}",destination:"Auffahrt rechts nehmen Richtung {destination}"}},rotary:{default:{default:{default:"In den Kreisverkehr fahren",name:"Im Kreisverkehr die Ausfahrt auf {way_name} nehmen",destination:"Im Kreisverkehr die Ausfahrt Richtung {destination} nehmen"},name:{default:"In {rotary_name} fahren",name:"In {rotary_name} die Ausfahrt auf {way_name} nehmen",destination:"In {rotary_name} die Ausfahrt Richtung {destination} nehmen"},exit:{default:"Im Kreisverkehr die {exit_number} Ausfahrt nehmen",name:"Im Kreisverkehr die {exit_number} Ausfahrt nehmen auf {way_name}",destination:"Im Kreisverkehr die {exit_number} Ausfahrt nehmen Richtung {destination}"},name_exit:{default:"In den Kreisverkehr fahren und {exit_number} Ausfahrt nehmen",name:"In den Kreisverkehr fahren und {exit_number} Ausfahrt nehmen auf {way_name}",destination:"In den Kreisverkehr fahren und {exit_number} Ausfahrt nehmen Richtung {destination}"}}},roundabout:{default:{exit:{default:"Im Kreisverkehr die {exit_number} Ausfahrt nehmen",name:"Im Kreisverkehr die {exit_number} Ausfahrt nehmen auf {way_name}",destination:"Im Kreisverkehr die {exit_number} Ausfahrt nehmen Richtung {destination}"},default:{default:"In den Kreisverkehr fahren",name:"Im Kreisverkehr die Ausfahrt auf {way_name} nehmen",destination:"Im Kreisverkehr die Ausfahrt Richtung {destination} nehmen"}}},"roundabout turn":{default:{default:"{modifier} abbiegen",name:"{modifier} abbiegen auf {way_name}",destination:"{modifier} abbiegen Richtung {destination}"},left:{default:"Links abbiegen",name:"Links abbiegen auf {way_name}",destination:"Links abbiegen Richtung {destination}"},right:{default:"Rechts abbiegen",name:"Rechts abbiegen auf {way_name}",destination:"Rechts abbiegen Richtung {destination}"},straight:{default:"Geradeaus weiterfahren",name:"Geradeaus weiterfahren auf {way_name}",destination:"Geradeaus weiterfahren Richtung {destination}"}},"exit roundabout":{default:{default:"{modifier} abbiegen",name:"{modifier} abbiegen auf {way_name}",destination:"{modifier} abbiegen Richtung {destination}"},left:{default:"Links abbiegen",name:"Links abbiegen auf {way_name}",destination:"Links abbiegen Richtung {destination}"},right:{default:"Rechts abbiegen",name:"Rechts abbiegen auf {way_name}",destination:"Rechts abbiegen Richtung {destination}"},straight:{default:"Geradeaus weiterfahren",name:"Geradeaus weiterfahren auf {way_name}",destination:"Geradeaus weiterfahren Richtung {destination}"}},"exit rotary":{default:{default:"{modifier} abbiegen",name:"{modifier} abbiegen auf {way_name}",destination:"{modifier} abbiegen Richtung {destination}"},left:{default:"Links abbiegen",name:"Links abbiegen auf {way_name}",destination:"Links abbiegen Richtung {destination}"},right:{default:"Rechts abbiegen",name:"Rechts abbiegen auf {way_name}",destination:"Rechts abbiegen Richtung {destination}"},straight:{default:"Geradeaus weiterfahren",name:"Geradeaus weiterfahren auf {way_name}",destination:"Geradeaus weiterfahren Richtung {destination}"}},turn:{default:{default:"{modifier} abbiegen",name:"{modifier} abbiegen auf {way_name}",destination:"{modifier} abbiegen Richtung {destination}"},left:{default:"Links abbiegen",name:"Links abbiegen auf {way_name}",destination:"Links abbiegen Richtung {destination}"},right:{default:"Rechts abbiegen",name:"Rechts abbiegen auf {way_name}",destination:"Rechts abbiegen Richtung {destination}"},straight:{default:"Geradeaus weiterfahren",name:"Geradeaus weiterfahren auf {way_name}",destination:"Geradeaus weiterfahren Richtung {destination}"}},"use lane":{no_lanes:{default:"Geradeaus weiterfahren"},default:{default:"{lane_instruction}"}}}}},{}],25:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1st",2:"2nd",3:"3rd",4:"4th",5:"5th",6:"6th",7:"7th",8:"8th",9:"9th",10:"10th"},direction:{north:"north",northeast:"northeast",east:"east",southeast:"southeast",south:"south",southwest:"southwest",west:"west",northwest:"northwest"},modifier:{left:"left",right:"right","sharp left":"sharp left","sharp right":"sharp right","slight left":"slight left","slight right":"slight right",straight:"straight",uturn:"U-turn"},lanes:{xo:"Keep right",ox:"Keep left",xox:"Keep in the middle",oxo:"Keep left or right"}},modes:{ferry:{default:"Take the ferry",name:"Take the ferry {way_name}",destination:"Take the ferry towards {destination}"}},phrase:{"two linked by distance":"{instruction_one}, then, in {distance}, {instruction_two}","two linked":"{instruction_one}, then {instruction_two}","one in distance":"In {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"exit {exit}"},arrive:{default:{default:"You have arrived at your {nth} destination",upcoming:"You will arrive at your {nth} destination",short:"You have arrived","short-upcoming":"You will arrive",named:"You have arrived at {waypoint_name}"},left:{default:"You have arrived at your {nth} destination, on the left",upcoming:"You will arrive at your {nth} destination, on the left",short:"You have arrived","short-upcoming":"You will arrive",named:"You have arrived at {waypoint_name}, on the left"},right:{default:"You have arrived at your {nth} destination, on the right",upcoming:"You will arrive at your {nth} destination, on the right",short:"You have arrived","short-upcoming":"You will arrive",named:"You have arrived at {waypoint_name}, on the right"},"sharp left":{default:"You have arrived at your {nth} destination, on the left",upcoming:"You will arrive at your {nth} destination, on the left",short:"You have arrived","short-upcoming":"You will arrive",named:"You have arrived at {waypoint_name}, on the left"},"sharp right":{default:"You have arrived at your {nth} destination, on the right",upcoming:"You will arrive at your {nth} destination, on the right",short:"You have arrived","short-upcoming":"You will arrive",named:"You have arrived at {waypoint_name}, on the right"},"slight right":{default:"You have arrived at your {nth} destination, on the right",upcoming:"You will arrive at your {nth} destination, on the right",short:"You have arrived","short-upcoming":"You will arrive",named:"You have arrived at {waypoint_name}, on the right"},"slight left":{default:"You have arrived at your {nth} destination, on the left",upcoming:"You will arrive at your {nth} destination, on the left",short:"You have arrived","short-upcoming":"You will arrive",named:"You have arrived at {waypoint_name}, on the left"},straight:{default:"You have arrived at your {nth} destination, straight ahead",upcoming:"You will arrive at your {nth} destination, straight ahead",short:"You have arrived","short-upcoming":"You will arrive",named:"You have arrived at {waypoint_name}, straight ahead"}},continue:{default:{default:"Turn {modifier}",name:"Turn {modifier} to stay on {way_name}",destination:"Turn {modifier} towards {destination}",exit:"Turn {modifier} onto {way_name}"},straight:{default:"Continue straight",name:"Continue straight to stay on {way_name}",destination:"Continue towards {destination}",distance:"Continue straight for {distance}",namedistance:"Continue on {way_name} for {distance}"},"sharp left":{default:"Make a sharp left",name:"Make a sharp left to stay on {way_name}",destination:"Make a sharp left towards {destination}"},"sharp right":{default:"Make a sharp right",name:"Make a sharp right to stay on {way_name}",destination:"Make a sharp right towards {destination}"},"slight left":{default:"Make a slight left",name:"Make a slight left to stay on {way_name}",destination:"Make a slight left towards {destination}"},"slight right":{default:"Make a slight right",name:"Make a slight right to stay on {way_name}",destination:"Make a slight right towards {destination}"},uturn:{default:"Make a U-turn",name:"Make a U-turn and continue on {way_name}",destination:"Make a U-turn towards {destination}"}},depart:{default:{default:"Head {direction}",name:"Head {direction} on {way_name}",namedistance:"Head {direction} on {way_name} for {distance}"}},"end of road":{default:{default:"Turn {modifier}",name:"Turn {modifier} onto {way_name}",destination:"Turn {modifier} towards {destination}"},straight:{default:"Continue straight",name:"Continue straight onto {way_name}",destination:"Continue straight towards {destination}"},uturn:{default:"Make a U-turn at the end of the road",name:"Make a U-turn onto {way_name} at the end of the road",destination:"Make a U-turn towards {destination} at the end of the road"}},fork:{default:{default:"Keep {modifier} at the fork",name:"Keep {modifier} onto {way_name}",destination:"Keep {modifier} towards {destination}"},"slight left":{default:"Keep left at the fork",name:"Keep left onto {way_name}",destination:"Keep left towards {destination}"},"slight right":{default:"Keep right at the fork",name:"Keep right onto {way_name}",destination:"Keep right towards {destination}"},"sharp left":{default:"Take a sharp left at the fork",name:"Take a sharp left onto {way_name}",destination:"Take a sharp left towards {destination}"},"sharp right":{default:"Take a sharp right at the fork",name:"Take a sharp right onto {way_name}",destination:"Take a sharp right towards {destination}"},uturn:{default:"Make a U-turn",name:"Make a U-turn onto {way_name}",destination:"Make a U-turn towards {destination}"}},merge:{default:{default:"Merge {modifier}",name:"Merge {modifier} onto {way_name}",destination:"Merge {modifier} towards {destination}"},straight:{default:"Merge",name:"Merge onto {way_name}",destination:"Merge towards {destination}"},"slight left":{default:"Merge left",name:"Merge left onto {way_name}",destination:"Merge left towards {destination}"},"slight right":{default:"Merge right",name:"Merge right onto {way_name}",destination:"Merge right towards {destination}"},"sharp left":{default:"Merge left",name:"Merge left onto {way_name}",destination:"Merge left towards {destination}"},"sharp right":{default:"Merge right",name:"Merge right onto {way_name}",destination:"Merge right towards {destination}"},uturn:{default:"Make a U-turn",name:"Make a U-turn onto {way_name}",destination:"Make a U-turn towards {destination}"}},"new name":{default:{default:"Continue {modifier}",name:"Continue {modifier} onto {way_name}",destination:"Continue {modifier} towards {destination}"},straight:{default:"Continue straight",name:"Continue onto {way_name}",destination:"Continue towards {destination}"},"sharp left":{default:"Take a sharp left",name:"Take a sharp left onto {way_name}",destination:"Take a sharp left towards {destination}"},"sharp right":{default:"Take a sharp right",name:"Take a sharp right onto {way_name}",destination:"Take a sharp right towards {destination}"},"slight left":{default:"Continue slightly left",name:"Continue slightly left onto {way_name}",destination:"Continue slightly left towards {destination}"},"slight right":{default:"Continue slightly right",name:"Continue slightly right onto {way_name}",destination:"Continue slightly right towards {destination}"},uturn:{default:"Make a U-turn",name:"Make a U-turn onto {way_name}",destination:"Make a U-turn towards {destination}"}},notification:{default:{default:"Continue {modifier}",name:"Continue {modifier} onto {way_name}",destination:"Continue {modifier} towards {destination}"},uturn:{default:"Make a U-turn",name:"Make a U-turn onto {way_name}",destination:"Make a U-turn towards {destination}"}},"off ramp":{default:{default:"Take the ramp",name:"Take the ramp onto {way_name}",destination:"Take the ramp towards {destination}",exit:"Take exit {exit}",exit_destination:"Take exit {exit} towards {destination}"},left:{default:"Take the ramp on the left",name:"Take the ramp on the left onto {way_name}",destination:"Take the ramp on the left towards {destination}",exit:"Take exit {exit} on the left",exit_destination:"Take exit {exit} on the left towards {destination}"},right:{default:"Take the ramp on the right",name:"Take the ramp on the right onto {way_name}",destination:"Take the ramp on the right towards {destination}",exit:"Take exit {exit} on the right",exit_destination:"Take exit {exit} on the right towards {destination}"},"sharp left":{default:"Take the ramp on the left",name:"Take the ramp on the left onto {way_name}",destination:"Take the ramp on the left towards {destination}",exit:"Take exit {exit} on the left",exit_destination:"Take exit {exit} on the left towards {destination}"},"sharp right":{default:"Take the ramp on the right",name:"Take the ramp on the right onto {way_name}",destination:"Take the ramp on the right towards {destination}",exit:"Take exit {exit} on the right",exit_destination:"Take exit {exit} on the right towards {destination}"},"slight left":{default:"Take the ramp on the left",name:"Take the ramp on the left onto {way_name}",destination:"Take the ramp on the left towards {destination}",exit:"Take exit {exit} on the left",exit_destination:"Take exit {exit} on the left towards {destination}"},"slight right":{default:"Take the ramp on the right",name:"Take the ramp on the right onto {way_name}",destination:"Take the ramp on the right towards {destination}",exit:"Take exit {exit} on the right",exit_destination:"Take exit {exit} on the right towards {destination}"}},"on ramp":{default:{default:"Take the ramp",name:"Take the ramp onto {way_name}",destination:"Take the ramp towards {destination}"},left:{default:"Take the ramp on the left",name:"Take the ramp on the left onto {way_name}",destination:"Take the ramp on the left towards {destination}"},right:{default:"Take the ramp on the right",name:"Take the ramp on the right onto {way_name}",destination:"Take the ramp on the right towards {destination}"},"sharp left":{default:"Take the ramp on the left",name:"Take the ramp on the left onto {way_name}",destination:"Take the ramp on the left towards {destination}"},"sharp right":{default:"Take the ramp on the right",name:"Take the ramp on the right onto {way_name}",destination:"Take the ramp on the right towards {destination}"},"slight left":{default:"Take the ramp on the left",name:"Take the ramp on the left onto {way_name}",destination:"Take the ramp on the left towards {destination}"},"slight right":{default:"Take the ramp on the right",name:"Take the ramp on the right onto {way_name}",destination:"Take the ramp on the right towards {destination}"}},rotary:{default:{default:{default:"Enter the traffic circle",name:"Enter the traffic circle and exit onto {way_name}",destination:"Enter the traffic circle and exit towards {destination}"},name:{default:"Enter {rotary_name}",name:"Enter {rotary_name} and exit onto {way_name}",destination:"Enter {rotary_name} and exit towards {destination}"},exit:{default:"Enter the traffic circle and take the {exit_number} exit",name:"Enter the traffic circle and take the {exit_number} exit onto {way_name}",destination:"Enter the traffic circle and take the {exit_number} exit towards {destination}"},name_exit:{default:"Enter {rotary_name} and take the {exit_number} exit",name:"Enter {rotary_name} and take the {exit_number} exit onto {way_name}",destination:"Enter {rotary_name} and take the {exit_number} exit towards {destination}"}}},roundabout:{default:{exit:{default:"Enter the traffic circle and take the {exit_number} exit",name:"Enter the traffic circle and take the {exit_number} exit onto {way_name}",destination:"Enter the traffic circle and take the {exit_number} exit towards {destination}"},default:{default:"Enter the traffic circle",name:"Enter the traffic circle and exit onto {way_name}",destination:"Enter the traffic circle and exit towards {destination}"}}},"roundabout turn":{default:{default:"Make a {modifier}",name:"Make a {modifier} onto {way_name}",destination:"Make a {modifier} towards {destination}"},left:{default:"Turn left",name:"Turn left onto {way_name}",destination:"Turn left towards {destination}"},right:{default:"Turn right",name:"Turn right onto {way_name}",destination:"Turn right towards {destination}"},straight:{default:"Continue straight",name:"Continue straight onto {way_name}",destination:"Continue straight towards {destination}"}},"exit roundabout":{default:{default:"Exit the traffic circle",name:"Exit the traffic circle onto {way_name}",destination:"Exit the traffic circle towards {destination}"}},"exit rotary":{default:{default:"Exit the traffic circle",name:"Exit the traffic circle onto {way_name}",destination:"Exit the traffic circle towards {destination}"}},turn:{default:{default:"Make a {modifier}",name:"Make a {modifier} onto {way_name}",destination:"Make a {modifier} towards {destination}"},left:{default:"Turn left",name:"Turn left onto {way_name}",destination:"Turn left towards {destination}"},right:{default:"Turn right",name:"Turn right onto {way_name}",destination:"Turn right towards {destination}"},straight:{default:"Go straight",name:"Go straight onto {way_name}",destination:"Go straight towards {destination}"}},"use lane":{no_lanes:{default:"Continue straight"},default:{default:"{lane_instruction}"}}}}},{}],26:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1.",2:"2.",3:"3.",4:"4.",5:"5.",6:"6.",7:"7.",8:"8.",9:"9.",10:"10."},direction:{north:"norden",northeast:"nord-orienten",east:"orienten",southeast:"sud-orienten",south:"suden",southwest:"sud-okcidenten",west:"okcidenten",northwest:"nord-okcidenten"},modifier:{left:"maldekstren",right:"dekstren","sharp left":"maldekstregen","sharp right":"dekstregen","slight left":"maldekstreten","slight right":"dekstreten",straight:"rekten",uturn:"turniu malantaen"},lanes:{xo:"Veturu dekstre",ox:"Veturu maldekstre",xox:"Veturu meze",oxo:"Veturu dekstre a maldekstre"}},modes:{ferry:{default:"Enpramiu",name:"Enpramiu {way_name}",destination:"Enpramiu direkte al {destination}"}},phrase:{"two linked by distance":"{instruction_one} kaj post {distance} {instruction_two}","two linked":"{instruction_one} kaj sekve {instruction_two}","one in distance":"Post {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"elveturejo {exit}"},arrive:{default:{default:"Vi atingis vian {nth} celon",upcoming:"Vi atingos vian {nth} celon",short:"Vi atingis","short-upcoming":"Vi atingos",named:"Vi atingis {waypoint_name}"},left:{default:"Vi atingis vian {nth} celon e maldekstre",upcoming:"Vi atingos vian {nth} celon e maldekstre",short:"Vi atingis","short-upcoming":"Vi atingos",named:"Vi atingis {waypoint_name}, e maldekstre"},right:{default:"Vi atingis vian {nth} celon e dekstre",upcoming:"Vi atingos vian {nth} celon e dekstre",short:"Vi atingis","short-upcoming":"Vi atingos",named:"Vi atingis {waypoint_name}, e dekstre"},"sharp left":{default:"Vi atingis vian {nth} celon e maldekstre",upcoming:"Vi atingos vian {nth} celon e maldekstre",short:"Vi atingis","short-upcoming":"Vi atingos",named:"Vi atingis {waypoint_name}, e maldekstre"},"sharp right":{default:"Vi atingis vian {nth} celon e dekstre",upcoming:"Vi atingos vian {nth} celon e dekstre",short:"Vi atingis","short-upcoming":"Vi atingos",named:"Vi atingis {waypoint_name}, e dekstre"},"slight right":{default:"Vi atingis vian {nth} celon e dekstre",upcoming:"Vi atingos vian {nth} celon e dekstre",short:"Vi atingis","short-upcoming":"Vi atingos",named:"Vi atingis {waypoint_name}, e dekstre"},"slight left":{default:"Vi atingis vian {nth} celon e maldekstre",upcoming:"Vi atingos vian {nth} celon e maldekstre",short:"Vi atingis","short-upcoming":"Vi atingos",named:"Vi atingis {waypoint_name}, e maldekstre"},straight:{default:"Vi atingis vian {nth} celon",upcoming:"Vi atingos vian {nth} celon rekte",short:"Vi atingis","short-upcoming":"Vi atingos",named:"Vi atingis {waypoint_name} antae"}},continue:{default:{default:"Veturu {modifier}",name:"Veturu {modifier} al {way_name}",destination:"Veturu {modifier} direkte al {destination}",exit:"Veturu {modifier} direkte al {way_name}"},straight:{default:"Veturu rekten",name:"Veturu rekten al {way_name}",destination:"Veturu rekten direkte al {destination}",distance:"Veturu rekten dum {distance}",namedistance:"Veturu rekten al {way_name} dum {distance}"},"sharp left":{default:"Turniu ege maldekstren",name:"Turniu ege maldekstren al {way_name}",destination:"Turniu ege maldekstren direkte al {destination}"},"sharp right":{default:"Turniu ege dekstren",name:"Turniu ege dekstren al {way_name}",destination:"Turniu ege dekstren direkte al {destination}"},"slight left":{default:"Turniu ete maldekstren",name:"Turniu ete maldekstren al {way_name}",destination:"Turniu ete maldekstren direkte al {destination}"},"slight right":{default:"Turniu ete dekstren",name:"Turniu ete dekstren al {way_name}",destination:"Turniu ete dekstren direkte al {destination}"},uturn:{default:"Turniu malantaen",name:"Turniu malantaen al {way_name}",destination:"Turniu malantaen direkte al {destination}"}},depart:{default:{default:"Direktiu {direction}",name:"Direktiu {direction} al {way_name}",namedistance:"Direktiu {direction} al {way_name} tra {distance}"}},"end of road":{default:{default:"Veturu {modifier}",name:"Veturu {modifier} direkte al {way_name}",destination:"Veturu {modifier} direkte al {destination}"},straight:{default:"Veturu rekten",name:"Veturu rekten al {way_name}",destination:"Veturu rekten direkte al {destination}"},uturn:{default:"Turniu malantaen e fino de la vojo",name:"Turniu malantaen al {way_name} e fino de la vojo",destination:"Turniu malantaen direkte al {destination} e fino de la vojo"}},fork:{default:{default:"Daru {modifier} e la vojforko",name:"Pluu {modifier} al {way_name}",destination:"Pluu {modifier} direkte al {destination}"},"slight left":{default:"Maldekstren e la vojforko",name:"Pluu maldekstren al {way_name}",destination:"Pluu maldekstren direkte al {destination}"},"slight right":{default:"Dekstren e la vojforko",name:"Pluu dekstren al {way_name}",destination:"Pluu dekstren direkte al {destination}"},"sharp left":{default:"Ege maldekstren e la vojforko",name:"Turniu ege maldekstren al {way_name}",destination:"Turniu ege maldekstren direkte al {destination}"},"sharp right":{default:"Ege dekstren e la vojforko",name:"Turniu ege dekstren al {way_name}",destination:"Turniu ege dekstren direkte al {destination}"},uturn:{default:"Turniu malantaen",name:"Turniu malantaen al {way_name}",destination:"Turniu malantaen direkte al {destination}"}},merge:{default:{default:"Enveturu {modifier}",name:"Enveturu {modifier} al {way_name}",destination:"Enveturu {modifier} direkte al {destination}"},straight:{default:"Enveturu",name:"Enveturu al {way_name}",destination:"Enveturu direkte al {destination}"},"slight left":{default:"Enveturu de maldekstre",name:"Enveturu de maldekstre al {way_name}",destination:"Enveturu de maldekstre direkte al {destination}"},"slight right":{default:"Enveturu de dekstre",name:"Enveturu de dekstre al {way_name}",destination:"Enveturu de dekstre direkte al {destination}"},"sharp left":{default:"Enveturu de maldekstre",name:"Enveture de maldekstre al {way_name}",destination:"Enveturu de maldekstre direkte al {destination}"},"sharp right":{default:"Enveturu de dekstre",name:"Enveturu de dekstre al {way_name}",destination:"Enveturu de dekstre direkte al {destination}"},uturn:{default:"Turniu malantaen",name:"Turniu malantaen al {way_name}",destination:"Turniu malantaen direkte al {destination}"}},"new name":{default:{default:"Pluu {modifier}",name:"Pluu {modifier} al {way_name}",destination:"Pluu {modifier} direkte al {destination}"},straight:{default:"Veturu rekten",name:"Veturu rekten al {way_name}",destination:"Veturu rekten direkte al {destination}"},"sharp left":{default:"Turniu ege maldekstren",name:"Turniu ege maldekstren al {way_name}",destination:"Turniu ege maldekstren direkte al {destination}"},"sharp right":{default:"Turniu ege dekstren",name:"Turniu ege dekstren al {way_name}",destination:"Turniu ege dekstren direkte al {destination}"},"slight left":{default:"Pluu ete maldekstren",name:"Pluu ete maldekstren al {way_name}",destination:"Pluu ete maldekstren direkte al {destination}"},"slight right":{default:"Pluu ete dekstren",name:"Pluu ete dekstren al {way_name}",destination:"Pluu ete dekstren direkte al {destination}"},uturn:{default:"Turniu malantaen",name:"Turniu malantaen al {way_name}",destination:"Turniu malantaen direkte al {destination}"}},notification:{default:{default:"Pluu {modifier}",name:"Pluu {modifier} al {way_name}",destination:"Pluu {modifier} direkte al {destination}"},uturn:{default:"Turniu malantaen",name:"Turniu malantaen al {way_name}",destination:"Turniu malantaen direkte al {destination}"}},"off ramp":{default:{default:"Direktiu al enveturejo",name:"Direktiu al enveturejo al {way_name}",destination:"Direktiu al enveturejo direkte al {destination}",exit:"Direktiu al elveturejo {exit}",exit_destination:"Direktiu al elveturejo {exit} direkte al {destination}"},left:{default:"Direktiu al enveturejo e maldekstre",name:"Direktiu al enveturejo e maldekstre al {way_name}",destination:"Direktiu al enveturejo e maldekstre al {destination}",exit:"Direktiu al elveturejo {exit} e maldekstre",exit_destination:"Direktiu al elveturejo {exit} e maldekstre direkte al {destination}"},right:{default:"Direktiu al enveturejo e dekstre",name:"Direktiu al enveturejo e dekstre al {way_name}",destination:"Direktiu al enveturejo e dekstre al {destination}",exit:"Direktiu al {exit} elveturejo e ldekstre",exit_destination:"Direktiu al elveturejo {exit} e dekstre direkte al {destination}"},"sharp left":{default:"Direktiu al enveturejo e maldekstre",name:"Direktiu al enveturejo e maldekstre al {way_name}",destination:"Direktiu al enveturejo e maldekstre al {destination}",exit:"Direktiu al {exit} elveturejo e maldekstre",exit_destination:"Direktiu al elveturejo {exit} e maldekstre direkte al {destination}"},"sharp right":{default:"Direktiu al enveturejo e dekstre",name:"Direktiu al enveturejo e dekstre al {way_name}",destination:"Direktiu al enveturejo e dekstre al {destination}",exit:"Direktiu al elveturejo {exit} e dekstre",exit_destination:"Direktiu al elveturejo {exit} e dekstre direkte al {destination}"},"slight left":{default:"Direktiu al enveturejo e maldekstre",name:"Direktiu al enveturejo e maldekstre al {way_name}",destination:"Direktiu al enveturejo e maldekstre al {destination}",exit:"Direktiu al {exit} elveturejo e maldekstre",exit_destination:"Direktiu al elveturejo {exit} e maldekstre direkte al {destination}"},"slight right":{default:"Direktiu al enveturejo e dekstre",name:"Direktiu al enveturejo e dekstre al {way_name}",destination:"Direktiu al enveturejo e dekstre al {destination}",exit:"Direktiu al {exit} elveturejo e ldekstre",exit_destination:"Direktiu al elveturejo {exit} e dekstre direkte al {destination}"}},"on ramp":{default:{default:"Direktiu al enveturejo",name:"Direktiu al enveturejo al {way_name}",destination:"Direktiu al enveturejo direkte al {destination}"},left:{default:"Direktiu al enveturejo e maldekstre",name:"Direktiu al enveturejo e maldekstre al {way_name}",destination:"Direktiu al enveturejo e maldekstre al {destination}"},right:{default:"Direktiu al enveturejo e dekstre",name:"Direktiu al enveturejo e dekstre al {way_name}",destination:"Direktiu al enveturejo e dekstre al {destination}"},"sharp left":{default:"Direktiu al enveturejo e maldekstre",name:"Direktiu al enveturejo e maldekstre al {way_name}",destination:"Direktiu al enveturejo e maldekstre al {destination}"},"sharp right":{default:"Direktiu al enveturejo e dekstre",name:"Direktiu al enveturejo e dekstre al {way_name}",destination:"Direktiu al enveturejo e dekstre al {destination}"},"slight left":{default:"Direktiu al enveturejo e maldekstre",name:"Direktiu al enveturejo e maldekstre al {way_name}",destination:"Direktiu al enveturejo e maldekstre al {destination}"},"slight right":{default:"Direktiu al enveturejo e dekstre",name:"Direktiu al enveturejo e dekstre al {way_name}",destination:"Direktiu al enveturejo e dekstre al {destination}"}},rotary:{default:{default:{default:"Enveturu trafikcirklegon",name:"Enveturu trafikcirklegon kaj elveturu al {way_name}",destination:"Enveturu trafikcirklegon kaj elveturu direkte al {destination}"},name:{default:"Enveturu {rotary_name}",name:"Enveturu {rotary_name} kaj elveturu al {way_name}",destination:"Enveturu {rotary_name} kaj elveturu direkte al {destination}"},exit:{default:"Enveturu trafikcirklegon kaj sekve al {exit_number} elveturejo",name:"Enveturu trafikcirklegon kaj sekve al {exit_number} elveturejo al {way_name}",destination:"Enveturu trafikcirklegon kaj sekve al {exit_number} elveturejo direkte al {destination}"},name_exit:{default:"Enveturu {rotary_name} kaj sekve al {exit_number} elveturejo",name:"Enveturu {rotary_name} kaj sekve al {exit_number} elveturejo al {way_name}",destination:"Enveturu {rotary_name} kaj sekve al {exit_number} elveturejo direkte al {destination}"}}},roundabout:{default:{exit:{default:"Enveturu trafikcirklegon kaj sekve al {exit_number} elveturejo",name:"Enveturu trafikcirklegon kaj sekve al {exit_number} elveturejo al {way_name}",destination:"Enveturu trafikcirklegon kaj sekve al {exit_number} elveturejo direkte al {destination}"},default:{default:"Enveturu trafikcirklegon",name:"Enveturu trafikcirklegon kaj elveturu al {way_name}",destination:"Enveturu trafikcirklegon kaj elveturu direkte al {destination}"}}},"roundabout turn":{default:{default:"Veturu {modifier}",name:"Veturu {modifier} al {way_name}",destination:"Veturu {modifier} direkte al {destination}"},left:{default:"Turniu maldekstren",name:"Turniu maldekstren al {way_name}",destination:"Turniu maldekstren direkte al {destination}"},right:{default:"Turniu dekstren",name:"Turniu dekstren al {way_name}",destination:"Turniu dekstren direkte al {destination}"},straight:{default:"Pluu rekten",name:"Veturu rekten al {way_name}",destination:"Veturu rekten direkte al {destination}"}},"exit roundabout":{default:{default:"Elveturu trafikcirklegon",name:"Elveturu trafikcirklegon al {way_name}",destination:"Elveturu trafikcirklegon direkte al {destination}"}},"exit rotary":{default:{default:"Eliru trafikcirklegon",name:"Elveturu trafikcirklegon al {way_name}",destination:"Elveturu trafikcirklegon direkte al {destination}"}},turn:{default:{default:"Veturu {modifier}",name:"Veturu {modifier} al {way_name}",destination:"Veturu {modifier} direkte al {destination}"},left:{default:"Turniu maldekstren",name:"Turniu maldekstren al {way_name}",destination:"Turniu maldekstren direkte al {destination}"},right:{default:"Turniu dekstren",name:"Turniu dekstren al {way_name}",destination:"Turniu dekstren direkte al {destination}"},straight:{default:"Veturu rekten",name:"Veturu rekten al {way_name}",destination:"Veturu rekten direkte al {destination}"}},"use lane":{no_lanes:{default:"Pluu rekten"},default:{default:"{lane_instruction}"}}}}},{}],27:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"},direction:{north:"norte",northeast:"noreste",east:"este",southeast:"sureste",south:"sur",southwest:"suroeste",west:"oeste",northwest:"noroeste"},modifier:{left:"a la izquierda",right:"a la derecha","sharp left":"cerrada a la izquierda","sharp right":"cerrada a la derecha","slight left":"ligeramente a la izquierda","slight right":"ligeramente a la derecha",straight:"recto",uturn:"cambio de sentido"},lanes:{xo:"Mantente a la derecha",ox:"Mantente a la izquierda",xox:"Mantente en el medio",oxo:"Mantente a la izquierda o a la derecha"}},modes:{ferry:{default:"Coge el ferry",name:"Coge el ferry {way_name}",destination:"Coge el ferry hacia {destination}"}},phrase:{"two linked by distance":"{instruction_one} y luego en {distance}, {instruction_two}","two linked":"{instruction_one} y luego {instruction_two}","one in distance":"A {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"salida {exit}"},arrive:{default:{default:"Has llegado a tu {nth} destino",upcoming:"Vas a llegar a tu {nth} destino",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}"},left:{default:"Has llegado a tu {nth} destino, a la izquierda",upcoming:"Vas a llegar a tu {nth} destino, a la izquierda",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la izquierda"},right:{default:"Has llegado a tu {nth} destino, a la derecha",upcoming:"Vas a llegar a tu {nth} destino, a la derecha",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la derecha"},"sharp left":{default:"Has llegado a tu {nth} destino, a la izquierda",upcoming:"Vas a llegar a tu {nth} destino, a la izquierda",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la izquierda"},"sharp right":{default:"Has llegado a tu {nth} destino, a la derecha",upcoming:"Vas a llegar a tu {nth} destino, a la derecha",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la derecha"},"slight right":{default:"Has llegado a tu {nth} destino, a la derecha",upcoming:"Vas a llegar a tu {nth} destino, a la derecha",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la derecha"},"slight left":{default:"Has llegado a tu {nth} destino, a la izquierda",upcoming:"Vas a llegar a tu {nth} destino, a la izquierda",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la izquierda"},straight:{default:"Has llegado a tu {nth} destino, en frente",upcoming:"Vas a llegar a tu {nth} destino, en frente",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, en frente"}},continue:{default:{default:"Gire {modifier}",name:"Cruce {modifier} en {way_name}",destination:"Gire {modifier} hacia {destination}",exit:"Gire {modifier} en {way_name}"},straight:{default:"Contina recto",name:"Contina en {way_name}",destination:"Contina hacia {destination}",distance:"Contina recto por {distance}",namedistance:"Contina recto en {way_name} por {distance}"},"sharp left":{default:"Gire a la izquierda",name:"Gire a la izquierda en {way_name}",destination:"Gire a la izquierda hacia {destination}"},"sharp right":{default:"Gire a la derecha",name:"Gire a la derecha en {way_name}",destination:"Gire a la derecha hacia {destination}"},"slight left":{default:"Gire a la izquierda",name:"Doble levementea la izquierda en {way_name}",destination:"Gire a la izquierda hacia {destination}"},"slight right":{default:"Gire a la izquierda",name:"Doble levemente a la derecha en {way_name}",destination:"Gire a la izquierda hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido y contina en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},depart:{default:{default:"Dirgete al {direction}",name:"Dirgete al {direction} por {way_name}",namedistance:"Dirgete al {direction} en {way_name} por {distance}"}},"end of road":{default:{default:"Al final de la calle gira {modifier}",name:"Al final de la calle gira {modifier} por {way_name}",destination:"Al final de la calle gira {modifier} hacia {destination}"},straight:{default:"Al final de la calle contina recto",name:"Al final de la calle contina recto por {way_name}",destination:"Al final de la calle contina recto hacia {destination}"},uturn:{default:"Al final de la calle haz un cambio de sentido",name:"Al final de la calle haz un cambio de sentido en {way_name}",destination:"Al final de la calle haz un cambio de sentido hacia {destination}"}},fork:{default:{default:"Mantente {modifier} en el cruce",name:"Mantente {modifier} por {way_name}",destination:"Mantente {modifier} hacia {destination}"},"slight left":{default:"Mantente a la izquierda en el cruce",name:"Mantente a la izquierda por {way_name}",destination:"Mantente a la izquierda hacia {destination}"},"slight right":{default:"Mantente a la derecha en el cruce",name:"Mantente a la derecha por {way_name}",destination:"Mantente a la derecha hacia {destination}"},"sharp left":{default:"Gira la izquierda en el cruce",name:"Gira a la izquierda por {way_name}",destination:"Gira a la izquierda hacia {destination}"},"sharp right":{default:"Gira a la derecha en el cruce",name:"Gira a la derecha por {way_name}",destination:"Gira a la derecha hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},merge:{default:{default:"Incorprate {modifier}",name:"Incorprate {modifier} por {way_name}",destination:"Incorprate {modifier} hacia {destination}"},straight:{default:"Incorprate",name:"Incorprate por {way_name}",destination:"Incorprate hacia {destination}"},"slight left":{default:"Incorprate a la izquierda",name:"Incorprate a la izquierda por {way_name}",destination:"Incorprate a la izquierda hacia {destination}"},"slight right":{default:"Incorprate a la derecha",name:"Incorprate a la derecha por {way_name}",destination:"Incorprate a la derecha hacia {destination}"},"sharp left":{default:"Incorprate a la izquierda",name:"Incorprate a la izquierda por {way_name}",destination:"Incorprate a la izquierda hacia {destination}"},"sharp right":{default:"Incorprate a la derecha",name:"Incorprate a la derecha por {way_name}",destination:"Incorprate a la derecha hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},"new name":{default:{default:"Contina {modifier}",name:"Contina {modifier} por {way_name}",destination:"Contina {modifier} hacia {destination}"},straight:{default:"Contina recto",name:"Contina por {way_name}",destination:"Contina hacia {destination}"},"sharp left":{default:"Gira a la izquierda",name:"Gira a la izquierda por {way_name}",destination:"Gira a la izquierda hacia {destination}"},"sharp right":{default:"Gira a la derecha",name:"Gira a la derecha por {way_name}",destination:"Gira a la derecha hacia {destination}"},"slight left":{default:"Contina ligeramente por la izquierda",name:"Contina ligeramente por la izquierda por {way_name}",destination:"Contina ligeramente por la izquierda hacia {destination}"},"slight right":{default:"Contina ligeramente por la derecha",name:"Contina ligeramente por la derecha por {way_name}",destination:"Contina ligeramente por la derecha hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},notification:{default:{default:"Contina {modifier}",name:"Contina {modifier} por {way_name}",destination:"Contina {modifier} hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},"off ramp":{default:{default:"Coge la cuesta abajo",name:"Coge la cuesta abajo por {way_name}",destination:"Coge la cuesta abajo hacia {destination}",exit:"Coge la cuesta abajo {exit}",exit_destination:"Coge la cuesta abajo {exit} hacia {destination}"},left:{default:"Coge la cuesta abajo de la izquierda",name:"Coge la cuesta abajo de la izquierda por {way_name}",destination:"Coge la cuesta abajo de la izquierda hacia {destination}",exit:"Coge la cuesta abajo {exit} a tu izquierda",exit_destination:"Coge la cuesta abajo {exit} a tu izquierda hacia {destination}"},right:{default:"Coge la cuesta abajo de la derecha",name:"Coge la cuesta abajo de la derecha por {way_name}",destination:"Coge la cuesta abajo de la derecha hacia {destination}",exit:"Coge la cuesta abajo {exit}",exit_destination:"Coge la cuesta abajo {exit} hacia {destination}"},"sharp left":{default:"Coge la cuesta abajo de la izquierda",name:"Coge la cuesta abajo de la izquierda por {way_name}",destination:"Coge la cuesta abajo de la izquierda hacia {destination}",exit:"Coge la cuesta abajo {exit} a tu izquierda",exit_destination:"Coge la cuesta abajo {exit} a tu izquierda hacia {destination}"},"sharp right":{default:"Coge la cuesta abajo de la derecha",name:"Coge la cuesta abajo de la derecha por {way_name}",destination:"Coge la cuesta abajo de la derecha hacia {destination}",exit:"Coge la cuesta abajo {exit}",exit_destination:"Coge la cuesta abajo {exit} hacia {destination}"},"slight left":{default:"Coge la cuesta abajo de la izquierda",name:"Coge la cuesta abajo de la izquierda por {way_name}",destination:"Coge la cuesta abajo de la izquierda hacia {destination}",exit:"Coge la cuesta abajo {exit} a tu izquierda",exit_destination:"Coge la cuesta abajo{exit} a tu izquierda hacia {destination}"},"slight right":{default:"Coge la cuesta abajo de la derecha",name:"Coge la cuesta abajo de la derecha por {way_name}",destination:"Coge la cuesta abajo de la derecha hacia {destination}",exit:"Coge la cuesta abajo {exit}",exit_destination:"Coge la cuesta abajo {exit} hacia {destination}"}},"on ramp":{default:{default:"Coge la cuesta",name:"Coge la cuesta por {way_name}",destination:"Coge la cuesta hacia {destination}"},left:{default:"Coge la cuesta de la izquierda",name:"Coge la cuesta de la izquierda por {way_name}",destination:"Coge la cuesta de la izquierda hacia {destination}"},right:{default:"Coge la cuesta de la derecha",name:"Coge la cuesta de la derecha por {way_name}",destination:"Coge la cuesta de la derecha hacia {destination}"},"sharp left":{default:"Coge la cuesta de la izquierda",name:"Coge la cuesta de la izquierda por {way_name}",destination:"Coge la cuesta de la izquierda hacia {destination}"},"sharp right":{default:"Coge la cuesta de la derecha",name:"Coge la cuesta de la derecha por {way_name}",destination:"Coge la cuesta de la derecha hacia {destination}"},"slight left":{default:"Coge la cuesta de la izquierda",name:"Coge la cuesta de la izquierda por {way_name}",destination:"Coge la cuesta de la izquierda hacia {destination}"},"slight right":{default:"Coge la cuesta de la derecha",name:"Coge la cuesta de la derecha por {way_name}",destination:"Coge la cuesta de la derecha hacia {destination}"}},rotary:{default:{default:{default:"Incorprate en la rotonda",name:"En la rotonda sal por {way_name}",destination:"En la rotonda sal hacia {destination}"},name:{default:"En {rotary_name}",name:"En {rotary_name} sal por {way_name}",destination:"En {rotary_name} sal hacia {destination}"},exit:{default:"En la rotonda toma la {exit_number} salida",name:"En la rotonda toma la {exit_number} salida por {way_name}",destination:"En la rotonda toma la {exit_number} salida hacia {destination}"},name_exit:{default:"En {rotary_name} toma la {exit_number} salida",name:"En {rotary_name} toma la {exit_number} salida por {way_name}",destination:"En {rotary_name} toma la {exit_number} salida hacia {destination}"}}},roundabout:{default:{exit:{default:"En la rotonda toma la {exit_number} salida",name:"En la rotonda toma la {exit_number} salida por {way_name}",destination:"En la rotonda toma la {exit_number} salida hacia {destination}"},default:{default:"Incorprate en la rotonda",name:"Incorprate en la rotonda y sal en {way_name}",destination:"Incorprate en la rotonda y sal hacia {destination}"}}},"roundabout turn":{default:{default:"Siga {modifier}",name:"Siga {modifier} en {way_name}",destination:"Siga {modifier} hacia {destination}"},left:{default:"Gire a la izquierda",name:"Gire a la izquierda en {way_name}",destination:"Gire a la izquierda hacia {destination}"},right:{default:"Gire a la derecha",name:"Gire a la derecha en {way_name}",destination:"Gire a la derecha hacia {destination}"},straight:{default:"Contina recto",name:"Contina recto por {way_name}",destination:"Contina recto hacia {destination}"}},"exit roundabout":{default:{default:"Sal la rotonda",name:"Toma la salida por {way_name}",destination:"Toma la salida hacia {destination}"}},"exit rotary":{default:{default:"Sal la rotonda",name:"Toma la salida por {way_name}",destination:"Toma la salida hacia {destination}"}},turn:{default:{default:"Gira {modifier}",name:"Gira {modifier} por {way_name}",destination:"Gira {modifier} hacia {destination}"},left:{default:"Gira a la izquierda",name:"Gira a la izquierda por {way_name}",destination:"Gira a la izquierda hacia {destination}"},right:{default:"Gira a la derecha",name:"Gira a la derecha por {way_name}",destination:"Gira a la derecha hacia {destination}"},straight:{default:"Contina recto",name:"Contina recto por {way_name}",destination:"Contina recto hacia {destination}"}},"use lane":{no_lanes:{default:"Contina recto"},default:{default:"{lane_instruction}"}}}}},{}],28:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"},direction:{north:"norte",northeast:"noreste",east:"este",southeast:"sureste",south:"sur",southwest:"suroeste",west:"oeste",northwest:"noroeste"},modifier:{left:"izquierda",right:"derecha","sharp left":"cerrada a la izquierda","sharp right":"cerrada a la derecha","slight left":"levemente a la izquierda","slight right":"levemente a la derecha",straight:"recto",uturn:"cambio de sentido"},lanes:{xo:"Mantente a la derecha",ox:"Mantente a la izquierda",xox:"Mantente en el medio",oxo:"Mantente a la izquierda o derecha"}},modes:{ferry:{default:"Coge el ferry",name:"Coge el ferry {way_name}",destination:"Coge el ferry a {destination}"}},phrase:{"two linked by distance":"{instruction_one} y luego a {distance}, {instruction_two}","two linked":"{instruction_one} y luego {instruction_two}","one in distance":"A {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"salida {exit}"},arrive:{default:{default:"Has llegado a tu {nth} destino",upcoming:"Vas a llegar a tu {nth} destino",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}"},left:{default:"Has llegado a tu {nth} destino, a la izquierda",upcoming:"Vas a llegar a tu {nth} destino, a la izquierda",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la izquierda"},right:{default:"Has llegado a tu {nth} destino, a la derecha",upcoming:"Vas a llegar a tu {nth} destino, a la derecha",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la derecha"},"sharp left":{default:"Has llegado a tu {nth} destino, a la izquierda",upcoming:"Vas a llegar a tu {nth} destino, a la izquierda",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la izquierda"},"sharp right":{default:"Has llegado a tu {nth} destino, a la derecha",upcoming:"Vas a llegar a tu {nth} destino, a la derecha",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la derecha"},"slight right":{default:"Has llegado a tu {nth} destino, a la derecha",upcoming:"Vas a llegar a tu {nth} destino, a la derecha",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la derecha"},"slight left":{default:"Has llegado a tu {nth} destino, a la izquierda",upcoming:"Vas a llegar a tu {nth} destino, a la izquierda",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, a la izquierda"},straight:{default:"Has llegado a tu {nth} destino, en frente",upcoming:"Vas a llegar a tu {nth} destino, en frente",short:"Has llegado","short-upcoming":"Vas a llegar",named:"Has llegado a {waypoint_name}, en frente"}},continue:{default:{default:"Gira a {modifier}",name:"Cruza a la{modifier}  en {way_name}",destination:"Gira a {modifier} hacia {destination}",exit:"Gira a {modifier} en {way_name}"},straight:{default:"Contina recto",name:"Contina en {way_name}",destination:"Contina hacia {destination}",distance:"Contina recto por {distance}",namedistance:"Contina recto en {way_name} por {distance}"},"sharp left":{default:"Gira a la izquierda",name:"Gira a la izquierda en {way_name}",destination:"Gira a la izquierda hacia {destination}"},"sharp right":{default:"Gira a la derecha",name:"Gira a la derecha en {way_name}",destination:"Gira a la derecha hacia {destination}"},"slight left":{default:"Gira a la izquierda",name:"Dobla levemente a la izquierda en {way_name}",destination:"Gira a la izquierda hacia {destination}"},"slight right":{default:"Gira a la izquierda",name:"Dobla levemente a la derecha en {way_name}",destination:"Gira a la izquierda hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido y contina en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},depart:{default:{default:"Ve a {direction}",name:"Ve a {direction} en {way_name}",namedistance:"Ve a {direction} en {way_name} por {distance}"}},"end of road":{default:{default:"Gira  a {modifier}",name:"Gira a {modifier} en {way_name}",destination:"Gira a {modifier} hacia {destination}"},straight:{default:"Contina recto",name:"Contina recto en {way_name}",destination:"Contina recto hacia {destination}"},uturn:{default:"Haz un cambio de sentido al final de la via",name:"Haz un cambio de sentido en {way_name} al final de la via",destination:"Haz un cambio de sentido hacia {destination} al final de la via"}},fork:{default:{default:"Mantente  {modifier} en el cruza",name:"Mantente {modifier} en {way_name}",destination:"Mantente {modifier} hacia {destination}"},"slight left":{default:"Mantente a la izquierda en el cruza",name:"Mantente a la izquierda en {way_name}",destination:"Mantente a la izquierda hacia {destination}"},"slight right":{default:"Mantente a la derecha en el cruza",name:"Mantente a la derecha en {way_name}",destination:"Mantente a la derecha hacia {destination}"},"sharp left":{default:"Gira a la izquierda en el cruza",name:"Gira a la izquierda en {way_name}",destination:"Gira a la izquierda hacia {destination}"},"sharp right":{default:"Gira a la derecha en el cruza",name:"Gira a la derecha en {way_name}",destination:"Gira a la derecha hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},merge:{default:{default:"Incorprate a {modifier}",name:"Incorprate a {modifier} en {way_name}",destination:"Incorprate a {modifier} hacia {destination}"},straight:{default:"Incorprate",name:"Incorprate a {way_name}",destination:"Incorprate hacia {destination}"},"slight left":{default:"Incorprate a la izquierda",name:"Incorprate a la izquierda en {way_name}",destination:"Incorprate a la izquierda hacia {destination}"},"slight right":{default:"Incorprate a la derecha",name:"Incorprate a la derecha en {way_name}",destination:"Incorprate a la derecha hacia {destination}"},"sharp left":{default:"Incorprate a la izquierda",name:"Incorprate a la izquierda en {way_name}",destination:"Incorprate a la izquierda hacia {destination}"},"sharp right":{default:"Incorprate a la derecha",name:"Incorprate a la derecha en {way_name}",destination:"Incorprate a la derecha hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},"new name":{default:{default:"Contina {modifier}",name:"Contina {modifier} en {way_name}",destination:"Contina {modifier} hacia {destination}"},straight:{default:"Contina recto",name:"Contina en {way_name}",destination:"Contina hacia {destination}"},"sharp left":{default:"Gira a la izquierda",name:"Gira a la izquierda en {way_name}",destination:"Gira a la izquierda hacia {destination}"},"sharp right":{default:"Gira a la derecha",name:"Gira a la derecha en {way_name}",destination:"Gira a la derecha hacia {destination}"},"slight left":{default:"Contina levemente a la izquierda",name:"Contina levemente a la izquierda en {way_name}",destination:"Contina levemente a la izquierda hacia {destination}"},"slight right":{default:"Contina levemente a la derecha",name:"Contina levemente a la derecha en {way_name}",destination:"Contina levemente a la derecha hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},notification:{default:{default:"Contina {modifier}",name:"Contina {modifier} en {way_name}",destination:"Contina {modifier} hacia {destination}"},uturn:{default:"Haz un cambio de sentido",name:"Haz un cambio de sentido en {way_name}",destination:"Haz un cambio de sentido hacia {destination}"}},"off ramp":{default:{default:"Toma la salida",name:"Toma la salida en {way_name}",destination:"Toma la salida hacia {destination}",exit:"Toma la salida {exit}",exit_destination:"Toma la salida {exit} hacia {destination}"},left:{default:"Toma la salida en la izquierda",name:"Toma la salida en la izquierda en {way_name}",destination:"Toma la salida en la izquierda en {destination}",exit:"Toma la salida {exit} en la izquierda",exit_destination:"Toma la salida {exit} en la izquierda hacia {destination}"},right:{default:"Toma la salida en la derecha",name:"Toma la salida en la derecha en {way_name}",destination:"Toma la salida en la derecha hacia {destination}",exit:"Toma la salida {exit} en la derecha",exit_destination:"Toma la salida {exit} en la derecha hacia {destination}"},"sharp left":{default:"Ve cuesta abajo en la izquierda",name:"Ve cuesta abajo en la izquierda en {way_name}",destination:"Ve cuesta abajo en la izquierda hacia {destination}",exit:"Toma la salida {exit} en la izquierda",exit_destination:"Toma la salida {exit} en la izquierda hacia {destination}"},"sharp right":{default:"Ve cuesta abajo en la derecha",name:"Ve cuesta abajo en la derecha en {way_name}",destination:"Ve cuesta abajo en la derecha hacia {destination}",exit:"Toma la salida {exit} en la derecha",exit_destination:"Toma la salida {exit} en la derecha hacia {destination}"},"slight left":{default:"Ve cuesta abajo en la izquierda",name:"Ve cuesta abajo en la izquierda en {way_name}",destination:"Ve cuesta abajo en la izquierda hacia {destination}",exit:"Toma la salida {exit} en la izquierda",exit_destination:"Toma la salida {exit} en la izquierda hacia {destination}"},"slight right":{default:"Toma la salida en la derecha",name:"Toma la salida en la derecha en {way_name}",destination:"Toma la salida en la derecha hacia {destination}",exit:"Toma la salida {exit} en la derecha",exit_destination:"Toma la salida {exit} en la derecha hacia {destination}"}},"on ramp":{default:{default:"Toma la rampa",name:"Toma la rampa en {way_name}",destination:"Toma la rampa hacia {destination}"},left:{default:"Toma la rampa en la izquierda",name:"Toma la rampa en la izquierda en {way_name}",destination:"Toma la rampa en la izquierda hacia {destination}"},right:{default:"Toma la rampa en la derecha",name:"Toma la rampa en la derecha en {way_name}",destination:"Toma la rampa en la derecha hacia {destination}"},"sharp left":{default:"Toma la rampa en la izquierda",name:"Toma la rampa en la izquierda en {way_name}",destination:"Toma la rampa en la izquierda hacia {destination}"},"sharp right":{default:"Toma la rampa en la derecha",name:"Toma la rampa en la derecha en {way_name}",destination:"Toma la rampa en la derecha hacia {destination}"},"slight left":{default:"Toma la rampa en la izquierda",name:"Toma la rampa en la izquierda en {way_name}",destination:"Toma la rampa en la izquierda hacia {destination}"},"slight right":{default:"Toma la rampa en la derecha",name:"Toma la rampa en la derecha en {way_name}",destination:"Toma la rampa en la derecha hacia {destination}"}},rotary:{default:{default:{default:"Entra en la rotonda",name:"Entra en la rotonda y sal en {way_name}",destination:"Entra en la rotonda y sal hacia {destination}"},name:{default:"Entra en {rotary_name}",name:"Entra en {rotary_name} y sal en {way_name}",destination:"Entra en {rotary_name} y sal hacia {destination}"},exit:{default:"Entra en la rotonda y toma la {exit_number} salida",name:"Entra en la rotonda y toma la {exit_number} salida a {way_name}",destination:"Entra en la rotonda y toma la {exit_number} salida hacia {destination}"},name_exit:{default:"Entra en {rotary_name} y coge la {exit_number} salida",name:"Entra en {rotary_name} y coge la {exit_number} salida en {way_name}",destination:"Entra en {rotary_name} y coge la {exit_number} salida hacia {destination}"}}},roundabout:{default:{exit:{default:"Entra en la rotonda y toma la {exit_number} salida",name:"Entra en la rotonda y toma la {exit_number} salida a {way_name}",destination:"Entra en la rotonda y toma la {exit_number} salida hacia {destination}"},default:{default:"Entra en la rotonda",name:"Entra en la rotonda y sal en {way_name}",destination:"Entra en la rotonda y sal hacia {destination}"}}},"roundabout turn":{default:{default:"Sigue {modifier}",name:"Sigue {modifier} en {way_name}",destination:"Sigue {modifier} hacia {destination}"},left:{default:"Gira a la izquierda",name:"Gira a la izquierda en {way_name}",destination:"Gira a la izquierda hacia {destination}"},right:{default:"Gira a la derecha",name:"Gira a la derecha en {way_name}",destination:"Gira a la derecha hacia {destination}"},straight:{default:"Contina recto",name:"Contina recto en {way_name}",destination:"Contina recto hacia {destination}"}},"exit roundabout":{default:{default:"Sal la rotonda",name:"Sal la rotonda en {way_name}",destination:"Sal la rotonda hacia {destination}"}},"exit rotary":{default:{default:"Sal la rotonda",name:"Sal la rotonda en {way_name}",destination:"Sal la rotonda hacia {destination}"}},turn:{default:{default:"Sigue {modifier}",name:"Sigue {modifier} en {way_name}",destination:"Sigue {modifier} hacia {destination}"},left:{default:"Gira a la izquierda",name:"Gira a la izquierda en {way_name}",destination:"Gira a la izquierda hacia {destination}"},right:{default:"Gira a la derecha",name:"Gira a la derecha en {way_name}",destination:"Gira a la derecha hacia {destination}"},straight:{default:"Ve recto",name:"Ve recto en {way_name}",destination:"Ve recto hacia {destination}"}},"use lane":{no_lanes:{default:"Contina recto"},default:{default:"{lane_instruction}"}}}}},{}],29:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1.",2:"2.",3:"3.",4:"4.",5:"5.",6:"6.",7:"7.",8:"8.",9:"9.",10:"10."},direction:{north:"pohjoiseen",northeast:"koilliseen",east:"itn",southeast:"kaakkoon",south:"eteln",southwest:"lounaaseen",west:"lnteen",northwest:"luoteeseen"},modifier:{left:"vasemmall(e/a)",right:"oikeall(e/a)","sharp left":"jyrksti vasempaan","sharp right":"jyrksti oikeaan","slight left":"loivasti vasempaan","slight right":"loivasti oikeaan",straight:"suoraan eteenpin",uturn:"U-knns"},lanes:{xo:"Pysy oikealla",ox:"Pysy vasemmalla",xox:"Pysy keskell",oxo:"Pysy vasemmalla tai oikealla"}},modes:{ferry:{default:"Aja lautalle",name:"Aja lautalle {way_name}",destination:"Aja lautalle, jonka mrnp on {destination}"}},phrase:{"two linked by distance":"{instruction_one}, sitten {distance} pst, {instruction_two}","two linked":"{instruction_one}, sitten {instruction_two}","one in distance":"{distance} pst, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"{exit}"},arrive:{default:{default:"Olet saapunut {nth} mrnphsi",upcoming:"Saavut {nth} mrnphsi",short:"Olet saapunut","short-upcoming":"Saavut",named:"Olet saapunut mrnphn {waypoint_name}"},left:{default:"Olet saapunut {nth} mrnphsi, joka on vasemmalla puolellasi",upcoming:"Saavut {nth} mrnphsi, joka on vasemmalla puolellasi",short:"Olet saapunut","short-upcoming":"Saavut",named:"Olet saapunut mrnphn {waypoint_name}, joka on vasemmalla puolellasi"},right:{default:"Olet saapunut {nth} mrnphsi, joka on oikealla puolellasi",upcoming:"Saavut {nth} mrnphsi, joka on oikealla puolellasi",short:"Olet saapunut","short-upcoming":"Saavut",named:"Olet saapunut mrnphn {waypoint_name}, joka on oikealla puolellasi"},"sharp left":{default:"Olet saapunut {nth} mrnphsi, joka on vasemmalla puolellasi",upcoming:"Saavut {nth} mrnphsi, joka on vasemmalla puolellasi",short:"Olet saapunut","short-upcoming":"Saavut",named:"Olet saapunut mrnphn {waypoint_name}, joka on vasemmalla puolellasi"},"sharp right":{default:"Olet saapunut {nth} mrnphsi, joka on oikealla puolellasi",upcoming:"Saavut {nth} mrnphsi, joka on oikealla puolellasi",short:"Olet saapunut","short-upcoming":"Saavut",named:"Olet saapunut mrnphn {waypoint_name}, joka on oikealla puolellasi"},"slight right":{default:"Olet saapunut {nth} mrnphsi, joka on oikealla puolellasi",upcoming:"Saavut {nth} mrnphsi, joka on oikealla puolellasi",short:"Olet saapunut","short-upcoming":"Saavut",named:"Olet saapunut mrnphn {waypoint_name}, joka on oikealla puolellasi"},"slight left":{default:"Olet saapunut {nth} mrnphsi, joka on vasemmalla puolellasi",upcoming:"Saavut {nth} mrnphsi, joka on vasemmalla puolellasi",short:"Olet saapunut","short-upcoming":"Saavut",named:"Olet saapunut mrnphn {waypoint_name}, joka on vasemmalla puolellasi"},straight:{default:"Olet saapunut {nth} mrnphsi, joka on suoraan edesssi",upcoming:"Saavut {nth} mrnphsi, suoraan edess",short:"Olet saapunut","short-upcoming":"Saavut",named:"Olet saapunut mrnphn {waypoint_name}, joka on suoraan edesssi"}},continue:{default:{default:"Knny {modifier}",name:"Knny {modifier} pysyksesi tiell {way_name}",destination:"Knny {modifier} suuntana {destination}",exit:"Knny {modifier} tielle {way_name}"},straight:{default:"Jatka suoraan eteenpin",name:"Jatka suoraan pysyksesi tiell {way_name}",destination:"Jatka suuntana {destination}",distance:"Jatka suoraan {distance}",namedistance:"Jatka tiell {way_name} {distance}"},"sharp left":{default:"Jatka jyrksti vasempaan",name:"Jatka jyrksti vasempaan pysyksesi tiell {way_name}",destination:"Jatka jyrksti vasempaan suuntana {destination}"},"sharp right":{default:"Jatka jyrksti oikeaan",name:"Jatka jyrksti oikeaan pysyksesi tiell {way_name}",destination:"Jatka jyrksti oikeaan suuntana {destination}"},"slight left":{default:"Jatka loivasti vasempaan",name:"Jatka loivasti vasempaan pysyksesi tiell {way_name}",destination:"Jatka loivasti vasempaan suuntana {destination}"},"slight right":{default:"Jatka loivasti oikeaan",name:"Jatka loivasti oikeaan pysyksesi tiell {way_name}",destination:"Jatka loivasti oikeaan suuntana {destination}"},uturn:{default:"Tee U-knns",name:"Tee U-knns ja jatka tiet {way_name}",destination:"Tee U-knns suuntana {destination}"}},depart:{default:{default:"Aja {direction}",name:"Aja tiet {way_name} {direction}",namedistance:"Aja {distance} {direction} tiet {way_name} "}},"end of road":{default:{default:"Knny {modifier}",name:"Knny {modifier} tielle {way_name}",destination:"Knny {modifier} suuntana {destination}"},straight:{default:"Jatka suoraan eteenpin",name:"Jatka suoraan eteenpin tielle {way_name}",destination:"Jatka suoraan eteenpin suuntana {destination}"},uturn:{default:"Tien pss tee U-knns",name:"Tien pss tee U-knns tielle {way_name}",destination:"Tien pss tee U-knns suuntana {destination}"}},fork:{default:{default:"Jatka tienhaarassa {modifier}",name:"Jatka {modifier} tielle {way_name}",destination:"Jatka {modifier} suuntana {destination}"},"slight left":{default:"Pysy vasemmalla tienhaarassa",name:"Pysy vasemmalla tielle {way_name}",destination:"Pysy vasemmalla suuntana {destination}"},"slight right":{default:"Pysy oikealla tienhaarassa",name:"Pysy oikealla tielle {way_name}",destination:"Pysy oikealla suuntana {destination}"},"sharp left":{default:"Knny tienhaarassa jyrksti vasempaan",name:"Knny tienhaarassa jyrksti vasempaan tielle {way_name}",destination:"Knny tienhaarassa jyrksti vasempaan suuntana {destination}"},"sharp right":{default:"Knny tienhaarassa jyrksti oikeaan",name:"Knny tienhaarassa jyrksti oikeaan tielle {way_name}",destination:"Knny tienhaarassa jyrksti oikeaan suuntana {destination}"},uturn:{default:"Tee U-knns",name:"Tee U-knns tielle {way_name}",destination:"Tee U-knns suuntana {destination}"}},merge:{default:{default:"Liity {modifier}",name:"Liity {modifier}, tielle {way_name}",destination:"Liity {modifier}, suuntana {destination}"},straight:{default:"Liity",name:"Liity tielle {way_name}",destination:"Liity suuntana {destination}"},"slight left":{default:"Liity vasemmalle",name:"Liity vasemmalle, tielle {way_name}",destination:"Liity vasemmalle, suuntana {destination}"},"slight right":{default:"Liity oikealle",name:"Liity oikealle, tielle {way_name}",destination:"Liity oikealle, suuntana {destination}"},"sharp left":{default:"Liity vasemmalle",name:"Liity vasemmalle, tielle {way_name}",destination:"Liity vasemmalle, suuntana {destination}"},"sharp right":{default:"Liity oikealle",name:"Liity oikealle, tielle {way_name}",destination:"Liity oikealle, suuntana {destination}"},uturn:{default:"Tee U-knns",name:"Tee U-knns tielle {way_name}",destination:"Tee U-knns suuntana {destination}"}},"new name":{default:{default:"Jatka {modifier}",name:"Jatka {modifier} tielle {way_name}",destination:"Jatka {modifier} suuntana {destination}"},straight:{default:"Jatka suoraan eteenpin",name:"Jatka tielle {way_name}",destination:"Jatka suuntana {destination}"},"sharp left":{default:"Knny jyrksti vasempaan",name:"Knny jyrksti vasempaan tielle {way_name}",destination:"Knny jyrksti vasempaan suuntana {destination}"},"sharp right":{default:"Knny jyrksti oikeaan",name:"Knny jyrksti oikeaan tielle {way_name}",destination:"Knny jyrksti oikeaan suuntana {destination}"},"slight left":{default:"Jatka loivasti vasempaan",name:"Jatka loivasti vasempaan tielle {way_name}",destination:"Jatka loivasti vasempaan suuntana {destination}"},"slight right":{default:"Jatka loivasti oikeaan",name:"Jatka loivasti oikeaan tielle {way_name}",destination:"Jatka loivasti oikeaan suuntana {destination}"},uturn:{default:"Tee U-knns",name:"Tee U-knns tielle {way_name}",destination:"Tee U-knns suuntana {destination}"}},notification:{default:{default:"Jatka {modifier}",name:"Jatka {modifier} tielle {way_name}",destination:"Jatka {modifier} suuntana {destination}"},uturn:{default:"Tee U-knns",name:"Tee U-knns tielle {way_name}",destination:"Tee U-knns suuntana {destination}"}},"off ramp":{default:{default:"Aja erkanemiskaistalle",name:"Aja erkanemiskaistaa tielle {way_name}",destination:"Aja erkanemiskaistalle suuntana {destination}",exit:"Ota poistuminen {exit}",exit_destination:"Ota poistuminen {exit}, suuntana {destination}"},left:{default:"Aja vasemmalla olevalle erkanemiskaistalle",name:"Aja vasemmalla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja vasemmalla olevalle erkanemiskaistalle suuntana {destination}",exit:"Ota poistuminen {exit} vasemmalla",exit_destination:"Ota poistuminen {exit} vasemmalla, suuntana {destination}"},right:{default:"Aja oikealla olevalle erkanemiskaistalle",name:"Aja oikealla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja oikealla olevalle erkanemiskaistalle suuntana {destination}",exit:"Ota poistuminen {exit} oikealla",exit_destination:"Ota poistuminen {exit} oikealla, suuntana {destination}"},"sharp left":{default:"Aja vasemmalla olevalle erkanemiskaistalle",name:"Aja vasemmalla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja vasemmalla olevalle erkanemiskaistalle suuntana {destination}",exit:"Ota poistuminen {exit} vasemmalla",exit_destination:"Ota poistuminen {exit} vasemmalla, suuntana {destination}"},"sharp right":{default:"Aja oikealla olevalle erkanemiskaistalle",name:"Aja oikealla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja oikealla olevalle erkanemiskaistalle suuntana {destination}",exit:"Ota poistuminen {exit} oikealla",exit_destination:"Ota poistuminen {exit} oikealla, suuntana {destination}"},"slight left":{default:"Aja vasemmalla olevalle erkanemiskaistalle",name:"Aja vasemmalla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja vasemmalla olevalle erkanemiskaistalle suuntana {destination}",exit:"Ota poistuminen {exit} vasemmalla",exit_destination:"Ota poistuminen {exit} vasemmalla, suuntana {destination}"},"slight right":{default:"Aja oikealla olevalle erkanemiskaistalle",name:"Aja oikealla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja oikealla olevalle erkanemiskaistalle suuntana {destination}",exit:"Ota poistuminen {exit} oikealla",exit_destination:"Ota poistuminen {exit} oikealla, suuntana {destination}"}},"on ramp":{default:{default:"Aja erkanemiskaistalle",name:"Aja erkanemiskaistaa tielle {way_name}",destination:"Aja erkanemiskaistalle suuntana {destination}"},left:{default:"Aja vasemmalla olevalle erkanemiskaistalle",name:"Aja vasemmalla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja vasemmalla olevalle erkanemiskaistalle suuntana {destination}"},right:{default:"Aja oikealla olevalle erkanemiskaistalle",name:"Aja oikealla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja oikealla olevalle erkanemiskaistalle suuntana {destination}"},"sharp left":{default:"Aja vasemmalla olevalle erkanemiskaistalle",name:"Aja vasemmalla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja vasemmalla olevalle erkanemiskaistalle suuntana {destination}"},"sharp right":{default:"Aja oikealla olevalle erkanemiskaistalle",name:"Aja oikealla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja oikealla olevalle erkanemiskaistalle suuntana {destination}"},"slight left":{default:"Aja vasemmalla olevalle erkanemiskaistalle",name:"Aja vasemmalla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja vasemmalla olevalle erkanemiskaistalle suuntana {destination}"},"slight right":{default:"Aja oikealla olevalle erkanemiskaistalle",name:"Aja oikealla olevaa erkanemiskaistaa tielle {way_name}",destination:"Aja oikealla olevalle erkanemiskaistalle suuntana {destination}"}},rotary:{default:{default:{default:"Aja liikenneympyrn",name:"Aja liikenneympyrn ja valitse erkanemiskaista tielle {way_name}",destination:"Aja liikenneympyrn ja valitse erkanemiskaista suuntana {destination}"},name:{default:"Aja liikenneympyrn {rotary_name}",name:"Aja liikenneympyrn {rotary_name} ja valitse erkanemiskaista tielle {way_name}",destination:"Aja liikenneympyrn {rotary_name} ja valitse erkanemiskaista suuntana {destination}"},exit:{default:"Aja liikenneympyrn ja valitse {exit_number} erkanemiskaista",name:"Aja liikenneympyrn ja valitse {exit_number} erkanemiskaista tielle {way_name}",destination:"Aja liikenneympyrn ja valitse {exit_number} erkanemiskaista suuntana {destination}"},name_exit:{default:"Aja liikenneympyrn {rotary_name} ja valitse {exit_number} erkanemiskaista",name:"Aja liikenneympyrn {rotary_name} ja valitse {exit_number} erkanemiskaista tielle {way_name}",destination:"Aja liikenneympyrn {rotary_name} ja valitse {exit_number} erkanemiskaista suuntana {destination}"}}},roundabout:{default:{exit:{default:"Aja liikenneympyrn ja valitse {exit_number} erkanemiskaista",name:"Aja liikenneympyrn ja valitse {exit_number} erkanemiskaista tielle {way_name}",destination:"Aja liikenneympyrn ja valitse {exit_number} erkanemiskaista suuntana {destination}"},default:{default:"Aja liikenneympyrn",name:"Aja liikenneympyrn ja valitse erkanemiskaista tielle {way_name}",destination:"Aja liikenneympyrn ja valitse erkanemiskaista suuntana {destination}"}}},"roundabout turn":{default:{default:"Knny {modifier}",name:"Knny {modifier} tielle {way_name}",destination:"Knny {modifier} suuntana {destination}"},left:{default:"Knny vasempaan",name:"Knny vasempaan tielle {way_name}",destination:"Knny vasempaan suuntana {destination}"},right:{default:"Knny oikeaan",name:"Knny oikeaan tielle {way_name}",destination:"Knny oikeaan suuntana {destination}"},straight:{default:"Jatka suoraan eteenpin",name:"Jatka suoraan eteenpin tielle {way_name}",destination:"Jatka suoraan eteenpin suuntana {destination}"}},"exit roundabout":{default:{default:"Poistu liikenneympyrst",name:"Poistu liikenneympyrst tielle {way_name}",destination:"Poistu liikenneympyrst suuntana {destination}"}},"exit rotary":{default:{default:"Poistu liikenneympyrst",name:"Poistu liikenneympyrst tielle {way_name}",destination:"Poistu liikenneympyrst suuntana {destination}"}},turn:{default:{default:"Knny {modifier}",name:"Knny {modifier} tielle {way_name}",destination:"Knny {modifier} suuntana {destination}"},left:{default:"Knny vasempaan",name:"Knny vasempaan tielle {way_name}",destination:"Knny vasempaan suuntana {destination}"},right:{default:"Knny oikeaan",name:"Knny oikeaan tielle {way_name}",destination:"Knny oikeaan suuntana {destination}"},straight:{default:"Aja suoraan eteenpin",name:"Aja suoraan eteenpin tielle {way_name}",destination:"Aja suoraan eteenpin suuntana {destination}"}},"use lane":{no_lanes:{default:"Jatka suoraan eteenpin"},default:{default:"{lane_instruction}"}}}}},{}],30:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"premire",2:"seconde",3:"troisime",4:"quatrime",5:"cinquime",6:"sixime",7:"septime",8:"huitime",9:"neuvime",10:"dixime"},direction:{north:"le nord",northeast:"le nord-est",east:"lest",southeast:"le sud-est",south:"le sud",southwest:"le sud-ouest",west:"louest",northwest:"le nord-ouest"},modifier:{left:" gauche",right:" droite","sharp left":"franchement  gauche","sharp right":"franchement  droite","slight left":"lgrement  gauche","slight right":"lgrement  droite",straight:"tout droit",uturn:"demi-tour"},lanes:{xo:"Tenir la droite",ox:"Tenir la gauche",xox:"Rester au milieu",oxo:"Tenir la gauche ou la droite"}},modes:{ferry:{default:"Prendre le ferry",name:"Prendre le ferry {way_name:article}",destination:"Prendre le ferry en direction {destination:preposition}"}},phrase:{"two linked by distance":"{instruction_one}, puis, dans {distance}, {instruction_two}","two linked":"{instruction_one}, puis {instruction_two}","one in distance":"Dans {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"sortie n{exit}"},arrive:{default:{default:"Vous tes arriv  votre {nth} destination",upcoming:"Vous arriverez  votre {nth} destination",short:"Vous tes arriv","short-upcoming":"Vous arriverez",named:"Vous tes arriv {waypoint_name:arrival}"},left:{default:"Vous tes arriv  votre {nth} destination, sur la gauche",upcoming:"Vous arriverez  votre {nth} destination, sur la gauche",short:"Vous tes arriv","short-upcoming":"Vous arriverez",named:"Vous tes arriv {waypoint_name:arrival}, sur la gauche"},right:{default:"Vous tes arriv  votre {nth} destination, sur la droite",upcoming:"Vous arriverez  votre {nth} destination, sur la droite",short:"Vous tes arriv","short-upcoming":"Vous arriverez",named:"Vous tes arriv   {waypoint_name:arrival}, sur la droite"},"sharp left":{default:"Vous tes arriv  votre {nth} destination, sur la gauche",upcoming:"Vous arriverez  votre {nth} destination, sur la gauche",short:"Vous tes arriv","short-upcoming":"Vous arriverez",named:"Vous tes arriv {waypoint_name:arrival}, sur la gauche"},"sharp right":{default:"Vous tes arriv  votre {nth} destination, sur la droite",upcoming:"Vous arriverez  votre {nth} destination, sur la droite",short:"Vous tes arriv","short-upcoming":"Vous arriverez",named:"Vous tes arriv {waypoint_name:arrival}, sur la droite"},"slight right":{default:"Vous tes arriv  votre {nth} destination, sur la droite",upcoming:"Vous arriverez  votre {nth} destination, sur la droite",short:"Vous tes arriv","short-upcoming":"Vous arriverez",named:"Vous tes arriv {waypoint_name:arrival}, sur la droite"},"slight left":{default:"Vous tes arriv  votre {nth} destination, sur la gauche",upcoming:"Vous arriverez  votre {nth} destination, sur la gauche",short:"Vous tes arriv","short-upcoming":"Vous tes arriv",named:"Vous tes arriv {waypoint_name:arrival}, sur la gauche"},straight:{default:"Vous tes arriv  votre {nth} destination, droit devant",upcoming:"Vous arriverez  votre {nth} destination, droit devant",short:"Vous tes arriv","short-upcoming":"Vous tes arriv",named:"Vous tes arriv {waypoint_name:arrival}, droit devant"}},continue:{default:{default:"Tourner {modifier}",name:"Tourner {modifier} pour rester sur {way_name:article}",destination:"Tourner {modifier} en direction {destination:preposition}",exit:"Tourner {modifier} sur {way_name:article}"},straight:{default:"Continuer tout droit",name:"Continuer tout droit pour rester sur {way_name:article}",destination:"Continuer tout droit en direction {destination:preposition}",distance:"Continuer tout droit sur {distance}",namedistance:"Continuer sur {way_name:article} sur {distance}"},"sharp left":{default:"Tourner franchement  gauche",name:"Tourner franchement  gauche pour rester sur {way_name:article}",destination:"Tourner franchement  gauche en direction {destination:preposition}"},"sharp right":{default:"Tourner franchement  droite",name:"Tourner franchement  droite pour rester sur {way_name:article}",destination:"Tourner franchement  droite en direction {destination:preposition}"},"slight left":{default:"Tourner lgrement  gauche",name:"Tourner lgrement  gauche pour rester sur {way_name:article}",destination:"Tourner lgrement  gauche en direction {destination:preposition}"},"slight right":{default:"Tourner lgrement  droite",name:"Tourner lgrement  droite pour rester sur {way_name:article}",destination:"Tourner lgrement  droite en direction {destination:preposition}"},uturn:{default:"Faire demi-tour",name:"Faire demi-tour et continuer sur {way_name:article}",destination:"Faire demi-tour en direction {destination:preposition}"}},depart:{default:{default:"Se diriger vers {direction}",name:"Se diriger vers {direction} sur {way_name:article}",namedistance:"Se diriger vers {direction} sur {way_name:article} sur {distance}"}},"end of road":{default:{default:"Tourner {modifier}",name:"Tourner {modifier} sur {way_name:article}",destination:"Tourner {modifier} en direction {destination:preposition}"},straight:{default:"Continuer tout droit",name:"Continuer tout droit sur {way_name:article}",destination:"Continuer tout droit en direction {destination:preposition}"},uturn:{default:"Faire demi-tour  la fin de la route",name:"Faire demi-tour  la fin {way_name:preposition}",destination:"Faire demi-tour  la fin de la route en direction {destination:preposition}"}},fork:{default:{default:"Tenir {modifier}  lembranchement",name:"Tenir {modifier} sur {way_name:article}",destination:"Tenir {modifier} en direction {destination:preposition}"},"slight left":{default:"Tenir la gauche  lembranchement",name:"Tenir la gauche sur {way_name:article}",destination:"Tenir la gauche en direction {destination:preposition}"},"slight right":{default:"Tenir la droite  lembranchement",name:"Tenir la droite sur {way_name:article}",destination:"Tenir la droite en direction {destination:preposition}"},"sharp left":{default:"Tourner franchement  gauche  lembranchement",name:"Tourner franchement  gauche sur {way_name:article}",destination:"Tourner franchement  gauche en direction {destination:preposition}"},"sharp right":{default:"Tourner franchement  droite  lembranchement",name:"Tourner franchement  droite sur {way_name:article}",destination:"Tourner franchement  droite en direction {destination:preposition}"},uturn:{default:"Faire demi-tour",name:"Faire demi-tour sur {way_name:article}",destination:"Faire demi-tour en direction {destination:preposition}"}},merge:{default:{default:"Sinsrer {modifier}",name:"Sinsrer {modifier} sur {way_name:article}",destination:"Sinsrer {modifier} en direction {destination:preposition}"},straight:{default:"Sinsrer",name:"Sinsrer sur {way_name:article}",destination:"Sinsrer en direction {destination:preposition}"},"slight left":{default:"Sinsrer lgrement  gauche",name:"Sinsrer lgrement  gauche sur {way_name:article}",destination:"Sinsrer lgrement  gauche en direction {destination:preposition}"},"slight right":{default:"Sinsrer lgrement  droite",name:"Sinsrer lgrement  droite sur {way_name:article}",destination:"Sinsrer  droite en direction {destination:preposition}"},"sharp left":{default:"Sinsrer  gauche",name:"Sinsrer  gauche sur {way_name:article}",destination:"Sinsrer  gauche en direction {destination:preposition}"},"sharp right":{default:"Sinsrer  droite",name:"Sinsrer  droite sur {way_name:article}",destination:"Sinsrer  droite en direction {destination:preposition}"},uturn:{default:"Faire demi-tour",name:"Faire demi-tour sur {way_name:article}",destination:"Faire demi-tour en direction {destination:preposition}"}},"new name":{default:{default:"Continuer {modifier}",name:"Continuer {modifier} sur {way_name:article}",destination:"Continuer {modifier} en direction {destination:preposition}"},straight:{default:"Continuer tout droit",name:"Continuer tout droit sur {way_name:article}",destination:"Continuer tout droit en direction {destination:preposition}"},"sharp left":{default:"Tourner franchement  gauche",name:"Tourner franchement  gauche sur {way_name:article}",destination:"Tourner franchement  gauche en direction {destination:preposition}"},"sharp right":{default:"Tourner franchement  droite",name:"Tourner franchement  droite sur {way_name:article}",destination:"Tourner franchement  droite en direction {destination:preposition}"},"slight left":{default:"Continuer lgrement  gauche",name:"Continuer lgrement  gauche sur {way_name:article}",destination:"Continuer lgrement  gauche en direction {destination:preposition}"},"slight right":{default:"Continuer lgrement  droite",name:"Continuer lgrement  droite sur {way_name:article}",destination:"Continuer lgrement  droite en direction {destination:preposition}"},uturn:{default:"Faire demi-tour",name:"Faire demi-tour sur {way_name:article}",destination:"Faire demi-tour en direction {destination:preposition}"}},notification:{default:{default:"Continuer {modifier}",name:"Continuer {modifier} sur {way_name:article}",destination:"Continuer {modifier} en direction {destination:preposition}"},uturn:{default:"Faire demi-tour",name:"Faire demi-tour sur {way_name:article}",destination:"Faire demi-tour en direction {destination:preposition}"}},"off ramp":{default:{default:"Prendre la sortie",name:"Prendre la sortie sur {way_name:article}",destination:"Prendre la sortie en direction {destination:preposition}",exit:"Prendre la sortie {exit}",exit_destination:"Prendre la sortie {exit} en direction {destination:preposition}"},left:{default:"Prendre la sortie  gauche",name:"Prendre la sortie  gauche sur {way_name:article}",destination:"Prendre la sortie  gauche en direction {destination:preposition}",exit:"Prendre la sortie {exit} sur la gauche",exit_destination:"Prendre la sortie {exit} sur la gauche en direction {destination:preposition}"},right:{default:"Prendre la sortie  droite",name:"Prendre la sortie  droite sur {way_name:article}",destination:"Prendre la sortie  droite en direction {destination:preposition}",exit:"Prendre la sortie {exit} sur la droite",exit_destination:"Prendre la sortie {exit} sur la droite en direction {destination:preposition}"},"sharp left":{default:"Prendre la sortie  gauche",name:"Prendre la sortie  gauche sur {way_name:article}",destination:"Prendre la sortie  gauche en direction {destination:preposition}",exit:"Prendre la sortie {exit} sur la gauche",exit_destination:"Prendre la sortie {exit} sur la gauche en direction {destination:preposition}"},"sharp right":{default:"Prendre la sortie  droite",name:"Prendre la sortie  droite sur {way_name:article}",destination:"Prendre la sortie  droite en direction {destination:preposition}",exit:"Prendre la sortie {exit} sur la droite",exit_destination:"Prendre la sortie {exit} sur la droite en direction {destination:preposition}"},"slight left":{default:"Prendre la sortie  gauche",name:"Prendre la sortie  gauche sur {way_name:article}",destination:"Prendre la sortie  gauche en direction {destination:preposition}",exit:"Prendre la sortie {exit} sur la gauche",exit_destination:"Prendre la sortie {exit} sur la gauche en direction {destination:preposition}"},"slight right":{default:"Prendre la sortie  droite",name:"Prendre la sortie  droite sur {way_name:article}",destination:"Prendre la sortie  droite en direction {destination:preposition}",exit:"Prendre la sortie {exit} sur la droite",exit_destination:"Prendre la sortie {exit} sur la droite en direction {destination:preposition}"}},"on ramp":{default:{default:"Prendre la sortie",name:"Prendre la sortie sur {way_name:article}",destination:"Prendre la sortie en direction {destination:preposition}"},left:{default:"Prendre la sortie  gauche",name:"Prendre la sortie  gauche sur {way_name:article}",destination:"Prendre la sortie  gauche en direction {destination:preposition}"},right:{default:"Prendre la sortie  droite",name:"Prendre la sortie  droite sur {way_name:article}",destination:"Prendre la sortie  droite en direction {destination:preposition}"},"sharp left":{default:"Prendre la sortie  gauche",name:"Prendre la sortie  gauche sur {way_name:article}",destination:"Prendre la sortie  gauche en direction {destination:preposition}"},"sharp right":{default:"Prendre la sortie  droite",name:"Prendre la sortie  droite sur {way_name:article}",destination:"Prendre la sortie  droite en direction {destination:preposition}"},"slight left":{default:"Prendre la sortie  gauche",name:"Prendre la sortie  gauche sur {way_name:article}",destination:"Prendre la sortie  gauche en direction {destination:preposition}"},"slight right":{default:"Prendre la sortie  droite",name:"Prendre la sortie  droite sur {way_name:article}",destination:"Prendre la sortie  droite en direction {destination:preposition}"}},rotary:{default:{default:{default:"Prendre le rond-point",name:"Prendre le rond-point, puis sortir sur {way_name:article}",destination:"Prendre le rond-point, puis sortir en direction {destination:preposition}"},name:{default:"Prendre {rotary_name:rotary}",name:"Prendre {rotary_name:rotary}, puis sortir par {way_name:article}",destination:"Prendre {rotary_name:rotary}, puis sortir en direction {destination:preposition}"},exit:{default:"Prendre le rond-point, puis la {exit_number} sortie",name:"Prendre le rond-point, puis la {exit_number} sortie sur {way_name:article}",destination:"Prendre le rond-point, puis la {exit_number} sortie en direction {destination:preposition}"},name_exit:{default:"Prendre {rotary_name:rotary}, puis la {exit_number} sortie",name:"Prendre {rotary_name:rotary}, puis la {exit_number} sortie sur {way_name:article}",destination:"Prendre {rotary_name:rotary}, puis la {exit_number} sortie en direction {destination:preposition}"}}},roundabout:{default:{exit:{default:"Prendre le rond-point, puis la {exit_number} sortie",name:"Prendre le rond-point, puis la {exit_number} sortie sur {way_name:article}",destination:"Prendre le rond-point, puis la {exit_number} sortie en direction {destination:preposition}"},default:{default:"Prendre le rond-point",name:"Prendre le rond-point, puis sortir sur {way_name:article}",destination:"Prendre le rond-point, puis sortir en direction {destination:preposition}"}}},"roundabout turn":{default:{default:"Tourner {modifier}",name:"Tourner {modifier} sur {way_name:article}",destination:"Tourner {modifier} en direction {destination:preposition}"},left:{default:"Tourner  gauche",name:"Tourner  gauche sur {way_name:article}",destination:"Tourner  gauche en direction {destination:preposition}"},right:{default:"Tourner  droite",name:"Tourner  droite sur {way_name:article}",destination:"Tourner  droite en direction {destination:preposition}"},straight:{default:"Continuer tout droit",name:"Continuer tout droit sur {way_name:article}",destination:"Continuer tout droit en direction {destination:preposition}"}},"exit roundabout":{default:{default:"Sortir du rond-point",name:"Sortir du rond-point sur {way_name:article}",destination:"Sortir du rond-point en direction {destination:preposition}"}},"exit rotary":{default:{default:"Sortir du rond-point",name:"Sortir du rond-point sur {way_name:article}",destination:"Sortir du rond-point en direction {destination:preposition}"}},turn:{default:{default:"Tourner {modifier}",name:"Tourner {modifier} sur {way_name:article}",destination:"Tourner {modifier} en direction {destination:preposition}"},left:{default:"Tourner  gauche",name:"Tourner  gauche sur {way_name:article}",destination:"Tourner  gauche en direction {destination:preposition}"},right:{default:"Tourner  droite",name:"Tourner  droite sur {way_name:article}",destination:"Tourner  droite en direction {destination:preposition}"},straight:{default:"Aller tout droit",name:"Aller tout droit sur {way_name:article}",destination:"Aller tout droit en direction {destination:preposition}"}},"use lane":{no_lanes:{default:"Continuer tout droit"},default:{default:"{lane_instruction}"}}}}},{}],31:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:""},direction:{north:"",northeast:" ",east:"",southeast:" ",south:"",southwest:" ",west:"",northwest:" "},modifier:{left:"",right:"","sharp left":" ","sharp right":" ","slight left":" ","slight right":" ",straight:"",uturn:" "},lanes:{xo:" ",ox:" ",xox:"  ",oxo:"   "}},modes:{ferry:{default:"  ",name:"   {way_name}",destination:"    {destination}"}},phrase:{"two linked by distance":"{instruction_one}, , {distance}, {instruction_two}","two linked":"{instruction_one},  {instruction_two}","one in distance":" {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":" {exit}"},arrive:{default:{default:"   {nth} ",upcoming:"    {nth} ",short:"","short-upcoming":"",named:"  {waypoint_name}"},left:{default:"   {nth}  ",upcoming:"    {nth}  ",short:"","short-upcoming":"",named:"  {waypoint_name}  "},right:{default:"   {nth}  ",upcoming:"    {nth}  ",short:"","short-upcoming":"",named:"  {waypoint_name}  "},"sharp left":{default:"   {nth}  ",upcoming:"    {nth}  ",short:"","short-upcoming":"",named:"  {waypoint_name}  "},"sharp right":{default:"   {nth}  ",upcoming:"    {nth}  ",short:"","short-upcoming":"",named:"  {waypoint_name}  "},"slight right":{default:"   {nth}  ",upcoming:"    {nth}  ",short:"","short-upcoming":"",named:"  {waypoint_name}  "},"slight left":{default:"   {nth}  ",upcoming:"    {nth}  ",short:"","short-upcoming":"",named:"  {waypoint_name}  "},straight:{default:"   {nth} , ",upcoming:"    {nth} , ",short:"","short-upcoming":"",named:"  {waypoint_name}, "}},continue:{default:{default:" {modifier}",name:" {modifier}   {way_name}",destination:" {modifier}  {destination}",exit:" {modifier}  {way_name}"},straight:{default:" ",name:"     {way_name}",destination:"  {destination}",distance:"   {distance}",namedistance:"  {way_name}  {distance}"},"sharp left":{default:"  ",name:"      {way_name}",destination:"    {destination}"},"sharp right":{default:"  ",name:"      {way_name}",destination:"    {destination}"},"slight left":{default:"  ",name:"      {way_name}",destination:"    {destination}"},"slight right":{default:"  ",name:"      {way_name}",destination:"    {destination}"},uturn:{default:"  ",name:"     {way_name}",destination:"    {destination}"}},depart:{default:{default:" {direction}",name:" {direction}  {way_name}",namedistance:" {direction}  {way_name}  {distance}"}},"end of road":{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}  {destination}"},straight:{default:" ",name:"   {way_name}",destination:"   {destination}"},uturn:{default:"    ",name:"    {way_name}  ",destination:"    {destination}  "}},fork:{default:{default:" {modifier} ",name:" {modifier}  {way_name}",destination:" {modifier}  {destination}"},"slight left":{default:"  ",name:"   {way_name}",destination:"   {destination}"},"slight right":{default:"  ",name:"   {way_name}",destination:"   {destination}"},"sharp left":{default:"   ",name:"    {way_name}",destination:"    {destination}"},"sharp right":{default:"   ",name:"    {way_name}",destination:"    {destination}"},uturn:{default:"  ",name:"    {way_name}",destination:"    {destination}"}},merge:{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}  {destination}"},straight:{default:"",name:"  {way_name}",destination:"  {destination}"},"slight left":{default:" ",name:"   {way_name}",destination:"   {destination}"},"slight right":{default:" ",name:"   {way_name}",destination:"   {destination}"},"sharp left":{default:" ",name:"   {way_name}",destination:"   {destination}"},"sharp right":{default:" ",name:"   {way_name}",destination:"   {destination}"},uturn:{default:"  ",name:"    {way_name}",destination:"    {destination}"}},"new name":{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}  {destination}"},straight:{default:" ",name:"  {way_name}",destination:"  {destination}"},"sharp left":{default:"  ",name:"    {way_name}",destination:"    {destination}"},"sharp right":{default:"  ",name:"    {way_name}",destination:"    {destination}"},"slight left":{default:"   ",name:"     {way_name}",destination:"     {destination}"},"slight right":{default:"   ",name:"     {way_name}",destination:"     {destination}"},uturn:{default:"  ",name:"    {way_name}",destination:"    {destination}"}},notification:{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}  {destination}"},uturn:{default:"  ",name:"    {way_name}",destination:"    {destination}"}},"off ramp":{default:{default:" ",name:"   {way_name}",destination:"   {destination}",exit:"  {exit}",exit_destination:"  {exit}  {destination}"},left:{default:"  ",name:"    {way_name}",destination:"    {destination}",exit:"  {exit} ",exit_destination:"  {exit}   {destination}"},right:{default:"  ",name:"    {way_name}",destination:"    {destination}",exit:"  {exit} ",exit_destination:"  {exit}   {destination}"},"sharp left":{default:"  ",name:"    {way_name}",destination:"    {destination}",exit:"  {exit} ",exit_destination:"  {exit}   {destination}"},"sharp right":{default:"  ",name:"    {way_name}",destination:"    {destination}",exit:"  {exit} ",exit_destination:"  {exit}   {destination}"},"slight left":{default:"  ",name:"    {way_name}",destination:"    {destination}",exit:"  {exit} ",exit_destination:"  {exit}   {destination}"},"slight right":{default:"  ",name:"    {way_name}",destination:"    {destination}",exit:"  {exit} ",exit_destination:"  {exit}   {destination}"}},"on ramp":{default:{default:" ",name:"   {way_name}",destination:"   {destination}"},left:{default:"  ",name:"    {way_name}",destination:"    {destination}"},right:{default:"  ",name:"    {way_name}",destination:"    {destination}"},"sharp left":{default:"  ",name:"    {way_name}",destination:"    {destination}"},"sharp right":{default:"  ",name:"    {way_name}",destination:"    {destination}"},"slight left":{default:"  ",name:"    {way_name}",destination:"    {destination}"},"slight right":{default:"  ",name:"    {way_name}",destination:"    {destination}"}},rotary:{default:{default:{default:"  ",name:"     {way_name}",destination:"     {destination}"},name:{default:" {rotary_name}",name:" {rotary_name}   {way_name}",destination:" {rotary_name}   {destination}"},exit:{default:"     {exit_number}",name:"     {exit_number} {way_name}",destination:"     {exit_number}  {destination}"},name_exit:{default:" {rotary_name}   {exit_number}",name:" {rotary_name}   {exit_number} {way_name}",destination:" {rotary_name}   {exit_number}  {destination}"}}},roundabout:{default:{exit:{default:"     {exit_number}",name:"     {exit_number} {way_name}",destination:"     {exit_number}  {destination}"},default:{default:"  ",name:"     {way_name}",destination:"     {destination}"}}},"roundabout turn":{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}  {destination}"},left:{default:" ",name:"  {way_name}",destination:"   {destination}"},right:{default:" ",name:"  {way_name}",destination:"   {destination}"},straight:{default:" ",name:"   {way_name}",destination:"   {destination}"}},"exit roundabout":{default:{default:"  ",name:"   {way_name}",destination:"    {destination}"}},"exit rotary":{default:{default:"  ",name:"   {way_name}",destination:"    {destination}"}},turn:{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}  {destination}"},left:{default:" ",name:"  {way_name}",destination:"   {destination}"},right:{default:" ",name:"  {way_name}",destination:"   {destination}"},straight:{default:" ",name:"  {way_name}",destination:"   {destination}"}},"use lane":{no_lanes:{default:" "},default:{default:"{lane_instruction}"}}}}},{}],32:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"},direction:{north:"utara",northeast:"timur laut",east:"timur",southeast:"tenggara",south:"selatan",southwest:"barat daya",west:"barat",northwest:"barat laut"},modifier:{left:"kiri",right:"kanan","sharp left":"tajam kiri","sharp right":"tajam kanan","slight left":"agak ke kiri","slight right":"agak ke kanan",straight:"lurus",uturn:"putar balik"},lanes:{xo:"Tetap di kanan",ox:"Tetap di kiri",xox:"Tetap di tengah",oxo:"Tetap di kiri atau kanan"}},modes:{ferry:{default:"Naik ferry",name:"Naik ferry di {way_name}",destination:"Naik ferry menuju {destination}"}},phrase:{"two linked by distance":"{instruction_one}, then, in {distance}, {instruction_two}","two linked":"{instruction_one}, then {instruction_two}","one in distance":"In {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"exit {exit}"},arrive:{default:{default:"Anda telah tiba di tujuan ke-{nth}",upcoming:"Anda telah tiba di tujuan ke-{nth}",short:"Anda telah tiba di tujuan ke-{nth}","short-upcoming":"Anda telah tiba di tujuan ke-{nth}",named:"Anda telah tiba di {waypoint_name}"},left:{default:"Anda telah tiba di tujuan ke-{nth}, di sebelah kiri",upcoming:"Anda telah tiba di tujuan ke-{nth}, di sebelah kiri",short:"Anda telah tiba di tujuan ke-{nth}","short-upcoming":"Anda telah tiba di tujuan ke-{nth}",named:"Anda telah tiba di {waypoint_name}, di sebelah kiri"},right:{default:"Anda telah tiba di tujuan ke-{nth}, di sebelah kanan",upcoming:"Anda telah tiba di tujuan ke-{nth}, di sebelah kanan",short:"Anda telah tiba di tujuan ke-{nth}","short-upcoming":"Anda telah tiba di tujuan ke-{nth}",named:"Anda telah tiba di {waypoint_name}, di sebelah kanan"},"sharp left":{default:"Anda telah tiba di tujuan ke-{nth}, di sebelah kiri",upcoming:"Anda telah tiba di tujuan ke-{nth}, di sebelah kiri",short:"Anda telah tiba di tujuan ke-{nth}","short-upcoming":"Anda telah tiba di tujuan ke-{nth}",named:"Anda telah tiba di {waypoint_name}, di sebelah kiri"},"sharp right":{default:"Anda telah tiba di tujuan ke-{nth}, di sebelah kanan",upcoming:"Anda telah tiba di tujuan ke-{nth}, di sebelah kanan",short:"Anda telah tiba di tujuan ke-{nth}","short-upcoming":"Anda telah tiba di tujuan ke-{nth}",named:"Anda telah tiba di {waypoint_name}, di sebelah kanan"},"slight right":{default:"Anda telah tiba di tujuan ke-{nth}, di sebelah kanan",upcoming:"Anda telah tiba di tujuan ke-{nth}, di sebelah kanan",short:"Anda telah tiba di tujuan ke-{nth}","short-upcoming":"Anda telah tiba di tujuan ke-{nth}",named:"Anda telah tiba di {waypoint_name}, di sebelah kanan"},"slight left":{default:"Anda telah tiba di tujuan ke-{nth}, di sebelah kiri",upcoming:"Anda telah tiba di tujuan ke-{nth}, di sebelah kiri",short:"Anda telah tiba di tujuan ke-{nth}","short-upcoming":"Anda telah tiba di tujuan ke-{nth}",named:"Anda telah tiba di {waypoint_name}, di sebelah kiri"},straight:{default:"Anda telah tiba di tujuan ke-{nth}, lurus saja",upcoming:"Anda telah tiba di tujuan ke-{nth}, lurus saja",short:"Anda telah tiba di tujuan ke-{nth}","short-upcoming":"Anda telah tiba di tujuan ke-{nth}",named:"Anda telah tiba di {waypoint_name}, lurus saja"}},continue:{default:{default:"Belok {modifier}",name:"Terus {modifier} ke {way_name}",destination:"Belok {modifier} menuju {destination}",exit:"Belok {modifier} ke {way_name}"},straight:{default:"Lurus terus",name:"Terus ke {way_name}",destination:"Terus menuju {destination}",distance:"Continue straight for {distance}",namedistance:"Continue on {way_name} for {distance}"},"sharp left":{default:"Belok kiri tajam",name:"Make a sharp left to stay on {way_name}",destination:"Belok kiri tajam menuju {destination}"},"sharp right":{default:"Belok kanan tajam",name:"Make a sharp right to stay on {way_name}",destination:"Belok kanan tajam menuju {destination}"},"slight left":{default:"Tetap agak di kiri",name:"Tetap agak di kiri ke {way_name}",destination:"Tetap agak di kiri menuju {destination}"},"slight right":{default:"Tetap agak di kanan",name:"Tetap agak di kanan ke {way_name}",destination:"Tetap agak di kanan menuju {destination}"},uturn:{default:"Putar balik",name:"Putar balik ke arah {way_name}",destination:"Putar balik menuju {destination}"}},depart:{default:{default:"Arah {direction}",name:"Arah {direction} di {way_name}",namedistance:"Head {direction} on {way_name} for {distance}"}},"end of road":{default:{default:"Belok {modifier}",name:"Belok {modifier} ke {way_name}",destination:"Belok {modifier} menuju {destination}"},straight:{default:"Lurus terus",name:"Tetap lurus ke {way_name} ",destination:"Tetap lurus menuju {destination}"},uturn:{default:"Putar balik di akhir jalan",name:"Putar balik di {way_name} di akhir jalan",destination:"Putar balik menuju {destination} di akhir jalan"}},fork:{default:{default:"Tetap {modifier} di pertigaan",name:"Tetap {modifier} di pertigaan ke {way_name}",destination:"Tetap {modifier} di pertigaan menuju {destination}"},"slight left":{default:"Tetap di kiri pada pertigaan",name:"Tetap di kiri pada pertigaan ke arah {way_name}",destination:"Tetap di kiri pada pertigaan menuju {destination}"},"slight right":{default:"Tetap di kanan pada pertigaan",name:"Tetap di kanan pada pertigaan ke arah {way_name}",destination:"Tetap di kanan pada pertigaan menuju {destination}"},"sharp left":{default:"Belok kiri pada pertigaan",name:"Belok kiri tajam ke arah {way_name}",destination:"Belok kiri tajam menuju {destination}"},"sharp right":{default:"Belok kanan pada pertigaan",name:"Belok kanan tajam ke arah {way_name}",destination:"Belok kanan tajam menuju {destination}"},uturn:{default:"Putar balik",name:"Putar balik ke arah {way_name}",destination:"Putar balik menuju {destination}"}},merge:{default:{default:"Bergabung {modifier}",name:"Bergabung {modifier} ke arah {way_name}",destination:"Bergabung {modifier} menuju {destination}"},straight:{default:"Bergabung lurus",name:"Bergabung lurus ke arah {way_name}",destination:"Bergabung lurus menuju {destination}"},"slight left":{default:"Bergabung di kiri",name:"Bergabung di kiri ke arah {way_name}",destination:"Bergabung di kiri menuju {destination}"},"slight right":{default:"Bergabung di kanan",name:"Bergabung di kanan ke arah {way_name}",destination:"Bergabung di kanan menuju {destination}"},"sharp left":{default:"Bergabung di kiri",name:"Bergabung di kiri ke arah {way_name}",destination:"Bergabung di kiri menuju {destination}"},"sharp right":{default:"Bergabung di kanan",name:"Bergabung di kanan ke arah {way_name}",destination:"Bergabung di kanan menuju {destination}"},uturn:{default:"Putar balik",name:"Putar balik ke arah {way_name}",destination:"Putar balik menuju {destination}"}},"new name":{default:{default:"Lanjutkan {modifier}",name:"Lanjutkan {modifier} menuju {way_name}",destination:"Lanjutkan {modifier} menuju {destination}"},straight:{default:"Lurus terus",name:"Terus ke {way_name}",destination:"Terus menuju {destination}"},"sharp left":{default:"Belok kiri tajam",name:"Belok kiri tajam ke arah {way_name}",destination:"Belok kiri tajam menuju {destination}"},"sharp right":{default:"Belok kanan tajam",name:"Belok kanan tajam ke arah {way_name}",destination:"Belok kanan tajam menuju {destination}"},"slight left":{default:"Lanjut dengan agak ke kiri",name:"Lanjut dengan agak di kiri ke {way_name}",destination:"Tetap agak di kiri menuju {destination}"},"slight right":{default:"Tetap agak di kanan",name:"Tetap agak di kanan ke {way_name}",destination:"Tetap agak di kanan menuju {destination}"},uturn:{default:"Putar balik",name:"Putar balik ke arah {way_name}",destination:"Putar balik menuju {destination}"}},notification:{default:{default:"Lanjutkan {modifier}",name:"Lanjutkan {modifier} menuju {way_name}",destination:"Lanjutkan {modifier} menuju {destination}"},uturn:{default:"Putar balik",name:"Putar balik ke arah {way_name}",destination:"Putar balik menuju {destination}"}},"off ramp":{default:{default:"Ambil jalan melandai",name:"Ambil jalan melandai ke {way_name}",destination:"Ambil jalan melandai menuju {destination}",exit:"Take exit {exit}",exit_destination:"Take exit {exit} towards {destination}"},left:{default:"Ambil jalan yang melandai di sebelah kiri",name:"Ambil jalan melandai di sebelah kiri ke arah {way_name}",destination:"Ambil jalan melandai di sebelah kiri menuju {destination}",exit:"Take exit {exit} on the left",exit_destination:"Take exit {exit} on the left towards {destination}"},right:{default:"Ambil jalan melandai di sebelah kanan",name:"Ambil jalan melandai di sebelah kanan ke {way_name}",destination:"Ambil jalan melandai di sebelah kanan menuju {destination}",exit:"Take exit {exit} on the right",exit_destination:"Take exit {exit} on the right towards {destination}"},"sharp left":{default:"Ambil jalan yang melandai di sebelah kiri",name:"Ambil jalan melandai di sebelah kiri ke arah {way_name}",destination:"Ambil jalan melandai di sebelah kiri menuju {destination}",exit:"Take exit {exit} on the left",exit_destination:"Take exit {exit} on the left towards {destination}"},"sharp right":{default:"Ambil jalan melandai di sebelah kanan",name:"Ambil jalan melandai di sebelah kanan ke {way_name}",destination:"Ambil jalan melandai di sebelah kanan menuju {destination}",exit:"Take exit {exit} on the right",exit_destination:"Take exit {exit} on the right towards {destination}"},"slight left":{default:"Ambil jalan yang melandai di sebelah kiri",name:"Ambil jalan melandai di sebelah kiri ke arah {way_name}",destination:"Ambil jalan melandai di sebelah kiri menuju {destination}",exit:"Take exit {exit} on the left",exit_destination:"Take exit {exit} on the left towards {destination}"},"slight right":{default:"Ambil jalan melandai di sebelah kanan",name:"Ambil jalan melandai di sebelah kanan ke {way_name}",destination:"Ambil jalan melandai di sebelah kanan  menuju {destination}",exit:"Take exit {exit} on the right",exit_destination:"Take exit {exit} on the right towards {destination}"}},"on ramp":{default:{default:"Ambil jalan melandai",name:"Ambil jalan melandai ke {way_name}",destination:"Ambil jalan melandai menuju {destination}"},left:{default:"Ambil jalan yang melandai di sebelah kiri",name:"Ambil jalan melandai di sebelah kiri ke arah {way_name}",destination:"Ambil jalan melandai di sebelah kiri menuju {destination}"},right:{default:"Ambil jalan melandai di sebelah kanan",name:"Ambil jalan melandai di sebelah kanan ke {way_name}",destination:"Ambil jalan melandai di sebelah kanan  menuju {destination}"},"sharp left":{default:"Ambil jalan yang melandai di sebelah kiri",name:"Ambil jalan melandai di sebelah kiri ke arah {way_name}",destination:"Ambil jalan melandai di sebelah kiri menuju {destination}"},"sharp right":{default:"Ambil jalan melandai di sebelah kanan",name:"Ambil jalan melandai di sebelah kanan ke {way_name}",destination:"Ambil jalan melandai di sebelah kanan  menuju {destination}"},"slight left":{default:"Ambil jalan yang melandai di sebelah kiri",name:"Ambil jalan melandai di sebelah kiri ke arah {way_name}",destination:"Ambil jalan melandai di sebelah kiri menuju {destination}"},"slight right":{default:"Ambil jalan melandai di sebelah kanan",name:"Ambil jalan melandai di sebelah kanan ke {way_name}",destination:"Ambil jalan melandai di sebelah kanan  menuju {destination}"}},rotary:{default:{default:{default:"Masuk bundaran",name:"Masuk bundaran dan keluar arah {way_name}",destination:"Masuk bundaran dan keluar menuju {destination}"},name:{default:"Masuk {rotary_name}",name:"Masuk {rotary_name} dan keluar arah {way_name}",destination:"Masuk {rotary_name} dan keluar menuju {destination}"},exit:{default:"Masuk bundaran dan ambil jalan keluar {exit_number}",name:"Masuk bundaran dan ambil jalan keluar {exit_number} arah {way_name}",destination:"Masuk bundaran dan ambil jalan keluar {exit_number} menuju {destination}"},name_exit:{default:"Masuk {rotary_name} dan ambil jalan keluar {exit_number}",name:"Masuk {rotary_name} dan ambil jalan keluar {exit_number} arah {way_name}",destination:"Masuk {rotary_name} dan ambil jalan keluar {exit_number} menuju {destination}"}}},roundabout:{default:{exit:{default:"Masuk bundaran dan ambil jalan keluar {exit_number}",name:"Masuk bundaran dan ambil jalan keluar {exit_number} arah {way_name}",destination:"Masuk bundaran dan ambil jalan keluar {exit_number} menuju {destination}"},default:{default:"Masuk bundaran",name:"Masuk bundaran dan keluar arah {way_name}",destination:"Masuk bundaran dan keluar menuju {destination}"}}},"roundabout turn":{default:{default:"Lakukan {modifier}",name:"Lakukan {modifier} ke arah {way_name}",destination:"Lakukan {modifier} menuju {destination}"},left:{default:"Belok kiri",name:"Belok kiri ke {way_name}",destination:"Belok kiri menuju {destination}"},right:{default:"Belok kanan",name:"Belok kanan ke {way_name}",destination:"Belok kanan menuju {destination}"},straight:{default:"Lurus terus",name:"Tetap lurus ke {way_name} ",destination:"Tetap lurus menuju {destination}"}},"exit roundabout":{default:{default:"Lakukan {modifier}",name:"Lakukan {modifier} ke arah {way_name}",destination:"Lakukan {modifier} menuju {destination}"},left:{default:"Belok kiri",name:"Belok kiri ke {way_name}",destination:"Belok kiri menuju {destination}"},right:{default:"Belok kanan",name:"Belok kanan ke {way_name}",destination:"Belok kanan menuju {destination}"},straight:{default:"Lurus terus",name:"Tetap lurus ke {way_name} ",destination:"Tetap lurus menuju {destination}"}},"exit rotary":{default:{default:"Lakukan {modifier}",name:"Lakukan {modifier} ke arah {way_name}",destination:"Lakukan {modifier} menuju {destination}"},left:{default:"Belok kiri",name:"Belok kiri ke {way_name}",destination:"Belok kiri menuju {destination}"},right:{default:"Belok kanan",name:"Belok kanan ke {way_name}",destination:"Belok kanan menuju {destination}"},straight:{default:"Lurus",name:"Lurus arah {way_name}",destination:"Lurus menuju {destination}"}},turn:{default:{default:"Lakukan {modifier}",name:"Lakukan {modifier} ke arah {way_name}",destination:"Lakukan {modifier} menuju {destination}"},left:{default:"Belok kiri",name:"Belok kiri ke {way_name}",destination:"Belok kiri menuju {destination}"},right:{default:"Belok kanan",name:"Belok kanan ke {way_name}",destination:"Belok kanan menuju {destination}"},straight:{default:"Lurus",name:"Lurus arah {way_name}",destination:"Lurus menuju {destination}"}},"use lane":{no_lanes:{default:"Lurus terus"},default:{default:"{lane_instruction}"}}}}},{}],33:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"},direction:{north:"nord",northeast:"nord-est",east:"est",southeast:"sud-est",south:"sud",southwest:"sud-ovest",west:"ovest",northwest:"nord-ovest"},modifier:{left:"sinistra",right:"destra","sharp left":"sinistra","sharp right":"destra","slight left":"sinistra leggermente","slight right":"destra leggermente",straight:"dritto",uturn:"inversione a U"},lanes:{xo:"Mantieni la destra",ox:"Mantieni la sinistra",xox:"Rimani in mezzo",oxo:"Mantieni la destra o la sinistra"}},modes:{ferry:{default:"Prendi il traghetto",name:"Prendi il traghetto {way_name}",destination:"Prendi il traghetto verso {destination}"}},phrase:{"two linked by distance":"{instruction_one}, poi tra {distance},{instruction_two}","two linked":"{instruction_one}, poi {instruction_two}","one in distance":"tra {distance} {instruction_one}","name and ref":"{name} ({ref})","exit with number":"exit {exit}"},arrive:{default:{default:"Sei arrivato alla tua {nth} destinazione",upcoming:"Sei arrivato alla tua {nth} destinazione",short:"Sei arrivato alla tua {nth} destinazione","short-upcoming":"Sei arrivato alla tua {nth} destinazione",named:"Sei arrivato a {waypoint_name}"},left:{default:"sei arrivato alla tua {nth} destinazione, sulla sinistra",upcoming:"sei arrivato alla tua {nth} destinazione, sulla sinistra",short:"Sei arrivato alla tua {nth} destinazione","short-upcoming":"Sei arrivato alla tua {nth} destinazione",named:"sei arrivato a {waypoint_name}, sulla sinistra"},right:{default:"sei arrivato alla tua {nth} destinazione, sulla destra",upcoming:"sei arrivato alla tua {nth} destinazione, sulla destra",short:"Sei arrivato alla tua {nth} destinazione","short-upcoming":"Sei arrivato alla tua {nth} destinazione",named:"sei arrivato a {waypoint_name}, sulla destra"},"sharp left":{default:"sei arrivato alla tua {nth} destinazione, sulla sinistra",upcoming:"sei arrivato alla tua {nth} destinazione, sulla sinistra",short:"Sei arrivato alla tua {nth} destinazione","short-upcoming":"Sei arrivato alla tua {nth} destinazione",named:"sei arrivato a {waypoint_name}, sulla sinistra"},"sharp right":{default:"sei arrivato alla tua {nth} destinazione, sulla destra",upcoming:"sei arrivato alla tua {nth} destinazione, sulla destra",short:"Sei arrivato alla tua {nth} destinazione","short-upcoming":"Sei arrivato alla tua {nth} destinazione",named:"sei arrivato a {waypoint_name}, sulla destra"},"slight right":{default:"sei arrivato alla tua {nth} destinazione, sulla destra",upcoming:"sei arrivato alla tua {nth} destinazione, sulla destra",short:"Sei arrivato alla tua {nth} destinazione","short-upcoming":"Sei arrivato alla tua {nth} destinazione",named:"sei arrivato a {waypoint_name}, sulla destra"},"slight left":{default:"sei arrivato alla tua {nth} destinazione, sulla sinistra",upcoming:"sei arrivato alla tua {nth} destinazione, sulla sinistra",short:"Sei arrivato alla tua {nth} destinazione","short-upcoming":"Sei arrivato alla tua {nth} destinazione",named:"sei arrivato a {waypoint_name}, sulla sinistra"},straight:{default:"sei arrivato alla tua {nth} destinazione, si trova davanti a te",upcoming:"sei arrivato alla tua {nth} destinazione, si trova davanti a te",short:"Sei arrivato alla tua {nth} destinazione","short-upcoming":"Sei arrivato alla tua {nth} destinazione",named:"sei arrivato a {waypoint_name}, si trova davanti a te"}},continue:{default:{default:"Gira a {modifier}",name:"Gira a {modifier} per stare su {way_name}",destination:"Gira a {modifier} verso {destination}",exit:"Gira a {modifier} in {way_name}"},straight:{default:"Continua dritto",name:"Continua dritto per stare su {way_name}",destination:"Continua verso {destination}",distance:"Continua dritto per {distance}",namedistance:"Continua su {way_name} per {distance}"},"sharp left":{default:"Svolta a sinistra",name:"Fai una stretta curva a sinistra per stare su {way_name}",destination:"Svolta a sinistra verso {destination}"},"sharp right":{default:"Svolta a destra",name:"Fau una stretta curva a destra per stare su {way_name}",destination:"Svolta a destra verso {destination}"},"slight left":{default:"Fai una leggera curva a sinistra",name:"Fai una leggera curva a sinistra per stare su {way_name}",destination:"Fai una leggera curva a sinistra verso {destination}"},"slight right":{default:"Fai una leggera curva a destra",name:"Fai una leggera curva a destra per stare su {way_name}",destination:"Fai una leggera curva a destra verso {destination}"},uturn:{default:"Fai un'inversione a U",name:"Fai un'inversione ad U poi continua su {way_name}",destination:"Fai un'inversione a U verso {destination}"}},depart:{default:{default:"Continua verso {direction}",name:"Continua verso {direction} in {way_name}",namedistance:"Head {direction} on {way_name} for {distance}"}},"end of road":{default:{default:"Gira a {modifier}",name:"Gira a {modifier} in {way_name}",destination:"Gira a {modifier} verso {destination}"},straight:{default:"Continua dritto",name:"Continua dritto in {way_name}",destination:"Continua dritto verso {destination}"},uturn:{default:"Fai un'inversione a U alla fine della strada",name:"Fai un'inversione a U in {way_name} alla fine della strada",destination:"Fai un'inversione a U verso {destination} alla fine della strada"}},fork:{default:{default:"Mantieni la {modifier} al bivio",name:"Mantieni la {modifier} al bivio in {way_name}",destination:"Mantieni la {modifier} al bivio verso {destination}"},"slight left":{default:"Mantieni la sinistra al bivio",name:"Mantieni la sinistra al bivio in {way_name}",destination:"Mantieni la sinistra al bivio verso {destination}"},"slight right":{default:"Mantieni la destra al bivio",name:"Mantieni la destra al bivio in {way_name}",destination:"Mantieni la destra al bivio verso {destination}"},"sharp left":{default:"Svolta a sinistra al bivio",name:"Svolta a sinistra in {way_name}",destination:"Svolta a sinistra verso {destination}"},"sharp right":{default:"Svolta a destra al bivio",name:"Svolta a destra in {way_name}",destination:"Svolta a destra verso {destination}"},uturn:{default:"Fai un'inversione a U",name:"Fai un'inversione a U in {way_name}",destination:"Fai un'inversione a U verso {destination}"}},merge:{default:{default:"Immettiti a {modifier}",name:"Immettiti {modifier} in {way_name}",destination:"Immettiti {modifier} verso {destination}"},straight:{default:"Immettiti a dritto",name:"Immettiti dritto in {way_name}",destination:"Immettiti dritto verso {destination}"},"slight left":{default:"Immettiti a sinistra",name:"Immettiti a sinistra in {way_name}",destination:"Immettiti a sinistra verso {destination}"},"slight right":{default:"Immettiti a destra",name:"Immettiti a destra in {way_name}",destination:"Immettiti a destra verso {destination}"},"sharp left":{default:"Immettiti a sinistra",name:"Immettiti a sinistra in {way_name}",destination:"Immettiti a sinistra verso {destination}"},"sharp right":{default:"Immettiti a destra",name:"Immettiti a destra in {way_name}",destination:"Immettiti a destra verso {destination}"},uturn:{default:"Fai un'inversione a U",name:"Fai un'inversione a U in {way_name}",destination:"Fai un'inversione a U verso {destination}"}},"new name":{default:{default:"Continua a {modifier}",name:"Continua a {modifier} in {way_name}",destination:"Continua a {modifier} verso {destination}"},straight:{default:"Continua dritto",name:"Continua in {way_name}",destination:"Continua verso {destination}"},"sharp left":{default:"Svolta a sinistra",name:"Svolta a sinistra in {way_name}",destination:"Svolta a sinistra verso {destination}"},"sharp right":{default:"Svolta a destra",name:"Svolta a destra in {way_name}",destination:"Svolta a destra verso {destination}"},"slight left":{default:"Continua leggermente a sinistra",name:"Continua leggermente a sinistra in {way_name}",destination:"Continua leggermente a sinistra verso {destination}"},"slight right":{default:"Continua leggermente a destra",name:"Continua leggermente a destra in {way_name} ",destination:"Continua leggermente a destra verso {destination}"},uturn:{default:"Fai un'inversione a U",name:"Fai un'inversione a U in {way_name}",destination:"Fai un'inversione a U verso {destination}"}},notification:{default:{default:"Continua a {modifier}",name:"Continua a {modifier} in {way_name}",destination:"Continua a {modifier} verso {destination}"},uturn:{default:"Fai un'inversione a U",name:"Fai un'inversione a U in {way_name}",destination:"Fai un'inversione a U verso {destination}"}},"off ramp":{default:{default:"Prendi la rampa",name:"Prendi la rampa in {way_name}",destination:"Prendi la rampa verso {destination}",exit:"Prendi l'uscita {exit}",exit_destination:"Prendi l'uscita  {exit} verso {destination}"},left:{default:"Prendi la rampa a sinistra",name:"Prendi la rampa a sinistra in {way_name}",destination:"Prendi la rampa a sinistra verso {destination}",exit:"Prendi l'uscita {exit} a sinistra",exit_destination:"Prendi la {exit}  uscita a sinistra verso {destination}"},right:{default:"Prendi la rampa a destra",name:"Prendi la rampa a destra in {way_name}",destination:"Prendi la rampa a destra verso {destination}",exit:"Prendi la {exit} uscita a destra",exit_destination:"Prendi la {exit} uscita a destra verso {destination}"},"sharp left":{default:"Prendi la rampa a sinistra",name:"Prendi la rampa a sinistra in {way_name}",destination:"Prendi la rampa a sinistra verso {destination}",exit:"Prendi l'uscita {exit} a sinistra",exit_destination:"Prendi la {exit}  uscita a sinistra verso {destination}"},"sharp right":{default:"Prendi la rampa a destra",name:"Prendi la rampa a destra in {way_name}",destination:"Prendi la rampa a destra verso {destination}",exit:"Prendi la {exit} uscita a destra",exit_destination:"Prendi la {exit} uscita a destra verso {destination}"},"slight left":{default:"Prendi la rampa a sinistra",name:"Prendi la rampa a sinistra in {way_name}",destination:"Prendi la rampa a sinistra verso {destination}",exit:"Prendi l'uscita {exit} a sinistra",exit_destination:"Prendi la {exit}  uscita a sinistra verso {destination}"},"slight right":{default:"Prendi la rampa a destra",name:"Prendi la rampa a destra in {way_name}",destination:"Prendi la rampa a destra verso {destination}",exit:"Prendi la {exit} uscita a destra",exit_destination:"Prendi la {exit} uscita a destra verso {destination}"}},"on ramp":{default:{default:"Prendi la rampa",name:"Prendi la rampa in {way_name}",destination:"Prendi la rampa verso {destination}"},left:{default:"Prendi la rampa a sinistra",name:"Prendi la rampa a sinistra in {way_name}",destination:"Prendi la rampa a sinistra verso {destination}"},right:{default:"Prendi la rampa a destra",name:"Prendi la rampa a destra in {way_name}",destination:"Prendi la rampa a destra verso {destination}"},"sharp left":{default:"Prendi la rampa a sinistra",name:"Prendi la rampa a sinistra in {way_name}",destination:"Prendi la rampa a sinistra verso {destination}"},"sharp right":{default:"Prendi la rampa a destra",name:"Prendi la rampa a destra in {way_name}",destination:"Prendi la rampa a destra verso {destination}"},"slight left":{default:"Prendi la rampa a sinistra",name:"Prendi la rampa a sinistra in {way_name}",destination:"Prendi la rampa a sinistra verso {destination}"},"slight right":{default:"Prendi la rampa a destra",name:"Prendi la rampa a destra in {way_name}",destination:"Prendi la rampa a destra verso {destination}"}},rotary:{default:{default:{default:"Immettiti nella rotonda",name:"Immettiti nella ritonda ed esci in {way_name}",destination:"Immettiti nella ritonda ed esci verso {destination}"},name:{default:"Immettiti in {rotary_name}",name:"Immettiti in {rotary_name} ed esci su {way_name}",destination:"Immettiti in {rotary_name} ed esci verso {destination}"},exit:{default:"Immettiti nella rotonda e prendi la {exit_number} uscita",name:"Immettiti nella rotonda e prendi la {exit_number} uscita in {way_name}",destination:"Immettiti nella rotonda e prendi la {exit_number} uscita verso   {destination}"},name_exit:{default:"Immettiti in {rotary_name} e prendi la {exit_number} uscita",name:"Immettiti in {rotary_name} e prendi la {exit_number} uscita in {way_name}",destination:"Immettiti in {rotary_name} e prendi la {exit_number}  uscita verso {destination}"}}},roundabout:{default:{exit:{default:"Immettiti nella rotonda e prendi la {exit_number} uscita",name:"Immettiti nella rotonda e prendi la {exit_number} uscita in {way_name}",destination:"Immettiti nella rotonda e prendi la {exit_number} uscita verso {destination}"},default:{default:"Entra nella rotonda",name:"Entra nella rotonda e prendi l'uscita in {way_name}",destination:"Entra nella rotonda e prendi l'uscita verso {destination}"}}},"roundabout turn":{default:{default:"Fai una {modifier}",name:"Fai una {modifier} in {way_name}",destination:"Fai una {modifier} verso {destination}"},left:{default:"Svolta a sinistra",name:"Svolta a sinistra in {way_name}",destination:"Svolta a sinistra verso {destination}"},right:{default:"Gira a destra",name:"Svolta a destra in {way_name}",destination:"Svolta a destra verso {destination}"},straight:{default:"Continua dritto",name:"Continua dritto in {way_name}",destination:"Continua dritto verso {destination}"}},"exit roundabout":{default:{default:"Fai una {modifier}",name:"Fai una {modifier} in {way_name}",destination:"Fai una {modifier} verso {destination}"},left:{default:"Svolta a sinistra",name:"Svolta a sinistra in {way_name}",destination:"Svolta a sinistra verso {destination}"},right:{default:"Gira a destra",name:"Svolta a destra in {way_name}",destination:"Svolta a destra verso {destination}"},straight:{default:"Continua dritto",name:"Continua dritto in {way_name}",destination:"Continua dritto verso {destination}"}},"exit rotary":{default:{default:"Fai una {modifier}",name:"Fai una {modifier} in {way_name}",destination:"Fai una {modifier} verso {destination}"},left:{default:"Svolta a sinistra",name:"Svolta a sinistra in {way_name}",destination:"Svolta a sinistra verso {destination}"},right:{default:"Gira a destra",name:"Svolta a destra in {way_name}",destination:"Svolta a destra verso {destination}"},straight:{default:"Prosegui dritto",name:"Continua su {way_name}",destination:"Continua verso {destination}"}},turn:{default:{default:"Fai una {modifier}",name:"Fai una {modifier} in {way_name}",destination:"Fai una {modifier} verso {destination}"},left:{default:"Svolta a sinistra",name:"Svolta a sinistra in {way_name}",destination:"Svolta a sinistra verso {destination}"},right:{default:"Gira a destra",name:"Svolta a destra in {way_name}",destination:"Svolta a destra verso {destination}"},straight:{default:"Prosegui dritto",name:"Continua su {way_name}",destination:"Continua verso {destination}"}},"use lane":{no_lanes:{default:"Continua dritto"},default:{default:"{lane_instruction}"}}}}},{}],34:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!1},v5:{constants:{ordinalize:{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:""},direction:{north:"",northeast:"",east:"",southeast:"",south:"",southwest:"",west:"",northwest:""},modifier:{left:"",right:"","sharp left":"","sharp right":"","slight left":"","slight right":"",straight:"",uturn:""},lanes:{xo:" ",ox:" ",xox:"",oxo:"    "}},modes:{ferry:{default:" ",name:"  {way_name}",destination:"  {destination} ."}},phrase:{"two linked by distance":"{instruction_one}, , {distance} , {instruction_two}","two linked":"{instruction_one},  {instruction_two}","one in distance":"{distance} , {instruction_one}","name and ref":"{name} ({ref})","exit with number":"{exit} ."},arrive:{default:{default:" {nth} .",upcoming:"{nth}   .",short:"","short-upcoming":" .",named:" {waypoint_name} ."},left:{default:" {nth}  .",upcoming:" {nth}   .",short:"","short-upcoming":"   .",named:"  {waypoint_name} ."},right:{default:" {nth}  .",upcoming:" {nth}   .",short:"","short-upcoming":"   .",named:"  {waypoint_name} ."},"sharp left":{default:" {nth}  .",upcoming:" {nth}   .",short:"","short-upcoming":"   .",named:"  {waypoint_name} ."},"sharp right":{default:" {nth}  .",upcoming:" {nth}   .",short:"","short-upcoming":"   .",named:"  {waypoint_name} ."},"slight right":{default:" {nth}  .",upcoming:" {nth}   .",short:"","short-upcoming":"   .",named:"  {waypoint_name} ."},"slight left":{default:" {nth}  .",upcoming:" {nth}   .",short:"","short-upcoming":"   .",named:"  {waypoint_name} ."},straight:{default:"  {nth}  .",upcoming:" {nth}   .",short:"","short-upcoming":"   .",named:"  {waypoint_name} ."}},continue:{default:{default:"{modifier} ",name:"{modifier}  {way_name}  .",destination:"{modifier}  {destination} .",exit:"{way_name}  {modifier}  ."},straight:{default:"  .",name:"{way_name}    .",destination:"{destination}  .",distance:"{distance}  .",namedistance:"{distance} {way_name} ."},"sharp left":{default:" .",name:"   {way_name} .",destination:"   {destination} ."},"sharp right":{default:" .",name:"  {way_name} .",destination:"   {destination} ."},"slight left":{default:" .",name:"   {way_name} .",destination:"    {destination} ."},"slight right":{default:" .",name:"   {way_name} .",destination:"    {destination} ."},uturn:{default:" ",name:" {way_name} .",destination:"  {destination} ."}},depart:{default:{default:"{direction} ",name:"{direction}   {way_name}  . ",namedistance:"{direction} {way_name}  {distance} ."}},"end of road":{default:{default:"{modifier} .",name:"{modifier} {way_name} .",destination:"{modifier}   {destination} ."},straight:{default:"  .",name:"{way_name}   .",destination:"{destination}  ."},uturn:{default:"    .",name:"    {way_name} .",destination:"    {destination}  ."}},fork:{default:{default:" {modifier}  .",name:"{modifier} {way_name} .",destination:"{modifier} {destination} ."},"slight left":{default:"  .",name:"  {way_name} .",destination:"  {destination} ."},"slight right":{default:"  .",name:"  {way_name} .",destination:"  {destination} ."},"sharp left":{default:"  .",name:"  {way_name} .",destination:"  {destination} ."},"sharp right":{default:"  .",name:"  {way_name} .",destination:"  {destination} ."},uturn:{default:".",name:" {way_name} .",destination:" {destination} ."}},merge:{default:{default:"{modifier} ",name:"{modifier}  {way_name} .",destination:"{modifier}  {destination} ."},straight:{default:"",name:"{way_name} .",destination:"{destination} ."},"slight left":{default:" .",name:"{way_name} .",destination:"  {destination} ."},"slight right":{default:" .",name:"{way_name} .",destination:"  {destination} ."},"sharp left":{default:" .",name:"{way_name} .",destination:"  {destination} ."},"sharp right":{default:" .",name:"{way_name} .",destination:"  {destination} ."},uturn:{default:".",name:" {way_name} .",destination:" {destination} ."}},"new name":{default:{default:"{modifier} .",name:"{modifier}  {way_name} .",destination:"{modifier}  {destination} ."},straight:{default:".",name:"{way_name}  .",destination:"{destination}  ."},"sharp left":{default:" .",name:"  {way_name} .",destination:"  {destination} ."},"sharp right":{default:" .",name:"  {way_name} .",destination:"  {destination} ."},"slight left":{default:"  .",name:"  {way_name} .",destination:"   {destination} ."},"slight right":{default:"  .",name:"  {way_name} .",destination:"   {destination} ."},uturn:{default:".",name:" {way_name} .",destination:" {destination} ."}},notification:{default:{default:"{modifier} .",name:"{modifier} {way_name} .",destination:"{modifier} {destination} ."},uturn:{default:".",name:" {way_name} .",destination:" {destination} ."}},"off ramp":{default:{default:"  ..",name:"  {way_name} .",destination:"  {destination} .",exit:"{exit}  .",exit_destination:"{exit}   {destination} ."},left:{default:"   .",name:"   {way_name} .",destination:"   {destination} .",exit:"{exit}   .",exit_destination:"{exit}    {destination} ."},right:{default:"   .",name:"   {way_name} .",destination:"   {destination} .",exit:"{exit}   .",exit_destination:"{exit}    {destination} ."},"sharp left":{default:"   .",name:"   {way_name} .",destination:"   {destination} .",exit:"{exit}   .",exit_destination:"{exit}    {destination} ."},"sharp right":{default:"   .",name:"   {way_name} .",destination:"   {destination} .",exit:"{exit}   .",exit_destination:"{exit}    {destination} ."},"slight left":{default:"   .",name:"   {way_name} .",destination:"   {destination} .",exit:"{exit}   .",exit_destination:"{exit}    {destination} ."},"slight right":{default:"   .",name:"   {way_name} .",destination:"   {destination} .",exit:"{exit}   .",exit_destination:"{exit}    {destination} ."}},"on ramp":{default:{default:"  ..",name:"  {way_name} .",destination:"  {destination} ."},left:{default:"   .",name:"   {way_name} .",destination:"   {destination} ."},right:{default:"   .",name:"   {way_name} .",destination:"   {destination} ."},"sharp left":{default:"   .",name:"   {way_name} .",destination:"   {destination} ."},"sharp right":{default:"   .",name:"   {way_name} .",destination:"   {destination} ."},"slight left":{default:"   .",name:"   {way_name} .",destination:"   {destination} ."},"slight right":{default:"   .",name:"   {way_name} .",destination:"   {destination} ."}},rotary:{default:{default:{default:" .",name:"  {way_name} .",destination:"  {destination} ."},name:{default:"{rotary_name} .",name:"{rotary_name}  {way_name} .",destination:"{rotary_name}  {destination} ."},exit:{default:"  {exit_number}  .",name:"  {exit_number}   {way_name} .",destination:"  {exit_number}   {destination} ."},name_exit:{default:"{rotary_name}  {exit_number}  .",name:"{rotary_name}  {exit_number}   {way_name} .",destination:"{rotary_name}  {exit_number}   {destination} ."}}},roundabout:{default:{exit:{default:"  {exit_number} .",name:"  {exit_number}  {way_name} .",destination:"  {exit_number}  {destination} ."},default:{default:" .",name:"  {way_name} .",destination:"  {destination} ."}}},"roundabout turn":{default:{default:"{modifier} .",name:"{modifier}  {way_name} .",destination:"{modifier}  {destination} ."},left:{default:" .",name:"  {way_name} .",destination:"  {destination} ."},right:{default:" .",name:"  {way_name} .",destination:"  {destination} ."},straight:{default:" .",name:" {way_name} .",destination:" {destination} ."}},"exit roundabout":{default:{default:" .",name:"  {way_name} .",destination:"  {destination} ."}},"exit rotary":{default:{default:" .",name:"  {way_name} .",destination:"  {destination} ."}},turn:{default:{default:"{modifier} .",name:"{modifier}  {way_name} .",destination:"{modifier}  {destination} ."},left:{default:" .",name:"  {way_name} .",destination:"  {destination} ."},right:{default:" .",name:"  {way_name} .",destination:"  {destination} ."},straight:{default:" .",name:" {way_name} .",destination:" {destination} ."}},"use lane":{no_lanes:{default:"."},default:{default:"{lane_instruction}"}}}}},{}],35:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!1},v5:{constants:{ordinalize:{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:""},direction:{north:"",northeast:"",east:"",southeast:"",south:"",southwest:"",west:"",northwest:""},modifier:{left:"",right:"","sharp left":" ","sharp right":" ","slight left":" ","slight right":" ",straight:"",uturn:"-"},lanes:{xo:"",ox:"",xox:"",oxo:"   "}},modes:{ferry:{default:" ",name:"{way_name} ",destination:"{destination} "}},phrase:{"two linked by distance":"{instruction_one} {distance} {instruction_two}","two linked":"{instruction_one} {instruction_two}","one in distance":"{distance} {instruction_one}","name and ref":"{name}( {ref})","exit with number":"{exit}"},arrive:{default:{default:"{nth}  ",upcoming:"  {nth}",short:"  ","short-upcoming":"  ",named:"  {waypoint_name}  "},left:{default:"  {nth}",upcoming:"  {nth}",short:"  ","short-upcoming":"  ",named:"  {waypoint_name} "},right:{default:"  {nth}  ",upcoming:" {nth}   ",short:"  ","short-upcoming":"  ",named:"  {waypoint_name}  "},"sharp left":{default:"  {nth}",upcoming:"  {nth}",short:"  ","short-upcoming":"  ",named:"  {waypoint_name} "},"sharp right":{default:"  {nth}  ",upcoming:" {nth}   ",short:"  ","short-upcoming":"  ",named:"  {waypoint_name}  "},"slight right":{default:"  {nth}  ",upcoming:" {nth}   ",short:"  ","short-upcoming":"  ",named:"  {waypoint_name}  "},"slight left":{default:"  {nth}",upcoming:"  {nth}",short:"  ","short-upcoming":"  ",named:"  {waypoint_name} "},straight:{default:"  {nth}",upcoming:"  {nth}",short:"  ","short-upcoming":"  ",named:"  {waypoint_name} "}},continue:{default:{default:"{modifier}",name:"{way_name} {modifier}",destination:"{destination} {modifier} ",exit:"{way_name} {modifier}"},straight:{default:" ",name:"{way_name}",destination:"{destination}",distance:"{distance}  ",namedistance:"{way_name}{distance}"},"sharp left":{default:"",name:"{way_name} ",destination:"{destination} "},"sharp right":{default:" ",name:"{way_name} ",destination:"{destination} "},"slight left":{default:" ",name:"{way_name} ",destination:"{destination} "},"slight right":{default:" ",name:"{way_name} ",destination:"{destination} "},uturn:{default:"- ",name:"{way_name} -",destination:"{destination} "}},depart:{default:{default:"{direction} ",name:"{direction} {way_name} ",namedistance:"{direction} {way_name}{distance} "}},"end of road":{default:{default:"{modifier}",name:"{way_name} {modifier}",destination:"{destination} {modifier} "},straight:{default:" ",name:"{way_name}",destination:"{destination}"},uturn:{default:" -",name:" {way_name}-",destination:"{destination} "}},fork:{default:{default:" {modifier}",name:"{way_name} {modifier}",destination:"{destination} {modifier} "},"slight left":{default:"",name:"{way_name}",destination:"{destination} "},"slight right":{default:"",name:"{way_name}",destination:"{destination} "},"sharp left":{default:"",name:"{way_name} ",destination:"{destination} "},"sharp right":{default:"",name:"{way_name} ",destination:"{destination} "},uturn:{default:"- ",name:"{way_name}-",destination:"{destination} "}},merge:{default:{default:"{modifier}",name:"{way_name} {modifier}",destination:"{destination} {modifier} "},straight:{default:"",name:"{way_name}",destination:"{destination} "},"slight left":{default:"",name:"{way_name}",destination:"{destination} "},"slight right":{default:"",name:"{way_name}",destination:"{destination} "},"sharp left":{default:"",name:"{way_name}",destination:"{destination} "},"sharp right":{default:"",name:"{way_name}",destination:"{destination} "},uturn:{default:"- ",name:"{way_name} -  ",destination:"{destination} "}},"new name":{default:{default:"{modifier}",name:"{way_name} {modifier}",destination:"{destination} {modifier} "},straight:{default:" ",name:"{way_name}",destination:"{destination}"},"sharp left":{default:"",name:"{way_name} ",destination:"{destination} "},"sharp right":{default:" ",name:"{way_name} ",destination:"{destination} "},"slight left":{default:" ",name:"{way_name} ",destination:"{destination}"},"slight right":{default:" ",name:"{way_name} ",destination:"{destination}"},uturn:{default:"- ",name:"{way_name} - ",destination:"{destination} "}},notification:{default:{default:"{modifier}",name:"{way_name} {modifier}",destination:"{destination} {modifier} "},uturn:{default:"- ",name:"{way_name} - ",destination:"{destination} "}},"off ramp":{default:{default:"",name:"{way_name}",destination:"{destination} ",exit:"{exit} ",exit_destination:"{destination} {exit} "},left:{default:"",name:"{way_name} ",destination:"{destination} ",exit:"{exit} ",exit_destination:"{destination} {exit} "},right:{default:"",name:"{way_name} ",destination:"{destination} ",exit:"{exit} ",exit_destination:"{destination} {exit} "},"sharp left":{default:"",name:"{way_name} ",destination:"{destination} ",exit:"{exit} ",exit_destination:"{destination} {exit} "},"sharp right":{default:"",name:"{way_name} ",destination:"{destination} ",exit:"{exit} ",exit_destination:"{destination} {exit} "},"slight left":{default:"",name:"{way_name} ",destination:"{destination} ",exit:"{exit} ",exit_destination:"{destination} {exit} "},"slight right":{default:"",name:"{way_name} ",destination:"{destination} ",exit:"{exit} ",exit_destination:"{destination} {exit} "}},"on ramp":{default:{default:"",name:"{way_name}",destination:"{destination} "},left:{default:"",name:"{way_name} ",destination:"{destination} "},right:{default:"",name:"{way_name} ",destination:"{destination} "},"sharp left":{default:"",name:"{way_name} ",destination:"{destination} "},"sharp right":{default:"",name:"{way_name} ",destination:"{destination} "},"slight left":{default:"",name:"{way_name} ",destination:"{destination} "},"slight right":{default:"",name:"{way_name} ",destination:"{destination} "}},rotary:{default:{default:{default:"",name:"{way_name}",destination:"{destination}"},name:{default:"{rotary_name}",name:"{rotary_name}{way_name}",destination:"{rotary_name}{destination}"},exit:{default:"{exit_number}",name:"{exit_number}{way_name}",destination:"{exit_number}{destination}"},name_exit:{default:"{rotary_name} {exit_number}",name:"{rotary_name}{exit_number}{way_name}",destination:"{rotary_name}{exit_number}{destination}"}}},roundabout:{default:{exit:{default:"{exit_number}",name:"{exit_number}{way_name}",destination:"{exit_number}{destination}"},default:{default:"",name:"{way_name}",destination:"{destination}"}}},"roundabout turn":{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination} "},left:{default:"",name:"{way_name}",destination:"{destination} "},right:{default:"",name:"{way_name}",destination:"{destination} "},straight:{default:" ",name:"{way_name}",destination:"{destination}"}},"exit roundabout":{default:{default:"",name:"{way_name}",destination:"{destination}"}},"exit rotary":{default:{default:"",name:"{way_name}",destination:"{destination}"}},turn:{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination} "},left:{default:"",name:"{way_name}",destination:"{destination} "},right:{default:"",name:"{way_name}",destination:"{destination} "},straight:{default:"",name:"{way_name}",destination:"{destination}"}},"use lane":{no_lanes:{default:" "},default:{default:"{lane_instruction}"}}}}},{}],36:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1e",2:"2e",3:"3e",4:"4e",5:"5e",6:"6e",7:"7e",8:"8e",9:"9e",10:"10e"},direction:{north:"noord",northeast:"noordoost",east:"oost",southeast:"zuidoost",south:"zuid",southwest:"zuidwest",west:"west",northwest:"noordwest"},modifier:{left:"links",right:"rechts","sharp left":"scherpe bocht naar links","sharp right":"scherpe bocht naar rechts","slight left":"iets naar links","slight right":"iets naar rechts",straight:"rechtdoor",uturn:"omkeren"},lanes:{xo:"Rechts aanhouden",ox:"Links aanhouden",xox:"In het midden blijven",oxo:"Links of rechts blijven"}},modes:{ferry:{default:"Neem de veerpont",name:"Neem de veerpont {way_name}",destination:"Neem de veerpont richting {destination}"}},phrase:{"two linked by distance":"{instruction_one}, dan na {distance}, {instruction_two}","two linked":"{instruction_one}, daarna {instruction_two}","one in distance":"Over {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"afslag {exit}"},arrive:{default:{default:"Je bent gearriveerd op de {nth} bestemming.",upcoming:"U arriveert op de {nth} bestemming",short:"U bent gearriveerd","short-upcoming":"U zult aankomen",named:"U bent gearriveerd bij {waypoint_name}"},left:{default:"Je bent gearriveerd. De {nth} bestemming bevindt zich links.",upcoming:"Uw {nth} bestemming bevindt zich aan de linkerkant",short:"U bent gearriveerd","short-upcoming":"U zult aankomen",named:"U bent gearriveerd bij {waypoint_name}, de bestemming is aan de linkerkant"},right:{default:"Je bent gearriveerd. De {nth} bestemming bevindt zich rechts.",upcoming:"Uw {nth} bestemming bevindt zich aan de rechterkant",short:"U bent gearriveerd","short-upcoming":"U zult aankomen",named:"U bent gearriveerd bij {waypoint_name}, de bestemming is aan de  rechterkant"},"sharp left":{default:"Je bent gearriveerd. De {nth} bestemming bevindt zich links.",upcoming:"Uw {nth} bestemming bevindt zich aan de linkerkant",short:"U bent gearriveerd","short-upcoming":"U zult aankomen",named:"U bent gearriveerd bij {waypoint_name}, de bestemming is aan de linkerkant"},"sharp right":{default:"Je bent gearriveerd. De {nth} bestemming bevindt zich rechts.",upcoming:"Uw {nth} bestemming bevindt zich aan de rechterkant",short:"U bent gearriveerd","short-upcoming":"U zult aankomen",named:"U bent gearriveerd bij {waypoint_name},  de bestemming is aan de rechterkant"},"slight right":{default:"Je bent gearriveerd. De {nth} bestemming bevindt zich rechts.",upcoming:"Uw {nth} bestemming bevindt zich aan de rechterkant",short:"U bent gearriveerd","short-upcoming":"U zult aankomen",named:"U bent gearriveerd bij {waypoint_name},  de bestemming is aan de rechterkant"},"slight left":{default:"Je bent gearriveerd. De {nth} bestemming bevindt zich links.",upcoming:"Uw {nth} bestemming bevindt zich aan de linkerkant",short:"U bent gearriveerd","short-upcoming":"U zult aankomen",named:"U bent gearriveerd bij {waypoint_name},  de bestemming is aan de linkerkant"},straight:{default:"Je bent gearriveerd. De {nth} bestemming bevindt zich voor je.",upcoming:"Uw {nth} bestemming is recht voor u",short:"U bent gearriveerd","short-upcoming":"U zult aankomen",named:"U bent gearriveerd bij {waypoint_name}, de bestemming is recht voor u"}},continue:{default:{default:"Ga {modifier}",name:"Sla {modifier} om op {way_name} te blijven",destination:"Ga {modifier} richting {destination}",exit:"Ga {modifier} naar {way_name}"},straight:{default:"Ga rechtdoor",name:"Blijf rechtdoor gaan op {way_name}",destination:"Ga rechtdoor richting {destination}",distance:"Ga rechtdoor voor {distance}",namedistance:"Ga verder op {way_name} voor {distance}"},"sharp left":{default:"Linksaf",name:"Sla scherp links af om op {way_name} te blijven",destination:"Linksaf richting {destination}"},"sharp right":{default:"Rechtsaf",name:"Sla scherp rechts af om op {way_name} te blijven",destination:"Rechtsaf richting {destination}"},"slight left":{default:"Ga links",name:"Links afbuigen om op {way_name} te blijven",destination:"Rechts afbuigen om op {destination} te blijven"},"slight right":{default:"Rechts afbuigen",name:"Rechts afbuigen om op {way_name} te blijven",destination:"Rechts afbuigen richting {destination}"},uturn:{default:"Keer om",name:"Draai om en ga verder op {way_name}",destination:"Keer om richting {destination}"}},depart:{default:{default:"Vertrek in {direction}elijke richting",name:"Neem {way_name} in {direction}elijke richting",namedistance:"Ga richting {direction} op {way_name} voor {distance}"}},"end of road":{default:{default:"Ga {modifier}",name:"Ga {modifier} naar {way_name}",destination:"Ga {modifier} richting {destination}"},straight:{default:"Ga in de aangegeven richting",name:"Ga naar {way_name}",destination:"Ga richting {destination}"},uturn:{default:"Keer om",name:"Keer om naar {way_name}",destination:"Keer om richting {destination}"}},fork:{default:{default:"Ga {modifier} op de splitsing",name:"Houd {modifier} aan, tot {way_name}",destination:"Houd {modifier}, in de richting van {destination}"},"slight left":{default:"Links aanhouden op de splitsing",name:"Houd links aan, tot {way_name}",destination:"Houd links aan, richting {destination}"},"slight right":{default:"Rechts aanhouden op de splitsing",name:"Houd rechts aan, tot {way_name}",destination:"Houd rechts aan, richting {destination}"},"sharp left":{default:"Neem bij de splitsing, een scherpe bocht, naar links ",name:"Neem een scherpe bocht naar links, tot aan {way_name}",destination:"Neem een scherpe bocht naar links, richting {destination}"},"sharp right":{default:"Neem  op de splitsing, een scherpe bocht, naar rechts",name:"Neem een scherpe bocht naar rechts, tot aan {way_name}",destination:"Neem een scherpe bocht naar rechts, richting {destination}"},uturn:{default:"Keer om",name:"Keer om naar {way_name}",destination:"Keer om richting {destination}"}},merge:{default:{default:"Bij de splitsing {modifier}",name:"Bij de splitsing {modifier} naar {way_name}",destination:"Bij de splitsing {modifier} richting {destination}"},straight:{default:"Samenvoegen",name:"Ga verder op {way_name}",destination:"Ga verder richting {destination}"},"slight left":{default:"Bij de splitsing links aanhouden",name:"Bij de splitsing links aanhouden naar {way_name}",destination:"Bij de splitsing links aanhouden richting {destination}"},"slight right":{default:"Bij de splitsing rechts aanhouden",name:"Bij de splitsing rechts aanhouden naar {way_name}",destination:"Bij de splitsing rechts aanhouden richting {destination}"},"sharp left":{default:"Bij de splitsing linksaf",name:"Bij de splitsing linksaf naar {way_name}",destination:"Bij de splitsing linksaf richting {destination}"},"sharp right":{default:"Bij de splitsing rechtsaf",name:"Bij de splitsing rechtsaf naar {way_name}",destination:"Bij de splitsing rechtsaf richting {destination}"},uturn:{default:"Keer om",name:"Keer om naar {way_name}",destination:"Keer om richting {destination}"}},"new name":{default:{default:"Ga {modifier}",name:"Ga {modifier} naar {way_name}",destination:"Ga {modifier} richting {destination}"},straight:{default:"Ga in de aangegeven richting",name:"Ga rechtdoor naar {way_name}",destination:"Ga rechtdoor richting {destination}"},"sharp left":{default:"Neem een scherpe bocht, naar links",name:"Linksaf naar {way_name}",destination:"Linksaf richting {destination}"},"sharp right":{default:"Neem een scherpe bocht, naar rechts",name:"Rechtsaf naar {way_name}",destination:"Rechtsaf richting {destination}"},"slight left":{default:"Links aanhouden",name:"Links aanhouden naar {way_name}",destination:"Links aanhouden richting {destination}"},"slight right":{default:"Rechts aanhouden",name:"Rechts aanhouden naar {way_name}",destination:"Rechts aanhouden richting {destination}"},uturn:{default:"Keer om",name:"Keer om naar {way_name}",destination:"Keer om richting {destination}"}},notification:{default:{default:"Ga {modifier}",name:"Ga {modifier} naar {way_name}",destination:"Ga {modifier} richting {destination}"},uturn:{default:"Keer om",name:"Keer om naar {way_name}",destination:"Keer om richting {destination}"}},"off ramp":{default:{default:"Neem de afrit",name:"Neem de afrit naar {way_name}",destination:"Neem de afrit richting {destination}",exit:"Neem afslag {exit}",exit_destination:"Neem afslag {exit} richting {destination}"},left:{default:"Neem de afrit links",name:"Neem de afrit links naar {way_name}",destination:"Neem de afrit links richting {destination}",exit:"Neem afslag {exit} aan de linkerkant",exit_destination:"Neem afslag {exit} aan de linkerkant richting {destination}"},right:{default:"Neem de afrit rechts",name:"Neem de afrit rechts naar {way_name}",destination:"Neem de afrit rechts richting {destination}",exit:"Neem afslag {exit} aan de rechterkant",exit_destination:"Neem afslag {exit} aan de rechterkant richting {destination}"},"sharp left":{default:"Neem de afrit links",name:"Neem de afrit links naar {way_name}",destination:"Neem de afrit links richting {destination}",exit:"Neem afslag {exit} aan de linkerkant",exit_destination:"Neem afslag {exit} aan de linkerkant richting {destination}"},"sharp right":{default:"Neem de afrit rechts",name:"Neem de afrit rechts naar {way_name}",destination:"Neem de afrit rechts richting {destination}",exit:"Neem afslag {exit} aan de rechterkant",exit_destination:"Neem afslag {exit} aan de rechterkant richting {destination}"},"slight left":{default:"Neem de afrit links",name:"Neem de afrit links naar {way_name}",destination:"Neem de afrit links richting {destination}",exit:"Neem afslag {exit} aan de linkerkant",exit_destination:"Neem afslag {exit} aan de linkerkant richting {destination}"},"slight right":{default:"Neem de afrit rechts",name:"Neem de afrit rechts naar {way_name}",destination:"Neem de afrit rechts richting {destination}",exit:"Neem afslag {exit} aan de rechterkant",exit_destination:"Neem afslag {exit} aan de rechterkant richting {destination}"}},"on ramp":{default:{default:"Neem de oprit",name:"Neem de oprit naar {way_name}",destination:"Neem de oprit richting {destination}"},left:{default:"Neem de oprit links",name:"Neem de oprit links naar {way_name}",destination:"Neem de oprit links richting {destination}"},right:{default:"Neem de oprit rechts",name:"Neem de oprit rechts naar {way_name}",destination:"Neem de oprit rechts richting {destination}"},"sharp left":{default:"Neem de oprit links",name:"Neem de oprit links naar {way_name}",destination:"Neem de oprit links richting {destination}"},"sharp right":{default:"Neem de oprit rechts",name:"Neem de oprit rechts naar {way_name}",destination:"Neem de oprit rechts richting {destination}"},"slight left":{default:"Neem de oprit links",name:"Neem de oprit links naar {way_name}",destination:"Neem de oprit links richting {destination}"},"slight right":{default:"Neem de oprit rechts",name:"Neem de oprit rechts naar {way_name}",destination:"Neem de oprit rechts richting {destination}"}},rotary:{default:{default:{default:"Betreedt de rotonde",name:"Betreedt rotonde en sla af op {way_name}",destination:"Betreedt rotonde en sla af richting {destination}"},name:{default:"Ga het knooppunt {rotary_name} op",name:"Verlaat het knooppunt {rotary_name} naar {way_name}",destination:"Verlaat het knooppunt {rotary_name} richting {destination}"},exit:{default:"Betreedt rotonde en neem afslag {exit_number}",name:"Betreedt rotonde en neem afslag {exit_number} naar {way_name}",destination:"Betreedt rotonde en neem afslag {exit_number} richting {destination}"},name_exit:{default:"Ga het knooppunt {rotary_name} op en neem afslag {exit_number}",name:"Ga het knooppunt {rotary_name} op en neem afslag {exit_number} naar {way_name}",destination:"Ga het knooppunt {rotary_name} op en neem afslag {exit_number} richting {destination}"}}},roundabout:{default:{exit:{default:"Betreedt rotonde en neem afslag {exit_number}",name:"Betreedt rotonde en neem afslag {exit_number} naar {way_name}",destination:"Betreedt rotonde en neem afslag {exit_number} richting {destination}"},default:{default:"Betreedt de rotonde",name:"Betreedt rotonde en sla af op {way_name}",destination:"Betreedt rotonde en sla af richting {destination}"}}},"roundabout turn":{default:{default:"Ga {modifier}",name:"Ga {modifier} naar {way_name}",destination:"Ga {modifier} richting {destination}"},left:{default:"Ga linksaf",name:"Ga linksaf naar {way_name}",destination:"Ga linksaf richting {destination}"},right:{default:"Ga rechtsaf",name:"Ga rechtsaf naar {way_name}",destination:"Ga rechtsaf richting {destination}"},straight:{default:"Ga in de aangegeven richting",name:"Ga naar {way_name}",destination:"Ga richting {destination}"}},"exit roundabout":{default:{default:"Verlaat de rotonde",name:"Verlaat de rotonde en ga verder op {way_name}",destination:"Verlaat de rotonde richting {destination}"}},"exit rotary":{default:{default:"Verlaat de rotonde",name:"Verlaat de rotonde en ga verder op {way_name}",destination:"Verlaat de rotonde richting {destination}"}},turn:{default:{default:"Ga {modifier}",name:"Ga {modifier} naar {way_name}",destination:"Ga {modifier} richting {destination}"},left:{default:"Ga linksaf",name:"Ga linksaf naar {way_name}",destination:"Ga linksaf richting {destination}"},right:{default:"Ga rechtsaf",name:"Ga rechtsaf naar {way_name}",destination:"Ga rechtsaf richting {destination}"},straight:{default:"Ga rechtdoor",name:"Ga rechtdoor naar {way_name}",destination:"Ga rechtdoor richting {destination}"}},"use lane":{no_lanes:{default:"Rechtdoor"},default:{default:"{lane_instruction}"}}}}},{}],37:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1.",2:"2.",3:"3.",4:"4.",5:"5.",6:"6.",7:"7.",8:"8.",9:"9.",10:"10."},direction:{north:"nord",northeast:"nordst",east:"st",southeast:"srst",south:"sr",southwest:"srvest",west:"vest",northwest:"nordvest"},modifier:{left:"venstre",right:"hyre","sharp left":"skarp venstre","sharp right":"skarp hyre","slight left":"litt til venstre","slight right":"litt til hyre",straight:"rett frem",uturn:"U-sving"},lanes:{xo:"Hold til hyre",ox:"Hold til venstre",xox:"Hold deg i midten",oxo:"Hold til venstre eller hyre"}},modes:{ferry:{default:"Ta ferja",name:"Ta ferja {way_name}",destination:"Ta ferja til {destination}"}},phrase:{"two linked by distance":"{instruction_one}, deretter {instruction_two} om {distance}","two linked":"{instruction_one}, deretter {instruction_two}","one in distance":"Om {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"avkjrsel {exit}"},arrive:{default:{default:"Du har ankommet din {nth} destinasjon",upcoming:"Du vil ankomme din {nth} destinasjon",short:"Du har ankommet","short-upcoming":"Du vil ankomme",named:"Du har ankommet {waypoint_name}"},left:{default:"Du har ankommet din {nth} destinasjon, p din venstre side",upcoming:"Du vil ankomme din {nth} destinasjon, p din venstre side",short:"Du har ankommet","short-upcoming":"Du vil ankomme",named:"Du har ankommet {waypoint_name}, p din venstre side"},right:{default:"Du har ankommet din {nth} destinasjon, p din hyre side",upcoming:"Du vil ankomme din {nth} destinasjon, p din hyre side",short:"Du har ankommet","short-upcoming":"Du vil ankomme",named:"Du har ankommet {waypoint_name}, p din hyre side"},"sharp left":{default:"Du har ankommet din {nth} destinasjon, p din venstre side",upcoming:"Du vil ankomme din {nth} destinasjon, p din venstre side",short:"Du har ankommet","short-upcoming":"Du vil ankomme",named:"Du har ankommet {waypoint_name}, p din venstre side"},"sharp right":{default:"Du har ankommet din {nth} destinasjon, p din hyre side",upcoming:"Du vil ankomme din {nth} destinasjon, p din hyre side",short:"Du har ankommet","short-upcoming":"Du vil ankomme",named:"Du har ankommet {waypoint_name}, p din hyre side"},"slight right":{default:"Du har ankommet din {nth} destinasjon, p din hyre side",upcoming:"Du vil ankomme din {nth} destinasjon, p din hyre side",short:"Du har ankommet","short-upcoming":"Du vil ankomme",named:"Du har ankommet {waypoint_name}, p din hyre side"},"slight left":{default:"Du har ankommet din {nth} destinasjon, p din venstre side",upcoming:"Du vil ankomme din {nth} destinasjon, p din venstre side",short:"Du har ankommet","short-upcoming":"Du vil ankomme",named:"Du har ankommet {waypoint_name}, p din venstre side"},straight:{default:"Du har ankommet din {nth} destinasjon, rett forut",upcoming:"Du vil ankomme din {nth} destinasjon, rett forut",short:"Du har ankommet","short-upcoming":"Du vil ankomme",named:"Du har ankommet {waypoint_name}, rett forut"}},continue:{default:{default:"Ta til {modifier}",name:"Ta til {modifier} for  bli vrende p {way_name}",destination:"Ta til {modifier} mot {destination}",exit:"Ta til {modifier} inn p {way_name}"},straight:{default:"Fortsett rett frem",name:"Fortsett rett frem for  bli vrende p {way_name}",destination:"Fortsett mot {destination}",distance:"Fortsett rett frem, {distance} ",namedistance:"Fortsett p {way_name}, {distance}"},"sharp left":{default:"Sving skarpt til venstre",name:"Sving skarpt til venstre for  bli vrende p {way_name}",destination:"Sving skarpt til venstre mot {destination}"},"sharp right":{default:"Sving skarpt til hyre",name:"Sving skarpt til hyre for  bli vrende p {way_name}",destination:"Sving skarpt mot {destination}"},"slight left":{default:"Sving svakt til venstre",name:"Sving svakt til venstre for  bli vrende p {way_name}",destination:"Sving svakt til venstre mot {destination}"},"slight right":{default:"Sving svakt til hyre",name:"Sving svakt til hyre for  bli vrende p {way_name}",destination:"Sving svakt til hyre mot {destination}"},uturn:{default:"Ta en U-sving",name:"Ta en U-sving og fortsett p {way_name}",destination:"Ta en U-sving mot {destination}"}},depart:{default:{default:"Kjr i retning {direction}",name:"Kjr i retning {direction} p {way_name}",namedistance:"Kjr i retning {direction} p {way_name}, {distance}"}},"end of road":{default:{default:"Sving {modifier}",name:"Ta til {modifier} inn p {way_name}",destination:"Sving {modifier} mot {destination}"},straight:{default:"Fortsett rett frem",name:"Fortsett rett frem til  {way_name}",destination:"Fortsett rett frem mot {destination}"},uturn:{default:"Ta en U-sving i enden av veien",name:"Ta en U-sving til {way_name} i enden av veien",destination:"Ta en U-sving mot {destination} i enden av veien"}},fork:{default:{default:"Hold til {modifier} i veikrysset",name:"Hold til {modifier} inn p {way_name}",destination:"Hold til {modifier} mot {destination}"},"slight left":{default:"Hold til venstre i veikrysset",name:"Hold til venstre inn p {way_name}",destination:"Hold til venstre mot {destination}"},"slight right":{default:"Hold til hyre i veikrysset",name:"Hold til hyre inn p {way_name}",destination:"Hold til hyre mot {destination}"},"sharp left":{default:"Sving skarpt til venstre i veikrysset",name:"Sving skarpt til venstre inn p {way_name}",destination:"Sving skarpt til venstre mot {destination}"},"sharp right":{default:"Sving skarpt til hyre i veikrysset",name:"Sving skarpt til hyre inn p {way_name}",destination:"Svings skarpt til hyre mot {destination}"},uturn:{default:"Ta en U-sving",name:"Ta en U-sving til {way_name}",destination:"Ta en U-sving mot {destination}"}},merge:{default:{default:"Hold {modifier} kjrefelt",name:"Hold {modifier} kjrefelt inn p {way_name}",destination:"Hold {modifier} kjrefelt mot {destination}"},straight:{default:"Hold kjrefelt",name:"Hold kjrefelt inn p {way_name}",destination:"Hold kjrefelt mot {destination}"},"slight left":{default:"Hold venstre kjrefelt",name:"Hold venstre kjrefelt inn p {way_name}",destination:"Hold venstre kjrefelt mot {destination}"},"slight right":{default:"Hold hyre kjrefelt",name:"Hold hyre kjrefelt inn p {way_name}",destination:"Hold hyre kjrefelt mot {destination}"},"sharp left":{default:"Hold venstre kjrefelt",name:"Hold venstre kjrefelt inn p {way_name}",destination:"Hold venstre kjrefelt mot {destination}"},"sharp right":{default:"Hold hyre kjrefelt",name:"Hold hyre kjrefelt inn p {way_name}",destination:"Hold hyre kjrefelt mot {destination}"},uturn:{default:"Ta en U-sving",name:"Ta en U-sving til {way_name}",destination:"Ta en U-sving mot {destination}"}},"new name":{default:{default:"Fortsett {modifier}",name:"Fortsett {modifier} til {way_name}",destination:"Fortsett {modifier} mot  {destination}"},straight:{default:"Fortsett rett frem",name:"Fortsett inn p {way_name}",destination:"Fortsett mot {destination}"},"sharp left":{default:"Sving skarpt til venstre",name:"Sving skarpt til venstre inn p {way_name}",destination:"Sving skarpt til venstre mot {destination}"},"sharp right":{default:"Sving skarpt til hyre",name:"Sving skarpt til hyre inn p {way_name}",destination:"Svings skarpt til hyre mot {destination}"},"slight left":{default:"Fortsett litt mot venstre",name:"Fortsett litt mot venstre til {way_name}",destination:"Fortsett litt mot venstre mot {destination}"},"slight right":{default:"Fortsett litt mot hyre",name:"Fortsett litt mot hyre til {way_name}",destination:"Fortsett litt mot hyre mot {destination}"},uturn:{default:"Ta en U-sving",name:"Ta en U-sving til {way_name}",destination:"Ta en U-sving mot {destination}"}},notification:{default:{default:"Fortsett {modifier}",name:"Fortsett {modifier} til {way_name}",destination:"Fortsett {modifier} mot  {destination}"},uturn:{default:"Ta en U-sving",name:"Ta en U-sving til {way_name}",destination:"Ta en U-sving mot {destination}"}},"off ramp":{default:{default:"Ta avkjrselen",name:"Ta avkjrselen inn p {way_name}",destination:"Ta avkjrselen mot {destination}",exit:"Ta avkjrsel {exit}",exit_destination:"Ta avkjrsel {exit} mot {destination}"},left:{default:"Ta avkjrselen p venstre side",name:"Ta avkjrselen p venstre side inn p {way_name}",destination:"Ta avkjrselen p venstre side mot {destination}",exit:"Ta avkjrsel {exit} p venstre side",exit_destination:"Ta avkjrsel {exit} p venstre side mot {destination}"},right:{default:"Ta avkjrselen p hyre side",name:"Ta avkjrselen p hyre side inn p {way_name}",destination:"Ta avkjrselen p hyre side mot {destination}",exit:"Ta avkjrsel {exit} p hyre side",exit_destination:"Ta avkjrsel {exit} p hyre side mot {destination}"},"sharp left":{default:"Ta avkjrselen p venstre side",name:"Ta avkjrselen p venstre side inn p {way_name}",destination:"Ta avkjrselen p venstre side mot {destination}",exit:"Ta avkjrsel {exit} p venstre side",exit_destination:"Ta avkjrsel {exit} p venstre side mot {destination}"},"sharp right":{default:"Ta avkjrselen p hyre side",name:"Ta avkjrselen p hyre side inn p {way_name}",destination:"Ta avkjrselen p hyre side mot {destination}",exit:"Ta avkjrsel {exit} p hyre side",exit_destination:"Ta avkjrsel {exit} p hyre side mot {destination}"},"slight left":{default:"Ta avkjrselen p venstre side",name:"Ta avkjrselen p venstre side inn p {way_name}",destination:"Ta avkjrselen p venstre side mot {destination}",exit:"Ta avkjrsel {exit} p venstre side",exit_destination:"Ta avkjrsel {exit} p venstre side mot {destination}"},"slight right":{default:"Ta avkjrselen p hyre side",name:"Ta avkjrselen p hyre side inn p {way_name}",destination:"Ta avkjrselen p hyre side mot {destination}",exit:"Ta avkjrsel {exit} p hyre side",exit_destination:"Ta avkjrsel {exit} p hyre side mot {destination}"}},"on ramp":{default:{default:"Ta avkjrselen",name:"Ta avkjrselen inn p {way_name}",destination:"Ta avkjrselen mot {destination}"},left:{default:"Ta avkjrselen p venstre side",name:"Ta avkjrselen p venstre side inn p {way_name}",destination:"Ta avkjrselen p venstre side mot {destination}"},right:{default:"Ta avkjrselen p hyre side",name:"Ta avkjrselen p hyre side inn p {way_name}",destination:"Ta avkjrselen p hyre side mot {destination}"},"sharp left":{default:"Ta avkjrselen p venstre side",name:"Ta avkjrselen p venstre side inn p {way_name}",destination:"Ta avkjrselen p venstre side mot {destination}"},"sharp right":{default:"Ta avkjrselen p hyre side",name:"Ta avkjrselen p hyre side inn p {way_name}",destination:"Ta avkjrselen p hyre side mot {destination}"},"slight left":{default:"Ta avkjrselen p venstre side",name:"Ta avkjrselen p venstre side inn p {way_name}",destination:"Ta avkjrselen p venstre side mot {destination}"},"slight right":{default:"Ta avkjrselen p hyre side",name:"Ta avkjrselen p hyre side inn p {way_name}",destination:"Ta avkjrselen p hyre side mot {destination}"}},rotary:{default:{default:{default:"Kjr inn i rundkjringen",name:"Kjr inn i rundkjringen og deretter ut p {way_name}",destination:"Kjr inn i rundkjringen og deretter ut mot {destination}"},name:{default:"Kjr inn i {rotary_name}",name:"Kjr inn i {rotary_name} og deretter ut p {way_name}",destination:"Kjr inn i {rotary_name} og deretter ut mot {destination}"},exit:{default:"Kjr inn i rundkjringen og ta {exit_number} avkjrsel",name:"Kjr inn i rundkjringen og ta {exit_number} avkjrsel ut p {way_name}",destination:"Kjr inn i rundkjringen og ta {exit_number} avkjrsel ut mot {destination} "},name_exit:{default:"Kjr inn i {rotary_name} og ta {exit_number} avkjrsel",name:"Kjr inn i {rotary_name} og ta {exit_number} avkjrsel inn p {way_name}",destination:"Kjr inn i {rotary_name} og ta {exit_number} avkjrsel mot {destination}"}}},roundabout:{default:{exit:{default:"Kjr inn i rundkjringen og ta {exit_number} avkjrsel",name:"Kjr inn i rundkjringen og ta {exit_number} avkjrsel inn p {way_name}",destination:"Kjr inn i rundkjringen og ta {exit_number} avkjrsel ut mot {destination} "},default:{default:"Kjr inn i rundkjringen",name:"Kjr inn i rundkjringen og deretter ut p {way_name}",destination:"Kjr inn i rundkjringen og deretter ut mot {destination}"}}},"roundabout turn":{default:{default:"Ta en {modifier}",name:"Ta en {modifier} inn p {way_name}",destination:"Ta en {modifier} mot {destination}"},left:{default:"Sving til venstre",name:"Sving til venstre inn p {way_name}",destination:"Sving til venstre mot {destination}"},right:{default:"Sving til hyre",name:"Sving til hyre inn p {way_name}",destination:"Sving til hyre mot {destination}"},straight:{default:"Fortsett rett frem",name:"Fortsett rett frem til  {way_name}",destination:"Fortsett rett frem mot {destination}"}},"exit roundabout":{default:{default:"Kjr ut av rundkjringen",name:"Kjr ut av rundkjringen og inn p {way_name}",destination:"Kjr ut av rundkjringen mot {destination}"}},"exit rotary":{default:{default:"Kjr ut av rundkjringen",name:"Kjr ut av rundkjringen og inn p {way_name}",destination:"Kjr ut av rundkjringen mot {destination}"}},turn:{default:{default:"Ta en {modifier}",name:"Ta en {modifier} inn p {way_name}",destination:"Ta en {modifier} mot {destination}"},left:{default:"Sving til venstre",name:"Sving til venstre inn p {way_name}",destination:"Sving til venstre mot {destination}"},right:{default:"Sving til hyre",name:"Sving til hyre inn p {way_name}",destination:"Sving til hyre mot {destination}"},straight:{default:"Kjr rett frem",name:"Kjr rett frem og inn p {way_name}",destination:"Kjr rett frem mot {destination}"}},"use lane":{no_lanes:{default:"Fortsett rett frem"},default:{default:"{lane_instruction}"}}}}},{}],38:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1.",2:"2.",3:"3.",4:"4.",5:"5.",6:"6.",7:"7.",8:"8.",9:"9.",10:"10."},direction:{north:"pnoc",northeast:"pnocny wschd",east:"wschd",southeast:"poudniowy wschd",south:"poudnie",southwest:"poudniowy zachd",west:"zachd",northwest:"pnocny zachd"},modifier:{left:"lewo",right:"prawo","sharp left":"ostro w lewo","sharp right":"ostro w prawo","slight left":"agodnie w lewo","slight right":"agodnie w prawo",straight:"prosto",uturn:"zawr"},lanes:{xo:"Trzymaj si prawej strony",ox:"Trzymaj si lewej strony",xox:"Trzymaj si rodka",oxo:"Trzymaj si lewej lub prawej strony"}},modes:{ferry:{default:"We prom",name:"We prom {way_name}",destination:"We prom w kierunku {destination}"}},phrase:{"two linked by distance":"{instruction_one}, nastpnie za {distance} {instruction_two}","two linked":"{instruction_one}, nastpnie {instruction_two}","one in distance":"Za {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"exit {exit}"},arrive:{default:{default:"Dojechano do miejsca docelowego {nth}",upcoming:"Dojechano do miejsca docelowego {nth}",short:"Dojechano do miejsca docelowego {nth}","short-upcoming":"Dojechano do miejsca docelowego {nth}",named:"Dojechano do {waypoint_name}"},left:{default:"Dojechano do miejsca docelowego {nth}, po lewej stronie",upcoming:"Dojechano do miejsca docelowego {nth}, po lewej stronie",short:"Dojechano do miejsca docelowego {nth}","short-upcoming":"Dojechano do miejsca docelowego {nth}",named:"Dojechano do {waypoint_name}, po lewej stronie"},right:{default:"Dojechano do miejsca docelowego {nth}, po prawej stronie",upcoming:"Dojechano do miejsca docelowego {nth}, po prawej stronie",short:"Dojechano do miejsca docelowego {nth}","short-upcoming":"Dojechano do miejsca docelowego {nth}",named:"Dojechano do {waypoint_name}, po prawej stronie"},"sharp left":{default:"Dojechano do miejsca docelowego {nth}, po lewej stronie",upcoming:"Dojechano do miejsca docelowego {nth}, po lewej stronie",short:"Dojechano do miejsca docelowego {nth}","short-upcoming":"Dojechano do miejsca docelowego {nth}",named:"Dojechano do {waypoint_name}, po lewej stronie"},"sharp right":{default:"Dojechano do miejsca docelowego {nth}, po prawej stronie",upcoming:"Dojechano do miejsca docelowego {nth}, po prawej stronie",short:"Dojechano do miejsca docelowego {nth}","short-upcoming":"Dojechano do miejsca docelowego {nth}",named:"Dojechano do {waypoint_name}, po prawej stronie"},"slight right":{default:"Dojechano do miejsca docelowego {nth}, po prawej stronie",upcoming:"Dojechano do miejsca docelowego {nth}, po prawej stronie",short:"Dojechano do miejsca docelowego {nth}","short-upcoming":"Dojechano do miejsca docelowego {nth}",named:"Dojechano do {waypoint_name}, po prawej stronie"},"slight left":{default:"Dojechano do miejsca docelowego {nth}, po lewej stronie",upcoming:"Dojechano do miejsca docelowego {nth}, po lewej stronie",short:"Dojechano do miejsca docelowego {nth}","short-upcoming":"Dojechano do miejsca docelowego {nth}",named:"Dojechano do {waypoint_name}, po lewej stronie"},straight:{default:"Dojechano do miejsca docelowego {nth} , prosto",upcoming:"Dojechano do miejsca docelowego {nth} , prosto",short:"Dojechano do miejsca docelowego {nth}","short-upcoming":"Dojechano do miejsca docelowego {nth}",named:"Dojechano do {waypoint_name}, prosto"}},continue:{default:{default:"Skr {modifier}",name:"Skr w {modifier}, aby pozosta na {way_name}",destination:"Skr {modifier} w kierunku {destination}",exit:"Skr {modifier} na {way_name}"},straight:{default:"Kontynuuj prosto",name:"Jed dalej prosto, aby pozosta na {way_name}",destination:"Kontynuuj w kierunku {destination}",distance:"Jed dalej prosto przez {distance}",namedistance:"Jed dalej {way_name} przez {distance}"},"sharp left":{default:"Skr ostro w lewo",name:"Skr w lewo w ostry zakrt, aby pozosta na {way_name}",destination:"Skr ostro w lewo w kierunku {destination}"},"sharp right":{default:"Skr ostro w prawo",name:"Skr w prawo w ostry zakrt, aby pozosta na {way_name}",destination:"Skr ostro w prawo w kierunku {destination}"},"slight left":{default:"Skr w lewo w agodny zakrt",name:"Skr w lewo w agodny zakrt, aby pozosta na {way_name}",destination:"Skr w lewo w agodny zakrt na {destination}"},"slight right":{default:"Skr w prawo w agodny zakrt",name:"Skr w prawo w agodny zakrt, aby pozosta na {way_name}",destination:"Skr w prawo w agodny zakrt na {destination}"},uturn:{default:"Zawr",name:"Zawr i jed dalej {way_name}",destination:"Zawr w kierunku {destination}"}},depart:{default:{default:"Kieruj si {direction}",name:"Kieruj si {direction} na {way_name}",namedistance:"Head {direction} on {way_name} for {distance}"}},"end of road":{default:{default:"Skr {modifier}",name:"Skr {modifier} na {way_name}",destination:"Skr {modifier} w kierunku {destination}"},straight:{default:"Kontynuuj prosto",name:"Kontynuuj prosto na {way_name}",destination:"Kontynuuj prosto w kierunku {destination}"},uturn:{default:"Zawr na kocu ulicy",name:"Zawr na kocu ulicy na {way_name}",destination:"Zawr na kocu ulicy w kierunku {destination}"}},fork:{default:{default:"Na rozwidleniu trzymaj si {modifier}",name:"Na rozwidleniu trzymaj si {modifier} na {way_name}",destination:"Na rozwidleniu trzymaj si {modifier} w kierunku {destination}"},"slight left":{default:"Na rozwidleniu trzymaj si lewej strony",name:"Na rozwidleniu trzymaj si lewej strony w {way_name}",destination:"Na rozwidleniu trzymaj si lewej strony w kierunku {destination}"},"slight right":{default:"Na rozwidleniu trzymaj si prawej strony",name:"Na rozwidleniu trzymaj si prawej strony na {way_name}",destination:"Na rozwidleniu trzymaj si prawej strony w kierunku {destination}"},"sharp left":{default:"Na rozwidleniu skr ostro w lewo",name:"Skr ostro w lewo w {way_name}",destination:"Skr ostro w lewo w kierunku {destination}"},"sharp right":{default:"Na rozwidleniu skr ostro w prawo",name:"Skr ostro w prawo na {way_name}",destination:"Skr ostro w prawo w kierunku {destination}"},uturn:{default:"Zawr",name:"Zawr na {way_name}",destination:"Zawr w kierunku {destination}"}},merge:{default:{default:"Wcz si {modifier}",name:"Wcz si {modifier} na {way_name}",destination:"Wcz si {modifier} w kierunku {destination}"},straight:{default:"Wcz si prosto",name:"Wcz si prosto na {way_name}",destination:"Wcz si prosto w kierunku {destination}"},"slight left":{default:"Wcz si z lewej strony",name:"Wcz si z lewej strony na {way_name}",destination:"Wcz si z lewej strony w kierunku {destination}"},"slight right":{default:"Wcz si z prawej strony",name:"Wcz si z prawej strony na {way_name}",destination:"Wcz si z prawej strony w kierunku {destination}"},"sharp left":{default:"Wcz si z lewej strony",name:"Wcz si z lewej strony na {way_name}",destination:"Wcz si z lewej strony w kierunku {destination}"},"sharp right":{default:"Wcz si z prawej strony",name:"Wcz si z prawej strony na {way_name}",destination:"Wcz si z prawej strony w kierunku {destination}"},uturn:{default:"Zawr",name:"Zawr na {way_name}",destination:"Zawr w kierunku {destination}"}},"new name":{default:{default:"Kontynuuj {modifier}",name:"Kontynuuj {modifier} na {way_name}",destination:"Kontynuuj {modifier} w kierunku {destination}"},straight:{default:"Kontynuuj prosto",name:"Kontynuuj na {way_name}",destination:"Kontynuuj w kierunku {destination}"},"sharp left":{default:"Skr ostro w lewo",name:"Skr ostro w lewo w {way_name}",destination:"Skr ostro w lewo w kierunku {destination}"},"sharp right":{default:"Skr ostro w prawo",name:"Skr ostro w prawo na {way_name}",destination:"Skr ostro w prawo w kierunku {destination}"},"slight left":{default:"Kontynuuj agodnie w lewo",name:"Kontynuuj agodnie w lewo na {way_name}",destination:"Kontynuuj agodnie w lewo w kierunku {destination}"},"slight right":{default:"Kontynuuj agodnie w prawo",name:"Kontynuuj agodnie w prawo na {way_name}",destination:"Kontynuuj agodnie w prawo w kierunku {destination}"},uturn:{default:"Zawr",name:"Zawr na {way_name}",destination:"Zawr w kierunku {destination}"}},notification:{default:{default:"Kontynuuj {modifier}",name:"Kontynuuj {modifier} na {way_name}",destination:"Kontynuuj {modifier} w kierunku {destination}"},uturn:{default:"Zawr",name:"Zawr na {way_name}",destination:"Zawr w kierunku {destination}"}},"off ramp":{default:{default:"Zjed",name:"We zjazd na {way_name}",destination:"We zjazd w kierunku {destination}",exit:"Zjed zjazdem {exit}",exit_destination:"Zjed zjazdem {exit} na {destination}"},left:{default:"We zjazd po lewej",name:"We zjazd po lewej na {way_name}",destination:"We zjazd po lewej w kierunku {destination}",exit:"Zjed zjazdem {exit} po lewej stronie",exit_destination:"Zjed zjazdem {exit} po lewej stronie na {destination}"},right:{default:"We zjazd po prawej",name:"We zjazd po prawej na {way_name}",destination:"We zjazd po prawej w kierunku {destination}",exit:"Zjed zjazdem {exit} po prawej stronie",exit_destination:"Zjed zjazdem {exit} po prawej stronie na {destination}"},"sharp left":{default:"We zjazd po lewej",name:"We zjazd po lewej na {way_name}",destination:"We zjazd po lewej w kierunku {destination}",exit:"Zjed zjazdem {exit} po lewej stronie",exit_destination:"Zjed zjazdem {exit} po lewej stronie na {destination}"},"sharp right":{default:"We zjazd po prawej",name:"We zjazd po prawej na {way_name}",destination:"We zjazd po prawej w kierunku {destination}",exit:"Zjed zjazdem {exit} po prawej stronie",exit_destination:"Zjed zjazdem {exit} po prawej stronie na {destination}"},"slight left":{default:"We zjazd po lewej",name:"We zjazd po lewej na {way_name}",destination:"We zjazd po lewej w kierunku {destination}",exit:"Zjed zjazdem {exit} po lewej stronie",exit_destination:"Zjed zjazdem {exit} po lewej stronie na {destination}"},"slight right":{default:"We zjazd po prawej",name:"We zjazd po prawej na {way_name}",destination:"We zjazd po prawej w kierunku {destination}",exit:"Zjed zjazdem {exit} po prawej stronie",exit_destination:"Zjed zjazdem {exit} po prawej stronie na {destination}"}},"on ramp":{default:{default:"We zjazd",name:"We zjazd na {way_name}",destination:"We zjazd w kierunku {destination}"},left:{default:"We zjazd po lewej",name:"We zjazd po lewej na {way_name}",destination:"We zjazd po lewej w kierunku {destination}"},right:{default:"We zjazd po prawej",name:"We zjazd po prawej na {way_name}",destination:"We zjazd po prawej w kierunku {destination}"},"sharp left":{default:"We zjazd po lewej",name:"We zjazd po lewej na {way_name}",destination:"We zjazd po lewej w kierunku {destination}"},"sharp right":{default:"We zjazd po prawej",name:"We zjazd po prawej na {way_name}",destination:"We zjazd po prawej w kierunku {destination}"},"slight left":{default:"We zjazd po lewej",name:"We zjazd po lewej na {way_name}",destination:"We zjazd po lewej w kierunku {destination}"},"slight right":{default:"We zjazd po prawej",name:"We zjazd po prawej na {way_name}",destination:"We zjazd po prawej w kierunku {destination}"}},rotary:{default:{default:{default:"Wjed na rondo",name:"Wjed na rondo i skr na {way_name}",destination:"Wjed na rondo i skr w kierunku {destination}"},name:{default:"Wjed na {rotary_name}",name:"Wjed na {rotary_name} i skr na {way_name}",destination:"Wjed na {rotary_name} i skr w kierunku {destination}"},exit:{default:"Wjed na rondo i wyjed {exit_number} zjazdem",name:"Wjed na rondo i wyjed {exit_number} zjazdem na {way_name}",destination:"Wjed na rondo i wyjed {exit_number} zjazdem w kierunku {destination}"},name_exit:{default:"Wjed na {rotary_name} i wyjed {exit_number} zjazdem",name:"Wjed na {rotary_name} i wyjed {exit_number} zjazdem na {way_name}",destination:"Wjed na {rotary_name} i wyjed {exit_number} zjazdem w kierunku {destination}"}}},roundabout:{default:{exit:{default:"Wjed na rondo i wyjed {exit_number} zjazdem",name:"Wjed na rondo i wyjed {exit_number} zjazdem na {way_name}",destination:"Wjed na rondo i wyjed {exit_number} zjazdem w kierunku {destination}"},default:{default:"Wjed na rondo",name:"Wjed na rondo i wyjed na {way_name}",destination:"Wjed na rondo i wyjed w kierunku {destination}"}}},"roundabout turn":{default:{default:"{modifier}",name:"{modifier} na {way_name}",destination:"{modifier} w kierunku {destination}"},left:{default:"Skr w lewo",name:"Skr w lewo na {way_name}",destination:"Skr w lewo w kierunku {destination}"},right:{default:"Skr w prawo",name:"Skr w prawo na {way_name}",destination:"Skr w prawo w kierunku {destination}"},straight:{default:"Kontynuuj prosto",name:"Kontynuuj prosto na {way_name}",destination:"Kontynuuj prosto w kierunku {destination}"}},"exit roundabout":{default:{default:"{modifier}",name:"{modifier} na {way_name}",destination:"{modifier} w kierunku {destination}"},left:{default:"Skr w lewo",name:"Skr w lewo na {way_name}",destination:"Skr w lewo w kierunku {destination}"},right:{default:"Skr w prawo",name:"Skr w prawo na {way_name}",destination:"Skr w prawo w kierunku {destination}"},straight:{default:"Kontynuuj prosto",name:"Kontynuuj prosto na {way_name}",destination:"Kontynuuj prosto w kierunku {destination}"}},"exit rotary":{default:{default:"{modifier}",name:"{modifier} na {way_name}",destination:"{modifier} w kierunku {destination}"},left:{default:"Skr w lewo",name:"Skr w lewo na {way_name}",destination:"Skr w lewo w kierunku {destination}"},right:{default:"Skr w prawo",name:"Skr w prawo na {way_name}",destination:"Skr w prawo w kierunku {destination}"},straight:{default:"Jed prosto",name:"Jed prosto na {way_name}",destination:"Jed prosto w kierunku {destination}"}},turn:{default:{default:"{modifier}",name:"{modifier} na {way_name}",destination:"{modifier} w kierunku {destination}"},left:{default:"Skr w lewo",name:"Skr w lewo na {way_name}",destination:"Skr w lewo w kierunku {destination}"},right:{default:"Skr w prawo",name:"Skr w prawo na {way_name}",destination:"Skr w prawo w kierunku {destination}"},straight:{default:"Jed prosto",name:"Jed prosto na {way_name}",destination:"Jed prosto w kierunku {destination}"}},"use lane":{no_lanes:{default:"Kontynuuj prosto"},default:{default:"{lane_instruction}"}}}}},{}],39:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"},direction:{north:"norte",northeast:"nordeste",east:"leste",southeast:"sudeste",south:"sul",southwest:"sudoeste",west:"oeste",northwest:"noroeste"},modifier:{left:" esquerda",right:" direita","sharp left":"fechada  esquerda","sharp right":"fechada  direita","slight left":"suave  esquerda","slight right":"suave  direita",straight:"em frente",uturn:"retorno"},lanes:{xo:"Mantenha-se  direita",ox:"Mantenha-se  esquerda",xox:"Mantenha-se ao centro",oxo:"Mantenha-se  esquerda ou direita"}},modes:{ferry:{default:"Pegue a balsa",name:"Pegue a balsa {way_name}",destination:"Pegue a balsa sentido {destination}"}},phrase:{"two linked by distance":"{instruction_one}, ento, em {distance}, {instruction_two}","two linked":"{instruction_one}, ento {instruction_two}","one in distance":"Em {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"sada {exit}"},arrive:{default:{default:"Voc chegou ao seu {nth} destino",upcoming:"Voc chegar ao seu {nth} destino",short:"Voc chegou","short-upcoming":"Voc vai chegar",named:"Voc chegou a {waypoint_name}"},left:{default:"Voc chegou ao seu {nth} destino,  esquerda",upcoming:"Voc chegar ao seu {nth} destino,  esquerda",short:"Voc chegou","short-upcoming":"Voc vai chegar",named:"Voc chegou {waypoint_name},  esquerda"},right:{default:"Voc chegou ao seu {nth} destino,  direita",upcoming:"Voc chegar ao seu {nth} destino,  direita",short:"Voc chegou","short-upcoming":"Voc vai chegar",named:"Voc chegou {waypoint_name},  direita"},"sharp left":{default:"Voc chegou ao seu {nth} destino,  esquerda",upcoming:"Voc chegar ao seu {nth} destino,  esquerda",short:"Voc chegou","short-upcoming":"Voc vai chegar",named:"Voc chegou {waypoint_name},  esquerda"},"sharp right":{default:"Voc chegou ao seu {nth} destino,  direita",upcoming:"Voc chegar ao seu {nth} destino,  direita",short:"Voc chegou","short-upcoming":"Voc vai chegar",named:"Voc chegou {waypoint_name},  direita"},"slight right":{default:"Voc chegou ao seu {nth} destino,  direita",upcoming:"Voc chegar ao seu {nth} destino,  direita",short:"Voc chegou","short-upcoming":"Voc vai chegar",named:"Voc chegou {waypoint_name},  direita"},"slight left":{default:"Voc chegou ao seu {nth} destino,  esquerda",upcoming:"Voc chegar ao seu {nth} destino,  esquerda",short:"Voc chegou","short-upcoming":"Voc vai chegar",named:"Voc chegou {waypoint_name},  esquerda"},straight:{default:"Voc chegou ao seu {nth} destino, em frente",upcoming:"Voc vai chegar ao seu {nth} destino, em frente",short:"Voc chegou","short-upcoming":"Voc vai chegar",named:"You have arrived at {waypoint_name}, straight ahead"}},continue:{default:{default:"Vire {modifier}",name:"Vire {modifier} para manter-se na {way_name}",destination:"Vire {modifier} sentido {destination}",exit:"Vire {modifier} em {way_name}"},straight:{default:"Continue em frente",name:"Continue em frente para manter-se na {way_name}",destination:"Continue em direo  {destination}",distance:"Continue em frente por {distance}",namedistance:"Continue na {way_name} por {distance}"},"sharp left":{default:"Faa uma curva fechada a esquerda",name:"Faa uma curva fechada a esquerda para manter-se na {way_name}",destination:"Faa uma curva fechada a esquerda sentido {destination}"},"sharp right":{default:"Faa uma curva fechada a direita",name:"Faa uma curva fechada a direita para manter-se na {way_name}",destination:"Faa uma curva fechada a direita sentido {destination}"},"slight left":{default:"Faa uma curva suave a esquerda",name:"Faa uma curva suave a esquerda para manter-se na {way_name}",destination:"Faa uma curva suave a esquerda em direo a {destination}"},"slight right":{default:"Faa uma curva suave a direita",name:"Faa uma curva suave a direita para manter-se na {way_name}",destination:"Faa uma curva suave a direita em direo a {destination}"},uturn:{default:"Faa o retorno",name:"Faa o retorno e continue em {way_name}",destination:"Faa o retorno sentido {destination}"}},depart:{default:{default:"Siga {direction}",name:"Siga {direction} em {way_name}",namedistance:"Siga {direction} na {way_name} por {distance}"}},"end of road":{default:{default:"Vire {modifier}",name:"Vire {modifier} em {way_name}",destination:"Vire {modifier} sentido {destination}"},straight:{default:"Continue em frente",name:"Continue em frente em {way_name}",destination:"Continue em frente sentido {destination}"},uturn:{default:"Faa o retorno no fim da rua",name:"Faa o retorno em {way_name} no fim da rua",destination:"Faa o retorno sentido {destination} no fim da rua"}},fork:{default:{default:"Mantenha-se {modifier} na bifurcao",name:"Mantenha-se {modifier} na bifurcao em {way_name}",destination:"Mantenha-se {modifier} na bifurcao sentido {destination}"},"slight left":{default:"Mantenha-se  esquerda na bifurcao",name:"Mantenha-se  esquerda na bifurcao em {way_name}",destination:"Mantenha-se  esquerda na bifurcao sentido {destination}"},"slight right":{default:"Mantenha-se  direita na bifurcao",name:"Mantenha-se  direita na bifurcao em {way_name}",destination:"Mantenha-se  direita na bifurcao sentido {destination}"},"sharp left":{default:"Faa uma curva fechada  esquerda na bifurcao",name:"Faa uma curva fechada  esquerda em {way_name}",destination:"Faa uma curva fechada  esquerda sentido {destination}"},"sharp right":{default:"Faa uma curva fechada  direita na bifurcao",name:"Faa uma curva fechada  direita em {way_name}",destination:"Faa uma curva fechada  direita sentido {destination}"},uturn:{default:"Faa o retorno",name:"Faa o retorno em {way_name}",destination:"Faa o retorno sentido {destination}"}},merge:{default:{default:"Entre {modifier}",name:"Entre {modifier} na {way_name}",destination:"Entre {modifier} em direo  {destination}"},straight:{default:"Mesclar",name:"Entre reto na {way_name}",destination:"Entre reto em direo  {destination}"},"slight left":{default:"Entre  esquerda",name:"Entre  esquerda na {way_name}",destination:"Entre  esquerda em direo  {destination}"},"slight right":{default:"Entre  direita",name:"Entre  direita na {way_name}",destination:"Entre  direita em direo  {destination}"},"sharp left":{default:"Entre  esquerda",name:"Entre  esquerda na {way_name}",destination:"Entre  esquerda em direo  {destination}"},"sharp right":{default:"Entre  direita",name:"Entre  direita na {way_name}",destination:"Entre  direita em direo  {destination}"},uturn:{default:"Faa o retorno",name:"Faa o retorno em {way_name}",destination:"Faa o retorno sentido {destination}"}},"new name":{default:{default:"Continue {modifier}",name:"Continue {modifier} em {way_name}",destination:"Continue {modifier} sentido {destination}"},straight:{default:"Continue em frente",name:"Continue em {way_name}",destination:"Continue em direo  {destination}"},"sharp left":{default:"Faa uma curva fechada  esquerda",name:"Faa uma curva fechada  esquerda em {way_name}",destination:"Faa uma curva fechada  esquerda sentido {destination}"},"sharp right":{default:"Faa uma curva fechada  direita",name:"Faa uma curva fechada  direita em {way_name}",destination:"Faa uma curva fechada  direita sentido {destination}"},"slight left":{default:"Continue ligeiramente  esquerda",name:"Continue ligeiramente  esquerda em {way_name}",destination:"Continue ligeiramente  esquerda sentido {destination}"},"slight right":{default:"Continue ligeiramente  direita",name:"Continue ligeiramente  direita em {way_name}",destination:"Continue ligeiramente  direita sentido {destination}"},uturn:{default:"Faa o retorno",name:"Faa o retorno em {way_name}",destination:"Faa o retorno sentido {destination}"}},notification:{default:{default:"Continue {modifier}",name:"Continue {modifier} em {way_name}",destination:"Continue {modifier} sentido {destination}"},uturn:{default:"Faa o retorno",name:"Faa o retorno em {way_name}",destination:"Faa o retorno sentido {destination}"}},"off ramp":{default:{default:"Pegue a rampa",name:"Pegue a rampa em {way_name}",destination:"Pegue a rampa sentido {destination}",exit:"Pegue a sada {exit}",exit_destination:"Pegue a sada {exit} em direo  {destination}"},left:{default:"Pegue a rampa  esquerda",name:"Pegue a rampa  esquerda em {way_name}",destination:"Pegue a rampa  esquerda sentido {destination}",exit:"Pegue a sada {exit}  esquerda",exit_destination:"Pegue a sada {exit}   esquerda em direo  {destination}"},right:{default:"Pegue a rampa  direita",name:"Pegue a rampa  direita em {way_name}",destination:"Pegue a rampa  direita sentido {destination}",exit:"Pegue a sada {exit}  direita",exit_destination:"Pegue a sada {exit}  direita em direo  {destination}"},"sharp left":{default:"Pegue a rampa  esquerda",name:"Pegue a rampa  esquerda em {way_name}",destination:"Pegue a rampa  esquerda sentido {destination}",exit:"Pegue a sada {exit}  esquerda",exit_destination:"Pegue a sada {exit}   esquerda em direo  {destination}"},"sharp right":{default:"Pegue a rampa  direita",name:"Pegue a rampa  direita em {way_name}",destination:"Pegue a rampa  direita sentido {destination}",exit:"Pegue a sada {exit}  direita",exit_destination:"Pegue a sada {exit}  direita em direo  {destination}"},"slight left":{default:"Pegue a rampa  esquerda",name:"Pegue a rampa  esquerda em {way_name}",destination:"Pegue a rampa  esquerda sentido {destination}",exit:"Pegue a sada {exit}  esquerda",exit_destination:"Pegue a sada {exit}   esquerda em direo  {destination}"},"slight right":{default:"Pegue a rampa  direita",name:"Pegue a rampa  direita em {way_name}",destination:"Pegue a rampa  direita sentido {destination}",exit:"Pegue a sada {exit}  direita",exit_destination:"Pegue a sada {exit}  direita em direo  {destination}"}},"on ramp":{default:{default:"Pegue a rampa",name:"Pegue a rampa em {way_name}",destination:"Pegue a rampa sentido {destination}"},left:{default:"Pegue a rampa  esquerda",name:"Pegue a rampa  esquerda em {way_name}",destination:"Pegue a rampa  esquerda sentido {destination}"},right:{default:"Pegue a rampa  direita",name:"Pegue a rampa  direita em {way_name}",destination:"Pegue a rampa  direita sentid {destination}"},"sharp left":{default:"Pegue a rampa  esquerda",name:"Pegue a rampa  esquerda em {way_name}",destination:"Pegue a rampa  esquerda sentido {destination}"},"sharp right":{default:"Pegue a rampa  direita",name:"Pegue a rampa  direita em {way_name}",destination:"Pegue a rampa  direita sentido {destination}"},"slight left":{default:"Pegue a rampa  esquerda",name:"Pegue a rampa  esquerda em {way_name}",destination:"Pegue a rampa  esquerda sentido {destination}"},"slight right":{default:"Pegue a rampa  direita",name:"Pegue a rampa  direita em {way_name}",destination:"Pegue a rampa  direita sentido {destination}"}},rotary:{default:{default:{default:"Entre na rotatria",name:"Entre na rotatria e saia na {way_name}",destination:"Entre na rotatria e saia sentido {destination}"},name:{default:"Entre em {rotary_name}",name:"Entre em {rotary_name} e saia em {way_name}",destination:"Entre em {rotary_name} e saia sentido {destination}"},exit:{default:"Entre na rotatria e pegue a {exit_number} sada",name:"Entre na rotatria e pegue a {exit_number} sada na {way_name}",destination:"Entre na rotatria e pegue a {exit_number} sada sentido {destination}"},name_exit:{default:"Entre em {rotary_name} e saia na {exit_number} sada",name:"Entre em {rotary_name} e saia na {exit_number} sada em {way_name}",destination:"Entre em {rotary_name} e saia na {exit_number} sada sentido {destination}"}}},roundabout:{default:{exit:{default:"Entre na rotatria e pegue a {exit_number} sada",name:"Entre na rotatria e pegue a {exit_number} sada na {way_name}",destination:"Entre na rotatria e pegue a {exit_number} sada sentido {destination}"},default:{default:"Entre na rotatria",name:"Entre na rotatria e saia na {way_name}",destination:"Entre na rotatria e saia sentido {destination}"}}},"roundabout turn":{default:{default:"Siga {modifier}",name:"Siga {modifier} em {way_name}",destination:"Siga {modifier} sentido {destination}"},left:{default:"Vire  esquerda",name:"Vire  esquerda em {way_name}",destination:"Vire  esquerda sentido {destination}"},right:{default:"Vire  direita",name:"Vire  direita em {way_name}",destination:"Vire  direita sentido {destination}"},straight:{default:"Continue em frente",name:"Continue em frente em {way_name}",destination:"Continue em frente sentido {destination}"}},"exit roundabout":{default:{default:"Saia da rotatria",name:"Exit the traffic circle onto {way_name}",destination:"Exit the traffic circle towards {destination}"}},"exit rotary":{default:{default:"Saia da rotatria",name:"Exit the traffic circle onto {way_name}",destination:"Exit the traffic circle towards {destination}"}},turn:{default:{default:"Siga {modifier}",name:"Siga {modifier} em {way_name}",destination:"Siga {modifier} sentido {destination}"},left:{default:"Vire  esquerda",name:"Vire  esquerda em {way_name}",destination:"Vire  esquerda sentido {destination}"},right:{default:"Vire  direita",name:"Vire  direita em {way_name}",destination:"Vire  direita sentido {destination}"},straight:{default:"Siga em frente",name:"Siga em frente em {way_name}",destination:"Siga em frente sentido {destination}"}},"use lane":{no_lanes:{default:"Continue em frente"},default:{default:"{lane_instruction}"}}}}},{}],40:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"},direction:{north:"norte",northeast:"nordeste",east:"este",southeast:"sudeste",south:"sul",southwest:"sudoeste",west:"oeste",northwest:"noroeste"},modifier:{left:" esquerda",right:" direita","sharp left":"acentuadamente  esquerda","sharp right":"acentuadamente  direita","slight left":"ligeiramente  esquerda","slight right":"ligeiramente  direita",straight:"em frente",uturn:"inverso de marcha"},lanes:{xo:"Mantenha-se  direita",ox:"Mantenha-se  esquerda",xox:"Mantenha-se ao meio",oxo:"Mantenha-se  esquerda ou  direita"}},modes:{ferry:{default:"Apanhe o ferry",name:"Apanhe o ferry {way_name}",destination:"Apanhe o ferry para {destination}"}},phrase:{"two linked by distance":"{instruction_one}, depois, a {distance}, {instruction_two}","two linked":"{instruction_one}, depois {instruction_two}","one in distance":"A {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"sada {exit}"},arrive:{default:{default:"Chegou ao seu {nth} destino",upcoming:"Est a chegar ao seu {nth} destino",short:"Chegou","short-upcoming":"Est a chegar",named:"Chegou a {waypoint_name}"},left:{default:"Chegou ao seu {nth} destino,  esquerda",upcoming:"Est a chegar ao seu {nth} destino,  esquerda",short:"Chegou","short-upcoming":"Est a chegar",named:"Chegou a {waypoint_name},  esquerda"},right:{default:"Chegou ao seu {nth} destino,  direita",upcoming:"Est a chegar ao seu {nth} destino,  direita",short:"Chegou","short-upcoming":"Est a chegar",named:"Chegou a {waypoint_name},  direita"},"sharp left":{default:"Chegou ao seu {nth} destino,  esquerda",upcoming:"Est a chegar ao seu {nth} destino,  esquerda",short:"Chegou","short-upcoming":"Est a chegar",named:"Chegou a {waypoint_name},  esquerda"},"sharp right":{default:"Chegou ao seu {nth} destino,  direita",upcoming:"Est a chegar ao seu {nth} destino,  direita",short:"Chegou","short-upcoming":"Est a chegar",named:"Chegou a {waypoint_name},  direita"},"slight right":{default:"Chegou ao seu {nth} destino,  direita",upcoming:"Est a chegar ao seu {nth} destino,  direita",short:"Chegou","short-upcoming":"Est a chegar",named:"Chegou a {waypoint_name},  direita"},"slight left":{default:"Chegou ao seu {nth} destino,  esquerda",upcoming:"Est a chegar ao seu {nth} destino,  esquerda",short:"Chegou","short-upcoming":"Est a chegar",named:"Chegou a {waypoint_name},  esquerda"},straight:{default:"Chegou ao seu {nth} destino, em frente",upcoming:"Est a chegar ao seu {nth} destino, em frente",short:"Chegou","short-upcoming":"Est a chegar",named:"Chegou a {waypoint_name}, em frente"}},continue:{default:{default:"Vire {modifier}",name:"Vire {modifier} para se manter em {way_name}",destination:"Vire {modifier} em direo a {destination}",exit:"Vire {modifier} para {way_name}"},straight:{default:"Continue em frente",name:"Continue em frente para se manter em {way_name}",destination:"Continue em direo a {destination}",distance:"Continue em frente por {distance}",namedistance:"Continue em {way_name} por {distance}"},"sharp left":{default:"Vire acentuadamente  esquerda",name:"Vire acentuadamente  esquerda para se manter em {way_name}",destination:"Vire acentuadamente  esquerda em direo a {destination}"},"sharp right":{default:"Vire acentuadamente  direita",name:"Vire acentuadamente  direita para se manter em {way_name}",destination:"Vire acentuadamente  direita em direo a {destination}"},"slight left":{default:"Vire ligeiramente  esquerda",name:"Vire ligeiramente  esquerda para se manter em {way_name}",destination:"Vire ligeiramente  esquerda em direo a {destination}"},"slight right":{default:"Vire ligeiramente  direita",name:"Vire ligeiramente  direita para se manter em {way_name}",destination:"Vire ligeiramente  direita em direo a {destination}"},uturn:{default:"Faa inverso de marcha",name:"Faa inverso de marcha e continue em {way_name}",destination:"Faa inverso de marcha em direo a {destination}"}},depart:{default:{default:"Dirija-se para {direction}",name:"Dirija-se para {direction} em {way_name}",namedistance:"Dirija-se para {direction} em {way_name} por {distance}"}},"end of road":{default:{default:"Vire {modifier}",name:"Vire {modifier} para {way_name}",destination:"Vire {modifier} em direo a {destination}"},straight:{default:"Continue em frente",name:"Continue em frente para {way_name}",destination:"Continue em frente em direo a {destination}"},uturn:{default:"No final da estrada faa uma inverso de marcha",name:"No final da estrada faa uma inverso de marcha para {way_name} ",destination:"No final da estrada faa uma inverso de marcha em direo a {destination}"}},fork:{default:{default:"Na bifurcao mantenha-se {modifier}",name:"Mantenha-se {modifier} para {way_name}",destination:"Mantenha-se {modifier} em direo a {destination}"},"slight left":{default:"Na bifurcao mantenha-se  esquerda",name:"Mantenha-se  esquerda para {way_name}",destination:"Mantenha-se  esquerda em direo a {destination}"},"slight right":{default:"Na bifurcao mantenha-se  direita",name:"Mantenha-se  direita para {way_name}",destination:"Mantenha-se  direita em direo a {destination}"},"sharp left":{default:"Na bifurcao vire acentuadamente  esquerda",name:"Vire acentuadamente  esquerda para {way_name}",destination:"Vire acentuadamente  esquerda em direo a {destination}"},"sharp right":{default:"Na bifurcao vire acentuadamente  direita",name:"Vire acentuadamente  direita para {way_name}",destination:"Vire acentuadamente  direita em direo a {destination}"},uturn:{default:"Faa inverso de marcha",name:"Faa inverso de marcha para {way_name}",destination:"Faa inverso de marcha em direo a {destination}"}},merge:{default:{default:"Una-se ao trfego {modifier}",name:"Una-se ao trfego {modifier} para {way_name}",destination:"Una-se ao trfego {modifier} em direo a {destination}"},straight:{default:"Una-se ao trfego",name:" Una-se ao trfego para {way_name}",destination:"Una-se ao trfego em direo a {destination}"},"slight left":{default:"Una-se ao trfego  esquerda",name:"Una-se ao trfego  esquerda para {way_name}",destination:"Una-se ao trfego  esquerda em direo a {destination}"},"slight right":{default:"Una-se ao trfego  direita",name:"Una-se ao trfego  direita para {way_name}",destination:"Una-se ao trfego  direita em direo a {destination}"},"sharp left":{default:"Una-se ao trfego  esquerda",name:"Una-se ao trfego  esquerda para {way_name}",destination:"Una-se ao trfego  esquerda em direo a {destination}"},"sharp right":{default:"Una-se ao trfego  direita",name:"Una-se ao trfego  direita para {way_name}",destination:"Una-se ao trfego  direita em direo a {destination}"},uturn:{default:"Faa inverso de marcha",name:"Faa inverso de marcha para {way_name}",destination:"Faa inverso de marcha em direo a {destination}"}},"new name":{default:{default:"Continue {modifier}",name:"Continue {modifier} para {way_name}",destination:"Continue {modifier} em direo a {destination}"},straight:{default:"Continue em frente",name:"Continue para {way_name}",destination:"Continue em direo a {destination}"},"sharp left":{default:"Vire acentuadamente  esquerda",name:"Vire acentuadamente  esquerda para {way_name}",destination:"Vire acentuadamente  esquerda em direo a{destination}"},"sharp right":{default:"Vire acentuadamente  direita",name:"Vire acentuadamente  direita para {way_name}",destination:"Vire acentuadamente  direita em direo a {destination}"},"slight left":{default:"Continue ligeiramente  esquerda",name:"Continue ligeiramente  esquerda para {way_name}",destination:"Continue ligeiramente  esquerda em direo a {destination}"},"slight right":{default:"Continue ligeiramente  direita",name:"Continue ligeiramente  direita para {way_name}",destination:"Continue ligeiramente  direita em direo a {destination}"},uturn:{default:"Faa inverso de marcha",name:"Faa inverso de marcha para {way_name}",destination:"Faa inverso de marcha em direo a {destination}"}},notification:{default:{default:"Continue {modifier}",name:"Continue {modifier} para {way_name}",destination:"Continue {modifier} em direo a {destination}"},uturn:{default:"Faa inverso de marcha",name:"Faa inverso de marcha para {way_name}",destination:"Faa inverso de marcha em direo a {destination}"}},"off ramp":{default:{default:"Saia na sada",name:"Saia na sada para {way_name}",destination:"Saia na sada em direo a {destination}",exit:"Saia na sada {exit}",exit_destination:"Saia na sada {exit} em direo a {destination}"},left:{default:"Saia na sada  esquerda",name:"Saia na sada  esquerda para {way_name}",destination:"Saia na sada  esquerda em direo a {destination}",exit:"Saia na sada {exit}  esquerda",exit_destination:"Saia na sada {exit}  esquerda em direo a {destination}"},right:{default:"Saia na sada  direita",name:"Saia na sada  direita para {way_name}",destination:"Saia na sada  direita em direo a {destination}",exit:"Saia na sada {exit}  direita",exit_destination:"Saia na sada {exit}  direita em direo a {destination}"},"sharp left":{default:"Saia na sada  esquerda",name:"Saia na sada  esquerda para {way_name}",destination:"Saia na sada  esquerda em direo a {destination}",exit:"Saia na sada {exit}  esquerda",exit_destination:"Saia na sada {exit}  esquerda em direo a {destination}"},"sharp right":{default:"Saia na sada  direita",name:"Saia na sada  direita para {way_name}",destination:"Saia na sada  direita em direo a {destination}",exit:"Saia na sada {exit}  direita",exit_destination:"Saia na sada {exit}  direita em direo a {destination}"},"slight left":{default:"Saia na sada  esquerda",name:"Saia na sada  esquerda para {way_name}",destination:"Saia na sada  esquerda em direo a {destination}",exit:"Saia na sada {exit}  esquerda",exit_destination:"Saia na sada {exit}  esquerda em direo a {destination}"},"slight right":{default:"Saia na sada  direita",name:"Saia na sada  direita para {way_name}",destination:"Saia na sada  direita em direo a {destination}",exit:"Saia na sada {exit}  direita",exit_destination:"Saia na sada {exit}  direita em direo a {destination}"}},"on ramp":{default:{default:"Saia na sada",name:"Saia na sada para {way_name}",destination:"Saia na sada em direo a {destination}"},left:{default:"Saia na sada  esquerda",name:"Saia na sada  esquerda para {way_name}",destination:"Saia na sada  esquerda em direo a {destination}"},right:{default:"Saia na sada  direita",name:"Saia na sada  direita para {way_name}",destination:"Saia na sada  direita em direo a {destination}"},"sharp left":{default:"Saia na sada  esquerda",name:"Saia na sada  esquerda para {way_name}",destination:"Saia na sada  esquerda em direo a {destination}"},"sharp right":{default:"Saia na sada  direita",name:"Saia na sada  direita para {way_name}",destination:"Saia na sada  direita em direo a {destination}"},"slight left":{default:"Saia na sada  esquerda",name:"Saia na sada  esquerda para {way_name}",destination:"Saia na sada  esquerda em direo a {destination}"},"slight right":{default:"Saia na sada  direita",name:"Saia na sada  direita para {way_name}",destination:"Saia na sada  direita em direo a {destination}"}},rotary:{default:{default:{default:"Entre na rotunda",name:"Entre na rotunda e saia para {way_name}",destination:"Entre na rotunda e saia em direo a {destination}"},name:{default:"Entre em {rotary_name}",name:"Entre em {rotary_name} e saia para {way_name}",destination:"Entre em {rotary_name} e saia em direo a {destination}"},exit:{default:"Entre na rotunda e saia na sada {exit_number}",name:"Entre na rotunda e saia na sada {exit_number} para {way_name}",destination:"Entre na rotunda e saia na sada {exit_number} em direo a {destination}"},name_exit:{default:"Entre em {rotary_name} e saia na sada {exit_number}",name:"Entre em {rotary_name} e saia na sada {exit_number} para {way_name}",destination:"Entre em{rotary_name} e saia na sada {exit_number} em direo a {destination}"}}},roundabout:{default:{exit:{default:"Entre na rotunda e saia na sada {exit_number}",name:"Entre na rotunda e saia na sada {exit_number} para {way_name}",destination:"Entre na rotunda e saia na sada {exit_number} em direo a {destination}"},default:{default:"Entre na rotunda",name:"Entre na rotunda e saia para {way_name}",destination:"Entre na rotunda e saia em direo a {destination}"}}},"roundabout turn":{default:{default:"Siga {modifier}",name:"Siga {modifier} para {way_name}",destination:"Siga {modifier} em direo a {destination}"},left:{default:"Vire  esquerda",name:"Vire  esquerda para {way_name}",destination:"Vire  esquerda em direo a {destination}"},right:{default:"Vire  direita",name:"Vire  direita para {way_name}",destination:"Vire  direita em direo a {destination}"},straight:{default:"Continue em frente",name:"Continue em frente para {way_name}",destination:"Continue em frente em direo a {destination}"}},"exit roundabout":{default:{default:"Saia da rotunda",name:"Saia da rotunda para {way_name}",destination:"Saia da rotunda em direo a {destination}"}},"exit rotary":{default:{default:"Saia da rotunda",name:"Saia da rotunda para {way_name}",destination:"Saia da rotunda em direo a {destination}"}},turn:{default:{default:"Siga {modifier}",name:"Siga {modifier} para{way_name}",destination:"Siga {modifier} em direo a {destination}"},left:{default:"Vire  esquerda",name:"Vire  esquerda para {way_name}",destination:"Vire  esquerda em direo a {destination}"},right:{default:"Vire  direita",name:"Vire  direita para {way_name}",destination:"Vire  direita em direo a {destination}"},straight:{default:"V em frente",name:"V em frente para {way_name}",destination:"V em frente em direo a {destination}"}},"use lane":{no_lanes:{default:"Continue em frente"},default:{default:"{lane_instruction}"}}}}},{}],41:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"prima",2:"a doua",3:"a treia",4:"a patra",5:"a cincea",6:"a asea",7:"a aptea",8:"a opta",9:"a noua",10:"a zecea"},direction:{north:"nord",northeast:"nord-est",east:"est",southeast:"sud-est",south:"sud",southwest:"sud-vest",west:"vest",northwest:"nord-vest"},modifier:{left:"stnga",right:"dreapta","sharp left":"puternic stnga","sharp right":"puternic dreapta","slight left":"uor stnga","slight right":"uor dreapta",straight:"nainte",uturn:"ntoarcere"},lanes:{xo:"inei stnga",ox:"inei dreapta",xox:"inei pe mijloc",oxo:"inei pe laterale"}},modes:{ferry:{default:"Luai feribotul",name:"Luai feribotul {way_name}",destination:"Luai feribotul spre {destination}"}},phrase:{"two linked by distance":"{instruction_one}, apoi n {distance}, {instruction_two}","two linked":"{instruction_one} apoi {instruction_two}","one in distance":"n {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"ieirea {exit}"},arrive:{default:{default:"Ai ajuns la {nth} destinaie",upcoming:"Ai ajuns la {nth} destinaie",short:"Ai ajuns","short-upcoming":"Vei ajunge",named:"Ai ajuns {waypoint_name}"},left:{default:"Ai ajuns la {nth} destinaie, pe stnga",upcoming:"Ai ajuns la {nth} destinaie, pe stnga",short:"Ai ajuns","short-upcoming":"Vei ajunge",named:"Ai ajuns {waypoint_name}, pe stnga"},right:{default:"Ai ajuns la {nth} destinaie, pe dreapta",upcoming:"Ai ajuns la {nth} destinaie, pe dreapta",short:"Ai ajuns","short-upcoming":"Vei ajunge",named:"Ai ajuns {waypoint_name}, pe dreapta"},"sharp left":{default:"Ai ajuns la {nth} destinaie, pe stnga",upcoming:"Ai ajuns la {nth} destinaie, pe stnga",short:"Ai ajuns","short-upcoming":"Vei ajunge",named:"Ai ajuns {waypoint_name}, pe stnga"},"sharp right":{default:"Ai ajuns la {nth} destinaie, pe dreapta",upcoming:"Ai ajuns la {nth} destinaie, pe dreapta",short:"Ai ajuns","short-upcoming":"Vei ajunge",named:"Ai ajuns {waypoint_name}, pe dreapta"},"slight right":{default:"Ai ajuns la {nth} destinaie, pe dreapta",upcoming:"Ai ajuns la {nth} destinaie, pe dreapta",short:"Ai ajuns","short-upcoming":"Vei ajunge",named:"Ai ajuns {waypoint_name}, pe dreapta"},"slight left":{default:"Ai ajuns la {nth} destinaie, pe stnga",upcoming:"Ai ajuns la {nth} destinaie, pe stnga",short:"Ai ajuns","short-upcoming":"Vei ajunge",named:"Ai ajuns {waypoint_name}, pe stnga"},straight:{default:"Ai ajuns la {nth} destinaie, n fa",upcoming:"Ai ajuns la {nth} destinaie, n fa",short:"Ai ajuns","short-upcoming":"Vei ajunge",named:"Ai ajuns {waypoint_name}, n fa"}},continue:{default:{default:"Virai {modifier}",name:"Virai {modifier} pe {way_name}",destination:"Virai {modifier} spre {destination}",exit:"Virai {modifier} pe {way_name}"},straight:{default:"Mergei nainte",name:"Mergei nainte pe {way_name}",destination:"Continuai spre {destination}",distance:"Mergei nainte pentru {distance}",namedistance:"Continuai pe {way_name} pentru {distance}"},"sharp left":{default:"Virai puternic la stnga",name:"Virai puternic la stnga pe {way_name}",destination:"Virai puternic la stnga spre {destination}"},"sharp right":{default:"Virai puternic la dreapta",name:"Virai puternic la dreapta pe {way_name}",destination:"Virai puternic la dreapta spre {destination}"},"slight left":{default:"Virai uor la stnga",name:"Virai uor la stnga pe {way_name}",destination:"Virai uor la stnga spre {destination}"},"slight right":{default:"Virai uor la dreapta",name:"Virai uor la dreapta pe {way_name}",destination:"Virai uor la dreapta spre {destination}"},uturn:{default:"ntoarcei-v",name:"ntoarcei-v i continuai pe {way_name}",destination:"ntoarcei-v spre {destination}"}},depart:{default:{default:"Mergei spre {direction}",name:"Mergei spre {direction} pe {way_name}",namedistance:"Mergei spre {direction} pe {way_name} pentru {distance}"}},"end of road":{default:{default:"Virai {modifier}",name:"Virai {modifier} pe {way_name}",destination:"Virai {modifier} spre {destination}"},straight:{default:"Continuai nainte",name:"Continuai nainte pe {way_name}",destination:"Continuai nainte spre {destination}"},uturn:{default:"ntoarcei-v la sfritul drumului",name:"ntoarcei-v pe {way_name} la sfritul drumului",destination:"ntoarcei-v spre {destination} la sfritul drumului"}},fork:{default:{default:"inei {modifier} la bifurcaie",name:"inei {modifier} la bifurcaie pe {way_name}",destination:"inei {modifier} la bifurcaie spre {destination}"},"slight left":{default:"inei pe stnga la bifurcaie",name:"inei pe stnga la bifurcaie pe {way_name}",destination:"inei pe stnga la bifurcaie spre {destination}"},"slight right":{default:"inei pe dreapta la bifurcaie",name:"inei pe dreapta la bifurcaie pe {way_name}",destination:"inei pe dreapta la bifurcaie spre {destination}"},"sharp left":{default:"Virai puternic stnga la bifurcaie",name:"Virai puternic stnga la bifurcaie pe {way_name}",destination:"Virai puternic stnga la bifurcaie spre {destination}"},"sharp right":{default:"Virai puternic dreapta la bifurcaie",name:"Virai puternic dreapta la bifurcaie pe {way_name}",destination:"Virai puternic dreapta la bifurcaie spre {destination}"},uturn:{default:"ntoarcei-v",name:"ntoarcei-v pe {way_name}",destination:"ntoarcei-v spre {destination}"}},merge:{default:{default:"Intrai n {modifier}",name:"Intrai n {modifier} pe {way_name}",destination:"Intrai n {modifier} spre {destination}"},straight:{default:"Intrai",name:"Intrai pe {way_name}",destination:"Intrai spre {destination}"},"slight left":{default:"Intrai n stnga",name:"Intrai n stnga pe {way_name}",destination:"Intrai n stnga spre {destination}"},"slight right":{default:"Intrai n dreapta",name:"Intrai n dreapta pe {way_name}",destination:"Intrai n dreapta spre {destination}"},"sharp left":{default:"Intrai n stnga",name:"Intrai n stnga pe {way_name}",destination:"Intrai n stnga spre {destination}"},"sharp right":{default:"Intrai n dreapta",name:"Intrai n dreapta pe {way_name}",destination:"Intrai n dreapta spre {destination}"},uturn:{default:"ntoarcei-v",name:"ntoarcei-v pe {way_name}",destination:"ntoarcei-v spre {destination}"}},"new name":{default:{default:"Continuai {modifier}",name:"Continuai {modifier} pe {way_name}",destination:"Continuai {modifier} spre {destination}"},straight:{default:"Continuai nainte",name:"Continuai pe {way_name}",destination:"Continuai spre {destination}"},"sharp left":{default:"Virai puternic la stnga",name:"Virai puternic la stnga pe {way_name}",destination:"Virai puternic la stnga spre {destination}"},"sharp right":{default:"Virai puternic la dreapta",name:"Virai puternic la dreapta pe {way_name}",destination:"Virai puternic la dreapta spre {destination}"},"slight left":{default:"Continuai uor la stnga",name:"Continuai uor la stnga pe {way_name}",destination:"Continuai uor la stnga spre {destination}"},"slight right":{default:"Continuai uor la dreapta",name:"Continuai uor la dreapta pe {way_name}",destination:"Continuai uor la dreapta spre {destination}"},uturn:{default:"ntoarcei-v",name:"ntoarcei-v pe {way_name}",destination:"ntoarcei-v spre {destination}"}},notification:{default:{default:"Continuai {modifier}",name:"Continuai {modifier} pe {way_name}",destination:"Continuai {modifier} spre {destination}"},uturn:{default:"ntoarcei-v",name:"ntoarcei-v pe {way_name}",destination:"ntoarcei-v spre {destination}"}},"off ramp":{default:{default:"Urmai breteaua",name:"Urmai breteaua pe {way_name}",destination:"Urmai breteaua spre {destination}",exit:"Urmai ieirea {exit}",exit_destination:"Urmai ieirea {exit} spre {destination}"},left:{default:"Urmai breteaua din stnga",name:"Urmai breteaua din stnga pe {way_name}",destination:"Urmai breteaua din stnga spre {destination}",exit:"Urmai ieirea {exit} pe stnga",exit_destination:"Urmai ieirea {exit} pe stnga spre {destination}"},right:{default:"Urmai breteaua din dreapta",name:"Urmai breteaua din dreapta pe {way_name}",destination:"Urmai breteaua din dreapta spre {destination}",exit:"Urmai ieirea {exit} pe dreapta",exit_destination:"Urmai ieirea {exit} pe dreapta spre {destination}"},"sharp left":{default:"Urmai breteaua din stnga",name:"Urmai breteaua din stnga pe {way_name}",destination:"Urmai breteaua din stnga spre {destination}",exit:"Urmai ieirea {exit} pe stnga",exit_destination:"Urmai ieirea {exit} pe stnga spre {destination}"},"sharp right":{default:"Urmai breteaua din dreapta",name:"Urmai breteaua din dreapta pe {way_name}",destination:"Urmai breteaua din dreapta spre {destination}",exit:"Urmai ieirea {exit} pe dreapta",exit_destination:"Urmai ieirea {exit} pe dreapta spre {destination}"},"slight left":{default:"Urmai breteaua din stnga",name:"Urmai breteaua din stnga pe {way_name}",destination:"Urmai breteaua din stnga spre {destination}",exit:"Urmai ieirea {exit} pe stnga",exit_destination:"Urmai ieirea {exit} pe stnga spre {destination}"},"slight right":{default:"Urmai breteaua din dreapta",name:"Urmai breteaua din dreapta pe {way_name}",destination:"Urmai breteaua din dreapta spre {destination}",exit:"Urmai ieirea {exit} pe dreapta",exit_destination:"Urmai ieirea {exit} pe dreapta spre {destination}"}},"on ramp":{default:{default:"Urmai breteaua de intrare",name:"Urmai breteaua pe {way_name}",destination:"Urmai breteaua spre {destination}"},left:{default:"Urmai breteaua din stnga",name:"Urmai breteaua din stnga pe {way_name}",destination:"Urmai breteaua din stnga spre {destination}"},right:{default:"Urmai breteaua din dreapta",name:"Urmai breteaua din dreapta pe {way_name}",destination:"Urmai breteaua din dreapta spre {destination}"},"sharp left":{default:"Urmai breteaua din stnga",name:"Urmai breteaua din stnga pe {way_name}",destination:"Urmai breteaua din stnga spre {destination}"},"sharp right":{default:"Urmai breteaua din dreapta",name:"Urmai breteaua din dreapta pe {way_name}",destination:"Urmai breteaua din dreapta spre {destination}"},"slight left":{default:"Urmai breteaua din stnga",name:"Urmai breteaua din stnga pe {way_name}",destination:"Urmai breteaua din stnga spre {destination}"},"slight right":{default:"Urmai breteaua din dreapta",name:"Urmai breteaua din dreapta pe {way_name}",destination:"Urmai breteaua din dreapta spre {destination}"}},rotary:{default:{default:{default:"Intrai n sensul giratoriu",name:"Intrai n sensul giratoriu i ieii pe {way_name}",destination:"Intrai n sensul giratoriu i ieii spre {destination}"},name:{default:"Intrai n {rotary_name}",name:"Intrai n {rotary_name} i ieii pe {way_name}",destination:"Intrai n {rotary_name} i ieii spre {destination}"},exit:{default:"Intrai n sensul giratoriu i urmai {exit_number} ieire",name:"Intrai n sensul giratoriu i urmai {exit_number} ieire pe {way_name}",destination:"Intrai n sensul giratoriu i urmai {exit_number} ieire spre {destination}"},name_exit:{default:"Intrai n {rotary_name} i urmai {exit_number} ieire",name:"Intrai n {rotary_name} i urmai {exit_number} ieire pe {way_name}",destination:"Intrai n  {rotary_name} i urmai {exit_number} ieire spre {destination}"}}},roundabout:{default:{exit:{default:"Intrai n sensul giratoriu i urmai {exit_number} ieire",name:"Intrai n sensul giratoriu i urmai {exit_number} ieire pe {way_name}",destination:"Intrai n sensul giratoriu i urmai {exit_number} ieire spre {destination}"},default:{default:"Intrai n sensul giratoriu",name:"Intrai n sensul giratoriu i ieii pe {way_name}",destination:"Intrai n sensul giratoriu i ieii spre {destination}"}}},"roundabout turn":{default:{default:"La sensul giratoriu virai {modifier}",name:"La sensul giratoriu virai {modifier} pe {way_name}",destination:"La sensul giratoriu virai {modifier} spre {destination}"},left:{default:"La sensul giratoriu virai la stnga",name:"La sensul giratoriu virai la stnga pe {way_name}",destination:"La sensul giratoriu virai la stnga spre {destination}"},right:{default:"La sensul giratoriu virai la dreapta",name:"La sensul giratoriu virai la dreapta pe {way_name}",destination:"La sensul giratoriu virai la dreapta spre {destination}"},straight:{default:"La sensul giratoriu continuai nainte",name:"La sensul giratoriu continuai nainte pe {way_name}",destination:"La sensul giratoriu continuai nainte spre {destination}"}},"exit roundabout":{default:{default:"Ieii din sensul giratoriu",name:"Ieii din sensul giratoriu pe {way_name}",destination:"Ieii din sensul giratoriu spre {destination}"}},"exit rotary":{default:{default:"Ieii din sensul giratoriu",name:"Ieii din sensul giratoriu pe {way_name}",destination:"Ieii din sensul giratoriu spre {destination}"}},turn:{default:{default:"Virai {modifier}",name:"Virai {modifier} pe {way_name}",destination:"Virai {modifier} spre {destination}"},left:{default:"Virai la stnga",name:"Virai la stnga pe {way_name}",destination:"Virai la stnga spre {destination}"},right:{default:"Virai la dreapta",name:"Virai la dreapta pe {way_name}",destination:"Virai la dreapta spre {destination}"},straight:{default:"Mergei nainte",name:"Mergei nainte pe {way_name}",destination:"Mergei nainte spre {destination}"}},"use lane":{no_lanes:{default:"Mergei nainte"},default:{default:"{lane_instruction}"}}}}},{}],42:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:""},direction:{north:"",northeast:"-",east:"",southeast:"-",south:"",southwest:"-",west:"",northwest:"-"},modifier:{left:"",right:"","sharp left":"","sharp right":"","slight left":"","slight right":"",straight:"",uturn:" "},lanes:{xo:" ",ox:" ",xox:" ",oxo:"   "}},modes:{ferry:{default:"  ",name:"   {way_name}",destination:"     {destination}"}},phrase:{"two linked by distance":"{instruction_one},   {distance} {instruction_two}","two linked":"{instruction_one},  {instruction_two}","one in distance":" {distance} {instruction_one}","name and ref":"{name} ({ref})","exit with number":" {exit}"},arrive:{default:{default:"   {nth}  ",upcoming:"   {nth}  ",short:" ","short-upcoming":"  ",named:"    , {waypoint_name}"},left:{default:"   {nth}  ,   ",upcoming:"   {nth}  ,   ",short:" ","short-upcoming":"  ",named:"    , {waypoint_name},   "},right:{default:"   {nth}  ,   ",upcoming:"   {nth}  ,   ",short:" ","short-upcoming":"  ",named:"    , {waypoint_name},   "},"sharp left":{default:"   {nth}  ,    ",upcoming:"   {nth}  ,    ",short:" ","short-upcoming":"  ",named:"    , {waypoint_name},    "},"sharp right":{default:"   {nth}  ,    ",upcoming:"   {nth}  ,    ",short:" ","short-upcoming":"  ",named:"    , {waypoint_name},    "},"slight right":{default:"   {nth}  ,    ",upcoming:"   {nth}  ,    ",short:" ","short-upcoming":"  ",named:"    , {waypoint_name},    "},"slight left":{default:"   {nth}  ,    ",upcoming:"   {nth}  ,    ",short:" ","short-upcoming":"  ",named:"    , {waypoint_name},    "},straight:{default:"   {nth}  ,    ",upcoming:"   {nth}  ,    ",short:" ","short-upcoming":"  ",named:"    , {waypoint_name},    "}},continue:{default:{default:" {modifier}",name:" {modifier}  {way_name:dative}",destination:" {modifier}   {destination}",exit:" {modifier}  {way_name:accusative}"},straight:{default:" ",name:"   {way_name:dative}",destination:"    {destination}",distance:"  {distance}",namedistance:"  {distance}  {way_name:dative}"},"sharp left":{default:"  ",name:"    {way_name:accusative}",destination:"     {destination}"},"sharp right":{default:"  ",name:"    {way_name:accusative}",destination:"     {destination}"},"slight left":{default:"  ",name:"    {way_name:accusative}",destination:"     {destination}"},"slight right":{default:"  ",name:"    {way_name:accusative}",destination:"     {destination}"},uturn:{default:"",name:"     {way_name:dative}",destination:"   {destination}"}},depart:{default:{default:"  {direction} ",name:"  {direction}   {way_name:dative}",namedistance:" {distance}  {direction}   {way_name:dative}"}},"end of road":{default:{default:" {modifier}",name:" {modifier}  {way_name:accusative}",destination:" {modifier}   {destination}"},straight:{default:" ",name:"   {way_name:dative}",destination:"    {destination}"},uturn:{default:"   ",name:"   {way_name:genitive}",destination:"      {destination}"}},fork:{default:{default:"   {modifier}",name:"   {modifier}  {way_name:accusative}",destination:"   {modifier}   {destination}"},"slight left":{default:"   ",name:"     {way_name:accusative}",destination:"         {destination}"},"slight right":{default:"   ",name:"     {way_name:accusative}",destination:"         {destination}"},"sharp left":{default:"    ",name:"    {way_name:accusative}",destination:"        {destination}"},"sharp right":{default:"    ",name:"    {way_name:accusative}",destination:"        {destination}"},uturn:{default:"  ",name:"    {way_name:prepositional}",destination:"        {destination}"}},merge:{default:{default:" {modifier}",name:" {modifier}  {way_name:accusative}",destination:" {modifier}   {destination}"},straight:{default:" ",name:"   {way_name:dative}",destination:"    {destination}"},"slight left":{default:" ",name:"   {way_name:accusative}",destination:"    {destination}"},"slight right":{default:" ",name:"   {way_name:accusative}",destination:"    {destination}"},"sharp left":{default:" ",name:"   {way_name:accusative}",destination:"    {destination}"},"sharp right":{default:" ",name:"   {way_name:accusative}",destination:"    {destination}"},uturn:{default:"",name:"  {way_name:prepositional}",destination:"   {destination}"}},"new name":{default:{default:" {modifier}",name:" {modifier}  {way_name:accusative}",destination:" {modifier}   {destination}"},straight:{default:" ",name:"   {way_name:dative}",destination:"    {destination}"},"sharp left":{default:"  ",name:"    {way_name:accusative}",destination:"        {destination}"},"sharp right":{default:"  ",name:"    {way_name:accusative}",destination:"        {destination}"},"slight left":{default:"  ",name:"    {way_name:accusative}",destination:"     {destination}"},"slight right":{default:"  ",name:"    {way_name:accusative}",destination:"     {destination}"},uturn:{default:"",name:"  {way_name:prepositional}",destination:"      {destination}"}},notification:{default:{default:" {modifier}",name:" {modifier}  {way_name:dative}",destination:" {modifier}   {destination}"},uturn:{default:"",name:"  {way_name:prepositional}",destination:"      {destination}"}},"off ramp":{default:{default:"  ",name:"    {way_name:accusative}",destination:"     {destination}",exit:"   {exit}",exit_destination:"   {exit}   {destination}"},left:{default:"   ",name:"     {way_name:accusative}",destination:"      {destination}",exit:"   {exit} ",exit_destination:"   {exit}    {destination}"},right:{default:"   ",name:"     {way_name:accusative}",destination:"      {destination}",exit:"   {exit} ",exit_destination:"   {exit}    {destination}"},"sharp left":{default:"   ",name:"     {way_name:accusative}",destination:"      {destination}",exit:"    {exit}",exit_destination:"    {exit}   {destination}"},"sharp right":{default:"   ",name:"     {way_name:accusative}",destination:"      {destination}",exit:"    {exit}",exit_destination:"    {exit}   {destination}"},"slight left":{default:"   ",name:"     {way_name:accusative}",destination:"      {destination}",exit:"   {exit}",exit_destination:"    {exit}   {destination}"},"slight right":{default:"   ",name:"     {way_name:accusative}",destination:"      {destination}",exit:"    {exit}",exit_destination:"    {exit}   {destination}"}},"on ramp":{default:{default:"  ",name:"    {way_name:accusative}",destination:"       {destination}"},left:{default:"     ",name:"     {way_name:accusative}",destination:"        {destination}"},right:{default:"     ",name:"     {way_name:accusative}",destination:"        {destination}"},"sharp left":{default:"     ",name:"     {way_name:accusative}",destination:"        {destination}"},"sharp right":{default:"     ",name:"     {way_name:accusative}",destination:"        {destination}"},"slight left":{default:"     ",name:"   {way_name:accusative}",destination:"      {destination}"},"slight right":{default:"     ",name:"   {way_name:accusative}",destination:"      {destination}"}},rotary:{default:{default:{default:"    ",name:"     {way_name:accusative}",destination:"      {destination}"},name:{default:"   {rotary_name:dative}",name:" {rotary_name:prepositional}   {way_name:accusative}",destination:" {rotary_name:prepositional}    {destination}"},exit:{default:"     {exit_number} ",name:"     {exit_number}   {way_name:accusative}",destination:"     {exit_number}    {destination}"},name_exit:{default:" {rotary_name:prepositional}   {exit_number} ",name:" {rotary_name:prepositional}   {exit_number}   {way_name:accusative}",destination:" {rotary_name:prepositional}   {exit_number}    {destination}"}}},roundabout:{default:{exit:{default:"     {exit_number} ",name:"     {exit_number}   {way_name:accusative}",destination:"     {exit_number}    {destination}"},default:{default:"    ",name:"     {way_name:accusative}",destination:"      {destination}"}}},"roundabout turn":{default:{default:" {modifier}",name:" {modifier}  {way_name:accusative}",destination:" {modifier}   {destination}"},left:{default:" ",name:"   {way_name:accusative}",destination:"    {destination}"},right:{default:" ",name:"   {way_name:accusative}",destination:"    {destination}"},straight:{default:" ",name:"   {way_name:dative}",destination:"    {destination}"}},"exit roundabout":{default:{default:"   ",name:"     {way_name:accusative}",destination:"      {destination}"}},"exit rotary":{default:{default:"   ",name:"     {way_name:accusative}",destination:"      {destination}"}},turn:{default:{default:" {modifier}",name:" {modifier}  {way_name:accusative}",destination:" {modifier}    {destination}"},left:{default:" ",name:"   {way_name:accusative}",destination:"    {destination}"},right:{default:" ",name:"   {way_name:accusative}",destination:"     {destination}"},straight:{default:" ",name:"  {way_name:dative}",destination:"   {destination}"}},"use lane":{no_lanes:{default:"  "},default:{default:"{lane_instruction}"}}}}},{}],43:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1:a",2:"2:a",3:"3:e",4:"4:e",5:"5:e",6:"6:e",7:"7:e",8:"8:e",9:"9:e",10:"10:e"},direction:{north:"norr",northeast:"nordost",east:"ster",southeast:"sydost",south:"sder",southwest:"sydvst",west:"vster",northwest:"nordvst"},modifier:{left:"vnster",right:"hger","sharp left":"vnster","sharp right":"hger","slight left":"vnster","slight right":"hger",straight:"rakt fram",uturn:"U-svng"},lanes:{xo:"Hll till hger",ox:"Hll till vnster",xox:"Hll till mitten",oxo:"Hll till vnster eller hger"}},modes:{ferry:{default:"Ta frjan",name:"Ta frjan p {way_name}",destination:"Ta frjan mot {destination}"}},phrase:{"two linked by distance":"{instruction_one}, sedan efter {distance}, {instruction_two}","two linked":"{instruction_one}, sedan {instruction_two}","one in distance":"Om {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"exit {exit}"},arrive:{default:{default:"Du r framme vid din {nth} destination",upcoming:"Du r snart framme vid din {nth} destination",short:"Du r framme","short-upcoming":"Du r snart framme",named:"Du r framme vid {waypoint_name}"},left:{default:"Du r framme vid din {nth} destination, till vnster",upcoming:"Du r snart framme vid din {nth} destination, till vnster",short:"Du r framme","short-upcoming":"Du r snart framme",named:"Du r framme vid {waypoint_name}, till vnster"},right:{default:"Du r framme vid din {nth} destination, till hger",upcoming:"Du r snart framme vid din {nth} destination, till hger",short:"Du r framme","short-upcoming":"Du r snart framme",named:"Du r framme vid {waypoint_name}, till hger"},"sharp left":{default:"Du r framme vid din {nth} destination, till vnster",upcoming:"Du r snart framme vid din {nth} destination, till vnster",short:"Du r framme","short-upcoming":"Du r snart framme",named:"Du r framme vid {waypoint_name}, till vnster"},"sharp right":{default:"Du r framme vid din {nth} destination, till hger",upcoming:"Du r snart framme vid din {nth} destination, till hger",short:"Du r framme","short-upcoming":"Du r snart framme",named:"Du r framme vid {waypoint_name}, till hger"},"slight right":{default:"Du r framme vid din {nth} destination, till hger",upcoming:"Du r snart framme vid din {nth} destination, till hger",short:"Du r framme","short-upcoming":"Du r snart framme",named:"Du r framme vid {waypoint_name}, till hger"},"slight left":{default:"Du r framme vid din {nth} destination, till vnster",upcoming:"Du r snart framme vid din {nth} destination, till vnster",short:"Du r framme","short-upcoming":"Du r snart framme",named:"Du r framme vid {waypoint_name}, till vnster"},straight:{default:"Du r framme vid din {nth} destination, rakt fram",upcoming:"Du r snart framme vid din {nth} destination, rakt fram",short:"Du r framme","short-upcoming":"Du r snart framme",named:"Du r framme vid {waypoint_name}, rakt fram"}},continue:{default:{default:"Svng {modifier}",name:"Svng {modifier} och fortstt p {way_name}",destination:"Svng {modifier} mot {destination}",exit:"Svng {modifier} in p {way_name}"},straight:{default:"Fortstt rakt fram",name:"Kr rakt fram och fortstt p {way_name}",destination:"Fortstt mot {destination}",distance:"Fortstt rakt fram i {distance}",namedistance:"Fortstt p {way_name} i {distance}"},"sharp left":{default:"Svng vnster",name:"Svng vnster och fortstt p {way_name}",destination:"Svng vnster mot {destination}"},"sharp right":{default:"Svng hger",name:"Svng hger och fortstt p {way_name}",destination:"Svng hger mot {destination}"},"slight left":{default:"Svng vnster",name:"Svng vnster och fortstt p {way_name}",destination:"Svng vnster mot {destination}"},"slight right":{default:"Svng hger",name:"Svng hger och fortstt p {way_name}",destination:"Svng hger mot {destination}"},uturn:{default:"Gr en U-svng",name:"Gr en U-svng och fortstt p {way_name}",destination:"Gr en U-svng mot {destination}"}},depart:{default:{default:"Kr t {direction}",name:"Kr t {direction} p {way_name}",namedistance:"Kr {distance} t {direction} p {way_name}"}},"end of road":{default:{default:"Svng {modifier}",name:"Svng {modifier} in p {way_name}",destination:"Svng {modifier} mot {destination}"},straight:{default:"Fortstt rakt fram",name:"Fortstt rakt fram in p {way_name}",destination:"Fortstt rakt fram mot {destination}"},uturn:{default:"Gr en U-svng i slutet av vgen",name:"Gr en U-svng in p {way_name} i slutet av vgen",destination:"Gr en U-svng mot {destination} i slutet av vgen"}},fork:{default:{default:"Hll till {modifier} dr vgen delar sig",name:"Hll till {modifier} in p {way_name}",destination:"Hll till {modifier} mot {destination}"},"slight left":{default:"Hll till vnster dr vgen delar sig",name:"Hll till vnster in p {way_name}",destination:"Hll till vnster mot {destination}"},"slight right":{default:"Hll till hger dr vgen delar sig",name:"Hll till hger in p {way_name}",destination:"Hll till hger mot {destination}"},"sharp left":{default:"Svng vnster dr vgen delar sig",name:"Svng vnster in p {way_name}",destination:"Svng vnster mot {destination}"},"sharp right":{default:"Svng hger dr vgen delar sig",name:"Svng hger in p {way_name}",destination:"Svng hger mot {destination}"},uturn:{default:"Gr en U-svng",name:"Gr en U-svng in p {way_name}",destination:"Gr en U-svng mot {destination}"}},merge:{default:{default:"Byt till {modifier} krflt",name:"Byt till {modifier} krflt, in p {way_name}",destination:"Byt till {modifier} krflt, mot {destination}"},straight:{default:"Fortstt",name:"Kr in p {way_name}",destination:"Kr mot {destination}"},"slight left":{default:"Byt till vnstra krfltet",name:"Byt till vnstra krfltet, in p {way_name}",destination:"Byt till vnstra krfltet, mot {destination}"},"slight right":{default:"Byt till hgra krfltet",name:"Byt till hgra krfltet, in p {way_name}",destination:"Byt till hgra krfltet, mot {destination}"},"sharp left":{default:"Byt till vnstra krfltet",name:"Byt till vnstra krfltet, in p {way_name}",destination:"Byt till vnstra krfltet, mot {destination}"},"sharp right":{default:"Byt till hgra krfltet",name:"Byt till hgra krfltet, in p {way_name}",destination:"Byt till hgra krfltet, mot {destination}"},uturn:{default:"Gr en U-svng",name:"Gr en U-svng in p {way_name}",destination:"Gr en U-svng mot {destination}"}},"new name":{default:{default:"Fortstt {modifier}",name:"Fortstt {modifier} p {way_name}",destination:"Fortstt {modifier} mot {destination}"},straight:{default:"Fortstt rakt fram",name:"Fortstt in p {way_name}",destination:"Fortstt mot {destination}"},"sharp left":{default:"Gr en skarp vnstersvng",name:"Gr en skarp vnstersvng in p {way_name}",destination:"Gr en skarp vnstersvng mot {destination}"},"sharp right":{default:"Gr en skarp hgersvng",name:"Gr en skarp hgersvng in p {way_name}",destination:"Gr en skarp hgersvng mot {destination}"},"slight left":{default:"Fortstt med ltt vnstersvng",name:"Fortstt med ltt vnstersvng in p {way_name}",destination:"Fortstt med ltt vnstersvng mot {destination}"},"slight right":{default:"Fortstt med ltt hgersvng",name:"Fortstt med ltt hgersvng in p {way_name}",destination:"Fortstt med ltt hgersvng mot {destination}"},uturn:{default:"Gr en U-svng",name:"Gr en U-svng in p {way_name}",destination:"Gr en U-svng mot {destination}"}},notification:{default:{default:"Fortstt {modifier}",name:"Fortstt {modifier} p {way_name}",destination:"Fortstt {modifier} mot {destination}"},uturn:{default:"Gr en U-svng",name:"Gr en U-svng in p {way_name}",destination:"Gr en U-svng mot {destination}"}},"off ramp":{default:{default:"Ta avfarten",name:"Ta avfarten in p {way_name}",destination:"Ta avfarten mot {destination}",exit:"Ta avfart {exit} ",exit_destination:"Ta avfart {exit} mot {destination}"},left:{default:"Ta avfarten till vnster",name:"Ta avfarten till vnster in p {way_name}",destination:"Ta avfarten till vnster mot {destination}",exit:"Ta avfart {exit} till vnster",exit_destination:"Ta avfart {exit} till vnster mot {destination}"},right:{default:"Ta avfarten till hger",name:"Ta avfarten till hger in p {way_name}",destination:"Ta avfarten till hger mot {destination}",exit:"Ta avfart {exit} till hger",exit_destination:"Ta avfart {exit} till hger mot {destination}"},"sharp left":{default:"Ta avfarten till vnster",name:"Ta avfarten till vnster in p {way_name}",destination:"Ta avfarten till vnster mot {destination}",exit:"Ta avfart {exit} till vnster",exit_destination:"Ta avfart {exit} till vnster mot {destination}"},"sharp right":{default:"Ta avfarten till hger",name:"Ta avfarten till hger in p {way_name}",destination:"Ta avfarten till hger mot {destination}",exit:"Ta avfart {exit} till hger",exit_destination:"Ta avfart {exit} till hger mot {destination}"},"slight left":{default:"Ta avfarten till vnster",name:"Ta avfarten till vnster in p {way_name}",destination:"Ta avfarten till vnster mot {destination}",exit:"Ta avfart {exit} till vnster",exit_destination:"Ta avfart{exit} till vnster mot {destination}"},"slight right":{default:"Ta avfarten till hger",name:"Ta avfarten till hger in p {way_name}",destination:"Ta avfarten till hger mot {destination}",exit:"Ta avfart {exit} till hger",exit_destination:"Ta avfart {exit} till hger mot {destination}"}},"on ramp":{default:{default:"Ta pfarten",name:"Ta pfarten in p {way_name}",destination:"Ta pfarten mot {destination}"},left:{default:"Ta pfarten till vnster",name:"Ta pfarten till vnster in p {way_name}",destination:"Ta pfarten till vnster mot {destination}"},right:{default:"Ta pfarten till hger",name:"Ta pfarten till hger in p {way_name}",destination:"Ta pfarten till hger mot {destination}"},"sharp left":{default:"Ta pfarten till vnster",name:"Ta pfarten till vnster in p {way_name}",destination:"Ta pfarten till vnster mot {destination}"},"sharp right":{default:"Ta pfarten till hger",name:"Ta pfarten till hger in p {way_name}",destination:"Ta pfarten till hger mot {destination}"},"slight left":{default:"Ta pfarten till vnster",name:"Ta pfarten till vnster in p {way_name}",destination:"Ta pfarten till vnster mot {destination}"},"slight right":{default:"Ta pfarten till hger",name:"Ta pfarten till hger in p {way_name}",destination:"Ta pfarten till hger mot {destination}"}},rotary:{default:{default:{default:"Kr in i rondellen",name:"I rondellen, ta avfarten in p {way_name}",destination:"I rondellen, ta av mot {destination}"},name:{default:"Kr in i {rotary_name}",name:"I {rotary_name}, ta av in p {way_name}",destination:"I {rotary_name}, ta av mot {destination}"},exit:{default:"I rondellen, ta {exit_number} avfarten",name:"I rondellen, ta {exit_number} avfarten in p {way_name}",destination:"I rondellen, ta {exit_number} avfarten mot {destination}"},name_exit:{default:"I {rotary_name}, ta {exit_number} avfarten",name:"I {rotary_name}, ta {exit_number}  avfarten in p {way_name}",destination:"I {rotary_name}, ta {exit_number} avfarten mot {destination}"}}},roundabout:{default:{exit:{default:"I rondellen, ta {exit_number} avfarten",name:"I rondellen, ta {exit_number} avfarten in p {way_name}",destination:"I rondellen, ta {exit_number} avfarten mot {destination}"},default:{default:"Kr in i rondellen",name:"I rondellen, ta avfarten in p {way_name}",destination:"I rondellen, ta av mot {destination}"}}},"roundabout turn":{default:{default:"Svng {modifier}",name:"Svng {modifier} in p {way_name}",destination:"Svng {modifier} mot {destination}"},left:{default:"Svng vnster",name:"Svng vnster in p {way_name}",destination:"Svng vnster mot {destination}"},right:{default:"Svng hger",name:"Svng hger in p {way_name}",destination:"Svng hger mot {destination}"},straight:{default:"Fortstt rakt fram",name:"Fortstt rakt fram in p {way_name}",destination:"Fortstt rakt fram mot {destination}"}},"exit roundabout":{default:{default:"Kr ut ur rondellen",name:"Kr ut ur rondellen in p {way_name}",destination:"Kr ut ur rondellen mot {destination}"}},"exit rotary":{default:{default:"Kr ut ur rondellen",name:"Kr ut ur rondellen in p {way_name}",destination:"Kr ut ur rondellen mot {destination}"}},turn:{default:{default:"Svng {modifier}",name:"Svng {modifier} in p {way_name}",destination:"Svng {modifier} mot {destination}"},left:{default:"Svng vnster",name:"Svng vnster in p {way_name}",destination:"Svng vnster mot {destination}"},right:{default:"Svng hger",name:"Svng hger in p {way_name}",destination:"Svng hger mot {destination}"},straight:{default:"Kr rakt fram",name:"Kr rakt fram in p {way_name}",destination:"Kr rakt fram mot {destination}"}},"use lane":{no_lanes:{default:"Fortstt rakt fram"},default:{default:"{lane_instruction}"}}}}},{}],44:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"birinci",2:"ikinci",3:"nc",4:"drdnc",5:"beinci",6:"altnc",7:"yedinci",8:"sekizinci",9:"dokuzuncu",10:"onuncu"},direction:{north:"kuzey",northeast:"kuzeydou",east:"dou",southeast:"gneydou",south:"gney",southwest:"gneybat",west:"bat",northwest:"kuzeybat"},modifier:{left:"sol",right:"sa","sharp left":"keskin sol","sharp right":"keskin sa","slight left":"hafif sol","slight right":"hafif sa",straight:"dz",uturn:"U dn"},lanes:{xo:"Sada kaln",ox:"Solda kaln",xox:"Ortada kaln",oxo:"Solda veya sada kaln"}},modes:{ferry:{default:"Vapur kullan",name:"{way_name} vapurunu kullan",destination:"{destination} istikametine giden vapuru kullan"}},phrase:{"two linked by distance":"{instruction_one} ve {distance} sonra {instruction_two}","two linked":"{instruction_one} ve sonra {instruction_two}","one in distance":"{distance} sonra, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"exit {exit}"},arrive:{default:{default:"{nth} hedefinize ulatnz",upcoming:"{nth} hedefinize ulatnz",short:"{nth} hedefinize ulatnz","short-upcoming":"{nth} hedefinize ulatnz",named:"{waypoint_name} ulatnz"},left:{default:"{nth} hedefinize ulatnz, hedefiniz solunuzdadr",upcoming:"{nth} hedefinize ulatnz, hedefiniz solunuzdadr",short:"{nth} hedefinize ulatnz","short-upcoming":"{nth} hedefinize ulatnz",named:"{waypoint_name} ulatnz, hedefiniz solunuzdadr"},right:{default:"{nth} hedefinize ulatnz, hedefiniz sanzdadr",upcoming:"{nth} hedefinize ulatnz, hedefiniz sanzdadr",short:"{nth} hedefinize ulatnz","short-upcoming":"{nth} hedefinize ulatnz",named:"{waypoint_name} ulatnz, hedefiniz sanzdadr"},"sharp left":{default:"{nth} hedefinize ulatnz, hedefiniz solunuzdadr",upcoming:"{nth} hedefinize ulatnz, hedefiniz solunuzdadr",short:"{nth} hedefinize ulatnz","short-upcoming":"{nth} hedefinize ulatnz",named:"{waypoint_name} ulatnz, hedefiniz solunuzdadr"},"sharp right":{default:"{nth} hedefinize ulatnz, hedefiniz sanzdadr",upcoming:"{nth} hedefinize ulatnz, hedefiniz sanzdadr",short:"{nth} hedefinize ulatnz","short-upcoming":"{nth} hedefinize ulatnz",named:"{waypoint_name} ulatnz, hedefiniz sanzdadr"},"slight right":{default:"{nth} hedefinize ulatnz, hedefiniz sanzdadr",upcoming:"{nth} hedefinize ulatnz, hedefiniz sanzdadr",short:"{nth} hedefinize ulatnz","short-upcoming":"{nth} hedefinize ulatnz",named:"{waypoint_name} ulatnz, hedefiniz sanzdadr"},"slight left":{default:"{nth} hedefinize ulatnz, hedefiniz solunuzdadr",upcoming:"{nth} hedefinize ulatnz, hedefiniz solunuzdadr",short:"{nth} hedefinize ulatnz","short-upcoming":"{nth} hedefinize ulatnz",named:"{waypoint_name} ulatnz, hedefiniz solunuzdadr"},straight:{default:"{nth} hedefinize ulatnz, hedefiniz karnzdadr",upcoming:"{nth} hedefinize ulatnz, hedefiniz karnzdadr",short:"{nth} hedefinize ulatnz","short-upcoming":"{nth} hedefinize ulatnz",named:"{waypoint_name} ulatnz, hedefiniz karnzdadr"}},continue:{default:{default:"{modifier} yne dn",name:"{way_name} zerinde kalmak iin {modifier} yne dn",destination:"{destination} istikametinde {modifier} yne dn",exit:"{way_name} zerinde {modifier} yne dn"},straight:{default:"Dz devam edin",name:"{way_name} zerinde kalmak iin dz devam et",destination:"{destination} istikametinde devam et",distance:"{distance} boyunca dz devam et",namedistance:"{distance} boyunca {way_name} zerinde devam et"},"sharp left":{default:"Sola keskin dn yap",name:"{way_name} zerinde kalmak iin sola keskin dn yap",destination:"{destination} istikametinde sola keskin dn yap"},"sharp right":{default:"Saa keskin dn yap",name:"{way_name} zerinde kalmak iin saa keskin dn yap",destination:"{destination} istikametinde saa keskin dn yap"},"slight left":{default:"Sola hafif dn yap",name:"{way_name} zerinde kalmak iin sola hafif dn yap",destination:"{destination} istikametinde sola hafif dn yap"},"slight right":{default:"Saa hafif dn yap",name:"{way_name} zerinde kalmak iin saa hafif dn yap",destination:"{destination} istikametinde saa hafif dn yap"},uturn:{default:"U dn yapn",name:"Bir U-dn yap ve {way_name} devam et",destination:"{destination} istikametinde bir U-dn yap"}},depart:{default:{default:"{direction} tarafna ynelin",name:"{way_name} zerinde {direction} yne git",namedistance:"Head {direction} on {way_name} for {distance}"}},"end of road":{default:{default:"{modifier} tarafa dnn",name:"{way_name} zerinde {modifier} yne dn",destination:"{destination} istikametinde {modifier} yne dn"},straight:{default:"Dz devam edin",name:"{way_name} zerinde dz devam et",destination:"{destination} istikametinde dz devam et"},uturn:{default:"Yolun sonunda U dn yapn",name:"Yolun sonunda {way_name} zerinde bir U-dn yap",destination:"Yolun sonunda {destination} istikametinde bir U-dn yap"}},fork:{default:{default:"Yol ayrmnda {modifier} ynde kal",name:"{way_name} zerindeki yol ayrmnda {modifier} ynde kal",destination:"{destination} istikametindeki yol ayrmnda {modifier} ynde kal"},"slight left":{default:"ataln solundan devam edin",name:"ataln solundan {way_name} yoluna doru ",destination:"{destination} istikametindeki yol ayrmnda solda kal"},"slight right":{default:"ataln sandan devam edin",name:"{way_name} zerindeki yol ayrmnda sada kal",destination:"{destination} istikametindeki yol ayrmnda sada kal"},"sharp left":{default:"atalda keskin sola dnn",name:"{way_name} yoluna doru sola keskin dn yapn",destination:"{destination} istikametinde sola keskin dn yap"},"sharp right":{default:"atalda keskin saa dnn",name:"{way_name} yoluna doru saa keskin dn yapn",destination:"{destination} istikametinde saa keskin dn yap"},uturn:{default:"U dn yapn",name:"{way_name} yoluna U dn yapn",destination:"{destination} istikametinde bir U-dn yap"}},merge:{default:{default:"{modifier} yne gir",name:"{way_name} zerinde {modifier} yne gir",destination:"{destination} istikametinde {modifier} yne gir"},straight:{default:"dz yne gir",name:"{way_name} zerinde dz yne gir",destination:"{destination} istikametinde dz yne gir"},"slight left":{default:"Sola gir",name:"{way_name} zerinde sola gir",destination:"{destination} istikametinde sola gir"},"slight right":{default:"Saa gir",name:"{way_name} zerinde saa gir",destination:"{destination} istikametinde saa gir"},"sharp left":{default:"Sola gir",name:"{way_name} zerinde sola gir",destination:"{destination} istikametinde sola gir"},"sharp right":{default:"Saa gir",name:"{way_name} zerinde saa gir",destination:"{destination} istikametinde saa gir"},uturn:{default:"U dn yapn",name:"{way_name} yoluna U dn yapn",destination:"{destination} istikametinde bir U-dn yap"}},"new name":{default:{default:"{modifier} ynde devam et",name:"{way_name} zerinde {modifier} ynde devam et",destination:"{destination} istikametinde {modifier} ynde devam et"},straight:{default:"Dz devam et",name:"{way_name} zerinde devam et",destination:"{destination} istikametinde devam et"},"sharp left":{default:"Sola keskin dn yapn",name:"{way_name} yoluna doru sola keskin dn yapn",destination:"{destination} istikametinde sola keskin dn yap"},"sharp right":{default:"Saa keskin dn yapn",name:"{way_name} yoluna doru saa keskin dn yapn",destination:"{destination} istikametinde saa keskin dn yap"},"slight left":{default:"Hafif soldan devam edin",name:"{way_name} zerinde hafif solda devam et",destination:"{destination} istikametinde hafif solda devam et"},"slight right":{default:"Hafif sadan devam edin",name:"{way_name} zerinde hafif sada devam et",destination:"{destination} istikametinde hafif sada devam et"},uturn:{default:"U dn yapn",name:"{way_name} yoluna U dn yapn",destination:"{destination} istikametinde bir U-dn yap"}},notification:{default:{default:"{modifier} ynde devam et",name:"{way_name} zerinde {modifier} ynde devam et",destination:"{destination} istikametinde {modifier} ynde devam et"},uturn:{default:"U dn yapn",name:"{way_name} yoluna U dn yapn",destination:"{destination} istikametinde bir U-dn yap"}},"off ramp":{default:{default:"Balant yoluna ge",name:"{way_name} zerindeki balant yoluna ge",destination:"{destination} istikametine giden balant yoluna ge",exit:"{exit} k yoluna ge",exit_destination:"{destination} istikametindeki {exit} k yoluna ge"},left:{default:"Soldaki balant yoluna ge",name:"{way_name} zerindeki sol balant yoluna ge",destination:"{destination} istikametine giden sol balant yoluna ge",exit:"Soldaki {exit} k yoluna ge",exit_destination:"{destination} istikametindeki {exit} sol k yoluna ge"},right:{default:"Sadaki balant yoluna ge",name:"{way_name} zerindeki sa balant yoluna ge",destination:"{destination} istikametine giden sa balant yoluna ge",exit:"Sadaki {exit} k yoluna ge",exit_destination:"{destination} istikametindeki {exit} sa k yoluna ge"},"sharp left":{default:"Soldaki balant yoluna ge",name:"{way_name} zerindeki sol balant yoluna ge",destination:"{destination} istikametine giden sol balant yoluna ge",exit:"Soldaki {exit} k yoluna ge",exit_destination:"{destination} istikametindeki {exit} sol k yoluna ge"},"sharp right":{default:"Sadaki balant yoluna ge",name:"{way_name} zerindeki sa balant yoluna ge",destination:"{destination} istikametine giden sa balant yoluna ge",exit:"Sadaki {exit} k yoluna ge",exit_destination:"{destination} istikametindeki {exit} sa k yoluna ge"},"slight left":{default:"Soldaki balant yoluna ge",name:"{way_name} zerindeki sol balant yoluna ge",destination:"{destination} istikametine giden sol balant yoluna ge",exit:"Soldaki {exit} k yoluna ge",exit_destination:"{destination} istikametindeki {exit} sol k yoluna ge"},"slight right":{default:"Sadaki balant yoluna ge",name:"{way_name} zerindeki sa balant yoluna ge",destination:"{destination} istikametine giden sa balant yoluna ge",exit:"Sadaki {exit} k yoluna ge",exit_destination:"{destination} istikametindeki {exit} sa k yoluna ge"}},"on ramp":{default:{default:"Balant yoluna ge",name:"{way_name} zerindeki balant yoluna ge",destination:"{destination} istikametine giden balant yoluna ge"},left:{default:"Soldaki balant yoluna ge",name:"{way_name} zerindeki sol balant yoluna ge",destination:"{destination} istikametine giden sol balant yoluna ge"},right:{default:"Sadaki balant yoluna ge",name:"{way_name} zerindeki sa balant yoluna ge",destination:"{destination} istikametine giden sa balant yoluna ge"},"sharp left":{default:"Soldaki balant yoluna ge",name:"{way_name} zerindeki sol balant yoluna ge",destination:"{destination} istikametine giden sol balant yoluna ge"},"sharp right":{default:"Sadaki balant yoluna ge",name:"{way_name} zerindeki sa balant yoluna ge",destination:"{destination} istikametine giden sa balant yoluna ge"},"slight left":{default:"Soldaki balant yoluna ge",name:"{way_name} zerindeki sol balant yoluna ge",destination:"{destination} istikametine giden sol balant yoluna ge"},"slight right":{default:"Sadaki balant yoluna ge",name:"{way_name} zerindeki sa balant yoluna ge",destination:"{destination} istikametine giden sa balant yoluna ge"}},rotary:{default:{default:{default:"Dnel kavaa gir",name:"Dnel kavaa gir ve {way_name} zerinde k",destination:"Dnel kavaa gir ve {destination} istikametinde k"},name:{default:"{rotary_name} dnel kavaa gir",name:"{rotary_name} dnel kavaa gir ve {way_name} zerinde k",destination:"{rotary_name} dnel kavaa gir ve {destination} istikametinde k"},exit:{default:"Dnel kavaa gir ve {exit_number} numaral ka gir",name:"Dnel kavaa gir ve {way_name} zerindeki {exit_number} numaral ka gir",destination:"Dnel kavaa gir ve {destination} istikametindeki {exit_number} numaral ka gir"},name_exit:{default:"{rotary_name} dnel kavaa gir ve {exit_number} numaral ka gir",name:"{rotary_name} dnel kavaa gir ve {way_name} zerindeki {exit_number} numaral ka gir",destination:"{rotary_name} dnel kavaa gir ve {destination} istikametindeki {exit_number} numaral ka gir"}}},roundabout:{default:{exit:{default:"Gbekli kavaa gir ve {exit_number} numaral ka gir",name:"Gbekli kavaa gir ve {way_name} zerindeki {exit_number} numaral ka gir",destination:"Gbekli kavaa gir ve {destination} istikametindeki {exit_number} numaral ka gir"},default:{default:"Gbekli kavaa gir",name:"Gbekli kavaa gir ve {way_name} zerinde k",destination:"Gbekli kavaa gir ve {destination} istikametinde k"}}},"roundabout turn":{default:{default:"{modifier} yne dn",name:"{way_name} zerinde {modifier} yne dn",destination:"{destination} istikametinde {modifier} yne dn"},left:{default:"Sola dn",name:"{way_name} zerinde sola dn",destination:"{destination} istikametinde sola dn"},right:{default:"Saa dn",name:"{way_name} zerinde saa dn",destination:"{destination} istikametinde saa dn"},straight:{default:"Dz devam et",name:"{way_name} zerinde dz devam et",destination:"{destination} istikametinde dz devam et"}},"exit roundabout":{default:{default:"{modifier} yne dn",name:"{way_name} zerinde {modifier} yne dn",destination:"{destination} istikametinde {modifier} yne dn"},left:{default:"Sola dn",name:"{way_name} zerinde sola dn",destination:"{destination} istikametinde sola dn"},right:{default:"Saa dn",name:"{way_name} zerinde saa dn",destination:"{destination} istikametinde saa dn"},straight:{default:"Dz devam et",name:"{way_name} zerinde dz devam et",destination:"{destination} istikametinde dz devam et"}},"exit rotary":{default:{default:"{modifier} yne dn",name:"{way_name} zerinde {modifier} yne dn",destination:"{destination} istikametinde {modifier} yne dn"},left:{default:"Sola dn",name:"{way_name} zerinde sola dn",destination:"{destination} istikametinde sola dn"},right:{default:"Saa dn",name:"{way_name} zerinde saa dn",destination:"{destination} istikametinde saa dn"},straight:{default:"Dz devam et",name:"{way_name} zerinde dz devam et",destination:"{destination} istikametinde dz devam et"}},turn:{default:{default:"{modifier} yne dn",name:"{way_name} zerinde {modifier} yne dn",destination:"{destination} istikametinde {modifier} yne dn"},left:{default:"Sola dnn",name:"{way_name} zerinde sola dn",destination:"{destination} istikametinde sola dn"},right:{default:"Saa dnn",name:"{way_name} zerinde saa dn",destination:"{destination} istikametinde saa dn"},straight:{default:"Dz git",name:"{way_name} zerinde dz git",destination:"{destination} istikametinde dz git"}},"use lane":{no_lanes:{default:"Dz devam edin"},default:{default:"{lane_instruction}"}}}}},{}],45:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"},direction:{north:"",northeast:" ",east:"",southeast:" ",south:"",southwest:" ",west:"",northwest:" "},modifier:{left:"",right:"","sharp left":" ","sharp right":" ","slight left":" ","slight right":" ",straight:"",uturn:""},lanes:{xo:" ",ox:" ",xox:"  ",oxo:"   "}},modes:{ferry:{default:" ",name:"  {way_name}",destination:"    {destination}"}},phrase:{"two linked by distance":"{instruction_one}, ,  {distance}, {instruction_two}","two linked":"{instruction_one},  {instruction_two}","one in distance":" {distance}, {instruction_one}","name and ref":"{name} ({ref})","exit with number":"' {exit}"},arrive:{default:{default:"    {nth}  ",upcoming:"    {nth}  ",short:" ","short-upcoming":" ",named:"   {waypoint_name}"},left:{default:"    {nth}  ,  ",upcoming:"    {nth}  , ",short:" ","short-upcoming":" ",named:"   {waypoint_name} "},right:{default:"    {nth}  ,   ",upcoming:"    {nth}  , ",short:" ","short-upcoming":" ",named:"   {waypoint_name} "},"sharp left":{default:"    {nth}  ,   ",upcoming:"    {nth}  , ",short:" ","short-upcoming":" ",named:"   {waypoint_name} "},"sharp right":{default:"    {nth}  ,   ",upcoming:"    {nth}  , ",short:" ","short-upcoming":" ",named:"   {waypoint_name} "},"slight right":{default:"    {nth}  ,   ",upcoming:"    {nth}  , ",short:" ","short-upcoming":" ",named:"   {waypoint_name} "},"slight left":{default:"    {nth}  ,   ",upcoming:"    {nth}  , ",short:" ","short-upcoming":" ",named:"   {waypoint_name} "},straight:{default:"    {nth}  ,     ",upcoming:"    {nth}  ,   ",short:" ","short-upcoming":" ",named:"   {waypoint_name}   "}},continue:{default:{default:" {modifier}",name:"{modifier}   {way_name}",destination:" {modifier}   {destination}",exit:" {modifier}  {way_name}"},straight:{default:"  ",name:"     {way_name}",destination:"   {destination}",distance:"   {distance}",namedistance:"   {way_name} {distance}"},"sharp left":{default:"  ",name:"      {way_name}",destination:"     {destination}"},"sharp right":{default:"  ",name:"      {way_name}",destination:"     {destination}"},"slight left":{default:"  ",name:"      {way_name}",destination:"     {destination}"},"slight right":{default:"  ",name:"      {way_name}",destination:"     {destination}"},uturn:{default:" ",name:"     {way_name}",destination:"    {destination}"}},depart:{default:{default:"  {direction}",name:"  {direction}  {way_name}",namedistance:"  {direction}  {way_name} {distance}"}},"end of road":{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}   {destination}"},straight:{default:"  ",name:"    {way_name}",destination:"     {destination}"},uturn:{default:"    ",name:"   {way_name}   ",destination:"    {destination}   "}},fork:{default:{default:"   {modifier}",name:" {modifier}    {way_name}",destination:" {modifier}   {destination}"},"slight left":{default:"   ",name:"     {way_name}",destination:"    {destination}"},"slight right":{default:"   ",name:"     {way_name}",destination:"    {destination}"},"sharp left":{default:"    ",name:"    {way_name}",destination:"     {destination}"},"sharp right":{default:"    ",name:"    {way_name}",destination:"     {destination}"},uturn:{default:" ",name:"   {way_name}",destination:"    {destination}"}},merge:{default:{default:"   {modifier}",name:"   {modifier}  {way_name}",destination:"   {modifier}   {destination}"},straight:{default:"  ",name:"    {way_name}",destination:"     {destination}"},"slight left":{default:"   ",name:"     {way_name}",destination:"      {destination}"},"slight right":{default:"   ",name:"     {way_name}",destination:"      {destination}"},"sharp left":{default:"   ",name:"     {way_name}",destination:"      {destination}"},"sharp right":{default:"   ",name:"     {way_name}",destination:"      {destination}"},uturn:{default:" ",name:"   {way_name}",destination:"    {destination}"}},"new name":{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}   {destination}"},straight:{default:" ",name:"  {way_name}",destination:"   {destination}"},"sharp left":{default:"  ",name:"    {way_name}",destination:"     {destination}"},"sharp right":{default:"  ",name:"    {way_name}",destination:"     {destination}"},"slight left":{default:"  ",name:"    {way_name}",destination:"     {destination}"},"slight right":{default:"  ",name:"    {way_name}",destination:"     {destination}"},uturn:{default:" ",name:"   {way_name}",destination:"    {destination}"}},notification:{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}   {destination}"},uturn:{default:" ",name:"   {way_name}",destination:"    {destination}"}},"off ramp":{default:{default:"  ",name:"    {way_name}",destination:"     {destination}",exit:" ' {exit}",exit_destination:" ' {exit}   {destination}"},left:{default:"   ",name:"     {way_name}",destination:"      {destination}",exit:" ' {exit} ",exit_destination:" ' {exit}    {destination}"},right:{default:"   ",name:"     {way_name}",destination:"      {destination}",exit:" ' {exit} ",exit_destination:" ' {exit}    {destination}"},"sharp left":{default:"   ",name:"     {way_name}",destination:"      {destination}",exit:" ' {exit} ",exit_destination:" ' {exit}    {destination}"},"sharp right":{default:"   ",name:"     {way_name}",destination:"      {destination}",exit:" ' {exit} ",exit_destination:" ' {exit}    {destination}"},"slight left":{default:"   ",name:"     {way_name}",destination:"      {destination}",exit:" ' {exit} ",exit_destination:" ' {exit}    {destination}"},"slight right":{default:"   ",name:"     {way_name}",destination:"      {destination}",exit:" ' {exit} ",exit_destination:" ' {exit}    {destination}"}},"on ramp":{default:{default:"  ",name:"    {way_name}",destination:"     {destination}"},left:{default:"   ",name:"     {way_name}",destination:"      {destination}"},right:{default:"   ",name:"     {way_name}",destination:"      {destination}"},"sharp left":{default:"   ",name:"     {way_name}",destination:"      {destination}"},"sharp right":{default:"   ",name:"     {way_name}",destination:"      {destination}"},"slight left":{default:"   ",name:"     {way_name}",destination:"      {destination}"},"slight right":{default:"   ",name:"     {way_name}",destination:"      {destination}"}},rotary:{default:{default:{default:"  ",name:"    {way_name}",destination:"     {destination}"},name:{default:"  {rotary_name}",name:"  {rotary_name}    {way_name}",destination:"  {rotary_name}     {destination}"},exit:{default:"      {exit_number} '",name:"      {exit_number} '  {way_name}",destination:"      {exit_number} '   {destination}"},name_exit:{default:"  {rotary_name}    {exit_number} '",name:"  {rotary_name}    {exit_number} '  {way_name}",destination:"  {rotary_name}    {exit_number} '   {destination}"}}},roundabout:{default:{exit:{default:"      {exit_number} '",name:"      {exit_number} '  {way_name}",destination:"      {exit_number} '   {destination}"},default:{default:"  ",name:"    {way_name}",destination:"     {destination}"}}},"roundabout turn":{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}   {destination}"},left:{default:" ",name:"   {way_name}",destination:"    {destination}"},right:{default:" ",name:"   {way_name}",destination:"    {destination}"},straight:{default:" ",name:"    {way_name}",destination:"     {destination}"}},"exit roundabout":{default:{default:" ",name:"   {way_name} ",destination:"    {destination}"}},"exit rotary":{default:{default:" ",name:"   {way_name} ",destination:"    {destination}"}},turn:{default:{default:" {modifier}",name:" {modifier}  {way_name}",destination:" {modifier}   {destination}"},left:{default:" ",name:"   {way_name}",destination:"    {destination}"},right:{default:" ",name:"   {way_name}",destination:"    {destination}"},straight:{default:" ",name:"   {way_name}",destination:"    {destination}"}},"use lane":{no_lanes:{default:"  "},default:{default:"{lane_instruction}"}}}}},{}],46:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!0},v5:{constants:{ordinalize:{1:"u tin",2:"th 2",3:"th 3",4:"th 4",5:"th 5",6:"th 6",7:"th 7",8:"th 8",9:"th 9",10:"th 10"},direction:{north:"bc",northeast:"ng bc",east:"ng",southeast:"ng nam",south:"nam",southwest:"ty nam",west:"ty",northwest:"ty bc"},modifier:{left:"tri",right:"phi","sharp left":"tri gt","sharp right":"phi gt","slight left":"tri nghing","slight right":"phi nghing",straight:"thng",uturn:"ngc"},lanes:{xo:"i bn phi",ox:"i bn tri",xox:"i vo gia",oxo:"i bn tri hay bn phi"}},modes:{ferry:{default:"Ln ph",name:"Ln ph {way_name}",destination:"Ln ph i {destination}"}},phrase:{"two linked by distance":"{instruction_one}, ri {distance} na th {instruction_two}","two linked":"{instruction_one}, ri {instruction_two}","one in distance":"{distance} na th {instruction_one}","name and ref":"{name} ({ref})","exit with number":"li ra {exit}"},arrive:{default:{default:"n ni {nth}",upcoming:"n ni {nth}",short:"n ni","short-upcoming":"n ni",named:"n {waypoint_name}"},left:{default:"n ni {nth}  bn tri",upcoming:"n ni {nth}  bn tri",short:"n ni","short-upcoming":"n ni",named:"n {waypoint_name}  bn tri"},right:{default:"n ni {nth}  bn phi",upcoming:"n ni {nth}  bn phi",short:"n ni","short-upcoming":"n ni",named:"n {waypoint_name}  bn phi"},"sharp left":{default:"n ni {nth}  bn tri",upcoming:"n ni {nth}  bn tri",short:"n ni","short-upcoming":"n ni",named:"n {waypoint_name}  bn tri"},"sharp right":{default:"n ni {nth}  bn phi",upcoming:"n ni {nth}  bn phi",short:"n ni","short-upcoming":"n ni",named:"n {waypoint_name}  bn phi"},"slight right":{default:"n ni {nth}  bn phi",upcoming:"n ni {nth}  bn phi",short:"n ni","short-upcoming":"n ni",named:"n {waypoint_name}  bn phi"},"slight left":{default:"n ni {nth}  bn tri",upcoming:"n ni {nth}  bn tri",short:"n ni","short-upcoming":"n ni",named:"n {waypoint_name}  bn tri"},straight:{default:"n ni {nth}  trc mt",upcoming:"n ni {nth}  trc mt",short:"n ni","short-upcoming":"n ni",named:"n {waypoint_name}  trc mt"}},continue:{default:{default:"Quo {modifier}",name:"Quo {modifier}  chy tip trn {way_name}",destination:"Quo {modifier} v {destination}",exit:"Quo {modifier} vo {way_name}"},straight:{default:"Chy thng",name:"Chy tip trn {way_name}",destination:"Chy tip v {destination}",distance:"Chy thng cho {distance}",namedistance:"Chy tip trn {way_name} cho {distance}"},"sharp left":{default:"Quo gt bn tri",name:"Quo gt bn tri  chy tip trn {way_name}",destination:"Quo gt bn tri v {destination}"},"sharp right":{default:"Quo gt bn phi",name:"Quo gt bn phi  chy tip trn {way_name}",destination:"Quo gt bn phi v {destination}"},"slight left":{default:"Nghing v bn tri",name:"Nghing v bn tri  chy tip trn {way_name}",destination:"Nghing v bn tri v {destination}"},"slight right":{default:"Nghing v bn phi",name:"Nghing v bn phi  chy tip trn {way_name}",destination:"Nghing v bn phi v {destination}"},uturn:{default:"Quo ngc li",name:"Quo ngc li trn {way_name}",destination:"Quo ngc v {destination}"}},depart:{default:{default:"i v hng {direction}",name:"i v hng {direction} trn {way_name}",namedistance:"i v hng {direction} trn {way_name} cho {distance}"}},"end of road":{default:{default:"Quo {modifier}",name:"Quo {modifier} vo {way_name}",destination:"Quo {modifier} v {destination}"},straight:{default:"Chy thng",name:"Chy tip trn {way_name}",destination:"Chy tip v {destination}"},uturn:{default:"Quo ngc li ti cui ng",name:"Quo ngc vo {way_name} ti cui ng",destination:"Quo ngc v {destination} ti cui ng"}},fork:{default:{default:"i bn {modifier}  ng ba",name:"Gi bn {modifier} vo {way_name}",destination:"Gi bn {modifier} v {destination}"},"slight left":{default:"Nghing v bn tri  ng ba",name:"Gi bn tri vo {way_name}",destination:"Gi bn tri v {destination}"},"slight right":{default:"Nghing v bn phi  ng ba",name:"Gi bn phi vo {way_name}",destination:"Gi bn phi v {destination}"},"sharp left":{default:"Quo gt bn tri  ng ba",name:"Quo gt bn tri vo {way_name}",destination:"Quo gt bn tri v {destination}"},"sharp right":{default:"Quo gt bn phi  ng ba",name:"Quo gt bn phi vo {way_name}",destination:"Quo gt bn phi v {destination}"},uturn:{default:"Quo ngc li",name:"Quo ngc li {way_name}",destination:"Quo ngc li v {destination}"}},merge:{default:{default:"Nhp sang {modifier}",name:"Nhp sang {modifier} vo {way_name}",destination:"Nhp sang {modifier} v {destination}"},straight:{default:"Nhp ng",name:"Nhp vo {way_name}",destination:"Nhp ng v {destination}"},"slight left":{default:"Nhp sang tri",name:"Nhp sang tri vo {way_name}",destination:"Nhp sang tri v {destination}"},"slight right":{default:"Nhp sang phi",name:"Nhp sang phi vo {way_name}",destination:"Nhp sang phi v {destination}"},"sharp left":{default:"Nhp sang tri",name:"Nhp sang tri vo {way_name}",destination:"Nhp sang tri v {destination}"},"sharp right":{default:"Nhp sang phi",name:"Nhp sang phi vo {way_name}",destination:"Nhp sang phi v {destination}"},uturn:{default:"Quo ngc li",name:"Quo ngc li {way_name}",destination:"Quo ngc li v {destination}"}},"new name":{default:{default:"Chy tip bn {modifier}",name:"Chy tip bn {modifier} trn {way_name}",destination:"Chy tip bn {modifier} v {destination}"},straight:{default:"Chy thng",name:"Chy tip trn {way_name}",destination:"Chy tip v {destination}"},"sharp left":{default:"Quo gt bn tri",name:"Quo gt bn tri vo {way_name}",destination:"Quo gt bn tri v {destination}"},"sharp right":{default:"Quo gt bn phi",name:"Quo gt bn phi vo {way_name}",destination:"Quo gt bn phi v {destination}"},"slight left":{default:"Nghing v bn tri",name:"Nghing v bn tri vo {way_name}",destination:"Nghing v bn tri v {destination}"},"slight right":{default:"Nghing v bn phi",name:"Nghing v bn phi vo {way_name}",destination:"Nghing v bn phi v {destination}"},uturn:{default:"Quo ngc li",name:"Quo ngc li {way_name}",destination:"Quo ngc li v {destination}"}},notification:{default:{default:"Chy tip bn {modifier}",name:"Chy tip bn {modifier} trn {way_name}",destination:"Chy tip bn {modifier} v {destination}"},uturn:{default:"Quo ngc li",name:"Quo ngc li {way_name}",destination:"Quo ngc li v {destination}"}},"off ramp":{default:{default:"i ng nhnh",name:"i ng nhnh {way_name}",destination:"i ng nhnh v {destination}",exit:"i theo li ra {exit}",exit_destination:"i theo li ra {exit} v {destination}"},left:{default:"i ng nhnh bn tri",name:"i ng nhnh {way_name} bn tri",destination:"i ng nhnh bn tri v {destination}",exit:"i theo li ra {exit} bn tri",exit_destination:"i theo li ra {exit} bn tri v {destination}"},right:{default:"i ng nhnh bn phi",name:"i ng nhnh {way_name} bn phi",destination:"i ng nhnh bn phi v {destination}",exit:"i theo li ra {exit} bn phi",exit_destination:"i theo li ra {exit} bn phi v {destination}"},"sharp left":{default:"i ng nhnh bn tri",name:"i ng nhnh {way_name} bn tri",destination:"i ng nhnh bn tri v {destination}",exit:"i theo li ra {exit} bn tri",exit_destination:"i theo li ra {exit} bn tri v {destination}"},"sharp right":{default:"i ng nhnh bn phi",name:"i ng nhnh {way_name} bn phi",destination:"i ng nhnh bn phi v {destination}",exit:"i theo li ra {exit} bn phi",exit_destination:"i theo li ra {exit} bn phi v {destination}"},"slight left":{default:"i ng nhnh bn tri",name:"i ng nhnh {way_name} bn tri",destination:"i ng nhnh bn tri v {destination}",exit:"i theo li ra {exit} bn tri",exit_destination:"i theo li ra {exit} bn tri v {destination}"},"slight right":{default:"i ng nhnh bn phi",name:"i ng nhnh {way_name} bn phi",destination:"i ng nhnh bn phi v {destination}",exit:"i theo li ra {exit} bn phi",exit_destination:"i theo li ra {exit} bn phi v {destination}"}},"on ramp":{default:{default:"i ng nhnh",name:"i ng nhnh {way_name}",destination:"i ng nhnh v {destination}"},left:{default:"i ng nhnh bn tri",name:"i ng nhnh {way_name} bn tri",destination:"i ng nhnh bn tri v {destination}"},right:{default:"i ng nhnh bn phi",name:"i ng nhnh {way_name} bn phi",destination:"i ng nhnh bn phi v {destination}"},"sharp left":{default:"i ng nhnh bn tri",name:"i ng nhnh {way_name} bn tri",destination:"i ng nhnh bn tri v {destination}"},"sharp right":{default:"i ng nhnh bn phi",name:"i ng nhnh {way_name} bn phi",destination:"i ng nhnh bn phi v {destination}"},"slight left":{default:"i ng nhnh bn tri",name:"i ng nhnh {way_name} bn tri",destination:"i ng nhnh bn tri v {destination}"},"slight right":{default:"i ng nhnh bn phi",name:"i ng nhnh {way_name} bn phi",destination:"i ng nhnh bn phi v {destination}"}},rotary:{default:{default:{default:"i vo bng binh",name:"i vo bng binh v ra ti {way_name}",destination:"i vo bng binh v ra v {destination}"},name:{default:"i vo {rotary_name}",name:"i vo {rotary_name} v ra ti {way_name}",destination:"i v {rotary_name} v ra v {destination}"},exit:{default:"i vo bng binh v ra ti ng {exit_number}",name:"i vo bng binh v ra ti ng {exit_number} tc {way_name}",destination:"i vo bng binh v ra ti ng {exit_number} v {destination}"},name_exit:{default:"i vo {rotary_name} v ra ti ng {exit_number}",name:"i vo {rotary_name} v ra ti ng {exit_number} tc {way_name}",destination:"i vo {rotary_name} v ra ti ng {exit_number} v {destination}"}}},roundabout:{default:{exit:{default:"i vo bng binh v ra ti ng {exit_number}",name:"i vo bng binh v ra ti ng {exit_number} tc {way_name}",destination:"i vo bng binh v ra ti ng {exit_number} v {destination}"},default:{default:"i vo bng binh",name:"i vo bng binh v ra ti {way_name}",destination:"i vo bng binh v ra v {destination}"}}},"roundabout turn":{default:{default:"Quo {modifier}",name:"Quo {modifier} vo {way_name}",destination:"Quo {modifier} v {destination}"},left:{default:"Quo tri",name:"Quo tri vo {way_name}",destination:"Quo tri v {destination}"},right:{default:"Quo phi",name:"Quo phi vo {way_name}",destination:"Quo phi v {destination}"},straight:{default:"Chy thng",name:"Chy tip trn {way_name}",destination:"Chy tip v {destination}"}},"exit roundabout":{default:{default:"Ra bng binh",name:"Ra bng binh vo {way_name}",destination:"Ra bng binh v {destination}"}},"exit rotary":{default:{default:"Ra bng binh",name:"Ra bng binh vo {way_name}",destination:"Ra bng binh v {destination}"}},turn:{default:{default:"Quo {modifier}",name:"Quo {modifier} vo {way_name}",destination:"Quo {modifier} v {destination}"},left:{default:"Quo tri",name:"Quo tri vo {way_name}",destination:"Quo tri v {destination}"},right:{default:"Quo phi",name:"Quo phi vo {way_name}",destination:"Quo phi v {destination}"},straight:{default:"Chy thng",name:"Chy thng vo {way_name}",destination:"Chy thng v {destination}"}},"use lane":{no_lanes:{default:"Chy thng"},default:{default:"{lane_instruction}"}}}}},{}],47:[function(Fe,Oe,De){Oe.exports={meta:{capitalizeFirstLetter:!1},v5:{constants:{ordinalize:{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:""},direction:{north:"",northeast:"",east:"",southeast:"",south:"",southwest:"",west:"",northwest:""},modifier:{left:"",right:"","sharp left":"","sharp right":"","slight left":"","slight right":"",straight:"",uturn:""},lanes:{xo:"",ox:"",xox:"",oxo:""}},modes:{ferry:{default:"",name:"{way_name}",destination:"{destination}"}},phrase:{"two linked by distance":"{instruction_one}{distance}{instruction_two}","two linked":"{instruction_one}{instruction_two}","one in distance":"{distance}{instruction_one}","name and ref":"{name}{ref}","exit with number":"{exit}"},arrive:{default:{default:"{nth}",upcoming:"{nth}",short:"","short-upcoming":"",named:"{waypoint_name}"},left:{default:"{nth}",upcoming:"{nth}",short:"","short-upcoming":"",named:"{waypoint_name}"},right:{default:"{nth}",upcoming:"{nth}",short:"","short-upcoming":"",named:"{waypoint_name}"},"sharp left":{default:"{nth}",upcoming:"{nth}",short:"","short-upcoming":"",named:"{waypoint_name}"},"sharp right":{default:"{nth}",upcoming:"{nth}",short:"","short-upcoming":"",named:"{waypoint_name}"},"slight right":{default:"{nth}",upcoming:"{nth}",short:"","short-upcoming":"",named:"{waypoint_name}"},"slight left":{default:"{nth}",upcoming:"{nth}",short:"","short-upcoming":"",named:"{waypoint_name}"},straight:{default:"{nth}",upcoming:"{nth}",short:"","short-upcoming":"",named:"{waypoint_name}"}},continue:{default:{default:"{modifier}",name:"{way_name}{modifier}",destination:"{modifier}{destination}",exit:"{modifier}{way_name}"},straight:{default:"",name:"{way_name}",destination:"{destination}",distance:"{distance}",namedistance:"{way_name}{distance}"},"sharp left":{default:"",name:"{way_name}",destination:"{destination}"},"sharp right":{default:"",name:"{way_name}",destination:"{destination}"},"slight left":{default:"",name:"{way_name}",destination:"{destination}"},"slight right":{default:"",name:"{way_name}",destination:"{destination}"},uturn:{default:"",name:"{way_name}",destination:"{destination}"}},depart:{default:{default:"{direction}",name:"{direction}{way_name}",namedistance:"{direction}{way_name}{distance}"}},"end of road":{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination}"},straight:{default:"",name:"{way_name}",destination:"{destination}"},uturn:{default:"",name:"{way_name}",destination:"{destination}"}},fork:{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination}"},"slight left":{default:"",name:"{way_name}",destination:"{destination}"},"slight right":{default:"",name:"{way_name}",destination:"{destination}"},"sharp left":{default:"",name:"{way_name}",destination:"{destination}"},"sharp right":{default:"",name:"{way_name}",destination:"{destination}"},uturn:{default:"",name:"{way_name}",destination:"{destination}"}},merge:{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination}"},straight:{default:"",name:"{way_name}",destination:"{destination}"},"slight left":{default:"",name:"{way_name}",destination:"{destination}"},"slight right":{default:"",name:"{way_name}",destination:"{destination}"},"sharp left":{default:"",name:"{way_name}",destination:"{destination}"},"sharp right":{default:"",name:"{way_name}",destination:"{destination}"},uturn:{default:"",name:"{way_name}",destination:"{destination}"}},"new name":{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination}"},straight:{default:"",name:"{way_name}",destination:"{destination}"},"sharp left":{default:"",name:"{way_name}",destination:"{destination}"},"sharp right":{default:"",name:"{way_name}",destination:"{destination}"},"slight left":{default:"",name:"{way_name}",destination:"{destination}"},"slight right":{default:"",name:"{way_name}",destination:"{destination}"},uturn:{default:"",name:"{way_name}",destination:"{destination}"}},notification:{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination}"},uturn:{default:"",name:"{way_name}",destination:"{destination}"}},"off ramp":{default:{default:"",name:"{way_name}",destination:"{destination}",exit:"{exit}",exit_destination:"{exit}{destination}"},left:{default:"",name:"{way_name}",destination:"{destination}",exit:"{exit}",exit_destination:"{exit}{destination}"},right:{default:"",name:"{way_name}",destination:"{destination}",exit:"{exit}",exit_destination:"{exit}{destination}"},"sharp left":{default:"",name:"{way_name}",destination:"{destination}",exit:"{exit}",exit_destination:"{exit}{destination}"},"sharp right":{default:"",name:"{way_name}",destination:"{destination}",exit:"{exit}",exit_destination:"{exit}{destination}"},"slight left":{default:"",name:"{way_name}",destination:"{destination}",exit:"{exit}",exit_destination:"{exit}{destination}"},"slight right":{default:"",name:"{way_name}",destination:"{destination}",exit:"{exit}",exit_destination:"{exit}{destination}"}},"on ramp":{default:{default:"",name:"{way_name}",destination:"{destination}"},left:{default:"",name:"{way_name}",destination:"{destination}"},right:{default:"",name:"{way_name}",destination:"{destination}"},"sharp left":{default:"",name:"{way_name}",destination:"{destination}"},"sharp right":{default:"",name:"{way_name}",destination:"{destination}"},"slight left":{default:"",name:"{way_name}",destination:"{destination}"},"slight right":{default:"",name:"{way_name}",destination:"{destination}"}},rotary:{default:{default:{default:"",name:"{way_name}",destination:"{destination}"},name:{default:"{rotary_name}",name:"{rotary_name}{way_name}",destination:"{rotary_name}{destination}"},exit:{default:"{exit_number}",name:"{exit_number}{way_name}",destination:"{exit_number}{destination}"},name_exit:{default:"{rotary_name}{exit_number}",name:"{rotary_name}{exit_number}{way_name}",destination:"{rotary_name}{exit_number}{destination}"}}},roundabout:{default:{exit:{default:"{exit_number}",name:"{exit_number}{way_name}",destination:"{exit_number}{destination}"},default:{default:"",name:"{way_name}",destination:"{destination}"}}},"roundabout turn":{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination}"},left:{default:"",name:"{way_name}",destination:"{destination}"},right:{default:"",name:"{way_name}",destination:"{destination}"},straight:{default:"",name:"{way_name}",destination:"{destination}"}},"exit roundabout":{default:{default:"",name:"{way_name}",destination:"{destination}"}},"exit rotary":{default:{default:"",name:"{way_name}",destination:"{destination}"}},turn:{default:{default:"{modifier}",name:"{modifier}{way_name}",destination:"{modifier}{destination}"},left:{default:"",name:"{way_name}",destination:"{destination}"},right:{default:"",name:"{way_name}",destination:"{destination}"},straight:{default:"",name:"{way_name}",destination:"{destination}"}},"use lane":{no_lanes:{default:""},default:{default:"{lane_instruction}"}}}}},{}],48:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null;Oe.exports=T.Class.extend({options:{timeout:500,blurTimeout:100,noResultsMessage:"No results found."},initialize:function(w,v,o,I){T.setOptions(this,I),this._elem=w,this._resultFn=I.resultFn?T.Util.bind(I.resultFn,I.resultContext):null,this._autocomplete=I.autocompleteFn?T.Util.bind(I.autocompleteFn,I.autocompleteContext):null,this._selectFn=T.Util.bind(v,o),this._container=T.DomUtil.create("div","leaflet-routing-geocoder-result"),this._resultTable=T.DomUtil.create("table","",this._container),T.DomEvent.addListener(this._elem,"input",this._keyPressed,this),T.DomEvent.addListener(this._elem,"keypress",this._keyPressed,this),T.DomEvent.addListener(this._elem,"keydown",this._keyDown,this),T.DomEvent.addListener(this._elem,"blur",function(){this._isOpen&&this.close()},this)},close:function(){T.DomUtil.removeClass(this._container,"leaflet-routing-geocoder-result-open"),this._isOpen=!1},_open:function(){var w=this._elem.getBoundingClientRect();if(!this._container.parentElement){var v=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,o=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;this._container.style.left=w.left+v+"px",this._container.style.top=w.bottom+o+"px",this._container.style.width=w.right-w.left+"px",document.body.appendChild(this._container)}T.DomUtil.addClass(this._container,"leaflet-routing-geocoder-result-open"),this._isOpen=!0},_setResults:function(w){var v,o,I,R;for(delete this._selection,this._results=w;this._resultTable.firstChild;)this._resultTable.removeChild(this._resultTable.firstChild);for(v=0;v<w.length;v++)o=T.DomUtil.create("tr","",this._resultTable),o.setAttribute("data-result-index",v),I=T.DomUtil.create("td","",o),R=document.createTextNode(w[v].name),I.appendChild(R),T.DomEvent.addListener(I,"mousedown",T.DomEvent.preventDefault),T.DomEvent.addListener(I,"click",this._createClickListener(w[v]));v||(o=T.DomUtil.create("tr","",this._resultTable),I=T.DomUtil.create("td","leaflet-routing-geocoder-no-results",o),I.innerHTML=this.options.noResultsMessage),this._open(),w.length>0&&this._select(1)},_createClickListener:function(w){var v=this._resultSelected(w);return T.bind(function(){this._elem.blur(),v()},this)},_resultSelected:function(w){return T.bind(function(){this.close(),this._elem.value=w.name,this._lastCompletedText=w.name,this._selectFn(w)},this)},_keyPressed:function(w){var v;if(this._isOpen&&w.keyCode===13&&this._selection){v=parseInt(this._selection.getAttribute("data-result-index"),10),this._resultSelected(this._results[v])(),T.DomEvent.preventDefault(w);return}if(w.keyCode===13){T.DomEvent.preventDefault(w),this._complete(this._resultFn,!0);return}if(this._autocomplete&&document.activeElement===this._elem){this._timer&&clearTimeout(this._timer),this._timer=setTimeout(T.Util.bind(function(){this._complete(this._autocomplete)},this),this.options.timeout);return}this._unselect()},_select:function(w){var v=this._selection;v&&(T.DomUtil.removeClass(v.firstChild,"leaflet-routing-geocoder-selected"),v=v[w>0?"nextSibling":"previousSibling"]),v||(v=this._resultTable[w>0?"firstChild":"lastChild"]),v&&(T.DomUtil.addClass(v.firstChild,"leaflet-routing-geocoder-selected"),this._selection=v)},_unselect:function(){this._selection&&T.DomUtil.removeClass(this._selection.firstChild,"leaflet-routing-geocoder-selected"),delete this._selection},_keyDown:function(w){if(this._isOpen)switch(w.keyCode){case 27:this.close(),T.DomEvent.preventDefault(w);return;case 38:this._select(-1),T.DomEvent.preventDefault(w);return;case 40:this._select(1),T.DomEvent.preventDefault(w);return}},_complete:function(w,v){var o=this._elem.value;function I(R){this._lastCompletedText=o,v&&R.length===1?this._resultSelected(R[0])():this._setResults(R)}o&&(o!==this._lastCompletedText?w(o,I,this):v&&I.call(this,this._results))}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{}],49:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null,w=Fe("./itinerary"),v=Fe("./line"),o=Fe("./plan"),I=Fe("./osrm-v1");Oe.exports=w.extend({options:{fitSelectedRoutes:"smart",routeLine:function(R,q){return new v(R,q)},autoRoute:!0,routeWhileDragging:!1,routeDragInterval:500,waypointMode:"connect",showAlternatives:!1,defaultErrorHandler:function(R){console.error("Routing error:",R.error)}},initialize:function(R){T.Util.setOptions(this,R),this._router=this.options.router||new I(R),this._plan=this.options.plan||new o(this.options.waypoints,R),this._requestCount=0,w.prototype.initialize.call(this,R),this.on("routeselected",this._routeSelected,this),this.options.defaultErrorHandler&&this.on("routingerror",this.options.defaultErrorHandler),this._plan.on("waypointschanged",this._onWaypointsChanged,this),R.routeWhileDragging&&this._setupRouteDragging()},_onZoomEnd:function(){if(!(!this._selectedRoute||!this._router.requiresMoreDetail)){var R=this._map;this._router.requiresMoreDetail(this._selectedRoute,R.getZoom(),R.getBounds())&&this.route({callback:T.bind(function(q,X){var re;if(!q){for(re=0;re<X.length;re++)this._routes[re].properties=X[re].properties;this._updateLineCallback(q,X)}},this),simplifyGeometry:!1,geometryOnly:!0})}},onAdd:function(R){this.options.autoRoute&&this.route();var q=w.prototype.onAdd.call(this,R);return this._map=R,this._map.addLayer(this._plan),this._map.on("zoomend",this._onZoomEnd,this),this._plan.options.geocoder&&q.insertBefore(this._plan.createGeocoders(),q.firstChild),q},onRemove:function(R){if(R.off("zoomend",this._onZoomEnd,this),this._line&&R.removeLayer(this._line),R.removeLayer(this._plan),this._alternatives&&this._alternatives.length>0)for(var q=0,X=this._alternatives.length;q<X;q++)R.removeLayer(this._alternatives[q]);return w.prototype.onRemove.call(this,R)},getWaypoints:function(){return this._plan.getWaypoints()},setWaypoints:function(R){return this._plan.setWaypoints(R),this},spliceWaypoints:function(){var R=this._plan.spliceWaypoints.apply(this._plan,arguments);return R},getPlan:function(){return this._plan},getRouter:function(){return this._router},_routeSelected:function(R){var q=this._selectedRoute=R.route,X=this.options.showAlternatives&&R.alternatives,re=this.options.fitSelectedRoutes,ce=re==="smart"&&!this._waypointsVisible()||re!=="smart"&&re;this._updateLines({route:q,alternatives:X}),ce&&this._map.fitBounds(this._line.getBounds()),this.options.waypointMode==="snap"&&(this._plan.off("waypointschanged",this._onWaypointsChanged,this),this.setWaypoints(q.waypoints),this._plan.on("waypointschanged",this._onWaypointsChanged,this))},_waypointsVisible:function(){var R=this.getWaypoints(),q,X,re,ce,Ae;try{for(q=this._map.getSize(),ce=0;ce<R.length;ce++)Ae=this._map.latLngToLayerPoint(R[ce].latLng),X?X.extend(Ae):X=T.bounds([Ae]);return re=X.getSize(),(re.x>q.x/5||re.y>q.y/5)&&this._waypointsInViewport()}catch{return!1}},_waypointsInViewport:function(){var R=this.getWaypoints(),q,X;try{q=this._map.getBounds()}catch{return!1}for(X=0;X<R.length;X++)if(q.contains(R[X].latLng))return!0;return!1},_updateLines:function(R){var q=this.options.addWaypoints!==void 0?this.options.addWaypoints:!0;this._clearLines(),this._alternatives=[],R.alternatives&&R.alternatives.forEach(function(X,re){this._alternatives[re]=this.options.routeLine(X,T.extend({isAlternative:!0},this.options.altLineOptions||this.options.lineOptions)),this._alternatives[re].addTo(this._map),this._hookAltEvents(this._alternatives[re])},this),this._line=this.options.routeLine(R.route,T.extend({addWaypoints:q,extendToWaypoints:this.options.waypointMode==="connect"},this.options.lineOptions)),this._line.addTo(this._map),this._hookEvents(this._line)},_hookEvents:function(R){R.on("linetouched",function(q){this._plan.dragNewWaypoint(q)},this)},_hookAltEvents:function(R){R.on("linetouched",function(q){var X=this._routes.slice(),re=X.splice(q.target._route.routesIndex,1)[0];this.fire("routeselected",{route:re,alternatives:X})},this)},_onWaypointsChanged:function(R){this.options.autoRoute&&this.route({}),this._plan.isReady()||(this._clearLines(),this._clearAlts()),this.fire("waypointschanged",{waypoints:R.waypoints})},_setupRouteDragging:function(){var R=0,q;this._plan.on("waypointdrag",T.bind(function(X){q=X.waypoints,R||(R=setTimeout(T.bind(function(){this.route({waypoints:q,geometryOnly:!0,callback:T.bind(this._updateLineCallback,this)}),R=void 0},this),this.options.routeDragInterval))},this)),this._plan.on("waypointdragend",function(){R&&(clearTimeout(R),R=void 0),this.route()},this)},_updateLineCallback:function(R,q){if(R)R.type!=="abort"&&this._clearLines();else{q=q.slice();var X=q.splice(this._selectedRoute.routesIndex,1)[0];this._updateLines({route:X,alternatives:this.options.showAlternatives?q:[]})}},route:function(R){var q=++this._requestCount,X;this._pendingRequest&&this._pendingRequest.abort&&(this._pendingRequest.abort(),this._pendingRequest=null),R=R||{},this._plan.isReady()&&(this.options.useZoomParameter&&(R.z=this._map&&this._map.getZoom()),X=R&&R.waypoints||this._plan.getWaypoints(),this.fire("routingstart",{waypoints:X}),this._pendingRequest=this._router.route(X,function(re,ce){if(this._pendingRequest=null,R.callback)return R.callback.call(this,re,ce);if(q===this._requestCount){if(this._clearLines(),this._clearAlts(),re&&re.type!=="abort"){this.fire("routingerror",{error:re});return}if(ce.forEach(function(Pe,le){Pe.routesIndex=le}),!R.geometryOnly)this.fire("routesfound",{waypoints:X,routes:ce}),this.setAlternatives(ce);else{var Ae=ce.splice(0,1)[0];this._routeSelected({route:Ae,alternatives:ce})}}},this,R))},_clearLines:function(){if(this._line&&(this._map.removeLayer(this._line),delete this._line),this._alternatives&&this._alternatives.length){for(var R in this._alternatives)this._map.removeLayer(this._alternatives[R]);this._alternatives=[]}}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{"./itinerary":55,"./line":56,"./osrm-v1":59,"./plan":60}],50:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null;Oe.exports=T.Control.extend({options:{header:"Routing error",formatMessage:function(w){return w.status<0?"Calculating the route caused an error. Technical description follows: <code><pre>"+w.message+"</pre></code":"The route could not be calculated. "+w.message}},initialize:function(w,v){T.Control.prototype.initialize.call(this,v),w.on("routingerror",T.bind(function(o){this._element&&(this._element.children[1].innerHTML=this.options.formatMessage(o.error),this._element.style.visibility="visible")},this)).on("routingstart",T.bind(function(){this._element&&(this._element.style.visibility="hidden")},this))},onAdd:function(){var w;return this._element=T.DomUtil.create("div","leaflet-bar leaflet-routing-error"),this._element.style.visibility="hidden",w=T.DomUtil.create("h3",null,this._element),T.DomUtil.create("span",null,this._element),w.innerHTML=this.options.header,this._element},onRemove:function(){delete this._element}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{}],51:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null,w=Fe("./localization");Oe.exports=T.Class.extend({options:{units:"metric",unitNames:null,language:"en",roundingSensitivity:1,distanceTemplate:"{value} {unit}"},initialize:function(v){T.setOptions(this,v);var o=T.Util.isArray(this.options.language)?this.options.language:[this.options.language,"en"];this._localization=new w(o)},formatDistance:function(v,o){var I=this.options.unitNames||this._localization.localize("units"),R=o<=0,q=R?function(Ae){return Ae}:T.bind(this._round,this),X,re,ce;return this.options.units==="imperial"?(re=v/.9144,re>=1e3?ce={value:q(v/1609.344,o),unit:I.miles}:ce={value:q(re,o),unit:I.yards}):(X=q(v,o),ce={value:X>=1e3?X/1e3:X,unit:X>=1e3?I.kilometers:I.meters}),R&&(ce.value=ce.value.toFixed(-o)),T.Util.template(this.options.distanceTemplate,ce)},_round:function(v,o){var I=o||this.options.roundingSensitivity,R=Math.pow(10,(Math.floor(v/I)+"").length-1),q=Math.floor(v/R),X=q>5?R:R/2;return Math.round(v/X)*X},formatTime:function(v){var o=this.options.unitNames||this._localization.localize("units");return v=Math.round(v/30)*30,v>86400?Math.round(v/3600)+" "+o.hours:v>3600?Math.floor(v/3600)+" "+o.hours+" "+Math.round(v%3600/60)+" "+o.minutes:v>300?Math.round(v/60)+" "+o.minutes:v>60?Math.floor(v/60)+" "+o.minutes+(v%60!==0?" "+v%60+" "+o.seconds:""):v+" "+o.seconds},formatInstruction:function(v,o){return v.text===void 0?this.capitalize(T.Util.template(this._getInstructionTemplate(v,o),T.extend({},v,{exitStr:v.exit?this._localization.localize("formatOrder")(v.exit):"",dir:this._localization.localize(["directions",v.direction]),modifier:this._localization.localize(["directions",v.modifier])}))):v.text},getIconName:function(v,o){switch(v.type){case"Head":if(o===0)return"depart";break;case"WaypointReached":return"via";case"Roundabout":return"enter-roundabout";case"DestinationReached":return"arrive"}switch(v.modifier){case"Straight":return"continue";case"SlightRight":return"bear-right";case"Right":return"turn-right";case"SharpRight":return"sharp-right";case"TurnAround":case"Uturn":return"u-turn";case"SharpLeft":return"sharp-left";case"Left":return"turn-left";case"SlightLeft":return"bear-left"}},capitalize:function(v){return v.charAt(0).toUpperCase()+v.substring(1)},_getInstructionTemplate:function(v,o){var I=v.type==="Straight"?o===0?"Head":"Continue":v.type,R=this._localization.localize(["instructions",I]);return R||(R=[this._localization.localize(["directions",I])," "+this._localization.localize(["instructions","Onto"])]),R[0]+(R.length>1&&v.road?R[1]:"")}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{"./localization":57}],52:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null,w=Fe("./autocomplete"),v=Fe("./localization");function o(I){I.setSelectionRange?I.setSelectionRange(0,9999):I.select()}Oe.exports=T.Class.extend({includes:typeof T.Evented<"u"&&T.Evented.prototype||T.Mixin.Events,options:{createGeocoder:function(I,R,q){var X=T.DomUtil.create("div","leaflet-routing-geocoder"),re=T.DomUtil.create("input","",X),ce=q.addWaypoints?T.DomUtil.create("span","leaflet-routing-remove-waypoint",X):void 0;return re.disabled=!q.addWaypoints,{container:X,input:re,closeButton:ce}},geocoderPlaceholder:function(I,R,q){var X=new v(q.options.language).localize("ui");return I===0?X.startPlaceholder:I<R-1?T.Util.template(X.viaPlaceholder,{viaNumber:I}):X.endPlaceholder},geocoderClass:function(){return""},waypointNameFallback:function(I){var R=I.lat<0?"S":"N",q=I.lng<0?"W":"E",X=(Math.round(Math.abs(I.lat)*1e4)/1e4).toString(),re=(Math.round(Math.abs(I.lng)*1e4)/1e4).toString();return R+X+", "+q+re},maxGeocoderTolerance:200,autocompleteOptions:{},language:"en"},initialize:function(I,R,q,X){T.setOptions(this,X);var re=this.options.createGeocoder(R,q,this.options),ce=re.closeButton,Ae=re.input;Ae.setAttribute("placeholder",this.options.geocoderPlaceholder(R,q,this)),Ae.className=this.options.geocoderClass(R,q),this._element=re,this._waypoint=I,this.update(),Ae.value=I.name,T.DomEvent.addListener(Ae,"click",function(){o(this)},Ae),ce&&T.DomEvent.addListener(ce,"click",function(){this.fire("delete",{waypoint:this._waypoint})},this),new w(Ae,function(Pe){Ae.value=Pe.name,I.name=Pe.name,I.latLng=Pe.center,this.fire("geocoded",{waypoint:I,value:Pe})},this,T.extend({resultFn:this.options.geocoder.geocode,resultContext:this.options.geocoder,autocompleteFn:this.options.geocoder.suggest,autocompleteContext:this.options.geocoder},this.options.autocompleteOptions))},getContainer:function(){return this._element.container},setValue:function(I){this._element.input.value=I},update:function(I){var R=this._waypoint,q;R.name=R.name||"",R.latLng&&(I||!R.name)&&(q=this.options.waypointNameFallback(R.latLng),this.options.geocoder&&this.options.geocoder.reverse?this.options.geocoder.reverse(R.latLng,67108864,function(X){X.length>0&&X[0].center.distanceTo(R.latLng)<this.options.maxGeocoderTolerance?R.name=X[0].name:R.name=q,this._update()},this):(R.name=q,this._update()))},focus:function(){var I=this._element.input;I.focus(),o(I)},_update:function(){var I=this._waypoint,R=I&&I.name?I.name:"";this.setValue(R),this.fire("reversegeocoded",{waypoint:I,value:R})}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{"./autocomplete":48,"./localization":57}],53:[function(Fe,Oe,De){(function(st){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null,w=Fe("./control"),v=Fe("./itinerary"),o=Fe("./line"),I=Fe("./osrm-v1"),R=Fe("./plan"),q=Fe("./waypoint"),X=Fe("./autocomplete"),re=Fe("./formatter"),ce=Fe("./geocoder-element"),Ae=Fe("./localization"),Pe=Fe("./itinerary-builder"),le=Fe("./mapbox"),it=Fe("./error-control");T.routing={control:function(We){return new w(We)},itinerary:function(We){return v(We)},line:function(We,He){return new o(We,He)},plan:function(We,He){return new R(We,He)},waypoint:function(We,He,bt){return new q(We,He,bt)},osrmv1:function(We){return new I(We)},localization:function(We){return new Ae(We)},formatter:function(We){return new re(We)},geocoderElement:function(We,He,bt,Bt){return new T.Routing.GeocoderElement(We,He,bt,Bt)},itineraryBuilder:function(We){return new Pe(We)},mapbox:function(We,He){return new le(We,He)},errorControl:function(We,He){return new it(We,He)},autocomplete:function(We,He,bt,Bt){return new X(We,He,bt,Bt)}},Oe.exports=T.Routing={Control:w,Itinerary:v,Line:o,OSRMv1:I,Plan:R,Waypoint:q,Autocomplete:X,Formatter:re,GeocoderElement:ce,Localization:Ae,Formatter:re,ItineraryBuilder:Pe,control:T.routing.control,itinerary:T.routing.itinerary,line:T.routing.line,plan:T.routing.plan,waypoint:T.routing.waypoint,osrmv1:T.routing.osrmv1,geocoderElement:T.routing.geocoderElement,mapbox:T.routing.mapbox,errorControl:T.routing.errorControl}}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{"./autocomplete":48,"./control":49,"./error-control":50,"./formatter":51,"./geocoder-element":52,"./itinerary":55,"./itinerary-builder":54,"./line":56,"./localization":57,"./mapbox":58,"./osrm-v1":59,"./plan":60,"./waypoint":61}],54:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null;Oe.exports=T.Class.extend({options:{containerClassName:""},initialize:function(w){T.setOptions(this,w)},createContainer:function(w){var v=T.DomUtil.create("table",(w||"")+" "+this.options.containerClassName),o=T.DomUtil.create("colgroup","",v);return T.DomUtil.create("col","leaflet-routing-instruction-icon",o),T.DomUtil.create("col","leaflet-routing-instruction-text",o),T.DomUtil.create("col","leaflet-routing-instruction-distance",o),v},createStepsContainer:function(){return T.DomUtil.create("tbody","")},createStep:function(w,v,o,I){var R=T.DomUtil.create("tr","",I),q,X;return X=T.DomUtil.create("td","",R),q=T.DomUtil.create("span","leaflet-routing-icon leaflet-routing-icon-"+o,X),X.appendChild(q),X=T.DomUtil.create("td","",R),X.appendChild(document.createTextNode(w)),X=T.DomUtil.create("td","",R),X.appendChild(document.createTextNode(v)),R}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{}],55:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null,w=Fe("./formatter"),v=Fe("./itinerary-builder");Oe.exports=T.Control.extend({includes:typeof T.Evented<"u"&&T.Evented.prototype||T.Mixin.Events,options:{pointMarkerStyle:{radius:5,color:"#03f",fillColor:"white",opacity:1,fillOpacity:.7},summaryTemplate:"<h2>{name}</h2><h3>{distance}, {time}</h3>",timeTemplate:"{time}",containerClassName:"",alternativeClassName:"",minimizedClassName:"",itineraryClassName:"",totalDistanceRoundingSensitivity:-1,show:!0,collapsible:void 0,collapseBtn:function(o){var I=T.DomUtil.create("span",o.options.collapseBtnClass);T.DomEvent.on(I,"click",o._toggle,o),o._container.insertBefore(I,o._container.firstChild)},collapseBtnClass:"leaflet-routing-collapse-btn"},initialize:function(o){T.setOptions(this,o),this._formatter=this.options.formatter||new w(this.options),this._itineraryBuilder=this.options.itineraryBuilder||new v({containerClassName:this.options.itineraryClassName})},onAdd:function(o){var I=this.options.collapsible;return I=I||I===void 0&&o.getSize().x<=640,this._container=T.DomUtil.create("div","leaflet-routing-container leaflet-bar "+(this.options.show?"":"leaflet-routing-container-hide ")+(I?"leaflet-routing-collapsible ":"")+this.options.containerClassName),this._altContainer=this.createAlternativesContainer(),this._container.appendChild(this._altContainer),T.DomEvent.disableClickPropagation(this._container),T.DomEvent.addListener(this._container,"mousewheel",function(R){T.DomEvent.stopPropagation(R)}),I&&this.options.collapseBtn(this),this._container},onRemove:function(){},createAlternativesContainer:function(){return T.DomUtil.create("div","leaflet-routing-alternatives-container")},setAlternatives:function(o){var I,R,q;for(this._clearAlts(),this._routes=o,I=0;I<this._routes.length;I++)R=this._routes[I],q=this._createAlternative(R,I),this._altContainer.appendChild(q),this._altElements.push(q);return this._selectRoute({route:this._routes[0],alternatives:this._routes.slice(1)}),this},show:function(){T.DomUtil.removeClass(this._container,"leaflet-routing-container-hide")},hide:function(){T.DomUtil.addClass(this._container,"leaflet-routing-container-hide")},_toggle:function(){var o=T.DomUtil.hasClass(this._container,"leaflet-routing-container-hide");this[o?"show":"hide"]()},_createAlternative:function(o,I){var R=T.DomUtil.create("div","leaflet-routing-alt "+this.options.alternativeClassName+(I>0?" leaflet-routing-alt-minimized "+this.options.minimizedClassName:"")),q=this.options.summaryTemplate,X=T.extend({name:o.name,distance:this._formatter.formatDistance(o.summary.totalDistance,this.options.totalDistanceRoundingSensitivity),time:this._formatter.formatTime(o.summary.totalTime)},o);return R.innerHTML=typeof q=="function"?q(X):T.Util.template(q,X),T.DomEvent.addListener(R,"click",this._onAltClicked,this),this.on("routeselected",this._selectAlt,this),R.appendChild(this._createItineraryContainer(o)),R},_clearAlts:function(){for(var o=this._altContainer;o&&o.firstChild;)o.removeChild(o.firstChild);this._altElements=[]},_createItineraryContainer:function(o){var I=this._itineraryBuilder.createContainer(),R=this._itineraryBuilder.createStepsContainer(),q,X,re,ce,Ae,Pe;for(I.appendChild(R),q=0;q<o.instructions.length;q++)X=o.instructions[q],Ae=this._formatter.formatInstruction(X,q),ce=this._formatter.formatDistance(X.distance),Pe=this._formatter.getIconName(X,q),re=this._itineraryBuilder.createStep(Ae,ce,Pe,R),X.index&&this._addRowListeners(re,o.coordinates[X.index]);return I},_addRowListeners:function(o,I){T.DomEvent.addListener(o,"mouseover",function(){this._marker=T.circleMarker(I,this.options.pointMarkerStyle).addTo(this._map)},this),T.DomEvent.addListener(o,"mouseout",function(){this._marker&&(this._map.removeLayer(this._marker),delete this._marker)},this),T.DomEvent.addListener(o,"click",function(R){this._map.panTo(I),T.DomEvent.stopPropagation(R)},this)},_onAltClicked:function(o){for(var I=o.target||window.event.srcElement;!T.DomUtil.hasClass(I,"leaflet-routing-alt");)I=I.parentElement;var R=this._altElements.indexOf(I),q=this._routes.slice(),X=q.splice(R,1)[0];this.fire("routeselected",{route:X,alternatives:q})},_selectAlt:function(o){var I,R,q,X;if(I=this._altElements[o.route.routesIndex],T.DomUtil.hasClass(I,"leaflet-routing-alt-minimized"))for(R=0;R<this._altElements.length;R++)q=this._altElements[R],X=R===o.route.routesIndex?"removeClass":"addClass",T.DomUtil[X](q,"leaflet-routing-alt-minimized"),this.options.minimizedClassName&&T.DomUtil[X](q,this.options.minimizedClassName),R!==o.route.routesIndex&&(q.scrollTop=0);T.DomEvent.stop(o)},_selectRoute:function(o){this._marker&&(this._map.removeLayer(this._marker),delete this._marker),this.fire("routeselected",o)}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{"./formatter":51,"./itinerary-builder":54}],56:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null;Oe.exports=T.LayerGroup.extend({includes:typeof T.Evented<"u"&&T.Evented.prototype||T.Mixin.Events,options:{styles:[{color:"black",opacity:.15,weight:9},{color:"white",opacity:.8,weight:6},{color:"red",opacity:1,weight:2}],missingRouteStyles:[{color:"black",opacity:.15,weight:7},{color:"white",opacity:.6,weight:4},{color:"gray",opacity:.8,weight:2,dashArray:"7,12"}],addWaypoints:!0,extendToWaypoints:!0,missingRouteTolerance:10},initialize:function(w,v){T.setOptions(this,v),T.LayerGroup.prototype.initialize.call(this,v),this._route=w,this.options.extendToWaypoints&&this._extendToWaypoints(),this._addSegment(w.coordinates,this.options.styles,this.options.addWaypoints)},getBounds:function(){return T.latLngBounds(this._route.coordinates)},_findWaypointIndices:function(){var w=this._route.inputWaypoints,v=[],o;for(o=0;o<w.length;o++)v.push(this._findClosestRoutePoint(w[o].latLng));return v},_findClosestRoutePoint:function(w){var v=Number.MAX_VALUE,o,I,R;for(I=this._route.coordinates.length-1;I>=0;I--)R=w.distanceTo(this._route.coordinates[I]),R<v&&(o=I,v=R);return o},_extendToWaypoints:function(){var w=this._route.inputWaypoints,v=this._getWaypointIndices(),o,I,R;for(o=0;o<w.length;o++)I=w[o].latLng,R=T.latLng(this._route.coordinates[v[o]]),I.distanceTo(R)>this.options.missingRouteTolerance&&this._addSegment([I,R],this.options.missingRouteStyles)},_addSegment:function(w,v,o){var I,R;for(I=0;I<v.length;I++)R=T.polyline(w,v[I]),this.addLayer(R),o&&R.on("mousedown",this._onLineTouched,this)},_findNearestWpBefore:function(w){for(var v=this._getWaypointIndices(),o=v.length-1;o>=0&&v[o]>w;)o--;return o},_onLineTouched:function(w){var v=this._findNearestWpBefore(this._findClosestRoutePoint(w.latlng));this.fire("linetouched",{afterIndex:v,latlng:w.latlng}),T.DomEvent.stop(w)},_getWaypointIndices:function(){return this._wpIndices||(this._wpIndices=this._route.waypointIndices||this._findWaypointIndices()),this._wpIndices}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{}],57:[function(Fe,Oe,De){(function(){var st={directions:{N:"norte",NE:"noreste",E:"este",SE:"sureste",S:"sur",SW:"suroeste",W:"oeste",NW:"noroeste",SlightRight:"leve giro a la derecha",Right:"derecha",SharpRight:"giro pronunciado a la derecha",SlightLeft:"leve giro a la izquierda",Left:"izquierda",SharpLeft:"giro pronunciado a la izquierda",Uturn:"media vuelta"},instructions:{Head:["Derecho {dir}"," sobre {road}"],Continue:["Continuar {dir}"," en {road}"],TurnAround:["Dar vuelta"],WaypointReached:["Lleg a un punto del camino"],Roundabout:["Tomar {exitStr} salida en la rotonda"," en {road}"],DestinationReached:["Llegada a destino"],Fork:["En el cruce gira a {modifier}"," hacia {road}"],Merge:["Incorprate {modifier}"," hacia {road}"],OnRamp:["Gira {modifier} en la salida"," hacia {road}"],OffRamp:["Toma la salida {modifier}"," hacia {road}"],EndOfRoad:["Gira {modifier} al final de la carretera"," hacia {road}"],Onto:"hacia {road}"},formatOrder:function(w){return w+""},ui:{startPlaceholder:"Inicio",viaPlaceholder:"Via {viaNumber}",endPlaceholder:"Destino"},units:{meters:"m",kilometers:"km",yards:"yd",miles:"mi",hours:"h",minutes:"min",seconds:"s"}};L.Routing=L.Routing||{};var T=L.Class.extend({initialize:function(w){this._langs=L.Util.isArray(w)?w.slice():[w,"en"];for(var v=0,o=this._langs.length;v<o;v++){var I=/([A-Za-z]+)/.exec(this._langs[v])[1];if(!T[this._langs[v]])if(T[I])this._langs[v]=I;else throw new Error('No localization for language "'+this._langs[v]+'".')}},localize:function(w){var v,o,I;w=L.Util.isArray(w)?w:[w];for(var R=0,q=this._langs.length;R<q;R++){v=T[this._langs[R]];for(var X=0,re=w.length;v&&X<re;X++)o=w[X],I=v[o],v=I;if(I)return I}}});Oe.exports=L.extend(T,{en:{directions:{N:"north",NE:"northeast",E:"east",SE:"southeast",S:"south",SW:"southwest",W:"west",NW:"northwest",SlightRight:"slight right",Right:"right",SharpRight:"sharp right",SlightLeft:"slight left",Left:"left",SharpLeft:"sharp left",Uturn:"Turn around"},instructions:{Head:["Head {dir}"," on {road}"],Continue:["Continue {dir}"],TurnAround:["Turn around"],WaypointReached:["Waypoint reached"],Roundabout:["Take the {exitStr} exit in the roundabout"," onto {road}"],DestinationReached:["Destination reached"],Fork:["At the fork, turn {modifier}"," onto {road}"],Merge:["Merge {modifier}"," onto {road}"],OnRamp:["Turn {modifier} on the ramp"," onto {road}"],OffRamp:["Take the ramp on the {modifier}"," onto {road}"],EndOfRoad:["Turn {modifier} at the end of the road"," onto {road}"],Onto:"onto {road}"},formatOrder:function(w){var v=w%10-1,o=["st","nd","rd"];return o[v]?w+o[v]:w+"th"},ui:{startPlaceholder:"Start",viaPlaceholder:"Via {viaNumber}",endPlaceholder:"End"},units:{meters:"m",kilometers:"km",yards:"yd",miles:"mi",hours:"h",minutes:"min",seconds:"s"}},de:{directions:{N:"Norden",NE:"Nordosten",E:"Osten",SE:"Sdosten",S:"Sden",SW:"Sdwesten",W:"Westen",NW:"Nordwesten",SlightRight:"leicht rechts",Right:"rechts",SharpRight:"scharf rechts",SlightLeft:"leicht links",Left:"links",SharpLeft:"scharf links",Uturn:"Wenden"},instructions:{Head:["Richtung {dir}"," auf {road}"],Continue:["Geradeaus Richtung {dir}"," auf {road}"],SlightRight:["Leicht rechts abbiegen"," auf {road}"],Right:["Rechts abbiegen"," auf {road}"],SharpRight:["Scharf rechts abbiegen"," auf {road}"],TurnAround:["Wenden"],SharpLeft:["Scharf links abbiegen"," auf {road}"],Left:["Links abbiegen"," auf {road}"],SlightLeft:["Leicht links abbiegen"," auf {road}"],WaypointReached:["Zwischenhalt erreicht"],Roundabout:["Nehmen Sie die {exitStr} Ausfahrt im Kreisverkehr"," auf {road}"],DestinationReached:["Sie haben ihr Ziel erreicht"],Fork:["An der Kreuzung {modifier}"," auf {road}"],Merge:["Fahren Sie {modifier} weiter"," auf {road}"],OnRamp:["Fahren Sie {modifier} auf die Auffahrt"," auf {road}"],OffRamp:["Nehmen Sie die Ausfahrt {modifier}"," auf {road}"],EndOfRoad:["Fahren Sie {modifier} am Ende der Strae"," auf {road}"],Onto:"auf {road}"},formatOrder:function(w){return w+"."},ui:{startPlaceholder:"Start",viaPlaceholder:"Via {viaNumber}",endPlaceholder:"Ziel"}},sv:{directions:{N:"norr",NE:"nordost",E:"st",SE:"sydost",S:"syd",SW:"sydvst",W:"vst",NW:"nordvst",SlightRight:"svagt hger",Right:"hger",SharpRight:"skarpt hger",SlightLeft:"svagt vnster",Left:"vnster",SharpLeft:"skarpt vnster",Uturn:"Vnd"},instructions:{Head:["k t {dir}"," till {road}"],Continue:["Fortstt {dir}"],SlightRight:["Svagt hger"," till {road}"],Right:["Svng hger"," till {road}"],SharpRight:["Skarpt hger"," till {road}"],TurnAround:["Vnd"],SharpLeft:["Skarpt vnster"," till {road}"],Left:["Svng vnster"," till {road}"],SlightLeft:["Svagt vnster"," till {road}"],WaypointReached:["Viapunkt ndd"],Roundabout:["Tag {exitStr} avfarten i rondellen"," till {road}"],DestinationReached:["Framme vid resans ml"],Fork:["Tag av {modifier}"," till {road}"],Merge:["Anslut {modifier} "," till {road}"],OnRamp:["Tag pfarten {modifier}"," till {road}"],OffRamp:["Tag avfarten {modifier}"," till {road}"],EndOfRoad:["Svng {modifier} vid vgens slut"," till {road}"],Onto:"till {road}"},formatOrder:function(w){return["frsta","andra","tredje","fjrde","femte","sjtte","sjunde","ttonde","nionde","tionde"][w-1]},ui:{startPlaceholder:"Frn",viaPlaceholder:"Via {viaNumber}",endPlaceholder:"Till"}},es:st,sp:st,nl:{directions:{N:"noordelijke",NE:"noordoostelijke",E:"oostelijke",SE:"zuidoostelijke",S:"zuidelijke",SW:"zuidewestelijke",W:"westelijke",NW:"noordwestelijke"},instructions:{Head:["Vertrek in {dir} richting"," de {road} op"],Continue:["Ga in {dir} richting"," de {road} op"],SlightRight:["Volg de weg naar rechts"," de {road} op"],Right:["Ga rechtsaf"," de {road} op"],SharpRight:["Ga scherpe bocht naar rechts"," de {road} op"],TurnAround:["Keer om"],SharpLeft:["Ga scherpe bocht naar links"," de {road} op"],Left:["Ga linksaf"," de {road} op"],SlightLeft:["Volg de weg naar links"," de {road} op"],WaypointReached:["Aangekomen bij tussenpunt"],Roundabout:["Neem de {exitStr} afslag op de rotonde"," de {road} op"],DestinationReached:["Aangekomen op eindpunt"]},formatOrder:function(w){return w===1||w>=20?w+"ste":w+"de"},ui:{startPlaceholder:"Vertrekpunt",viaPlaceholder:"Via {viaNumber}",endPlaceholder:"Bestemming"}},fr:{directions:{N:"nord",NE:"nord-est",E:"est",SE:"sud-est",S:"sud",SW:"sud-ouest",W:"ouest",NW:"nord-ouest"},instructions:{Head:["Tout droit au {dir}"," sur {road}"],Continue:["Continuer au {dir}"," sur {road}"],SlightRight:["Lgrement  droite"," sur {road}"],Right:["A droite"," sur {road}"],SharpRight:["Compltement  droite"," sur {road}"],TurnAround:["Faire demi-tour"],SharpLeft:["Compltement  gauche"," sur {road}"],Left:["A gauche"," sur {road}"],SlightLeft:["Lgrement  gauche"," sur {road}"],WaypointReached:["Point d'tape atteint"],Roundabout:["Au rond-point, prenez la {exitStr} sortie"," sur {road}"],DestinationReached:["Destination atteinte"]},formatOrder:function(w){return w+""},ui:{startPlaceholder:"Dpart",viaPlaceholder:"Intermdiaire {viaNumber}",endPlaceholder:"Arrive"}},it:{directions:{N:"nord",NE:"nord-est",E:"est",SE:"sud-est",S:"sud",SW:"sud-ovest",W:"ovest",NW:"nord-ovest"},instructions:{Head:["Dritto verso {dir}"," su {road}"],Continue:["Continuare verso {dir}"," su {road}"],SlightRight:["Mantenere la destra"," su {road}"],Right:["A destra"," su {road}"],SharpRight:["Strettamente a destra"," su {road}"],TurnAround:["Fare inversione di marcia"],SharpLeft:["Strettamente a sinistra"," su {road}"],Left:["A sinistra"," sur {road}"],SlightLeft:["Mantenere la sinistra"," su {road}"],WaypointReached:["Punto di passaggio raggiunto"],Roundabout:["Alla rotonda, prendere la {exitStr} uscita"],DestinationReached:["Destinazione raggiunta"]},formatOrder:function(w){return w+""},ui:{startPlaceholder:"Partenza",viaPlaceholder:"Intermedia {viaNumber}",endPlaceholder:"Destinazione"}},pt:{directions:{N:"norte",NE:"nordeste",E:"leste",SE:"sudeste",S:"sul",SW:"sudoeste",W:"oeste",NW:"noroeste",SlightRight:"curva ligeira a direita",Right:"direita",SharpRight:"curva fechada a direita",SlightLeft:"ligeira a esquerda",Left:"esquerda",SharpLeft:"curva fechada a esquerda",Uturn:"Meia volta"},instructions:{Head:["Siga {dir}"," na {road}"],Continue:["Continue {dir}"," na {road}"],SlightRight:["Curva ligeira a direita"," na {road}"],Right:["Curva a direita"," na {road}"],SharpRight:["Curva fechada a direita"," na {road}"],TurnAround:["Retorne"],SharpLeft:["Curva fechada a esquerda"," na {road}"],Left:["Curva a esquerda"," na {road}"],SlightLeft:["Curva ligueira a esquerda"," na {road}"],WaypointReached:["Ponto de interesse atingido"],Roundabout:["Pegue a {exitStr} sada na rotatria"," na {road}"],DestinationReached:["Destino atingido"],Fork:["Na encruzilhada, vire a {modifier}"," na {road}"],Merge:["Entre  {modifier}"," na {road}"],OnRamp:["Vire {modifier} na rampa"," na {road}"],OffRamp:["Entre na rampa na {modifier}"," na {road}"],EndOfRoad:["Vire {modifier} no fim da rua"," na {road}"],Onto:"na {road}"},formatOrder:function(w){return w+""},ui:{startPlaceholder:"Origem",viaPlaceholder:"Intermdio {viaNumber}",endPlaceholder:"Destino"}},sk:{directions:{N:"sever",NE:"serverovchod",E:"vchod",SE:"juhovchod",S:"juh",SW:"juhozpad",W:"zpad",NW:"serverozpad"},instructions:{Head:["Mierte na {dir}"," na {road}"],Continue:["Pokraujte na {dir}"," na {road}"],SlightRight:["Mierne doprava"," na {road}"],Right:["Doprava"," na {road}"],SharpRight:["Prudko doprava"," na {road}"],TurnAround:["Otote sa"],SharpLeft:["Prudko doava"," na {road}"],Left:["Doava"," na {road}"],SlightLeft:["Mierne doava"," na {road}"],WaypointReached:["Ste v prejazdovom bode."],Roundabout:["Odbote na {exitStr} vjazde"," na {road}"],DestinationReached:["Prili ste do ciea."]},formatOrder:function(w){var v=w%10-1,o=[".",".","."];return o[v]?w+o[v]:w+"."},ui:{startPlaceholder:"Zaiatok",viaPlaceholder:"Cez {viaNumber}",endPlaceholder:"Koniec"}},el:{directions:{N:"",NE:"",E:"",SE:"",S:"",SW:"",W:"",NW:""},instructions:{Head:[" {dir}","  {road}"],Continue:[" {dir}","  {road}"],SlightRight:[" ","  {road}"],Right:["","  {road}"],SharpRight:["  ","  {road}"],TurnAround:[" "],SharpLeft:["  ","  {road}"],Left:["","  {road}"],SlightLeft:[" ","  {road}"],WaypointReached:["   "],Roundabout:["  {exitStr}    ","  {road}"],DestinationReached:["   "]},formatOrder:function(w){return w+""},ui:{startPlaceholder:"",viaPlaceholder:" {viaNumber}",endPlaceholder:""}},ca:{directions:{N:"nord",NE:"nord-est",E:"est",SE:"sud-est",S:"sud",SW:"sud-oest",W:"oest",NW:"nord-oest",SlightRight:"lleu gir a la dreta",Right:"dreta",SharpRight:"gir pronunciat a la dreta",SlightLeft:"gir pronunciat a l'esquerra",Left:"esquerra",SharpLeft:"lleu gir a l'esquerra",Uturn:"mitja volta"},instructions:{Head:["Recte {dir}"," sobre {road}"],Continue:["Continuar {dir}"],TurnAround:["Donar la volta"],WaypointReached:["Ha arribat a un punt del cam"],Roundabout:["Agafar {exitStr} sortida a la rotonda"," a {road}"],DestinationReached:["Arribada al dest"],Fork:["A la crulla gira a la {modifier}"," cap a {road}"],Merge:["Incorpora't {modifier}"," a {road}"],OnRamp:["Gira {modifier} a la sortida"," cap a {road}"],OffRamp:["Pren la sortida {modifier}"," cap a {road}"],EndOfRoad:["Gira {modifier} al final de la carretera"," cap a {road}"],Onto:"cap a {road}"},formatOrder:function(w){return w+""},ui:{startPlaceholder:"Origen",viaPlaceholder:"Via {viaNumber}",endPlaceholder:"Dest"},units:{meters:"m",kilometers:"km",yards:"yd",miles:"mi",hours:"h",minutes:"min",seconds:"s"}},ru:{directions:{N:"",NE:"",E:"",SE:"",S:"",SW:"",W:"",NW:"",SlightRight:" ",Right:"",SharpRight:" ",SlightLeft:" ",Left:"",SharpLeft:" ",Uturn:""},instructions:{Head:["   {dir}","  {road}"],Continue:["   {dir}","  {road}"],SlightRight:["  ","  {road}"],Right:["","  {road}"],SharpRight:["  ","  {road}"],TurnAround:[""],SharpLeft:["  ","  {road}"],Left:[" ","  {road}"],SlightLeft:["  ","  {road}"],WaypointReached:[" "],Roundabout:["{exitStr}   ","  {road}"],DestinationReached:[" "],Fork:["   {modifier}","  {road}"],Merge:[" {modifier}","  {road}"],OnRamp:[" {modifier}  ","  {road}"],OffRamp:["  {modifier}","  {road}"],EndOfRoad:[" {modifier}   ","  {road}"],Onto:" {road}"},formatOrder:function(w){return w+"-"},ui:{startPlaceholder:"",viaPlaceholder:" {viaNumber}",endPlaceholder:""},units:{meters:"",kilometers:"",yards:"",miles:"",hours:"",minutes:"",seconds:""}},pl:{directions:{N:"pnoc",NE:"pnocny wschd",E:"wschd",SE:"poudniowy wschd",S:"poudnie",SW:"poudniowy zachd",W:"zachd",NW:"pnocny zachd",SlightRight:"lekko w prawo",Right:"w prawo",SharpRight:"ostro w prawo",SlightLeft:"lekko w lewo",Left:"w lewo",SharpLeft:"ostro w lewo",Uturn:"zawr"},instructions:{Head:["Kieruj si na {dir}"," na {road}"],Continue:["Jed dalej przez {dir}"],TurnAround:["Zawr"],WaypointReached:["Punkt poredni"],Roundabout:["Wyjed {exitStr} zjazdem na rondzie"," na {road}"],DestinationReached:["Dojechano do miejsca docelowego"],Fork:["Na rozwidleniu {modifier}"," na {road}"],Merge:["Zjed {modifier}"," na {road}"],OnRamp:["Wjazd {modifier}"," na {road}"],OffRamp:["Zjazd {modifier}"," na {road}"],EndOfRoad:["Skr {modifier} na kocu drogi"," na {road}"],Onto:"na {road}"},formatOrder:function(w){return w+"."},ui:{startPlaceholder:"Pocztek",viaPlaceholder:"Przez {viaNumber}",endPlaceholder:"Koniec"},units:{meters:"m",kilometers:"km",yards:"yd",miles:"mi",hours:"godz",minutes:"min",seconds:"s"}}})})()},{}],58:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null,w=Fe("./osrm-v1");Oe.exports=w.extend({options:{serviceUrl:"https://api.mapbox.com/directions/v5",profile:"mapbox/driving",useHints:!1},initialize:function(v,o){T.Routing.OSRMv1.prototype.initialize.call(this,o),this.options.requestParameters=this.options.requestParameters||{},this.options.requestParameters.access_token=v}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{"./osrm-v1":59}],59:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null,w=Fe("@mapbox/corslite"),v=Fe("@mapbox/polyline"),o=Fe("osrm-text-instructions")("v5"),I=Fe("./waypoint");Oe.exports=T.Class.extend({options:{serviceUrl:"https://router.project-osrm.org/route/v1",profile:"driving",timeout:30*1e3,routingOptions:{alternatives:!0,steps:!0},polylinePrecision:5,useHints:!0,suppressDemoServerWarning:!1,language:"en"},initialize:function(R){T.Util.setOptions(this,R),this._hints={locations:{}},!this.options.suppressDemoServerWarning&&this.options.serviceUrl.indexOf("//router.project-osrm.org")>=0&&console.warn(`You are using OSRM's demo server. Please note that it is **NOT SUITABLE FOR PRODUCTION USE**.
Refer to the demo server's usage policy: https://github.com/Project-OSRM/osrm-backend/wiki/Api-usage-policy

To change, set the serviceUrl option.

Please do not report issues with this server to neither Leaflet Routing Machine or OSRM - it's for
demo only, and will sometimes not be available, or work in unexpected ways.

Please set up your own OSRM server, or use a paid service provider for production.`)},route:function(R,q,X,re){var ce=!1,Ae=[],Pe,le,it,We,He;for(re=T.extend({},this.options.routingOptions,re),Pe=this.buildRouteUrl(R,re),this.options.requestParameters&&(Pe+=T.Util.getParamString(this.options.requestParameters,Pe)),le=setTimeout(function(){ce=!0,q.call(X||q,{status:-1,message:"OSRM request timed out."})},this.options.timeout),We=0;We<R.length;We++)it=R[We],Ae.push(new I(it.latLng,it.name,it.options));return He=w(Pe,T.bind(function(bt,Bt){var Di,Ot={};if(clearTimeout(le),ce)He.abort();else{if(bt)Ot.message="HTTP request failed: "+bt.type+(bt.target&&bt.target.status?" HTTP "+bt.target.status+": "+bt.target.statusText:""),Ot.url=Pe,Ot.status=-1,Ot.target=bt;else try{Di=JSON.parse(Bt.responseText);try{return this._routeDone(Di,Ae,re,q,X)}catch(Ai){Ot.status=-3,Ot.message=Ai.toString()}}catch(Ai){Ot.status=-2,Ot.message="Error parsing OSRM response: "+Ai.toString()}q.call(X||q,Ot)}},this))},requiresMoreDetail:function(R,q,X){if(!R.properties.isSimplified)return!1;var re=R.inputWaypoints,ce;for(ce=0;ce<re.length;++ce)if(!X.contains(re[ce].latLng))return!0;return!1},_routeDone:function(R,q,X,re,ce){var Ae=[],Pe,le,it;if(ce=ce||re,R.code!=="Ok"){re.call(ce,{status:R.code});return}for(Pe=this._toWaypoints(q,R.waypoints),le=0;le<R.routes.length;le++)it=this._convertRoute(R.routes[le]),it.inputWaypoints=q,it.waypoints=Pe,it.properties={isSimplified:!X||!X.geometryOnly||X.simplifyGeometry},Ae.push(it);this._saveHintData(R.waypoints,q),re.call(ce,null,Ae)},_convertRoute:function(R){var q={name:"",coordinates:[],instructions:[],summary:{totalDistance:R.distance,totalTime:R.duration}},X=[],re=[],ce=0,Ae=R.legs.length,Pe=R.legs[0].steps.length>0,le,it,We,He,bt,Bt,Di,Ot,Ai;for(this.options.stepToText?Ai=this.options.stepToText:Ai=T.bind(o.compile,o,this.options.language),le=0;le<Ae;le++)for(We=R.legs[le],X.push(We.summary&&We.summary.charAt(0).toUpperCase()+We.summary.substring(1)),it=0;it<We.steps.length;it++)He=We.steps[it],bt=this._decodePolyline(He.geometry),q.coordinates.push.apply(q.coordinates,bt),Bt=this._maneuverToInstructionType(He.maneuver,le===Ae-1),Di=this._maneuverToModifier(He.maneuver),Ot=Ai(He,{legCount:Ae,legIndex:le}),Bt&&((le==0&&He.maneuver.type=="depart"||He.maneuver.type=="arrive")&&re.push(ce),q.instructions.push({type:Bt,distance:He.distance,time:He.duration,road:He.name,direction:this._bearingToDirection(He.maneuver.bearing_after),exit:He.maneuver.exit,index:ce,mode:He.mode,modifier:Di,text:Ot})),ce+=bt.length;return q.name=X.join(", "),Pe?q.waypointIndices=re:q.coordinates=this._decodePolyline(R.geometry),q},_bearingToDirection:function(R){var q=Math.round(R/45)%8;return["N","NE","E","SE","S","SW","W","NW"][q]},_maneuverToInstructionType:function(R,q){switch(R.type){case"new name":return"Continue";case"depart":return"Head";case"arrive":return q?"DestinationReached":"WaypointReached";case"roundabout":case"rotary":return"Roundabout";case"merge":case"fork":case"on ramp":case"off ramp":case"end of road":return this._camelCase(R.type);default:return this._camelCase(R.modifier)}},_maneuverToModifier:function(R){var q=R.modifier;switch(R.type){case"merge":case"fork":case"on ramp":case"off ramp":case"end of road":q=this._leftOrRight(q)}return q&&this._camelCase(q)},_camelCase:function(R){for(var q=R.split(" "),X="",re=0,ce=q.length;re<ce;re++)X+=q[re].charAt(0).toUpperCase()+q[re].substring(1);return X},_leftOrRight:function(R){return R.indexOf("left")>=0?"Left":"Right"},_decodePolyline:function(R){var q=v.decode(R,this.options.polylinePrecision),X=new Array(q.length),re;for(re=q.length-1;re>=0;re--)X[re]=T.latLng(q[re]);return X},_toWaypoints:function(R,q){var X=[],re,ce;for(re=0;re<q.length;re++)ce=q[re].location,X.push(new I(T.latLng(ce[1],ce[0]),R[re].name,R[re].options));return X},buildRouteUrl:function(R,q){for(var X=[],re=[],ce,Ae,Pe,le=!0,it=0;it<R.length;it++)ce=R[it],Ae=ce.latLng,X.push(Ae.lng+","+Ae.lat),re.push(this._hints.locations[this._locationKey(Ae)]||"");return Pe=!0,this.options.serviceUrl+"/"+this.options.profile+"/"+X.join(";")+"?"+(q.geometryOnly?q.simplifyGeometry?"":"overview=full":"overview=false")+"&alternatives="+le.toString()+"&steps="+Pe.toString()+(this.options.useHints?"&hints="+re.join(";"):"")+(q.allowUTurns?"&continue_straight="+!q.allowUTurns:"")},_locationKey:function(R){return R.lat+","+R.lng},_saveHintData:function(R,q){var X;this._hints={locations:{}};for(var re=R.length-1;re>=0;re--)X=q[re].latLng,this._hints.locations[this._locationKey(X)]=R[re].hint}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{"./waypoint":61,"@mapbox/corslite":1,"@mapbox/polyline":2,"osrm-text-instructions":3}],60:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null,w=Fe("./geocoder-element"),v=Fe("./waypoint");Oe.exports=(T.Layer||T.Class).extend({includes:typeof T.Evented<"u"&&T.Evented.prototype||T.Mixin.Events,options:{dragStyles:[{color:"black",opacity:.15,weight:9},{color:"white",opacity:.8,weight:6},{color:"red",opacity:1,weight:2,dashArray:"7,12"}],draggableWaypoints:!0,routeWhileDragging:!1,addWaypoints:!0,reverseWaypoints:!1,addButtonClassName:"",language:"en",createGeocoderElement:function(o,I,R,q){return new w(o,I,R,q)},createMarker:function(o,I){var R={draggable:this.draggableWaypoints},q=T.marker(I.latLng,R);return q},geocodersClassName:""},initialize:function(o,I){T.Util.setOptions(this,I),this._waypoints=[],this.setWaypoints(o)},isReady:function(){var o;for(o=0;o<this._waypoints.length;o++)if(!this._waypoints[o].latLng)return!1;return!0},getWaypoints:function(){var o,I=[];for(o=0;o<this._waypoints.length;o++)I.push(this._waypoints[o]);return I},setWaypoints:function(o){var I=[0,this._waypoints.length].concat(o);return this.spliceWaypoints.apply(this,I),this},spliceWaypoints:function(){var o=[arguments[0],arguments[1]],I;for(I=2;I<arguments.length;I++)o.push(arguments[I]&&arguments[I].hasOwnProperty("latLng")?arguments[I]:new v(arguments[I]));for([].splice.apply(this._waypoints,o);this._waypoints.length<2;)this.spliceWaypoints(this._waypoints.length,0,null);this._updateMarkers(),this._fireChanged.apply(this,o)},onAdd:function(o){this._map=o,this._updateMarkers()},onRemove:function(){var o;if(this._removeMarkers(),this._newWp)for(o=0;o<this._newWp.lines.length;o++)this._map.removeLayer(this._newWp.lines[o]);delete this._map},createGeocoders:function(){var o=T.DomUtil.create("div","leaflet-routing-geocoders "+this.options.geocodersClassName),I=this._waypoints,R,q;return this._geocoderContainer=o,this._geocoderElems=[],this.options.addWaypoints&&(R=T.DomUtil.create("button","leaflet-routing-add-waypoint "+this.options.addButtonClassName,o),R.setAttribute("type","button"),T.DomEvent.addListener(R,"click",function(){this.spliceWaypoints(I.length,0,null)},this)),this.options.reverseWaypoints&&(q=T.DomUtil.create("button","leaflet-routing-reverse-waypoints",o),q.setAttribute("type","button"),T.DomEvent.addListener(q,"click",function(){this._waypoints.reverse(),this.setWaypoints(this._waypoints)},this)),this._updateGeocoders(),this.on("waypointsspliced",this._updateGeocoders),o},_createGeocoder:function(o){var I=this.options.createGeocoderElement(this._waypoints[o],o,this._waypoints.length,this.options);return I.on("delete",function(){o>0||this._waypoints.length>2?this.spliceWaypoints(o,1):this.spliceWaypoints(o,1,new v)},this).on("geocoded",function(R){this._updateMarkers(),this._fireChanged(),this._focusGeocoder(o+1),this.fire("waypointgeocoded",{waypointIndex:o,waypoint:R.waypoint})},this).on("reversegeocoded",function(R){this.fire("waypointgeocoded",{waypointIndex:o,waypoint:R.waypoint})},this),I},_updateGeocoders:function(){var o=[],I,R;for(I=0;I<this._geocoderElems.length;I++)this._geocoderContainer.removeChild(this._geocoderElems[I].getContainer());for(I=this._waypoints.length-1;I>=0;I--)R=this._createGeocoder(I),this._geocoderContainer.insertBefore(R.getContainer(),this._geocoderContainer.firstChild),o.push(R);this._geocoderElems=o.reverse()},_removeMarkers:function(){var o;if(this._markers)for(o=0;o<this._markers.length;o++)this._markers[o]&&this._map.removeLayer(this._markers[o]);this._markers=[]},_updateMarkers:function(){var o,I;if(this._map)for(this._removeMarkers(),o=0;o<this._waypoints.length;o++)this._waypoints[o].latLng?(I=this.options.createMarker(o,this._waypoints[o],this._waypoints.length),I&&(I.addTo(this._map),this.options.draggableWaypoints&&this._hookWaypointEvents(I,o))):I=null,this._markers.push(I)},_fireChanged:function(){this.fire("waypointschanged",{waypoints:this.getWaypoints()}),arguments.length>=2&&this.fire("waypointsspliced",{index:Array.prototype.shift.call(arguments),nRemoved:Array.prototype.shift.call(arguments),added:arguments})},_hookWaypointEvents:function(o,I,R){var q=function(le){return R?le.latlng:le.target.getLatLng()},X=T.bind(function(le){this.fire("waypointdragstart",{index:I,latlng:q(le)})},this),re=T.bind(function(le){this._waypoints[I].latLng=q(le),this.fire("waypointdrag",{index:I,latlng:q(le)})},this),ce=T.bind(function(le){this._waypoints[I].latLng=q(le),this._waypoints[I].name="",this._geocoderElems&&this._geocoderElems[I].update(!0),this.fire("waypointdragend",{index:I,latlng:q(le)}),this._fireChanged()},this),Ae,Pe;R?(Ae=T.bind(function(le){this._markers[I].setLatLng(le.latlng),re(le)},this),Pe=T.bind(function(le){this._map.dragging.enable(),this._map.off("mouseup",Pe),this._map.off("mousemove",Ae),ce(le)},this),this._map.dragging.disable(),this._map.on("mousemove",Ae),this._map.on("mouseup",Pe),X({latlng:this._waypoints[I].latLng})):(o.on("dragstart",X),o.on("drag",re),o.on("dragend",ce))},dragNewWaypoint:function(o){var I=o.afterIndex+1;this.options.routeWhileDragging?(this.spliceWaypoints(I,0,o.latlng),this._hookWaypointEvents(this._markers[I],I,!0)):this._dragNewWaypoint(I,o.latlng)},_dragNewWaypoint:function(o,I){var R=new v(I),q=this._waypoints[o-1],X=this._waypoints[o],re=this.options.createMarker(o,R,this._waypoints.length+1),ce=[],Ae=this._map.dragging.enabled(),Pe=T.bind(function(We){var He,bt;for(re&&re.setLatLng(We.latlng),He=0;He<ce.length;He++)bt=ce[He].getLatLngs(),bt.splice(1,1,We.latlng),ce[He].setLatLngs(bt);T.DomEvent.stop(We)},this),le=T.bind(function(We){var He;for(re&&this._map.removeLayer(re),He=0;He<ce.length;He++)this._map.removeLayer(ce[He]);this._map.off("mousemove",Pe),this._map.off("mouseup",le),this.spliceWaypoints(o,0,We.latlng),Ae&&this._map.dragging.enable(),T.DomEvent.stop(We)},this),it;for(re&&re.addTo(this._map),it=0;it<this.options.dragStyles.length;it++)ce.push(T.polyline([q.latLng,I,X.latLng],this.options.dragStyles[it]).addTo(this._map));Ae&&this._map.dragging.disable(),this._map.on("mousemove",Pe),this._map.on("mouseup",le)},_focusGeocoder:function(o){this._geocoderElems[o]?this._geocoderElems[o].focus():document.activeElement.blur()}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{"./geocoder-element":52,"./waypoint":61}],61:[function(Fe,Oe,De){(function(st){(function(){var T=typeof window<"u"?window.L:typeof st<"u"?st.L:null;Oe.exports=T.Class.extend({options:{allowUTurn:!1},initialize:function(w,v,o){T.Util.setOptions(this,o),this.latLng=T.latLng(w),this.name=v}})})()}).call(this,typeof Ii<"u"?Ii:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[53])),hm}Z_();var Xu={exports:{}},H_=Xu.exports,fm;function W_(){return fm||(fm=1,(function(Fe,Oe){(function(De,st){st(Oe)})(H_,function(De){var st=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(w){L.Util.setOptions(this,w),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var v=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,v?this._withAnimation:this._noAnimation),this._markerCluster=v?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(w){if(w instanceof L.LayerGroup)return this.addLayers([w]);if(!w.getLatLng)return this._nonPointGroup.addLayer(w),this.fire("layeradd",{layer:w}),this;if(!this._map)return this._needsClustering.push(w),this.fire("layeradd",{layer:w}),this;if(this.hasLayer(w))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(w,this._maxZoom),this.fire("layeradd",{layer:w}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var v=w,o=this._zoom;if(w.__parent)for(;v.__parent._zoom>=o;)v=v.__parent;return this._currentShownBounds.contains(v.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(w,v):this._animationAddLayerNonAnimated(w,v)),this},removeLayer:function(w){return w instanceof L.LayerGroup?this.removeLayers([w]):w.getLatLng?this._map?w.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(w)),this._removeLayer(w,!0),this.fire("layerremove",{layer:w}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),w.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(w)&&(this._featureGroup.removeLayer(w),w.clusterShow&&w.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,w)&&this.hasLayer(w)&&this._needsRemoving.push({layer:w,latlng:w._latlng}),this.fire("layerremove",{layer:w}),this):(this._nonPointGroup.removeLayer(w),this.fire("layerremove",{layer:w}),this)},addLayers:function(w,v){if(!L.Util.isArray(w))return this.addLayer(w);var o=this._featureGroup,I=this._nonPointGroup,R=this.options.chunkedLoading,q=this.options.chunkInterval,X=this.options.chunkProgress,re=w.length,ce=0,Ae=!0,Pe;if(this._map){var le=new Date().getTime(),it=L.bind(function(){var He=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();ce<re;ce++){if(R&&ce%200===0){var bt=new Date().getTime()-He;if(bt>q)break}if(Pe=w[ce],Pe instanceof L.LayerGroup){Ae&&(w=w.slice(),Ae=!1),this._extractNonGroupLayers(Pe,w),re=w.length;continue}if(!Pe.getLatLng){I.addLayer(Pe),v||this.fire("layeradd",{layer:Pe});continue}if(!this.hasLayer(Pe)&&(this._addLayer(Pe,this._maxZoom),v||this.fire("layeradd",{layer:Pe}),Pe.__parent&&Pe.__parent.getChildCount()===2)){var Bt=Pe.__parent.getAllChildMarkers(),Di=Bt[0]===Pe?Bt[1]:Bt[0];o.removeLayer(Di)}}X&&X(ce,re,new Date().getTime()-le),ce===re?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(it,this.options.chunkDelay)},this);it()}else for(var We=this._needsClustering;ce<re;ce++){if(Pe=w[ce],Pe instanceof L.LayerGroup){Ae&&(w=w.slice(),Ae=!1),this._extractNonGroupLayers(Pe,w),re=w.length;continue}if(!Pe.getLatLng){I.addLayer(Pe);continue}this.hasLayer(Pe)||We.push(Pe)}return this},removeLayers:function(w){var v,o,I=w.length,R=this._featureGroup,q=this._nonPointGroup,X=!0;if(!this._map){for(v=0;v<I;v++){if(o=w[v],o instanceof L.LayerGroup){X&&(w=w.slice(),X=!1),this._extractNonGroupLayers(o,w),I=w.length;continue}this._arraySplice(this._needsClustering,o),q.removeLayer(o),this.hasLayer(o)&&this._needsRemoving.push({layer:o,latlng:o._latlng}),this.fire("layerremove",{layer:o})}return this}if(this._unspiderfy){this._unspiderfy();var re=w.slice(),ce=I;for(v=0;v<ce;v++){if(o=re[v],o instanceof L.LayerGroup){this._extractNonGroupLayers(o,re),ce=re.length;continue}this._unspiderfyLayer(o)}}for(v=0;v<I;v++){if(o=w[v],o instanceof L.LayerGroup){X&&(w=w.slice(),X=!1),this._extractNonGroupLayers(o,w),I=w.length;continue}if(!o.__parent){q.removeLayer(o),this.fire("layerremove",{layer:o});continue}this._removeLayer(o,!0,!0),this.fire("layerremove",{layer:o}),R.hasLayer(o)&&(R.removeLayer(o),o.clusterShow&&o.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(w){w.off(this._childMarkerEventHandlers,this),delete w.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var w=new L.LatLngBounds;this._topClusterLevel&&w.extend(this._topClusterLevel._bounds);for(var v=this._needsClustering.length-1;v>=0;v--)w.extend(this._needsClustering[v].getLatLng());return w.extend(this._nonPointGroup.getBounds()),w},eachLayer:function(w,v){var o=this._needsClustering.slice(),I=this._needsRemoving,R,q,X;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(o),q=o.length-1;q>=0;q--){for(R=!0,X=I.length-1;X>=0;X--)if(I[X].layer===o[q]){R=!1;break}R&&w.call(v,o[q])}this._nonPointGroup.eachLayer(w,v)},getLayers:function(){var w=[];return this.eachLayer(function(v){w.push(v)}),w},getLayer:function(w){var v=null;return w=parseInt(w,10),this.eachLayer(function(o){L.stamp(o)===w&&(v=o)}),v},hasLayer:function(w){if(!w)return!1;var v,o=this._needsClustering;for(v=o.length-1;v>=0;v--)if(o[v]===w)return!0;for(o=this._needsRemoving,v=o.length-1;v>=0;v--)if(o[v].layer===w)return!1;return!!(w.__parent&&w.__parent._group===this)||this._nonPointGroup.hasLayer(w)},zoomToShowLayer:function(w,v){var o=this._map;typeof v!="function"&&(v=function(){});var I=function(){(o.hasLayer(w)||o.hasLayer(w.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",I,this),this.off("animationend",I,this),o.hasLayer(w)?v():w.__parent._icon&&(this.once("spiderfied",v,this),w.__parent.spiderfy()))};w._icon&&this._map.getBounds().contains(w.getLatLng())?v():w.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",I,this),this._map.panTo(w.getLatLng())):(this._map.on("moveend",I,this),this.on("animationend",I,this),w.__parent.zoomToBounds())},onAdd:function(w){this._map=w;var v,o,I;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(w),this._nonPointGroup.addTo(w),this._gridClusters||this._generateInitialClusters(),this._maxLat=w.options.crs.projection.MAX_LATITUDE,v=0,o=this._needsRemoving.length;v<o;v++)I=this._needsRemoving[v],I.newlatlng=I.layer._latlng,I.layer._latlng=I.latlng;for(v=0,o=this._needsRemoving.length;v<o;v++)I=this._needsRemoving[v],this._removeLayer(I.layer,!0),I.layer._latlng=I.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),o=this._needsClustering,this._needsClustering=[],this.addLayers(o,!0)},onRemove:function(w){w.off("zoomend",this._zoomEnd,this),w.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(w){for(var v=w;v&&!v._icon;)v=v.__parent;return v||null},_arraySplice:function(w,v){for(var o=w.length-1;o>=0;o--)if(w[o]===v)return w.splice(o,1),!0},_removeFromGridUnclustered:function(w,v){for(var o=this._map,I=this._gridUnclustered,R=Math.floor(this._map.getMinZoom());v>=R&&I[v].removeObject(w,o.project(w.getLatLng(),v));v--);},_childMarkerDragStart:function(w){w.target.__dragStart=w.target._latlng},_childMarkerMoved:function(w){if(!this._ignoreMove&&!w.target.__dragStart){var v=w.target._popup&&w.target._popup.isOpen();this._moveChild(w.target,w.oldLatLng,w.latlng),v&&w.target.openPopup()}},_moveChild:function(w,v,o){w._latlng=v,this.removeLayer(w),w._latlng=o,this.addLayer(w)},_childMarkerDragEnd:function(w){var v=w.target.__dragStart;delete w.target.__dragStart,v&&this._moveChild(w.target,v,w.target._latlng)},_removeLayer:function(w,v,o){var I=this._gridClusters,R=this._gridUnclustered,q=this._featureGroup,X=this._map,re=Math.floor(this._map.getMinZoom());v&&this._removeFromGridUnclustered(w,this._maxZoom);var ce=w.__parent,Ae=ce._markers,Pe;for(this._arraySplice(Ae,w);ce&&(ce._childCount--,ce._boundsNeedUpdate=!0,!(ce._zoom<re));)v&&ce._childCount<=1?(Pe=ce._markers[0]===w?ce._markers[1]:ce._markers[0],I[ce._zoom].removeObject(ce,X.project(ce._cLatLng,ce._zoom)),R[ce._zoom].addObject(Pe,X.project(Pe.getLatLng(),ce._zoom)),this._arraySplice(ce.__parent._childClusters,ce),ce.__parent._markers.push(Pe),Pe.__parent=ce.__parent,ce._icon&&(q.removeLayer(ce),o||q.addLayer(Pe))):ce._iconNeedsUpdate=!0,ce=ce.__parent;delete w.__parent},_isOrIsParent:function(w,v){for(;v;){if(w===v)return!0;v=v.parentNode}return!1},fire:function(w,v,o){if(v&&v.layer instanceof L.MarkerCluster){if(v.originalEvent&&this._isOrIsParent(v.layer._icon,v.originalEvent.relatedTarget))return;w="cluster"+w}L.FeatureGroup.prototype.fire.call(this,w,v,o)},listens:function(w,v){return L.FeatureGroup.prototype.listens.call(this,w,v)||L.FeatureGroup.prototype.listens.call(this,"cluster"+w,v)},_defaultIconCreateFunction:function(w){var v=w.getChildCount(),o=" marker-cluster-";return v<10?o+="small":v<100?o+="medium":o+="large",new L.DivIcon({html:"<div><span>"+v+"</span></div>",className:"marker-cluster"+o,iconSize:new L.Point(40,40)})},_bindEvents:function(){var w=this._map,v=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,I=this.options.zoomToBoundsOnClick,R=this.options.spiderfyOnEveryZoom;(v||I||R)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),w.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(w){var v=w.layer,o=v;if(!(w.type==="clusterkeypress"&&w.originalEvent&&w.originalEvent.keyCode!==13)){for(;o._childClusters.length===1;)o=o._childClusters[0];o._zoom===this._maxZoom&&o._childCount===v._childCount&&this.options.spiderfyOnMaxZoom?v.spiderfy():this.options.zoomToBoundsOnClick&&v.zoomToBounds(),this.options.spiderfyOnEveryZoom&&v.spiderfy(),w.originalEvent&&w.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(w){var v=this._map;this._inZoomAnimation||(this._shownPolygon&&v.removeLayer(this._shownPolygon),w.layer.getChildCount()>2&&w.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(w.layer.getConvexHull(),this.options.polygonOptions),v.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var w=this.options.spiderfyOnMaxZoom,v=this.options.showCoverageOnHover,o=this.options.zoomToBoundsOnClick,I=this.options.spiderfyOnEveryZoom,R=this._map;(w||o||I)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),v&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),R.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var w=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,w),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),w),this._currentShownBounds=w}},_generateInitialClusters:function(){var w=Math.ceil(this._map.getMaxZoom()),v=Math.floor(this._map.getMinZoom()),o=this.options.maxClusterRadius,I=o;typeof o!="function"&&(I=function(){return o}),this.options.disableClusteringAtZoom!==null&&(w=this.options.disableClusteringAtZoom-1),this._maxZoom=w,this._gridClusters={},this._gridUnclustered={};for(var R=w;R>=v;R--)this._gridClusters[R]=new L.DistanceGrid(I(R)),this._gridUnclustered[R]=new L.DistanceGrid(I(R));this._topClusterLevel=new this._markerCluster(this,v-1)},_addLayer:function(w,v){var o=this._gridClusters,I=this._gridUnclustered,R=Math.floor(this._map.getMinZoom()),q,X;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(w),w.on(this._childMarkerEventHandlers,this);v>=R;v--){q=this._map.project(w.getLatLng(),v);var re=o[v].getNearObject(q);if(re){re._addChild(w),w.__parent=re;return}if(re=I[v].getNearObject(q),re){var ce=re.__parent;ce&&this._removeLayer(re,!1);var Ae=new this._markerCluster(this,v,re,w);o[v].addObject(Ae,this._map.project(Ae._cLatLng,v)),re.__parent=Ae,w.__parent=Ae;var Pe=Ae;for(X=v-1;X>ce._zoom;X--)Pe=new this._markerCluster(this,X,Pe),o[X].addObject(Pe,this._map.project(re.getLatLng(),X));ce._addChild(Pe),this._removeFromGridUnclustered(re,v);return}I[v].addObject(w,q)}this._topClusterLevel._addChild(w),w.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(w){w instanceof L.MarkerCluster&&w._iconNeedsUpdate&&w._updateIcon()})},_enqueue:function(w){this._queue.push(w),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var w=0;w<this._queue.length;w++)this._queue[w].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var w=Math.round(this._map._zoom);this._processQueue(),this._zoom<w&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,w)):this._zoom>w?(this._animationStart(),this._animationZoomOut(this._zoom,w)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(w){var v=this._maxLat;return v!==void 0&&(w.getNorth()>=v&&(w._northEast.lat=1/0),w.getSouth()<=-v&&(w._southWest.lat=-1/0)),w},_animationAddLayerNonAnimated:function(w,v){if(v===w)this._featureGroup.addLayer(w);else if(v._childCount===2){v._addToMap();var o=v.getAllChildMarkers();this._featureGroup.removeLayer(o[0]),this._featureGroup.removeLayer(o[1])}else v._updateIcon()},_extractNonGroupLayers:function(w,v){var o=w.getLayers(),I=0,R;for(v=v||[];I<o.length;I++){if(R=o[I],R instanceof L.LayerGroup){this._extractNonGroupLayers(R,v);continue}v.push(R)}return v},_overrideMarkerIcon:function(w){var v=w.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[w]}});return v}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(w,v){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),w),this._topClusterLevel._recursivelyAddChildrenToMap(null,v,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(w,v){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),w),this._topClusterLevel._recursivelyAddChildrenToMap(null,v,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(w,v){this._animationAddLayerNonAnimated(w,v)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(w,v){var o=this._getExpandedVisibleBounds(),I=this._featureGroup,R=Math.floor(this._map.getMinZoom()),q;this._ignoreMove=!0,this._topClusterLevel._recursively(o,w,R,function(X){var re=X._latlng,ce=X._markers,Ae;for(o.contains(re)||(re=null),X._isSingleParent()&&w+1===v?(I.removeLayer(X),X._recursivelyAddChildrenToMap(null,v,o)):(X.clusterHide(),X._recursivelyAddChildrenToMap(re,v,o)),q=ce.length-1;q>=0;q--)Ae=ce[q],o.contains(Ae._latlng)||I.removeLayer(Ae)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(o,v),I.eachLayer(function(X){!(X instanceof L.MarkerCluster)&&X._icon&&X.clusterShow()}),this._topClusterLevel._recursively(o,w,v,function(X){X._recursivelyRestoreChildPositions(v)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(o,w,R,function(X){I.removeLayer(X),X.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(w,v){this._animationZoomOutSingle(this._topClusterLevel,w-1,v),this._topClusterLevel._recursivelyAddChildrenToMap(null,v,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),w,this._getExpandedVisibleBounds())},_animationAddLayer:function(w,v){var o=this,I=this._featureGroup;I.addLayer(w),v!==w&&(v._childCount>2?(v._updateIcon(),this._forceLayout(),this._animationStart(),w._setPos(this._map.latLngToLayerPoint(v.getLatLng())),w.clusterHide(),this._enqueue(function(){I.removeLayer(w),w.clusterShow(),o._animationEnd()})):(this._forceLayout(),o._animationStart(),o._animationZoomOutSingle(v,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(w,v,o){var I=this._getExpandedVisibleBounds(),R=Math.floor(this._map.getMinZoom());w._recursivelyAnimateChildrenInAndAddSelfToMap(I,R,v+1,o);var q=this;this._forceLayout(),w._recursivelyBecomeVisible(I,o),this._enqueue(function(){if(w._childCount===1){var X=w._markers[0];this._ignoreMove=!0,X.setLatLng(X.getLatLng()),this._ignoreMove=!1,X.clusterShow&&X.clusterShow()}else w._recursively(I,o,R,function(re){re._recursivelyRemoveChildrenFromMap(I,R,v+1)});q._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(w){return new L.MarkerClusterGroup(w)};var T=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(w,v,o,I){L.Marker.prototype.initialize.call(this,o?o._cLatLng||o.getLatLng():new L.LatLng(0,0),{icon:this,pane:w.options.clusterPane}),this._group=w,this._zoom=v,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,o&&this._addChild(o),I&&this._addChild(I)},getAllChildMarkers:function(w,v){w=w||[];for(var o=this._childClusters.length-1;o>=0;o--)this._childClusters[o].getAllChildMarkers(w,v);for(var I=this._markers.length-1;I>=0;I--)v&&this._markers[I].__dragStart||w.push(this._markers[I]);return w},getChildCount:function(){return this._childCount},zoomToBounds:function(w){for(var v=this._childClusters.slice(),o=this._group._map,I=o.getBoundsZoom(this._bounds),R=this._zoom+1,q=o.getZoom(),X;v.length>0&&I>R;){R++;var re=[];for(X=0;X<v.length;X++)re=re.concat(v[X]._childClusters);v=re}I>R?this._group._map.setView(this._latlng,R):I<=q?this._group._map.setView(this._latlng,q+1):this._group._map.fitBounds(this._bounds,w)},getBounds:function(){var w=new L.LatLngBounds;return w.extend(this._bounds),w},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(w,v){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(w),w instanceof L.MarkerCluster?(v||(this._childClusters.push(w),w.__parent=this),this._childCount+=w._childCount):(v||this._markers.push(w),this._childCount++),this.__parent&&this.__parent._addChild(w,!0)},_setClusterCenter:function(w){this._cLatLng||(this._cLatLng=w._cLatLng||w._latlng)},_resetBounds:function(){var w=this._bounds;w._southWest&&(w._southWest.lat=1/0,w._southWest.lng=1/0),w._northEast&&(w._northEast.lat=-1/0,w._northEast.lng=-1/0)},_recalculateBounds:function(){var w=this._markers,v=this._childClusters,o=0,I=0,R=this._childCount,q,X,re,ce;if(R!==0){for(this._resetBounds(),q=0;q<w.length;q++)re=w[q]._latlng,this._bounds.extend(re),o+=re.lat,I+=re.lng;for(q=0;q<v.length;q++)X=v[q],X._boundsNeedUpdate&&X._recalculateBounds(),this._bounds.extend(X._bounds),re=X._wLatLng,ce=X._childCount,o+=re.lat*ce,I+=re.lng*ce;this._latlng=this._wLatLng=new L.LatLng(o/R,I/R),this._boundsNeedUpdate=!1}},_addToMap:function(w){w&&(this._backupLatlng=this._latlng,this.setLatLng(w)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(w,v,o){this._recursively(w,this._group._map.getMinZoom(),o-1,function(I){var R=I._markers,q,X;for(q=R.length-1;q>=0;q--)X=R[q],X._icon&&(X._setPos(v),X.clusterHide())},function(I){var R=I._childClusters,q,X;for(q=R.length-1;q>=0;q--)X=R[q],X._icon&&(X._setPos(v),X.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(w,v,o,I){this._recursively(w,I,v,function(R){R._recursivelyAnimateChildrenIn(w,R._group._map.latLngToLayerPoint(R.getLatLng()).round(),o),R._isSingleParent()&&o-1===I?(R.clusterShow(),R._recursivelyRemoveChildrenFromMap(w,v,o)):R.clusterHide(),R._addToMap()})},_recursivelyBecomeVisible:function(w,v){this._recursively(w,this._group._map.getMinZoom(),v,null,function(o){o.clusterShow()})},_recursivelyAddChildrenToMap:function(w,v,o){this._recursively(o,this._group._map.getMinZoom()-1,v,function(I){if(v!==I._zoom)for(var R=I._markers.length-1;R>=0;R--){var q=I._markers[R];o.contains(q._latlng)&&(w&&(q._backupLatlng=q.getLatLng(),q.setLatLng(w),q.clusterHide&&q.clusterHide()),I._group._featureGroup.addLayer(q))}},function(I){I._addToMap(w)})},_recursivelyRestoreChildPositions:function(w){for(var v=this._markers.length-1;v>=0;v--){var o=this._markers[v];o._backupLatlng&&(o.setLatLng(o._backupLatlng),delete o._backupLatlng)}if(w-1===this._zoom)for(var I=this._childClusters.length-1;I>=0;I--)this._childClusters[I]._restorePosition();else for(var R=this._childClusters.length-1;R>=0;R--)this._childClusters[R]._recursivelyRestoreChildPositions(w)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(w,v,o,I){var R,q;this._recursively(w,v-1,o-1,function(X){for(q=X._markers.length-1;q>=0;q--)R=X._markers[q],(!I||!I.contains(R._latlng))&&(X._group._featureGroup.removeLayer(R),R.clusterShow&&R.clusterShow())},function(X){for(q=X._childClusters.length-1;q>=0;q--)R=X._childClusters[q],(!I||!I.contains(R._latlng))&&(X._group._featureGroup.removeLayer(R),R.clusterShow&&R.clusterShow())})},_recursively:function(w,v,o,I,R){var q=this._childClusters,X=this._zoom,re,ce;if(v<=X&&(I&&I(this),R&&X===o&&R(this)),X<v||X<o)for(re=q.length-1;re>=0;re--)ce=q[re],ce._boundsNeedUpdate&&ce._recalculateBounds(),w.intersects(ce._bounds)&&ce._recursively(w,v,o,I,R)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var w=this.options.opacity;return this.setOpacity(0),this.options.opacity=w,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(w){this._cellSize=w,this._sqCellSize=w*w,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(w,v){var o=this._getCoord(v.x),I=this._getCoord(v.y),R=this._grid,q=R[I]=R[I]||{},X=q[o]=q[o]||[],re=L.Util.stamp(w);this._objectPoint[re]=v,X.push(w)},updateObject:function(w,v){this.removeObject(w),this.addObject(w,v)},removeObject:function(w,v){var o=this._getCoord(v.x),I=this._getCoord(v.y),R=this._grid,q=R[I]=R[I]||{},X=q[o]=q[o]||[],re,ce;for(delete this._objectPoint[L.Util.stamp(w)],re=0,ce=X.length;re<ce;re++)if(X[re]===w)return X.splice(re,1),ce===1&&delete q[o],!0},eachObject:function(w,v){var o,I,R,q,X,re,ce,Ae=this._grid;for(o in Ae){X=Ae[o];for(I in X)for(re=X[I],R=0,q=re.length;R<q;R++)ce=w.call(v,re[R]),ce&&(R--,q--)}},getNearObject:function(w){var v=this._getCoord(w.x),o=this._getCoord(w.y),I,R,q,X,re,ce,Ae,Pe,le=this._objectPoint,it=this._sqCellSize,We=null;for(I=o-1;I<=o+1;I++)if(X=this._grid[I],X){for(R=v-1;R<=v+1;R++)if(re=X[R],re)for(q=0,ce=re.length;q<ce;q++)Ae=re[q],Pe=this._sqDist(le[L.Util.stamp(Ae)],w),(Pe<it||Pe<=it&&We===null)&&(it=Pe,We=Ae)}return We},_getCoord:function(w){var v=Math.floor(w/this._cellSize);return isFinite(v)?v:w},_sqDist:function(w,v){var o=v.x-w.x,I=v.y-w.y;return o*o+I*I}},(function(){L.QuickHull={getDistant:function(w,v){var o=v[1].lat-v[0].lat,I=v[0].lng-v[1].lng;return I*(w.lat-v[0].lat)+o*(w.lng-v[0].lng)},findMostDistantPointFromBaseLine:function(w,v){var o=0,I=null,R=[],q,X,re;for(q=v.length-1;q>=0;q--){if(X=v[q],re=this.getDistant(X,w),re>0)R.push(X);else continue;re>o&&(o=re,I=X)}return{maxPoint:I,newPoints:R}},buildConvexHull:function(w,v){var o=[],I=this.findMostDistantPointFromBaseLine(w,v);return I.maxPoint?(o=o.concat(this.buildConvexHull([w[0],I.maxPoint],I.newPoints)),o=o.concat(this.buildConvexHull([I.maxPoint,w[1]],I.newPoints)),o):[w[0]]},getConvexHull:function(w){var v=!1,o=!1,I=!1,R=!1,q=null,X=null,re=null,ce=null,Ae=null,Pe=null,le;for(le=w.length-1;le>=0;le--){var it=w[le];(v===!1||it.lat>v)&&(q=it,v=it.lat),(o===!1||it.lat<o)&&(X=it,o=it.lat),(I===!1||it.lng>I)&&(re=it,I=it.lng),(R===!1||it.lng<R)&&(ce=it,R=it.lng)}o!==v?(Pe=X,Ae=q):(Pe=ce,Ae=re);var We=[].concat(this.buildConvexHull([Pe,Ae],w),this.buildConvexHull([Ae,Pe],w));return We}}})(),L.MarkerCluster.include({getConvexHull:function(){var w=this.getAllChildMarkers(),v=[],o,I;for(I=w.length-1;I>=0;I--)o=w[I].getLatLng(),v.push(o);return L.QuickHull.getConvexHull(v)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var w=this.getAllChildMarkers(null,!0),v=this._group,o=v._map,I=o.latLngToLayerPoint(this._latlng),R;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?R=this._group.options.spiderfyShapePositions(w.length,I):w.length>=this._circleSpiralSwitchover?R=this._generatePointsSpiral(w.length,I):(I.y+=10,R=this._generatePointsCircle(w.length,I)),this._animationSpiderfy(w,R)}},unspiderfy:function(w){this._group._inZoomAnimation||(this._animationUnspiderfy(w),this._group._spiderfied=null)},_generatePointsCircle:function(w,v){var o=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+w),I=o/this._2PI,R=this._2PI/w,q=[],X,re;for(I=Math.max(I,35),q.length=w,X=0;X<w;X++)re=this._circleStartAngle+X*R,q[X]=new L.Point(v.x+I*Math.cos(re),v.y+I*Math.sin(re))._round();return q},_generatePointsSpiral:function(w,v){var o=this._group.options.spiderfyDistanceMultiplier,I=o*this._spiralLengthStart,R=o*this._spiralFootSeparation,q=o*this._spiralLengthFactor*this._2PI,X=0,re=[],ce;for(re.length=w,ce=w;ce>=0;ce--)ce<w&&(re[ce]=new L.Point(v.x+I*Math.cos(X),v.y+I*Math.sin(X))._round()),X+=R/I+ce*5e-4,I+=q/X;return re},_noanimationUnspiderfy:function(){var w=this._group,v=w._map,o=w._featureGroup,I=this.getAllChildMarkers(null,!0),R,q;for(w._ignoreMove=!0,this.setOpacity(1),q=I.length-1;q>=0;q--)R=I[q],o.removeLayer(R),R._preSpiderfyLatlng&&(R.setLatLng(R._preSpiderfyLatlng),delete R._preSpiderfyLatlng),R.setZIndexOffset&&R.setZIndexOffset(0),R._spiderLeg&&(v.removeLayer(R._spiderLeg),delete R._spiderLeg);w.fire("unspiderfied",{cluster:this,markers:I}),w._ignoreMove=!1,w._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(w,v){var o=this._group,I=o._map,R=o._featureGroup,q=this._group.options.spiderLegPolylineOptions,X,re,ce,Ae;for(o._ignoreMove=!0,X=0;X<w.length;X++)Ae=I.layerPointToLatLng(v[X]),re=w[X],ce=new L.Polyline([this._latlng,Ae],q),I.addLayer(ce),re._spiderLeg=ce,re._preSpiderfyLatlng=re._latlng,re.setLatLng(Ae),re.setZIndexOffset&&re.setZIndexOffset(1e6),R.addLayer(re);this.setOpacity(.3),o._ignoreMove=!1,o.fire("spiderfied",{cluster:this,markers:w})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(w,v){var o=this,I=this._group,R=I._map,q=I._featureGroup,X=this._latlng,re=R.latLngToLayerPoint(X),ce=L.Path.SVG,Ae=L.extend({},this._group.options.spiderLegPolylineOptions),Pe=Ae.opacity,le,it,We,He,bt,Bt;for(Pe===void 0&&(Pe=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),ce?(Ae.opacity=0,Ae.className=(Ae.className||"")+" leaflet-cluster-spider-leg"):Ae.opacity=Pe,I._ignoreMove=!0,le=0;le<w.length;le++)it=w[le],Bt=R.layerPointToLatLng(v[le]),We=new L.Polyline([X,Bt],Ae),R.addLayer(We),it._spiderLeg=We,ce&&(He=We._path,bt=He.getTotalLength()+.1,He.style.strokeDasharray=bt,He.style.strokeDashoffset=bt),it.setZIndexOffset&&it.setZIndexOffset(1e6),it.clusterHide&&it.clusterHide(),q.addLayer(it),it._setPos&&it._setPos(re);for(I._forceLayout(),I._animationStart(),le=w.length-1;le>=0;le--)Bt=R.layerPointToLatLng(v[le]),it=w[le],it._preSpiderfyLatlng=it._latlng,it.setLatLng(Bt),it.clusterShow&&it.clusterShow(),ce&&(We=it._spiderLeg,He=We._path,He.style.strokeDashoffset=0,We.setStyle({opacity:Pe}));this.setOpacity(.3),I._ignoreMove=!1,setTimeout(function(){I._animationEnd(),I.fire("spiderfied",{cluster:o,markers:w})},200)},_animationUnspiderfy:function(w){var v=this,o=this._group,I=o._map,R=o._featureGroup,q=w?I._latLngToNewLayerPoint(this._latlng,w.zoom,w.center):I.latLngToLayerPoint(this._latlng),X=this.getAllChildMarkers(null,!0),re=L.Path.SVG,ce,Ae,Pe,le,it,We;for(o._ignoreMove=!0,o._animationStart(),this.setOpacity(1),Ae=X.length-1;Ae>=0;Ae--)ce=X[Ae],ce._preSpiderfyLatlng&&(ce.closePopup(),ce.setLatLng(ce._preSpiderfyLatlng),delete ce._preSpiderfyLatlng,We=!0,ce._setPos&&(ce._setPos(q),We=!1),ce.clusterHide&&(ce.clusterHide(),We=!1),We&&R.removeLayer(ce),re&&(Pe=ce._spiderLeg,le=Pe._path,it=le.getTotalLength()+.1,le.style.strokeDashoffset=it,Pe.setStyle({opacity:0})));o._ignoreMove=!1,setTimeout(function(){var He=0;for(Ae=X.length-1;Ae>=0;Ae--)ce=X[Ae],ce._spiderLeg&&He++;for(Ae=X.length-1;Ae>=0;Ae--)ce=X[Ae],ce._spiderLeg&&(ce.clusterShow&&ce.clusterShow(),ce.setZIndexOffset&&ce.setZIndexOffset(0),He>1&&R.removeLayer(ce),I.removeLayer(ce._spiderLeg),delete ce._spiderLeg);o._animationEnd(),o.fire("unspiderfied",{cluster:v,markers:X})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(w){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(w))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(w){this._spiderfied&&this._spiderfied.unspiderfy(w)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(w){w._spiderLeg&&(this._featureGroup.removeLayer(w),w.clusterShow&&w.clusterShow(),w.setZIndexOffset&&w.setZIndexOffset(0),this._map.removeLayer(w._spiderLeg),delete w._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(w){return w?w instanceof L.MarkerClusterGroup?w=w._topClusterLevel.getAllChildMarkers():w instanceof L.LayerGroup?w=w._layers:w instanceof L.MarkerCluster?w=w.getAllChildMarkers():w instanceof L.Marker&&(w=[w]):w=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(w),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(w),this},_flagParentsIconsNeedUpdate:function(w){var v,o;for(v in w)for(o=w[v].__parent;o;)o._iconNeedsUpdate=!0,o=o.__parent},_refreshSingleMarkerModeMarkers:function(w){var v,o;for(v in w)o=w[v],this.hasLayer(o)&&o.setIcon(this._overrideMarkerIcon(o))}}),L.Marker.include({refreshIconOptions:function(w,v){var o=this.options.icon;return L.setOptions(o,w),this.setIcon(o),v&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),De.MarkerClusterGroup=st,De.MarkerCluster=T,Object.defineProperty(De,"__esModule",{value:!0})})})(Xu,Xu.exports)),Xu.exports}W_();export{X_ as L,Y_ as m};
