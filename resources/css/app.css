/* 1. Imports (MUST be first) */
@import "leaflet/dist/leaflet.css";
@import "leaflet-draw/dist/leaflet.draw.css";
@import "maplibre-gl/dist/maplibre-gl.css";
@import "@fontsource/plus-jakarta-sans/300.css";
@import "@fontsource/plus-jakarta-sans/400.css";
@import "@fontsource/plus-jakarta-sans/500.css";
@import "@fontsource/plus-jakarta-sans/600.css";
@import "@fontsource/plus-jakarta-sans/700.css";
@import "@fontsource/noto-sans/400.css";
@import "@fontsource/noto-sans/500.css";
@import "@fontsource/noto-sans/700.css";
@import "@fontsource/poppins/500.css";
@import "@fontsource/poppins/700.css";
@import "@fontsource/poppins/900.css";
@import "@fontsource/inter/400.css";
@import "@fontsource/inter/500.css";
@import "@fontsource/inter/600.css";
@import "@fontsource/inter/700.css";
@import "@fontsource/pinyon-script/400.css";
@import "@fontsource/playfair-display/400.css";
@import "@fontsource/playfair-display/700.css";
@import "@fontsource/playfair-display/900.css";
@import "@fontsource/playfair-display/400-italic.css";
@import "@fontsource/figtree/400.css";
@import "@fontsource/figtree/500.css";
@import "@fontsource/figtree/600.css";
@import "@fontsource/figtree/700.css";
@import "@fontsource/figtree/800.css";
@import "material-symbols";
@import "@fortawesome/fontawesome-free/css/all.css";
@import "@fontsource/caveat/400.css";
@import "@fontsource/caveat/500.css";
@import "@fontsource/caveat/600.css";
@import "@fontsource/caveat/700.css";
@import "@fontsource/noto-serif/400.css";
@import "@fontsource/noto-serif/700.css";
@import "@fontsource/noto-serif/900.css";
@import "@fontsource/press-start-2p/400.css";

/* 2. Tailwind Directives */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* 3. Article Content Styles (supports legacy HTML + Editor.js output) */
@layer components {
    .article-content h1,
    .tinymce-content h1 {
        @apply text-3xl font-bold my-4;
    }

    .article-content h2,
    .tinymce-content h2 {
        @apply text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-white;
    }

    .article-content h3,
    .tinymce-content h3 {
        @apply text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white;
    }

    .article-content h4,
    .tinymce-content h4 {
        @apply text-lg font-semibold mt-4 mb-2 text-gray-800 dark:text-gray-200;
    }

    .article-content p,
    .tinymce-content p {
        @apply mb-4 leading-relaxed;
    }

    .article-content ul,
    .tinymce-content ul {
        @apply list-disc ml-6 mb-4 space-y-1;
    }

    .article-content ol,
    .tinymce-content ol {
        @apply list-decimal ml-6 mb-4 space-y-1;
    }

    .article-content blockquote,
    .tinymce-content blockquote {
        @apply border-l-4 border-blue-300 pl-5 italic my-6 text-gray-600 dark:text-gray-400;
    }

    .article-content blockquote cite {
        @apply block mt-2 not-italic text-sm text-gray-500;
    }

    /* Images */
    .article-content img,
    .tinymce-content img {
        @apply max-w-full h-auto rounded-xl my-2 shadow-sm;
    }

    .article-content figure {
        @apply my-6;
    }

    .article-content figcaption {
        @apply text-center text-sm text-gray-500 mt-2;
    }

    /* Tables */
    .article-content table {
        @apply w-full border-collapse my-6;
    }

    .article-content td,
    .article-content th {
        @apply border border-gray-200 dark:border-gray-700 px-3 py-2 text-sm;
    }

    .article-content th {
        @apply bg-gray-50 dark:bg-gray-800 font-semibold;
    }

    /* Code blocks */
    .article-content pre {
        @apply bg-gray-900 text-gray-100 p-4 rounded-xl my-4 overflow-x-auto text-sm;
    }

    .article-content code {
        @apply font-mono;
    }

    /* Horizontal rules */
    .article-content hr {
        @apply my-8 border-gray-200 dark:border-gray-700;
    }

    /* Warning blocks */
    .article-content .warning-block {
        @apply bg-amber-50 dark:bg-amber-900/20 border-l-4 border-amber-400 p-4 my-4 rounded-r-xl;
    }

    /* Embeds (responsive iframes) */
    .article-content .aspect-video {
        @apply relative rounded-xl overflow-hidden shadow-sm;
        padding-bottom: 56.25%;
    }

    /* Legacy TinyMCE alignment classes */
    .tinymce-content .alignleft,
    .article-content .alignleft {
        float: left;
        margin-right: 1.5rem;
        margin-bottom: 1rem;
    }

    .tinymce-content .alignright,
    .article-content .alignright {
        float: right;
        margin-left: 1.5rem;
        margin-bottom: 1rem;
    }

    .tinymce-content .aligncenter,
    .article-content .aligncenter {
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    /* Fusion (Merge & Transform) Animation */
    .fusion-line {
        transform-origin: center;
        transition: opacity 0.3s ease;
    }

    /* Top Line Animation */
    @keyframes fusion-top-open {
        0% {
            transform: translateY(0) rotate(0deg);
        }

        50% {
            transform: translateY(6px) rotate(0deg);
        }

        100% {
            transform: translateY(6px) rotate(45deg);
        }
    }

    @keyframes fusion-top-close {
        0% {
            transform: translateY(6px) rotate(45deg);
        }

        50% {
            transform: translateY(6px) rotate(0deg);
        }

        100% {
            transform: translateY(0) rotate(0deg);
        }
    }

    /* Bottom Line Animation */
    @keyframes fusion-bottom-open {
        0% {
            transform: translateY(0) rotate(0deg);
        }

        50% {
            transform: translateY(-6px) rotate(0deg);
        }

        100% {
            transform: translateY(-6px) rotate(-45deg);
        }
    }

    @keyframes fusion-bottom-close {
        0% {
            transform: translateY(-6px) rotate(-45deg);
        }

        50% {
            transform: translateY(-6px) rotate(0deg);
        }

        100% {
            transform: translateY(0) rotate(0deg);
        }
    }

    /* Apply Animations */
    .menu-open .fusion-line-1 {
        animation: fusion-top-open 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .menu-closed .fusion-line-1 {
        animation: fusion-top-close 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .menu-open .fusion-line-2 {
        opacity: 0;
    }

    .menu-closed .fusion-line-2 {
        opacity: 1;
        transition-delay: 0.3s;
    }

    .menu-open .fusion-line-3 {
        animation: fusion-bottom-open 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .menu-closed .fusion-line-3 {
        animation: fusion-bottom-close 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    /* Clearfix for floats */
    .tinymce-content::after {
        content: "";
        display: table;
        clear: both;
    }
}

@layer utilities {

    /* Hide scrollbar for Chrome, Safari and Opera */
    .no-scrollbar::-webkit-scrollbar {
        display: none;
    }

    /* Hide scrollbar for IE, Edge and Firefox */
    .no-scrollbar {
        -ms-overflow-style: none;
        /* IE and Edge */
        scrollbar-width: none;
        /* Firefox */
    }

    .mask-image-b {
        -webkit-mask-image: linear-gradient(to bottom, black 60%, transparent 100%);
        mask-image: linear-gradient(to bottom, black 60%, transparent 100%);
    }
}

/* Prevent Alpine.js "flicker" */
[x-cloak] {
    display: none !important;
}

/* 4. Livewire SPA Progress Bar Smoothing */
.livewire-progress-bar {
    height: 4px !important;
    background: linear-gradient(to right, #2563eb, #60a5fa, #2563eb) !important;
    background-size: 200% 100% !important;
    animation: loading-shimmer 1.5s linear infinite !important;
    box-shadow: 0 0 15px rgba(37, 99, 235, 0.5) !important;
    z-index: 2147483647 !important;
    transition: all 0.4s ease-out !important;
}

@keyframes loading-shimmer {
    0% {
        background-position: 200% 0;
    }

    100% {
        background-position: -200% 0;
    }
}

/* 5. Page Transitions & Entry Animations */
.page-entry {
    animation: page-fade-in-up 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    opacity: 0;
    will-change: transform, opacity;
}

@keyframes page-fade-in-up {
    0% {
        opacity: 0;
        transform: translateY(15px);
        filter: blur(4px);
    }

    100% {
        opacity: 1;
        transform: translateY(0);
        filter: blur(0);
    }
}

/* Optional: Staggered entry for children */
.stagger-entry>* {
    opacity: 0;
    animation: page-fade-in-up 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
}

.stagger-entry>*:nth-child(1) {
    animation-delay: 0.05s;
}

.stagger-entry>*:nth-child(2) {
    animation-delay: 0.1s;
}

.stagger-entry>*:nth-child(3) {
    animation-delay: 0.15s;
}

.stagger-entry>*:nth-child(4) {
    animation-delay: 0.2s;
}

.stagger-entry>*:nth-child(5) {
    animation-delay: 0.25s;
}

/* 6. Leaflet Fixes */
.leaflet-pane img,
.leaflet-tile,
.leaflet-marker-icon,
.leaflet-marker-shadow {
    max-width: none !important;
    max-height: none !important;
}

.leaflet-tile-container {
    pointer-events: auto !important;
}